
# –ó–∞–º–µ—Ç–∫–∏ –ø–æ –∏–∑—É—á–µ–Ω–∏—é Three.js –∏ PBR

## 1. Physically Based Rendering (PBR) - –§–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://discoverthreejs.com/book/first-steps/physically-based-rendering/

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:

#### –ß—Ç–æ —Ç–∞–∫–æ–µ PBR?
- **PBR (Physically Based Rendering)** - –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ 3D —Å—Ü–µ–Ω
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∑–∏–∫—É —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π —Å–æ —Å–≤–µ—Ç–æ–º
- –°–æ–∑–¥–∞–Ω Disney –¥–ª—è –ø–æ–ª–Ω–æ–º–µ—Ç—Ä–∞–∂–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–≥—Ä–æ–≤—ã—Ö –¥–≤–∏–∂–∫–∞—Ö (Unreal, Frostbite)
- Three.js (–≤—Å–µ–≥–æ 600kb) –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ –∂–µ —Ç–µ—Ö–Ω–∏–∫–∏, —á—Ç–æ –∏ –∫—Ä—É–ø–Ω—ã–µ —Å—Ç—É–¥–∏–∏

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PBR:
- **–£–±–∏—Ä–∞–µ—Ç –¥–æ–≥–∞–¥–∫–∏** –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ –æ—Å–≤–µ—â–µ–Ω–∏—è
- **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤—ã–≥–ª—è–¥—è—Ç —Ö–æ—Ä–æ—à–æ –ø—Ä–∏ –ª—é–±–æ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏**
- **–õ–µ–≥–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–µ–Ω—å/–Ω–æ—á—å**: –ø—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–≤–µ—Ç–∞
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª—é–º–µ–Ω—ã –¥–ª—è –ª–∞–º–ø–æ—á–µ–∫)

---

## 2. –û—Å–≤–µ—â–µ–Ω–∏–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ Three.js

### –°–≤—è–∑—å –æ—Å–≤–µ—â–µ–Ω–∏—è –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:
- –û—Å–≤–µ—â–µ–Ω–∏–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã **–Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω–æ —Å–≤—è–∑–∞–Ω—ã**
- –î–ª—è PBR –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω—É–∂–µ–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞**
- `MeshBasicMaterial` - –Ω–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π, —Å–≤–µ—Ç –Ω–µ –Ω—É–∂–µ–Ω
- `MeshStandardMaterial` - —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç —Å–≤–µ—Ç–∞

### –¢–∏–ø—ã –æ—Å–≤–µ—â–µ–Ω–∏—è:

#### Direct Lighting (–ü—Ä—è–º–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ):
–õ—É—á–∏ —Å–≤–µ—Ç–∞ –∏–¥—É—Ç –Ω–∞–ø—Ä—è–º—É—é –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∫ –æ–±—ä–µ–∫—Ç—É.

**–¢–∏–ø—ã –ø—Ä—è–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–≤–µ—Ç–∞:**
1. **DirectionalLight** ‚Üí –°–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ª—É—á–∏)
2. **PointLight** ‚Üí –õ–∞–º–ø–æ—á–∫–∏ (—Å–≤–µ—Ç –≤–æ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã)
3. **RectAreaLight** ‚Üí –ü–æ–ª–æ—Å–æ–≤–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, —è—Ä–∫–∏–µ –æ–∫–Ω–∞
4. **SpotLight** ‚Üí –ü—Ä–æ–∂–µ–∫—Ç–æ—Ä—ã (–∫–æ–Ω—É—Å —Å–≤–µ—Ç–∞)

#### Indirect Lighting (–ù–µ–ø—Ä—è–º–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ):
–õ—É—á–∏ —Å–≤–µ—Ç–∞ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –æ—Ç —Å—Ç–µ–Ω –∏ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–µ—Ä–µ–¥ –ø–æ–ø–∞–¥–∞–Ω–∏–µ–º –Ω–∞ –æ–±—ä–µ–∫—Ç.

**–°–ø–æ—Å–æ–±—ã –∏–º–∏—Ç–∞—Ü–∏–∏:**
- **Ambient lights** - –¥–µ—à–µ–≤—ã–π —Å–ø–æ—Å–æ–± –∏–º–∏—Ç–∞—Ü–∏–∏
- **Image-Based Lighting (IBL)** - –æ—Å–≤–µ—â–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Light probes** - —Å–≤–µ—Ç–æ–≤—ã–µ –∑–æ–Ω–¥—ã

---

## 3. Physically Correct Lighting (–§–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ)

### –í–∫–ª—é—á–µ–Ω–∏–µ:
```javascript
renderer.physicallyCorrectLights = true;
```

### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:
- –†–∞—Å—á–µ—Ç –∑–∞—Ç—É—Ö–∞–Ω–∏—è —Å–≤–µ—Ç–∞ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —Ñ–æ—Ä–º—É–ª–∞–º
- –û—Ç–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **–ù–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤** - –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–∞–π—Ç–µ!

### –í–∞–∂–Ω–æ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏:
**–ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ Three.js = –º–µ—Ç—Ä—ã**

```
1 unit = 1 meter
```

–ü—Ä–∏–º–µ—Ä—ã:
- –ö—É–± 2√ó2√ó2 = 2 –º–µ—Ç—Ä–∞ –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
- `camera.far = 100` = –≤–∏–¥–∏–º–æ—Å—Ç—å –Ω–∞ 100 –º–µ—Ç—Ä–æ–≤
- `camera.near = 0.1` = –æ–±—ä–µ–∫—Ç—ã –±–ª–∏–∂–µ 10 —Å–º –Ω–µ –≤–∏–¥–Ω—ã

**–ï—Å–ª–∏ –º–æ–¥–µ–ª–∏ –≤ –¥—Ä—É–≥–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö (—Ñ—É—Ç—ã, –¥—é–π–º—ã) - –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –≤ –º–µ—Ç—Ä—ã!**

---

## 4. DirectionalLight - –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–≤–µ—Ç

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç **–¥–∞–ª–µ–∫–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞** (—Å–æ–ª–Ω—Ü–µ)
- –õ—É—á–∏ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã**
- –°–≤–µ—Ç **–Ω–µ –∑–∞—Ç—É—Ö–∞–µ—Ç —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º**
- –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –æ—Å–≤–µ—â–µ–Ω—ã **–æ–¥–∏–Ω–∞–∫–æ–≤–æ —è—Ä–∫–æ**
- –°–≤–µ—Ç–∏—Ç –æ—Ç `light.position` –∫ `light.target.position`
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é target = (0, 0, 0) - —Ü–µ–Ω—Ç—Ä —Å—Ü–µ–Ω—ã

### –°–æ–∑–¥–∞–Ω–∏–µ:
```javascript
import { DirectionalLight } from 'three';

const light = new DirectionalLight('white', 8);
light.position.set(10, 10, 10); // x, y, z

scene.add(light);
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `color` - —Ü–≤–µ—Ç —Å–≤–µ—Ç–∞ (CSS –Ω–∞–∑–≤–∞–Ω–∏—è –∏–ª–∏ hex)
- `intensity` - –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å (—è—Ä–∫–æ—Å—Ç—å)

---

## 5. MeshStandardMaterial - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π PBR –º–∞—Ç–µ—Ä–∏–∞–ª

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- **–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π**, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω—ã–π
- –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–≤–µ—Ç –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–±–æ—Ä** –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–∏—Ç—É–∞—Ü–∏–π
- –° —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏ –º–æ–∂–Ω–æ –≤–æ—Å—Å–æ–∑–¥–∞—Ç—å –ø–æ—á—Ç–∏ –ª—é–±—É—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å

### –°–æ–∑–¥–∞–Ω–∏–µ:
```javascript
import { MeshStandardMaterial } from 'three';

const material = new MeshStandardMaterial({ 
  color: 'purple',
  roughness: 0.5,
  metalness: 0.0
});
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å MeshBasicMaterial:
| MeshBasicMaterial | MeshStandardMaterial |
|-------------------|---------------------|
| –ù–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–≤–µ—Ç | –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–≤–µ—Ç |
| –ü–ª–æ—Å–∫–∏–π –≤–∏–¥ (2D) | –û–±—ä–µ–º–Ω—ã–π –≤–∏–¥ (3D) |
| –ë–∞–∑–æ–≤—ã–π | –§–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π |
| –ë—ã—Å—Ç—Ä—ã–π | –ë–æ–ª–µ–µ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π |

---

## 6. –¢–µ–Ω–∏ (Shadows)

### –í–∞–∂–Ω–æ:
- **–¢–µ–Ω–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** –≤ Three.js
- –û–±—ä–µ–∫—Ç—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç —Å–≤–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù—É–∂–Ω–æ **–≤—Ä—É—á–Ω—É—é –≤–∫–ª—é—á–∞—Ç—å** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏ —Å–≤–µ—Ç–∞
- **–¢–µ–Ω–∏ –¥–æ—Ä–æ–≥–∏–µ** - –æ–±—ã—á–Ω–æ –≤–∫–ª—é—á–∞—é—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è 1-2 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **–¢–æ–ª—å–∫–æ –ø—Ä—è–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–≤–µ—Ç–∞** –º–æ–≥—É—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏
- Ambient lights **–Ω–µ –º–æ–≥—É—Ç** —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ–Ω–∏

### –í–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–Ω–µ–π:
```javascript
// –î–ª—è —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;

// –î–ª—è —Å–≤–µ—Ç–∞
light.castShadow = true;

// –î–ª—è –æ–±—ä–µ–∫—Ç–∞
mesh.castShadow = true;    // –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω—å
mesh.receiveShadow = true; // –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–Ω—å
```

---

## 7. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ (TRS)

–¢—Ä–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Å–ø–æ—Å–æ–±–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤:

1. **Translation (–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ)** - `position`
   ```javascript
   cube.position.set(x, y, z);
   ```

2. **Rotation (–í—Ä–∞—â–µ–Ω–∏–µ)** - `rotation`
   ```javascript
   cube.rotation.set(-0.5, -0.1, 0.8);
   ```

3. **Scaling (–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)** - `scale`
   ```javascript
   cube.scale.set(2, 2, 2);
   ```

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

### ‚úÖ –ß—Ç–æ –º—ã –¥–µ–ª–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. –ò—Å–ø–æ–ª—å–∑—É–µ–º `MeshStandardMaterial` - —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª
2. –ò—Å–ø–æ–ª—å–∑—É–µ–º HDRI –¥–ª—è –æ—Å–≤–µ—â–µ–Ω–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –í–∫–ª—é—á–∏–ª–∏ `physicallyCorrectLights` (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å)

### ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
1. **–¢–µ–Ω–∏**: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–µ–Ω–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
2. **–ú–∞—Å—à—Ç–∞–±**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–æ–¥–µ–ª—å –≤ –º–µ—Ç—Ä–∞—Ö (1 unit = 1 meter)
3. **DirectionalLight**: –ù–∞—à –≤—Ä–∞—â–∞—é—â–∏–π—Å—è —Å–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
4. **SSAO**: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–µ–π –∏ –Ω–æ—Ä–º–∞–ª—è–º–∏

### üí° –ò–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:
1. –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–Ω–µ–π
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ç–µ—Ä–∏–∞–ª–∞ (roughness, metalness)
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–≤–µ—Ç–∞
4. –î–æ–±–∞–≤–∏—Ç—å ambient light –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –Ω–µ–ø—Ä—è–º–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è

---

## –°–ª–µ–¥—É—é—â–∏–µ —Ç–µ–º—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:
- [ ] Image-Based Lighting (IBL) - –¥–µ—Ç–∞–ª—å–Ω–µ–µ
- [ ] –¢–µ–∫—Å—Ç—É—Ä—ã –∏ –∫–∞—Ä—Ç—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–µ–Ω–µ–π
- [ ] Light probes
- [ ] Tone mapping –∏ —Ü–≤–µ—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏—è
—Ä–∞—è: https://www.rustcodeweb.com/2024/04/lighting-and-shadows-in-threejs.html


---

# 2. –û—Å–≤–µ—â–µ–Ω–∏–µ –∏ —Ç–µ–Ω–∏ –≤ Three.js (–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://www.rustcodeweb.com/2024/04/lighting-and-shadows-in-threejs.html

## –¢–∏–ø—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–≤–µ—Ç–∞ –≤ Three.js

### 1. AmbientLight (–†–∞—Å—Å–µ—è–Ω–Ω—ã–π —Å–≤–µ—Ç)
```javascript
const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
scene.add(ambientLight);
```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- **–ò–º–∏—Ç–∏—Ä—É–µ—Ç**: –ù–µ–ø—Ä—è–º–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ (–æ—Ç—Ä–∞–∂–µ–Ω–Ω—ã–π —Å–≤–µ—Ç)
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: 
  - –ù–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  - –ù–µ—Ç —Ç–µ–Ω–µ–π
  - –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –æ—Å–≤–µ—â–∞–µ—Ç –≤—Å—é —Å—Ü–µ–Ω—É
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –î–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–º–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π, –∏–º–∏—Ç–∞—Ü–∏–∏ –æ—Ç—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∞

### 2. DirectionalLight (–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–≤–µ—Ç)
```javascript
const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
directionalLight.position.set(0, 10, 0);
directionalLight.castShadow = true;
scene.add(directionalLight);
```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–≤–µ—Ç –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–ò–º–∏—Ç–∏—Ä—É–µ—Ç**: –°–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ª—É—á–∏
  - –ú–æ–∂–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏
  - –ù–µ –∑–∞—Ç—É—Ö–∞–µ—Ç —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º

### 3. PointLight (–¢–æ—á–µ—á–Ω—ã–π —Å–≤–µ—Ç)
```javascript
const pointLight = new THREE.PointLight(0xffffff, 1, 100);
pointLight.position.set(0, 5, 0);
scene.add(pointLight);
```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–≤–µ—Ç –≤–æ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç —Ç–æ—á–∫–∏
- **–ò–º–∏—Ç–∏—Ä—É–µ—Ç**: –õ–∞–º–ø–æ—á–∫–∞
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - –°–≤–µ—Ç –≤–æ –≤—Å–µ—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö
  - –ó–∞—Ç—É—Ö–∞–µ—Ç —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
  - –ú–æ–∂–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏

### 4. SpotLight (–ü—Ä–æ–∂–µ–∫—Ç–æ—Ä)
```javascript
const spotLight = new THREE.SpotLight(0xffffff, 1);
spotLight.position.set(0, 10, 0);
spotLight.angle = Math.PI / 6;
scene.add(spotLight);
```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–Ω—É—Å–æ–æ–±—Ä–∞–∑–Ω—ã–π –ª—É—á —Å–≤–µ—Ç–∞
- **–ò–º–∏—Ç–∏—Ä—É–µ—Ç**: –§–æ–Ω–∞—Ä–∏–∫, –ø—Ä–æ–∂–µ–∫—Ç–æ—Ä
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—É—Å —Å–≤–µ—Ç–∞
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —É–≥–æ–ª
  - –ú–æ–∂–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏

### 5. HemisphereLight (–ü–æ–ª—É—Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–π —Å–≤–µ—Ç)
```javascript
const hemisphereLight = new THREE.HemisphereLight(0x0000ff, 0xff0000, 0.5);
scene.add(hemisphereLight);
```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å–≤–µ—â–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–≤—É—Ö —Ü–≤–µ—Ç–æ–≤
- **–ò–º–∏—Ç–∏—Ä—É–µ—Ç**: –ù–µ–±–æ –∏ –∑–µ–º–ª—è
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - –î–≤–∞ —Ü–≤–µ—Ç–∞ (–Ω–µ–±–æ/–∑–µ–º–ª—è)
  - –ú—è–≥–∫–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ
  - –ù–µ –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω–∏

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–Ω–µ–π –≤ Three.js

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏ –≤ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–µ
```javascript
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap; // –ú—è–≥–∫–∏–µ —Ç–µ–Ω–∏
```

**–¢–∏–ø—ã —Ç–µ–Ω–µ–π:**
- `THREE.BasicShadowMap` - –ë–∞–∑–æ–≤—ã–µ (–±—ã—Å—Ç—Ä—ã–µ, –Ω–æ —Ä–µ–∑–∫–∏–µ)
- `THREE.PCFShadowMap` - –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ä–µ–¥–Ω–∏–µ)
- `THREE.PCFSoftShadowMap` - –ú—è–≥–∫–∏–µ —Ç–µ–Ω–∏ (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
- `THREE.VSMShadowMap` - Variance Shadow Map (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞
```javascript
directionalLight.castShadow = true; // –°–≤–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω–∏

// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–Ω–µ–π
directionalLight.shadow.mapSize.width = 2048;  // –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Ç–µ–Ω–µ–π
directionalLight.shadow.mapSize.height = 2048;
directionalLight.shadow.camera.near = 0.5;     // –ë–ª–∏–∂–Ω—è—è –ø–ª–æ—Å–∫–æ—Å—Ç—å
directionalLight.shadow.camera.far = 500;      // –î–∞–ª—å–Ω—è—è –ø–ª–æ—Å–∫–æ—Å—Ç—å
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã
```javascript
// –û–±—ä–µ–∫—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω—å
cube.castShadow = true;

// –û–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–Ω—å
floor.receiveShadow = true;
```

---

## –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å —Ç–µ–Ω—è–º–∏

```javascript
// 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;

// 2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∞ —Å —Ç–µ–Ω—è–º–∏
const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
directionalLight.position.set(0, 10, 0);
directionalLight.castShadow = true;

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–Ω–µ–π
directionalLight.shadow.mapSize.width = 2048;
directionalLight.shadow.mapSize.height = 2048;
directionalLight.shadow.camera.near = 0.5;
directionalLight.shadow.camera.far = 500;

scene.add(directionalLight);

// 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—Å–µ—è–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∞ (–∑–∞–ø–æ–ª–Ω—è—é—â–∏–π)
const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
scene.add(ambientLight);

// 4. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —Å —Ç–µ–Ω—è–º–∏
const cubeGeometry = new THREE.BoxGeometry(1, 1, 1);
const cubeMaterial = new THREE.MeshStandardMaterial({ color: 0x00ff00 });
const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
cube.castShadow = true;    // –û—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω—å
cube.receiveShadow = true; // –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–Ω—å
scene.add(cube);

// 5. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ —Ç–µ–Ω–µ–π
const floorGeometry = new THREE.PlaneGeometry(20, 20);
const floorMaterial = new THREE.MeshStandardMaterial({ color: 0x808080 });
const floor = new THREE.Mesh(floorGeometry, floorMaterial);
floor.rotation.x = -Math.PI / 2;
floor.receiveShadow = true; // –ü–æ–ª –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–Ω–∏
scene.add(floor);
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–µ–Ω–µ–π

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. **shadowMapSize** - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Ç–µ–Ω–µ–π
   ```javascript
   light.shadow.mapSize.width = 1024;  // –ú–µ–Ω—å—à–µ = –±—ã—Å—Ç—Ä–µ–µ
   light.shadow.mapSize.height = 1024;
   ```
   - 512√ó512 - –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –±—ã—Å—Ç—Ä–æ
   - 1024√ó1024 - –°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
   - 2048√ó2048 - –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
   - 4096√ó4096 - –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ, –º–µ–¥–ª–µ–Ω–Ω–æ

2. **shadowBias** - –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
   ```javascript
   light.shadow.bias = -0.0001;
   ```
   - –£–±–∏—Ä–∞–µ—Ç "–∞–∫–Ω–µ" –Ω–∞ —Ç–µ–Ω—è—Ö
   - –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ = –æ—Ç—Ä—ã–≤ —Ç–µ–Ω–∏ –æ—Ç –æ–±—ä–µ–∫—Ç–∞

3. **shadowCameraNear/Far** - –ì—Ä–∞–Ω–∏—Ü—ã –∫–∞–º–µ—Ä—ã —Ç–µ–Ω–µ–π
   ```javascript
   light.shadow.camera.near = 0.5;
   light.shadow.camera.far = 500;
   ```
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±–ª–∞—Å—Ç—å, –≥–¥–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–µ–Ω–∏
   - –ú–µ–Ω—å—à–∞—è –æ–±–ª–∞—Å—Ç—å = –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ

4. **shadowCamera (–¥–ª—è DirectionalLight)**
   ```javascript
   light.shadow.camera.left = -50;
   light.shadow.camera.right = 50;
   light.shadow.camera.top = 50;
   light.shadow.camera.bottom = -50;
   ```
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –æ–±–ª–∞—Å—Ç–∏ —Ç–µ–Ω–µ–π
   - –î–æ–ª–∂–Ω–∞ –ø–æ–∫—Ä—ã–≤–∞—Ç—å –≤—Å—é —Å—Ü–µ–Ω—É

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–≤–µ—Ç–∞

| –¢–∏–ø —Å–≤–µ—Ç–∞ | –¢–µ–Ω–∏ | –ó–∞—Ç—É—Ö–∞–Ω–∏–µ | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|-----------|------|-----------|-------------|-------------------|
| AmbientLight | ‚ùå | ‚ùå | ‚ùå | ‚ö°‚ö°‚ö° –û—Ç–ª–∏—á–Ω–æ |
| DirectionalLight | ‚úÖ | ‚ùå | ‚úÖ | ‚ö°‚ö° –•–æ—Ä–æ—à–æ |
| PointLight | ‚úÖ | ‚úÖ | ‚ùå | ‚ö° –°—Ä–µ–¥–Ω–µ |
| SpotLight | ‚úÖ | ‚úÖ | ‚úÖ | ‚ö° –°—Ä–µ–¥–Ω–µ |
| HemisphereLight | ‚ùå | ‚ùå | –ß–∞—Å—Ç–∏—á–Ω–æ | ‚ö°‚ö°‚ö° –û—Ç–ª–∏—á–Ω–æ |

---

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–∞—à–µ–º—É –ø—Ä–æ–µ–∫—Ç—É

### ‚úÖ –ß—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. **DirectionalLight** –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è (—Å–æ–ª–Ω—Ü–µ)
2. **–í—Ä–∞—â–µ–Ω–∏–µ —Å–≤–µ—Ç–∞** –≤–º–µ—Å—Ç–µ —Å HDRI —Ñ–æ–Ω–æ–º
3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ shadow map** (2048√ó2048)

### ‚ö†Ô∏è –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

1. **–î–æ–±–∞–≤–∏—Ç—å AmbientLight** –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–º–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π:
   ```javascript
   const ambientLight = new THREE.AmbientLight(0x404040, 0.3);
   scene.add(ambientLight);
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–Ω–µ–π** –¥–ª—è –º–æ–¥–µ–ª–∏:
   ```javascript
   // –í VenueModel.tsx
   child.castShadow = true;
   child.receiveShadow = true;
   ```

3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å shadow camera** –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –∑–¥–∞–Ω–∏—è:
   ```javascript
   directionalLight.shadow.camera.left = -100;
   directionalLight.shadow.camera.right = 100;
   directionalLight.shadow.camera.top = 100;
   directionalLight.shadow.camera.bottom = -100;
   ```

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å shadowBias** –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤:
   ```javascript
   directionalLight.shadow.bias = -0.0001;
   directionalLight.shadow.normalBias = 0.02;
   ```

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –æ—Å–≤–µ—â–µ–Ω–∏—è**: DirectionalLight (–æ—Å–Ω–æ–≤–Ω–æ–π) + AmbientLight (–∑–∞–ø–æ–ª–Ω—è—é—â–∏–π)
2. **–î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö**: –£–º–µ–Ω—å—à–∏—Ç—å shadowMapSize –¥–æ 1024√ó1024
3. **–î–ª—è –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å PointLight –≤ –ø–æ–º–µ—â–µ–Ω–∏—è—Ö
4. **SSAO + —Ç–µ–Ω–∏**: –í–º–µ—Å—Ç–µ –¥–∞—é—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–ª—É–±–∏–Ω—ã

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:

1. **–¢–µ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –Ω–∞ —Ç—Ä–µ—Ö —É—Ä–æ–≤–Ω—è—Ö: renderer, light, objects
2. **AmbientLight** - –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —É–ª—É—á—à–∏—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ –±–µ–∑ —Ç–µ–Ω–µ–π
3. **–ö–∞—á–µ—Å—Ç–≤–æ —Ç–µ–Ω–µ–π** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç shadowMapSize –∏ —Ç–∏–ø–∞ shadowMap
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
5. **–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** —Å–≤–µ—Ç–∞ –¥–∞–µ—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç


---

# 3. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Three.js - –û—Å–≤–µ—â–µ–Ω–∏–µ

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://threejs.org/manual/en/lights.html

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ—Å–≤–µ—â–µ–Ω–∏—è

### –í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å:
- **–ö–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º—É–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –†–∞–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ-—Ä–∞–∑–Ω–æ–º—É —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ —Å–≤–µ—Ç
- Helpers (–ø–æ–º–æ—â–Ω–∏–∫–∏) –ø–æ–º–æ–≥–∞—é—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–≤–∏–¥–∏–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–≤–µ—Ç–∞

---

## 1. AmbientLight - –†–∞—Å—Å–µ—è–Ω–Ω—ã–π —Å–≤–µ—Ç

### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞:
```
finalColor = materialColor * light.color * light.intensity
```

### –ö–æ–¥:
```javascript
const color = 0xFFFFFF;
const intensity = 1;
const light = new THREE.AmbientLight(color, intensity);
scene.add(light);
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚úÖ **–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π** –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞
- ‚úÖ **–ù–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è** - –æ—Å–≤–µ—â–∞–µ—Ç –≤—Å–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- ‚úÖ **–ù–µ—Ç —Ç–µ–Ω–µ–π**
- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–π** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á–µ—Ç–æ–≤
- ‚ùå **–ü–ª–æ—Å–∫–∏–π –≤–∏–¥** - –Ω–µ—Ç –æ–±—ä–µ–º–∞ –∏ –≥–ª—É–±–∏–Ω—ã
- ‚ùå **–ù–µ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ**

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- –ß—Ç–æ–±—ã **—Ç–µ–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –Ω–µ –±—ã–ª–∏ —Å–ª–∏—à–∫–æ–º —Ç–µ–º–Ω—ã–º–∏**
- –ö–∞–∫ **–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ** –∫ –¥—Ä—É–≥–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º —Å–≤–µ—Ç–∞
- **–ù–ï –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π** –∏—Å—Ç–æ—á–Ω–∏–∫ –æ—Å–≤–µ—â–µ–Ω–∏—è

### –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:
```
–ë–ï–ó AmbientLight: –¢–µ–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ = —á–µ—Ä–Ω—ã–µ
–° AmbientLight:   –¢–µ–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ = —Å–ª–µ–≥–∫–∞ –æ—Å–≤–µ—â–µ–Ω—ã
```

---

## 2. HemisphereLight - –ü–æ–ª—É—Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–π —Å–≤–µ—Ç

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
–î–≤–∞ —Ü–≤–µ—Ç–∞: **–Ω–µ–±–æ** (—Å–≤–µ—Ä—Ö—É) –∏ **–∑–µ–º–ª—è** (—Å–Ω–∏–∑—É)

### –ö–æ–¥:
```javascript
const skyColor = 0xB1E1FF;      // —Å–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π
const groundColor = 0xB97A20;   // –∫–æ—Ä–∏—á–Ω–µ–≤–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π
const intensity = 1;
const light = new THREE.HemisphereLight(skyColor, groundColor, intensity);
scene.add(light);
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏, **–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–≤–µ—Ä—Ö** ‚Üí –ø–æ–ª—É—á–∞—é—Ç skyColor
- –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏, **–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–Ω–∏–∑** ‚Üí –ø–æ–ª—É—á–∞—é—Ç groundColor
- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É–≥–ª—ã ‚Üí **—Å–º–µ—à–∏–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤**

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚úÖ –ò–º–∏—Ç–∏—Ä—É–µ—Ç **–≤–ª–∏—è–Ω–∏–µ –Ω–µ–±–∞ –∏ –∑–µ–º–ª–∏**
- ‚úÖ –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ —á–µ–º AmbientLight
- ‚úÖ –•–æ—Ä–æ—à–æ **–≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏** —Å –¥—Ä—É–≥–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
- ‚ùå –í—Å–µ –µ—â–µ **–Ω–µ—Ç —á–µ—Ç–∫–æ–π —Ñ–æ—Ä–º—ã** –æ–±—ä–µ–∫—Ç–æ–≤
- ‚ùå **–ù–µ –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω–∏**

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **–í–º–µ—Å—Ç–æ AmbientLight** –¥–ª—è –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –≤–∏–¥–∞
- **–í –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏** —Å DirectionalLight (—Å–æ–ª–Ω—Ü–µ)
- –î–ª—è **–Ω–∞—Ä—É–∂–Ω—ã—Ö —Å—Ü–µ–Ω** (–Ω–µ–±–æ + –∑–µ–º–ª—è)

---

## 3. DirectionalLight - –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–≤–µ—Ç (–°–æ–ª–Ω—Ü–µ)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ª—É—á–∏ —Å–≤–µ—Ç–∞ –∏–∑ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏

### –ö–æ–¥:
```javascript
const color = 0xFFFFFF;
const intensity = 1;
const light = new THREE.DirectionalLight(color, intensity);
light.position.set(0, 10, 0);
light.target.position.set(-5, 0, 0);
scene.add(light);
scene.add(light.target);  // –í–ê–ñ–ù–û: –¥–æ–±–∞–≤–∏—Ç—å target!
```

### –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
1. **–¢—Ä–µ–±—É–µ—Ç target** - —Å–≤–µ—Ç–∏—Ç –æ—Ç position –∫ target
2. **Target –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—Ü–µ–Ω—É** - `scene.add(light.target)`
3. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ª—É—á–∏** - –Ω–µ —Ä–∞—Å—Ö–æ–¥—è—Ç—Å—è
4. **–ù–µ –∑–∞—Ç—É—Ö–∞–µ—Ç** —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
5. **–ú–æ–∂–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏**

### Helper –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
```javascript
const helper = new THREE.DirectionalLightHelper(light);
scene.add(helper);

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
function updateLight() {
  light.target.updateMatrixWorld();
  helper.update();
}
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ GUI:
```javascript
function makeXYZGUI(gui, vector3, name, onChangeFn) {
  const folder = gui.addFolder(name);
  folder.add(vector3, 'x', -10, 10).onChange(onChangeFn);
  folder.add(vector3, 'y', 0, 10).onChange(onChangeFn);
  folder.add(vector3, 'z', -10, 10).onChange(onChangeFn);
  folder.open();
}

makeXYZGUI(gui, light.position, 'position', updateLight);
makeXYZGUI(gui, light.target.position, 'target', updateLight);
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **–ò–º–∏—Ç–∞—Ü–∏—è —Å–æ–ª–Ω—Ü–∞** - –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞
- **–ù–∞—Ä—É–∂–Ω—ã–µ —Å—Ü–µ–Ω—ã**
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ç–µ–Ω–∏**

---

## 4. PointLight - –¢–æ—á–µ—á–Ω—ã–π —Å–≤–µ—Ç (–õ–∞–º–ø–æ—á–∫–∞)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
–°–≤–µ—Ç –∏–∑–ª—É—á–∞–µ—Ç—Å—è **–≤–æ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã** –æ—Ç —Ç–æ—á–∫–∏

### –ö–æ–¥:
```javascript
const color = 0xFFFFFF;
const intensity = 150;  // –í—ã—à–µ —á–µ–º —É DirectionalLight!
const light = new THREE.PointLight(color, intensity);
light.position.set(0, 10, 0);
scene.add(light);
```

### –í–∞–∂–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ - distance:
```javascript
light.distance = 40;  // –°–≤–µ—Ç –∑–∞—Ç—É—Ö–∞–µ—Ç –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ 40 –µ–¥–∏–Ω–∏—Ü
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ distance:**
- `distance = 0` ‚Üí —Å–≤–µ—Ç –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `distance > 0` ‚Üí —Å–≤–µ—Ç –∑–∞—Ç—É—Ö–∞–µ—Ç –æ—Ç –ø–æ–ª–Ω–æ–π —è—Ä–∫–æ—Å—Ç–∏ –¥–æ 0

### Helper:
```javascript
const helper = new THREE.PointLightHelper(light);
scene.add(helper);
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚úÖ –°–≤–µ—Ç **–≤–æ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã**
- ‚úÖ **–ó–∞—Ç—É—Ö–∞–µ—Ç** —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
- ‚úÖ –ú–æ–∂–µ—Ç **–æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏** (6 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π!)
- ‚ö†Ô∏è **–î–æ—Ä–æ–∂–µ** —á–µ–º DirectionalLight (—Ç–µ–Ω–∏ –≤ 6 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö)

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **–õ–∞–º–ø–æ—á–∫–∏** –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏
- **–°–≤–µ—á–∏, —Ñ–∞–∫–µ–ª—ã**
- –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–≤–µ—Ç–∞

---

## 5. SpotLight - –ü—Ä–æ–∂–µ–∫—Ç–æ—Ä (–§–æ–Ω–∞—Ä–∏–∫)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
–ö–æ–Ω—É—Å —Å–≤–µ—Ç–∞ –æ—Ç —Ç–æ—á–∫–∏ –∫ target

### –ö–æ–¥:
```javascript
const color = 0xFFFFFF;
const intensity = 150;
const light = new THREE.SpotLight(color, intensity);
light.position.set(0, 10, 0);
light.target.position.set(-5, 0, 0);
scene.add(light);
scene.add(light.target);
```

### –í–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

#### 1. angle - –£–≥–æ–ª –∫–æ–Ω—É—Å–∞ (–≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö)
```javascript
light.angle = THREE.MathUtils.degToRad(45); // 45 –≥—Ä–∞–¥—É—Å–æ–≤
```

#### 2. penumbra - –†–∞–∑–º—ã—Ç–∏–µ –∫—Ä–∞–µ–≤ (0-1)
```javascript
light.penumbra = 0;    // –†–µ–∑–∫–∏–µ –∫—Ä–∞—è
light.penumbra = 0.5;  // –°—Ä–µ–¥–Ω—è—è —Ä–∞–∑–º—ã—Ç–æ—Å—Ç—å
light.penumbra = 1;    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–º—ã—Ç–æ—Å—Ç—å
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç penumbra:**
- `0` = –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—É—Å = –≤–Ω–µ—à–Ω–∏–π –∫–æ–Ω—É—Å (—Ä–µ–∑–∫–∏–µ –∫—Ä–∞—è)
- `0.5` = –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 50% –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
- `1` = –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ü–µ–Ω—Ç—Ä–∞ –∫–æ–Ω—É—Å–∞

#### 3. distance - –î–∞–ª—å–Ω–æ—Å—Ç—å —Å–≤–µ—Ç–∞
```javascript
light.distance = 20;  // –°–≤–µ—Ç –∑–∞—Ç—É—Ö–∞–µ—Ç –Ω–∞ 20 –µ–¥–∏–Ω–∏—Ü
```

### Helper:
```javascript
const helper = new THREE.SpotLightHelper(light);
scene.add(helper);

function updateLight() {
  light.target.updateMatrixWorld();
  helper.update();
}
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚úÖ **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—É—Å** —Å–≤–µ—Ç–∞
- ‚úÖ **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —É–≥–æ–ª** –∏ —Ä–∞–∑–º—ã—Ç–∏–µ
- ‚úÖ –ú–æ–∂–µ—Ç **–æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–µ–Ω–∏**
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç target** –∫–∞–∫ DirectionalLight
- ‚ö†Ô∏è **–î–æ—Ä–æ–∂–µ** —á–µ–º DirectionalLight

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **–ü—Ä–æ–∂–µ–∫—Ç–æ—Ä—ã** –Ω–∞ —Å—Ü–µ–Ω–µ
- **–§–æ–Ω–∞—Ä–∏–∫–∏**
- **–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ —Ñ–∞—Ä—ã**
- –î—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ

---

## 6. RectAreaLight - –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Å–≤–µ—Ç (–û–∫–Ω–æ, –ø–∞–Ω–µ–ª—å)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å–≤–µ—Ç–∞ (—Ñ–ª—É–æ—Ä–µ—Å—Ü–µ–Ω—Ç–Ω–∞—è –ª–∞–º–ø–∞, –æ–∫–Ω–æ)

### ‚ö†Ô∏è –í–ê–ñ–ù–û:
**–†–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å:**
- `MeshStandardMaterial`
- `MeshPhysicalMaterial`

**–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç —Å:**
- `MeshPhongMaterial`
- `MeshLambertMaterial`

### –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç:
```javascript
import { RectAreaLightUniformsLib } from 'three/addons/lights/RectAreaLightUniformsLib.js';
import { RectAreaLightHelper } from 'three/addons/helpers/RectAreaLightHelper.js';

// –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å!
RectAreaLightUniformsLib.init();
```

### –ö–æ–¥:
```javascript
const color = 0xFFFFFF;
const intensity = 5;
const width = 12;
const height = 4;
const light = new THREE.RectAreaLight(color, intensity, width, height);
light.position.set(0, 10, 0);
light.rotation.x = THREE.MathUtils.degToRad(-90);  // –ù–∞–ø—Ä–∞–≤–∏—Ç—å –≤–Ω–∏–∑
scene.add(light);

// Helper - –î–û–ß–ï–†–ù–ò–ô —ç–ª–µ–º–µ–Ω—Ç —Å–≤–µ—Ç–∞!
const helper = new RectAreaLightHelper(light);
light.add(helper);  // –ù–ï scene.add()!
```

### –û—Ç–ª–∏—á–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
1. **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç target** - —Ç–æ–ª—å–∫–æ rotation
2. **Helper - –¥–æ—á–µ—Ä–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç** —Å–≤–µ—Ç–∞ (–Ω–µ —Å—Ü–µ–Ω—ã)
3. **–ò–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä—ã** (width, height)
4. **–ù–ï –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω–∏** (!)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
```javascript
light.width = 12;   // –®–∏—Ä–∏–Ω–∞
light.height = 4;   // –í—ã—Å–æ—Ç–∞
light.rotation.x = THREE.MathUtils.degToRad(-90);  // –í—Ä–∞—â–µ–Ω–∏–µ
```

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- ‚úÖ **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ** –æ—Å–≤–µ—â–µ–Ω–∏–µ –æ—Ç –ø–∞–Ω–µ–ª–µ–π
- ‚úÖ **–ú—è–≥–∫–∏–π —Å–≤–µ—Ç** —Å –±–æ–ª—å—à–æ–π –ø–ª–æ—â–∞–¥–∏
- ‚úÖ –•–æ—Ä–æ—à–æ –¥–ª—è **–∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤**
- ‚ùå **–ù–ï –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω–∏**
- ‚ùå –†–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ —Å Standard/Physical** –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏
- ‚ùå **–¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **–§–ª—É–æ—Ä–µ—Å—Ü–µ–Ω—Ç–Ω—ã–µ –ª–∞–º–ø—ã**
- **–°–≤–µ—Ç–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏**
- **–û–∫–Ω–∞** —Å –º–∞—Ç–æ–≤—ã–º —Å—Ç–µ–∫–ª–æ–º
- **–°–æ—Ñ—Ç–±–æ–∫—Å—ã** –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏

---

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–≤–µ—Ç–∞

| –°–≤–µ—Ç | –¢–µ–Ω–∏ | –ó–∞—Ç—É—Ö–∞–Ω–∏–µ | Target | –ú–∞—Ç–µ—Ä–∏–∞–ª—ã | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –†–µ–∞–ª–∏–∑–º |
|------|------|-----------|--------|-----------|-------------------|---------|
| **AmbientLight** | ‚ùå | ‚ùå | ‚ùå | –í—Å–µ | ‚ö°‚ö°‚ö°‚ö°‚ö° | ‚≠ê |
| **HemisphereLight** | ‚ùå | ‚ùå | ‚ùå | –í—Å–µ | ‚ö°‚ö°‚ö°‚ö°‚ö° | ‚≠ê‚≠ê |
| **DirectionalLight** | ‚úÖ | ‚ùå | ‚úÖ | –í—Å–µ | ‚ö°‚ö°‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **PointLight** | ‚úÖ | ‚úÖ | ‚ùå | –í—Å–µ | ‚ö°‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **SpotLight** | ‚úÖ | ‚úÖ | ‚úÖ | –í—Å–µ | ‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **RectAreaLight** | ‚ùå | ‚úÖ | ‚ùå | Standard/Physical | ‚ö°‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ë–∞–∑–æ–≤–∞—è —Å—Ö–µ–º–∞ –æ—Å–≤–µ—â–µ–Ω–∏—è (3-—Ç–æ—á–µ—á–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ):
```javascript
// –û—Å–Ω–æ–≤–Ω–æ–π —Å–≤–µ—Ç (Key Light)
const mainLight = new THREE.DirectionalLight(0xffffff, 1);
mainLight.position.set(5, 10, 5);
mainLight.castShadow = true;

// –ó–∞–ø–æ–ª–Ω—è—é—â–∏–π —Å–≤–µ—Ç (Fill Light)
const fillLight = new THREE.HemisphereLight(0xB1E1FF, 0xB97A20, 0.5);

// –ö–æ–Ω—Ç—Ä–æ–≤–æ–π —Å–≤–µ—Ç (Back Light) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
const backLight = new THREE.DirectionalLight(0xffffff, 0.3);
backLight.position.set(-5, 5, -5);
```

### 2. –ò–Ω—Ç–µ—Ä—å–µ—Ä–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ:
```javascript
// –û–±—â–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ
const ambient = new THREE.AmbientLight(0x404040, 0.3);

// –û–∫–Ω–∞
const windowLight = new THREE.RectAreaLight(0xffffff, 5, 10, 5);
windowLight.position.set(-10, 5, 0);

// –õ–∞–º–ø—ã
const lamp1 = new THREE.PointLight(0xffaa00, 50, 20);
lamp1.position.set(5, 3, 5);
```

### 3. –ù–∞—Ä—É–∂–Ω–∞—è —Å—Ü–µ–Ω–∞ (–¥–µ–Ω—å):
```javascript
// –°–æ–ª–Ω—Ü–µ
const sun = new THREE.DirectionalLight(0xffffff, 1);
sun.position.set(10, 20, 10);
sun.castShadow = true;

// –ù–µ–±–æ/–∑–µ–º–ª—è
const sky = new THREE.HemisphereLight(0x87CEEB, 0x8B4513, 0.6);
```

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

**–ü—Ä–∞–≤–∏–ª–∞:**
1. **–ú–∏–Ω–∏–º—É–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** - –∫–∞–∂–¥—ã–π —Å–≤–µ—Ç –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
2. **–¢–µ–Ω–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è 1-2 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** - —Å–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ
3. **AmbientLight/HemisphereLight** –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ PointLight
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ baked lighting** –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:**
```
–ë—ã—Å—Ç—Ä–æ ‚Üí –ú–µ–¥–ª–µ–Ω–Ω–æ:
AmbientLight ‚Üí HemisphereLight ‚Üí DirectionalLight ‚Üí PointLight ‚Üí SpotLight
```

---

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–∞—à–µ–º—É –ø—Ä–æ–µ–∫—Ç—É

### ‚úÖ –¢–µ–∫—É—â–∞—è —Å—Ö–µ–º–∞ (—Ö–æ—Ä–æ—à–æ):
```javascript
// HDRI –æ–∫—Ä—É–∂–µ–Ω–∏–µ (IBL)
<HDRIEnvironment />

// –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–≤–µ—Ç (–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å HDRI)
<directionalLight 
  position={[lightX, lightY, lightZ]}
  intensity={1.5}
  castShadow
/>
```

### üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

#### 1. –î–æ–±–∞–≤–∏—Ç—å HemisphereLight –≤–º–µ—Å—Ç–æ AmbientLight:
```javascript
<hemisphereLight 
  args={[0xB1E1FF, 0x8B4513, 0.3]}  // –Ω–µ–±–æ, –∑–µ–º–ª—è, –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
/>
```
**–ü–æ—á–µ–º—É:** –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ —á–µ–º AmbientLight, –∏–º–∏—Ç–∏—Ä—É–µ—Ç –Ω–µ–±–æ –∏ –∑–µ–º–ª—é

#### 2. –î–ª—è –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ - –¥–æ–±–∞–≤–∏—Ç—å PointLight –≤ –ø–æ–º–µ—â–µ–Ω–∏—è—Ö:
```javascript
// –í –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü-–∑–∞–ª–∞—Ö
<pointLight 
  position={[x, 3, z]} 
  intensity={30} 
  distance={15}
  color="#ffaa00"
/>
```

#### 3. –î–ª—è –æ–∫–æ–Ω - RectAreaLight:
```javascript
<RectAreaLight 
  width={5} 
  height={3} 
  intensity={3}
  position={[x, y, z]}
  rotation={[0, angle, 0]}
/>
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- **–ù–µ –±–æ–ª–µ–µ 2-3 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å —Ç–µ–Ω—è–º–∏**
- **HDRI + 1 DirectionalLight** - –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞
- **HemisphereLight** –ª—É—á—à–µ —á–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ PointLight

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:

1. **–ö–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞ = —Å–Ω–∏–∂–µ–Ω–∏–µ FPS** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º—É–º
2. **–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** –¥–∞–µ—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ–º –æ–¥–∏–Ω
3. **DirectionalLight + HemisphereLight** - –∫–ª–∞—Å—Å–∏–∫–∞ –¥–ª—è –Ω–∞—Ä—É–∂–Ω—ã—Ö —Å—Ü–µ–Ω
4. **RectAreaLight** —Ç—Ä–µ–±—É–µ—Ç MeshStandardMaterial
5. **Helpers** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å–≤–µ—â–µ–Ω–∏—è
6. **Target** –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ —Å—Ü–µ–Ω—É –¥–ª—è DirectionalLight –∏ SpotLight


---

# 4. –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ Three.js

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://threejs-journey.com/lessons/realistic-render

## –í–≤–µ–¥–µ–Ω–∏–µ

### –¶–µ–ª—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:
- –ü–æ–∫–∞–∑–∞—Ç—å **—Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã** –Ω–∞ —Å–∞–π—Ç–µ
- –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å **3D —Ä–∞–±–æ—Ç—ã** —Å –ª—É—á—à–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º
- –î–æ—Å—Ç–∏—á—å **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ** –≤–∏–¥–∞

### ‚ö†Ô∏è –í–∞–∂–Ω–æ:
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ **—Å–Ω–∏–∂–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ **–∑–∞–≤–∏—Å—è—Ç –æ—Ç –º–æ–¥–µ–ª–∏**
- –ù—É–∂–Ω–æ **–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å** –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å–∏—Ç—É–∞—Ü–∏—é

---

## 1. Environment Map (–ö–∞—Ä—Ç–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

#### HDR Environment Map:
```javascript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HDR –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è
const hdrTexture = new RGBELoader().load('environment.hdr');
scene.environment = hdrTexture;
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–õ—É—á—à–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ** –∏ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –±–ª–∏–∫–∏**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è**

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå **–°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- ‚ùå **–ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞**

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ**
   ```
   –î–ª—è —Ñ–æ–Ω–∞: 2K-4K
   –¢–æ–ª—å–∫–æ –¥–ª—è –æ—Å–≤–µ—â–µ–Ω–∏—è: 512px-1K (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—Ç–∏—Ç!)
   ```

2. **–ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∫–∞–∫ —Ñ–æ–Ω** - –º–æ–∂–Ω–æ —Å–∏–ª—å–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
   ```javascript
   // –¢–æ–ª—å–∫–æ –¥–ª—è –æ—Å–≤–µ—â–µ–Ω–∏—è, –Ω–µ –¥–ª—è —Ñ–æ–Ω–∞
   scene.environment = hdrTexture;
   scene.background = null; // –∏–ª–∏ –¥—Ä—É–≥–æ–π —Ü–≤–µ—Ç
   ```

---

## 2. Tone Mapping (–¢–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–ø—Ä–µ—Å—Å–∏—è)

### –ß—Ç–æ —ç—Ç–æ?
**Tone Mapping** - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ High Dynamic Range (HDR) –≤ Low Dynamic Range (LDR)

### –ó–∞—á–µ–º –Ω—É–∂–Ω–æ?
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç **—à–∏—Ä–æ–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω —è—Ä–∫–æ—Å—Ç–∏** –≤ –≤–∏–¥–∏–º—ã–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ
- –°–æ–∑–¥–∞–µ—Ç **—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –≤–∏–¥** –¥–∞–∂–µ –±–µ–∑ HDR
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç **–ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã**

### –¢–∏–ø—ã Tone Mapping –≤ Three.js:

```javascript
// 1. NoToneMapping (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
renderer.toneMapping = THREE.NoToneMapping;
// –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏, —Å—ã—Ä—ã–µ —Ü–≤–µ—Ç–∞

// 2. LinearToneMapping
renderer.toneMapping = THREE.LinearToneMapping;
// –õ–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ

// 3. ReinhardToneMapping
renderer.toneMapping = THREE.ReinhardToneMapping;
// –ú–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å "–≤—ã—Ü–≤–µ—Ç—à–∏–º", –Ω–æ –æ—á–µ–Ω—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ

// 4. CineonToneMapping
renderer.toneMapping = THREE.CineonToneMapping;
// –ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å

// 5. ACESFilmicToneMapping ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø
renderer.toneMapping = THREE.ACESFilmicToneMapping;
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∏–Ω–æ –∏ –∏–≥—Ä–∞—Ö, –ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ GUI:
```javascript
gui.add(renderer, 'toneMapping', {
    No: THREE.NoToneMapping,
    Linear: THREE.LinearToneMapping,
    Reinhard: THREE.ReinhardToneMapping,
    Cineon: THREE.CineonToneMapping,
    ACESFilmic: THREE.ACESFilmicToneMapping
});
```

---

## 3. Tone Mapping Exposure (–≠–∫—Å–ø–æ–∑–∏—Ü–∏—è)

### –ß—Ç–æ —ç—Ç–æ?
–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—Ç–∞**, –ø–æ–ø–∞–¥–∞—é—â–µ–≥–æ –≤ —Å—Ü–µ–Ω—É

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞:
```javascript
renderer.toneMappingExposure = 3;  // –î–∏–∞–ø–∞–∑–æ–Ω: 0-10
```

**–ó–Ω–∞—á–µ–Ω–∏—è:**
- `< 1` - –¢–µ–º–Ω–∞—è —Å—Ü–µ–Ω–∞ (–Ω–µ–¥–æ—ç–∫—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∞)
- `= 1` - –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `> 1` - –Ø—Ä–∫–∞—è —Å—Ü–µ–Ω–∞ (–ø–µ—Ä–µ—ç–∫—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∞)
- `2-3` - –ß–∞—Å—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ GUI:
```javascript
gui.add(renderer, 'toneMappingExposure')
   .min(0)
   .max(10)
   .step(0.001)
   .name('Exposure');
```

### –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:
```
Exposure = 0.5  ‚Üí  –û—á–µ–Ω—å —Ç–µ–º–Ω–æ (–∫–∞–∫ –Ω–æ—á—å)
Exposure = 1.0  ‚Üí  –ù–æ—Ä–º–∞–ª—å–Ω–æ
Exposure = 2.0  ‚Üí  –Ø—Ä–∫–æ (–∫–∞–∫ —Å–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å)
Exposure = 3.0  ‚Üí  –û—á–µ–Ω—å —è—Ä–∫–æ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ—ç–∫—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ)
```

---

## 4. Antialiasing (–°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)

### –ß—Ç–æ —ç—Ç–æ?
–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ **"–ª–µ—Å—Ç–Ω–∏—á–Ω–æ–≥–æ" —ç—Ñ—Ñ–µ–∫—Ç–∞** –Ω–∞ –∫—Ä–∞—è—Ö –≥–µ–æ–º–µ—Ç—Ä–∏–∏

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞:
```javascript
const renderer = new THREE.WebGLRenderer({
    canvas: canvas,
    antialias: true  // ‚ö° –í–∫–ª—é—á–∏—Ç—å —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ
});
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** 
- –ù—É–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å **–ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏** —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
- **–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å** –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
- –ù–µ–±–æ–ª—å—à–æ–µ **—Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

---

## –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

### –ö–æ–¥ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞:

```javascript
// 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞ —Å –∞–Ω—Ç–∏–∞–ª–∏–∞—Å–∏–Ω–≥–æ–º
const renderer = new THREE.WebGLRenderer({
    canvas: canvas,
    antialias: true,
    alpha: true
});

// 2. –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è
renderer.physicallyCorrectLights = true;

// 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ tone mapping
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 2.5;

// 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
renderer.outputColorSpace = THREE.SRGBColorSpace;

// 5. –í–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–Ω–µ–π
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;

// 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ pixel ratio
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

// 7. HDR Environment Map
const rgbeLoader = new RGBELoader();
rgbeLoader.load('environment.hdr', (texture) => {
    texture.mapping = THREE.EquirectangularReflectionMapping;
    scene.environment = texture;
    // scene.background = texture; // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
});
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Tone Mapping –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

| –ê–ª–≥–æ—Ä–∏—Ç–º | –†–µ–∞–ª–∏–∑–º | –ö–æ–Ω—Ç—Ä–∞—Å—Ç | –¶–≤–µ—Ç–∞ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|----------|---------|----------|-------|---------------|
| **NoToneMapping** | ‚≠ê | –í—ã—Å–æ–∫–∏–π | –°—ã—Ä—ã–µ | –°—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω—ã |
| **LinearToneMapping** | ‚≠ê‚≠ê | –°—Ä–µ–¥–Ω–∏–π | –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ | –ü—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω—ã |
| **ReinhardToneMapping** | ‚≠ê‚≠ê‚≠ê‚≠ê | –ù–∏–∑–∫–∏–π | –í—ã—Ü–≤–µ—Ç—à–∏–µ | –û—á–µ–Ω—å —è—Ä–∫–∏–µ —Å—Ü–µ–Ω—ã |
| **CineonToneMapping** | ‚≠ê‚≠ê‚≠ê‚≠ê | –í—ã—Å–æ–∫–∏–π | –ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω—ã–µ | –î—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω—ã |
| **ACESFilmicToneMapping** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π | –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ | **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** |

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ë–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–æ/–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

#### –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–¥–µ—Å–∫—Ç–æ–ø):
```javascript
renderer.antialias = true;
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 2.5;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
// HDR 2K-4K
```

#### –°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–º–æ–±–∏–ª—å–Ω—ã–µ):
```javascript
renderer.antialias = true;
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 2.0;
renderer.shadowMap.type = THREE.PCFShadowMap;
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
// HDR 1K
```

#### –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (—Å–ª–∞–±—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞):
```javascript
renderer.antialias = false;
renderer.toneMapping = THREE.LinearToneMapping;
renderer.toneMappingExposure = 1.5;
renderer.shadowMap.enabled = false;
renderer.setPixelRatio(1);
// HDR 512px –∏–ª–∏ LDR
```

---

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–∞—à–µ–º—É –ø—Ä–æ–µ–∫—Ç—É

### ‚úÖ –ß—Ç–æ –º—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º:
```javascript
// –í Scene3D.tsx
gl={{
  toneMapping: getToneMapping(),
  toneMappingExposure: toneMappingExposure,
  outputColorSpace: THREE.SRGBColorSpace,
  antialias: true,
}}
```

### üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

#### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å tone mapping –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
```javascript
// –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ACESFilmic
const getToneMapping = () => {
  switch(toneMapping) {
    case 'ACES': return THREE.ACESFilmicToneMapping;
    case 'Reinhard': return THREE.ReinhardToneMapping;
    case 'Cineon': return THREE.CineonToneMapping;
    default: return THREE.ACESFilmicToneMapping;
  }
}
```

#### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å toneMappingExposure:
```javascript
// –î–ª—è –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ –∑–¥–∞–Ω–∏—è
toneMappingExposure: 1.4  // –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - —Ö–æ—Ä–æ—à–æ!
```

#### 3. –î–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–Ω–µ–ª—å –æ—Å–≤–µ—â–µ–Ω–∏—è:
```javascript
// –í AdjustmentsPanel.tsx
<div>
  <label>Tone Mapping</label>
  <select onChange={(e) => store.setToneMapping(e.target.value)}>
    <option value="ACES">ACES Filmic (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
    <option value="Reinhard">Reinhard</option>
    <option value="Cineon">Cineon</option>
    <option value="Linear">Linear</option>
  </select>
</div>

<div>
  <label>Exposure: {toneMappingExposure.toFixed(2)}</label>
  <input 
    type="range" 
    min="0.5" 
    max="3" 
    step="0.1"
    value={toneMappingExposure}
    onChange={(e) => store.setToneMappingExposure(parseFloat(e.target.value))}
  />
</div>
```

#### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è HDR:
```javascript
// –î–ª—è —Ñ–æ–Ω–∞ - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—å—à–µ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
backgroundIntensity: hdriIntensity * 0.3  // ‚úÖ –£–∂–µ –¥–µ–ª–∞–µ–º!

// –î–ª—è –æ—Å–≤–µ—â–µ–Ω–∏—è - –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
environmentIntensity: hdriIntensity  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
```

---

## –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
- [x] ‚úÖ **physicallyCorrectLights** = true
- [x] ‚úÖ **toneMapping** = ACESFilmicToneMapping
- [x] ‚úÖ **toneMappingExposure** –Ω–∞—Å—Ç—Ä–æ–µ–Ω (1.4)
- [x] ‚úÖ **outputColorSpace** = SRGBColorSpace
- [x] ‚úÖ **antialias** = true
- [x] ‚úÖ **HDR environment** map
- [x] ‚úÖ **MeshStandardMaterial** (PBR)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- [x] ‚úÖ **shadowMap** enabled
- [x] ‚úÖ **shadowMap.type** = PCFSoftShadowMap
- [x] ‚úÖ **pixelRatio** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω (max 2)
- [ ] ‚ö†Ô∏è **Tone mapping** –≤ GUI –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- [ ] ‚ö†Ô∏è **Exposure** –≤ GUI –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
- [ ] üí° **Post-processing** (SSAO, Bloom)
- [ ] üí° **Color grading**
- [ ] üí° **Depth of field**

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:

1. **ACESFilmicToneMapping** - –ª—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
2. **toneMappingExposure** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —è—Ä–∫–æ—Å—Ç–∏
3. **HDR environment** –¥–∞–µ—Ç –ª—É—á—à–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, –Ω–æ –¥–æ—Ä–æ–∂–µ
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è HDR** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∏–∑–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ —Ñ–æ–Ω
5. **–ê–Ω—Ç–∏–∞–ª–∏–∞—Å–∏–Ω–≥** –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
6. **–ë–∞–ª–∞–Ω—Å** –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

### –§–æ—Ä–º—É–ª–∞ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:
```
–†–µ–∞–ª–∏–∑–º = PBR –º–∞—Ç–µ—Ä–∏–∞–ª—ã + HDR –æ—Å–≤–µ—â–µ–Ω–∏–µ + –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π tone mapping + 
          –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è + –ê–Ω—Ç–∏–∞–ª–∏–∞—Å–∏–Ω–≥ + –¢–µ–Ω–∏
```


---

# 5. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å–≤–µ—Ç –∏ —Ç–µ–Ω–∏

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://redstapler.co/threejs-realistic-light-shadow-tutorial/

## –í–≤–µ–¥–µ–Ω–∏–µ

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ **—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è –∏ —Ç–µ–Ω–µ–π** –¥–ª—è –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö 3D –º–æ–¥–µ–ª–µ–π.

---

## –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ü–µ–Ω—ã

### 1. –ò–º–ø–æ—Ä—Ç—ã:
```javascript
<script src="three.min.js"></script>
<script src="GLTFLoader.js"></script>
<script src="OrbitControls.js"></script>
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã:
```javascript
let scene, camera, renderer, controls;

function init() {
  // –°—Ü–µ–Ω–∞ —Å —Å–µ—Ä—ã–º —Ñ–æ–Ω–æ–º
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0xdddddd);

  // –ö–∞–º–µ—Ä–∞
  camera = new THREE.PerspectiveCamera(
    60,                              // FOV
    window.innerWidth / window.innerHeight,
    1,                               // near
    5000                             // far
  );
  camera.position.set(0, 25, 25);

  // Orbit Controls
  controls = new THREE.OrbitControls(camera);

  // AxesHelper –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—É–¥–∞–ª–∏—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
  scene.add(new THREE.AxesHelper(500));

  // –†–µ–Ω–¥–µ—Ä–µ—Ä
  renderer = new THREE.WebGLRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);
}
```

### 3. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏:
```javascript
new THREE.GLTFLoader().load('model/scene.gltf', result => { 
  model = result.scene.children[0]; 
  scene.add(model);
  animate();
});
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Å–≤–µ—â–µ–Ω–∏—è

### 1. HemisphereLight - –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫—Ä—É–∂–∞—é—â–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ

```javascript
const hemiLight = new THREE.HemisphereLight(
  0xffeeb1,  // Sky color (–±–ª–µ–¥–Ω–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π)
  0x080820,  // Ground color (—Å–µ—Ä—ã–π)
  4          // Intensity
);
scene.add(hemiLight);
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç **–æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–ª–Ω–µ—á–Ω–æ–≥–æ —Å–≤–µ—Ç–∞** –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è
- –°–≤–µ—Ç **—Å–≤–µ—Ä—Ö—É** (–Ω–µ–±–æ) –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–≤–µ—Ç **—Å–Ω–∏–∑—É** (–∑–µ–º–ª—è)
- –°–æ–∑–¥–∞–µ—Ç **–±–∞–∑–æ–≤–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ** —Å—Ü–µ–Ω—ã

**–¶–≤–µ—Ç–∞:**
- `0xffeeb1` - –¢–µ–ø–ª—ã–π –±–ª–µ–¥–Ω–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π (–Ω–µ–±–æ –Ω–∞ –∑–∞–∫–∞—Ç–µ)
- `0x080820` - –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π (–∑–µ–º–ª—è/—Ç–µ–Ω–∏)

---

## Tone Mapping –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º–∞:
–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è HemisphereLight —Ü–≤–µ—Ç–∞ **—Å–ª–∏—à–∫–æ–º –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–µ** –∏ –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ

### –†–µ—à–µ–Ω–∏–µ - Reinhard Tone Mapping:
```javascript
renderer.toneMapping = THREE.ReinhardToneMapping;
renderer.toneMappingExposure = 2.0;  // –£–≤–µ–ª–∏—á–∏—Ç—å —è—Ä–∫–æ—Å—Ç—å
```

**–ü–æ—á–µ–º—É Reinhard?**
- –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **HDR —ç—Ñ—Ñ–µ–∫—Ç**
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **—è—Ä–∫–∏–º–∏ —Å—Ü–µ–Ω–∞–º–∏**
- –ú–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Å—Ü–µ–Ω—É **—Ç–µ–º–Ω–µ–µ** - –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º exposure

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
```javascript
// –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
renderer.toneMapping = THREE.ACESFilmicToneMapping;  // –ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω—ã–π
renderer.toneMapping = THREE.CineonToneMapping;      // –î—Ä–∞–º–∞—Ç–∏—á–Ω—ã–π
renderer.toneMapping = THREE.LinearToneMapping;      // –ü—Ä–æ—Å—Ç–æ–π
```

---

## SpotLight - –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–≤–µ—Ç–∞ (–°–æ–ª–Ω—Ü–µ)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞:
```javascript
const light = new THREE.SpotLight(
  0xffa95c,  // –û—Ä–∞–Ω–∂–µ–≤–æ-–∂–µ–ª—Ç—ã–π —Ü–≤–µ—Ç (—Å–æ–ª–Ω—Ü–µ)
  4          // Intensity
);
light.position.set(-50, 50, 50);
light.castShadow = true;  // ‚ö° –í–ê–ñ–ù–û –¥–ª—è —Ç–µ–Ω–µ–π
scene.add(light);
```

**–¶–≤–µ—Ç —Å–æ–ª–Ω—Ü–∞:**
- `0xffa95c` - –¢–µ–ø–ª—ã–π –æ—Ä–∞–Ω–∂–µ–≤–æ-–∂–µ–ª—Ç—ã–π
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç **–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç**

---

## –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ (—Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫–∞–º–µ—Ä–æ–π)

### –¢—Ä—é–∫ –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏:
```javascript
function animate() {
  renderer.render(scene, camera);
  
  // –°–≤–µ—Ç —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫–∞–º–µ—Ä–æ–π —Å –Ω–µ–±–æ–ª—å—à–∏–º —Å–º–µ—â–µ–Ω–∏–µ–º
  light.position.set(
    camera.position.x + 10,
    camera.position.y + 10,
    camera.position.z + 10
  );
  
  requestAnimationFrame(animate);
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –°–≤–µ—Ç **–≤—Å–µ–≥–¥–∞ –æ—Å–≤–µ—â–∞–µ—Ç** —Ç–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –∫–∞–º–µ—Ä–∞
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–≤–µ—Ç–∞** —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞
- –ù–µ—Ç —Ç–µ–º–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ** –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ —Å–æ–ª–Ω—Ü–∞
- –•–æ—Ä–æ—à–æ –¥–ª—è **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ü–µ–Ω**
- –î–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–ª–Ω—Ü–∞ - **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è**

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–Ω–µ–π

### 1. –í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏ –¥–ª—è –º–æ–¥–µ–ª–∏:

```javascript
model.traverse(n => { 
  if (n.isMesh) {
    n.castShadow = true;     // –û—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–Ω—å
    n.receiveShadow = true;  // –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–Ω—å
    
    // –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–∫—Å—Ç—É—Ä
    if (n.material.map) {
      n.material.map.anisotropy = 16;  // 16x —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    }
  }
});
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç traverse:**
- –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ **–≤—Å–µ–º –æ–±—ä–µ–∫—Ç–∞–º** –≤ –º–æ–¥–µ–ª–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `isMesh` - —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–±—ä–µ–∫—Ç –º–µ—à–µ–º
- –í–∫–ª—é—á–∞–µ—Ç —Ç–µ–Ω–∏ –¥–ª—è **–∫–∞–∂–¥–æ–≥–æ –º–µ—à–∞**

**Anisotropy (–ê–Ω–∏–∑–æ—Ç—Ä–æ–ø–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è):**
- –£–ª—É—á—à–∞–µ—Ç **–∫–∞—á–µ—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç—É—Ä** –ø–æ–¥ —É–≥–ª–æ–º
- –ó–Ω–∞—á–µ–Ω–∏—è: 1, 2, 4, 8, 16
- `16` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- **–í–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

### 2. –í–∫–ª—é—á–∏—Ç—å shadow map –≤ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–µ:

```javascript
renderer.shadowMap.enabled = true;
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–Ω–µ–π:

```javascript
// –£–º–µ–Ω—å—à–∏—Ç—å shadow bias –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
light.shadow.bias = -0.0001;

// –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Ç–µ–Ω–µ–π
light.shadow.mapSize.width = 1024 * 4;   // 4096
light.shadow.mapSize.height = 1024 * 4;  // 4096
```

**Shadow Bias:**
- **–ü—Ä–æ–±–ª–µ–º–∞:** "Shadow acne" - –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞ —Ç–µ–Ω—è—Ö
- **–†–µ—à–µ–Ω–∏–µ:** –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ bias
- –¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `-0.0001` –¥–æ `-0.001`
- **–°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ** = —Ç–µ–Ω—å –æ—Ç—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç –æ–±—ä–µ–∫—Ç–∞

**Shadow Map Size:**
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Ç–µ–Ω–µ–π
- –ö—Ä–∞—Ç–Ω–æ 1024: `1024, 2048, 4096, 8192`
- **–ë–æ–ª—å—à–µ = –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ**
- `4096√ó4096` - –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
- `2048√ó2048` - —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- `1024√ó1024` - –Ω–∏–∑–∫–æ–µ –¥–ª—è —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

---

## –ü–æ–ª–Ω—ã–π –∫–æ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```javascript
// 1. –ë–∞–∑–æ–≤–∞—è —Å—Ü–µ–Ω–∞
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xdddddd);

const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 5000);
camera.position.set(0, 25, 25);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMap.enabled = true;

// 2. Tone Mapping
renderer.toneMapping = THREE.ReinhardToneMapping;
renderer.toneMappingExposure = 2.0;

// 3. HemisphereLight (–æ–∫—Ä—É–∂–∞—é—â–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ)
const hemiLight = new THREE.HemisphereLight(0xffeeb1, 0x080820, 4);
scene.add(hemiLight);

// 4. SpotLight (–æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫)
const light = new THREE.SpotLight(0xffa95c, 4);
light.position.set(-50, 50, 50);
light.castShadow = true;
light.shadow.bias = -0.0001;
light.shadow.mapSize.width = 4096;
light.shadow.mapSize.height = 4096;
scene.add(light);

// 5. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
new THREE.GLTFLoader().load('model/scene.gltf', result => {
  const model = result.scene.children[0];
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–Ω–µ–π –¥–ª—è –≤—Å–µ—Ö –º–µ—à–µ–π
  model.traverse(n => {
    if (n.isMesh) {
      n.castShadow = true;
      n.receiveShadow = true;
      if (n.material.map) n.material.map.anisotropy = 16;
    }
  });
  
  scene.add(model);
  animate();
});

// 6. Render loop —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Å–≤–µ—Ç–æ–º
function animate() {
  // –°–≤–µ—Ç —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫–∞–º–µ—Ä–æ–π
  light.position.set(
    camera.position.x + 10,
    camera.position.y + 10,
    camera.position.z + 10
  );
  
  renderer.render(scene, camera);
  requestAnimationFrame(animate);
}
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –£—Ä–æ–≤–Ω–∏ –∫–∞—á–µ—Å—Ç–≤–∞:

#### –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–î–µ—Å–∫—Ç–æ–ø):
```javascript
light.shadow.mapSize.width = 4096;
light.shadow.mapSize.height = 4096;
n.material.map.anisotropy = 16;
renderer.toneMapping = THREE.ACESFilmicToneMapping;
```

#### –°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–ú–æ–±–∏–ª—å–Ω—ã–µ):
```javascript
light.shadow.mapSize.width = 2048;
light.shadow.mapSize.height = 2048;
n.material.map.anisotropy = 8;
renderer.toneMapping = THREE.ReinhardToneMapping;
```

#### –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–°–ª–∞–±—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞):
```javascript
light.shadow.mapSize.width = 1024;
light.shadow.mapSize.height = 1024;
n.material.map.anisotropy = 4;
renderer.toneMapping = THREE.LinearToneMapping;
// –ò–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏: renderer.shadowMap.enabled = false;
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –§–æ–Ω —Å Cubemap (–≤–º–µ—Å—Ç–æ —Å–µ—Ä–æ–≥–æ):
```javascript
const cubeTextureLoader = new THREE.CubeTextureLoader();
scene.background = cubeTextureLoader.load([
  'px.jpg', 'nx.jpg',
  'py.jpg', 'ny.jpg',
  'pz.jpg', 'nz.jpg'
]);
```

### 2. –†–∞–∑–º—ã—Ç—ã–π —Ñ–æ–Ω:
```javascript
scene.backgroundBlurriness = 0.5;  // 0-1
```

### 3. Fog –¥–ª—è –≥–ª—É–±–∏–Ω—ã:
```javascript
scene.fog = new THREE.Fog(0xdddddd, 50, 200);
```

---

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–∞—à–µ–º—É –ø—Ä–æ–µ–∫—Ç—É

### ‚úÖ –ß—Ç–æ –º—ã —É–∂–µ –¥–µ–ª–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. **–¢–µ–Ω–∏ –≤–∫–ª—é—á–µ–Ω—ã:**
   ```javascript
   renderer.shadowMap.enabled = true;
   renderer.shadowMap.type = THREE.PCFSoftShadowMap;
   ```

2. **–ú–æ–¥–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞:**
   ```javascript
   child.castShadow = true;
   child.receiveShadow = true;
   child.geometry.computeVertexNormals();
   ```

3. **Tone mapping:**
   ```javascript
   toneMapping: getToneMapping(),
   toneMappingExposure: 1.4,
   ```

### üí° –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

#### 1. HemisphereLight –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–∫—Ä—É–∂–∞—é—â–µ–≥–æ —Å–≤–µ—Ç–∞:
```javascript
// –í–º–µ—Å—Ç–æ –∏–ª–∏ –≤–º–µ—Å—Ç–µ —Å HDRI
const hemiLight = new THREE.HemisphereLight(
  0xffeeb1,  // –¢–µ–ø–ª–æ–µ –Ω–µ–±–æ
  0x080820,  // –¢–µ–º–Ω–∞—è –∑–µ–º–ª—è
  0.5        // –£–º–µ—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
);
scene.add(hemiLight);
```

#### 2. Anisotropic filtering –¥–ª—è —Ç–µ–∫—Å—Ç—É—Ä:
```javascript
// –í VenueModel.tsx
model.traverse(n => {
  if (n.isMesh) {
    if (n.material.map) {
      n.material.map.anisotropy = 16;  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
    }
  }
});
```

#### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è shadow map size:
```javascript
// –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
const shadowMapSize = isMobile ? 2048 : 4096;

directionalLight.shadow.mapSize.width = shadowMapSize;
directionalLight.shadow.mapSize.height = shadowMapSize;
```

#### 4. Shadow bias –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤:
```javascript
directionalLight.shadow.bias = -0.0001;  // –£–∂–µ –µ—Å—Ç—å!
directionalLight.shadow.normalBias = 0.02;  // –£–∂–µ –µ—Å—Ç—å!
```

---

## –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è

### –û—Å–≤–µ—â–µ–Ω–∏–µ:
- [x] ‚úÖ DirectionalLight (–æ—Å–Ω–æ–≤–Ω–æ–π)
- [ ] üí° HemisphereLight (–æ–∫—Ä—É–∂–∞—é—â–∏–π)
- [x] ‚úÖ HDRI Environment
- [x] ‚úÖ Tone Mapping (ACES/Reinhard)
- [x] ‚úÖ Tone Mapping Exposure

### –¢–µ–Ω–∏:
- [x] ‚úÖ shadowMap.enabled
- [x] ‚úÖ shadowMap.type (PCFSoft)
- [x] ‚úÖ light.castShadow
- [x] ‚úÖ mesh.castShadow
- [x] ‚úÖ mesh.receiveShadow
- [x] ‚úÖ shadow.bias –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] ‚úÖ shadow.mapSize –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω

### –ö–∞—á–µ—Å—Ç–≤–æ:
- [x] ‚úÖ antialias
- [ ] üí° anisotropy –¥–ª—è —Ç–µ–∫—Å—Ç—É—Ä
- [x] ‚úÖ computeVertexNormals
- [x] ‚úÖ outputColorSpace (SRGB)

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:

1. **HemisphereLight + SpotLight** - –æ—Ç–ª–∏—á–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
2. **Reinhard Tone Mapping** - —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –¥–ª—è —è—Ä–∫–∏—Ö —Å—Ü–µ–Ω
3. **Shadow bias = -0.0001** - —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Ç–µ–Ω–µ–π
4. **Shadow map 4096√ó4096** - –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
5. **Anisotropy = 16** - —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç—É—Ä –ø–æ–¥ —É–≥–ª–æ–º
6. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–≤–µ—Ç** - —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫–∞–º–µ—Ä–æ–π –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è
7. **traverse()** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ—Ö –º–µ—à–µ–π –≤ –º–æ–¥–µ–ª–∏

### –§–æ—Ä–º—É–ª–∞ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è:
```
–†–µ–∞–ª–∏–∑–º = HemisphereLight (–±–∞–∑–∞) + 
          DirectionalLight/SpotLight (–æ—Å–Ω–æ–≤–Ω–æ–π) + 
          –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Tone Mapping + 
          –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–Ω–∏ + 
          Anisotropic filtering
```


---

## 6. Three-Geospatial Library - Advanced Atmospheric Rendering
**Source**: https://github.com/takram-design-engineering/three-geospatial
**Date**: February 12, 2026

### Overview
Three-geospatial is a comprehensive library for rendering realistic Earth atmospheres in Three.js and React Three Fiber. It implements Eric Bruneton's "Precomputed Atmospheric Scattering" algorithm, which is the gold standard for physically accurate atmospheric rendering.

### Key Packages
1. **@takram/three-atmosphere** - Core atmospheric scattering and lighting
2. **@takram/three-clouds** - Cloud rendering (mentioned but not detailed yet)
3. **@takram/three-geospatial/core** - Core utilities
4. **@takram/three-geospatial/effects** - Post-processing effects

### Three Lighting Methods

The library offers three distinct lighting approaches, each with specific use cases:

#### 1. Post-Process Lighting
**Best for**: Large-scale scenes (cities, landscapes, terrain)
**Limitation**: Only supports Lambertian BRDF (diffuse surfaces)

```tsx
<Atmosphere date={new Date()}>
  <Sky />
  <mesh>
    <meshBasicMaterial /> {/* Must be unlit! */}
  </mesh>
  <EffectComposer enableNormalPass>
    <AerialPerspective sunLight skyLight />
  </EffectComposer>
</Atmosphere>
```

**How it works**:
- Materials must be unlit (MeshBasicMaterial)
- Render buffer stores surface albedo (color without lighting)
- Lighting applied in post-processing by AerialPerspectiveEffect
- Physically accurate for diffuse surfaces
- Very efficient for large scenes

#### 2. Light-Source Lighting
**Best for**: Small-scale scenes with complex materials
**Supports**: All Three.js materials, shadows, various BRDFs

```tsx
<Atmosphere date={new Date()}>
  <Sky />
  <group position={ecefCoordinate}>
    <SkyLight />  {/* Indirect sky irradiance */}
    <SunLight />  {/* Direct sunlight */}
  </group>
  <mesh>
    <meshPhysicalMaterial /> {/* Any material works */}
  </mesh>
  <EffectComposer>
    <AerialPerspective /> {/* No sunLight/skyLight props */}
  </EffectComposer>
</Atmosphere>
```

**How it works**:
- Uses standard Three.js lights (SunDirectionalLight, SkyLightProbe)
- Approximates atmospheric lighting at a single point
- Applies that lighting to entire scene
- Works with PBR materials, shadows, reflections
- Less accurate for large scenes but more flexible

#### 3. Mixed Lighting
**Best for**: Combining large terrain with detailed objects
**Combines**: Accuracy of post-process + flexibility of light-source

```tsx
const LIGHTING_MASK_LAYER = 10
const layers = new Layers()
layers.enable(LIGHTING_MASK_LAYER)

<Atmosphere date={new Date()}>
  <Sky />
  <group position={ecefCoordinate}>
    <SkyLight />
    <SunLight />
  </group>
  
  {/* Terrain - post-process lit */}
  <mesh>
    <meshBasicMaterial />
  </mesh>
  
  {/* Building - light-source lit */}
  <mesh layers={layers}>
    <meshPhysicalMaterial />
  </mesh>
  
  <EffectComposer enableNormalPass>
    <LightingMask selectionLayer={LIGHTING_MASK_LAYER} />
    <AerialPerspective sunLight skyLight />
  </EffectComposer>
</Atmosphere>
```

**How it works**:
- LightingMaskPass creates a mask separating objects
- Post-process lighting applied only to unmasked objects
- Light-source lighting applied to masked objects
- Best of both worlds but more complex setup

### Critical Rules for Lighting

1. **Post-process lighting**: Use MeshBasicMaterial ONLY
2. **Light-source lighting**: Any material works
3. **Never enable sunLight/skyLight on AerialPerspectiveEffect when using SunDirectionalLight/SkyLightProbe** unless properly masked
4. **MeshBasicMaterial is always unlit** - perfect for storing albedo
5. **Lit materials store outgoing radiance** - cannot be used as albedo

### Precomputed Textures

The library uses precomputed lookup tables (LUTs) for performance:

1. **transmittanceTexture** (2D)
   - Transmittance between any point in atmosphere and space
   - Parameters: view height, zenith angle

2. **scatteringTexture** (4D packed in 3D)
   - Rayleigh scattering + single Mie scattering
   - Parameters: view height, view zenith angle, sun zenith angle, view-sun angle

3. **irradianceTexture** (2D)
   - Indirect irradiance on horizontal surfaces
   - Parameters: view height, sun zenith angle

4. **singleMieScatteringTexture** (optional)
   - Full RGB Mie scattering (reduces artifacts)

5. **higherOrderScatteringTexture** (optional)
   - Multiple scattering (N ‚â• 2)
   - Needed for volumetric shadows and cloud light shafts

### Key Components

#### Atmosphere (R3F)
Main provider component that synchronizes all atmosphere components:
```tsx
const atmosphereRef = useRef<AtmosphereApi>(null)
useFrame(() => {
  atmosphereRef.current?.updateByDate(new Date())
})

<Atmosphere ref={atmosphereRef} textures={precomputedTextures}>
  <Sky />
  <Stars />
  {/* ... */}
</Atmosphere>
```

**Props**:
- `textures`: PrecomputedTextures or URL
- `ellipsoid`: Earth model (default: WGS84)
- `correctAltitude`: Compensates for ellipsoid vs sphere difference (¬±10km)
- `date`: Static date for sun/moon position
- `worldToECEFMatrix`: Transform for coordinate system conversion

#### Sky
Renders atmosphere, sun, and moon in screen space:
```tsx
<Sky 
  sunDirection={sunDir}
  moonDirection={moonDir}
  sun={true}
  moon={true}
  groundAlbedo={new Color(0.1, 0.1, 0.1)}
/>
```

#### Stars
Renders 9,096 brightest stars from Yale Bright Star Catalog:
```tsx
<Stars 
  data={starsData}
  sunDirection={sunDir}
  matrix={inertialToECEFMatrix}
/>
```

#### SunLight
Directional light with atmospheric transmittance:
```tsx
<SunLight
  transmittanceTexture={texture}
  position={ecefPosition}
  sunDirection={sunDir}
  castShadow
/>
```

#### SkyLight
Light probe for indirect sky irradiance:
```tsx
<SkyLight
  irradianceTexture={texture}
  position={ecefPosition}
  sunDirection={sunDir}
/>
```

#### AerialPerspective
Post-processing effect for atmospheric scattering:
```tsx
<AerialPerspective
  {...textures}
  sunDirection={sunDir}
  sunLight={true}  // Apply direct lighting
  skyLight={true}  // Apply indirect lighting
/>
```

### Coordinate Systems

**ECEF (Earth-Centered, Earth-Fixed)**:
- Origin at Earth's center
- Rotates with Earth
- X: 0¬∞ lat, 0¬∞ lon
- Y: 0¬∞ lat, 90¬∞ lon
- Z: North pole

**ECI (Earth-Centered Inertial)**:
- Origin at Earth's center
- Fixed to stars (doesn't rotate)
- Used for star positions

**World Space**:
- Three.js scene coordinates
- Can be transformed to/from ECEF via `worldToECEFMatrix`

### Practical Tips

1. **Altitude Correction**: Always enable `correctAltitude` for ground-level scenes
   - Compensates for up to 10km difference between ellipsoid and sphere
   - Critical for realistic appearance at low altitudes

2. **Sun Angular Radius**: Increase if sun flickers in low-res environment maps
   - Default: 0.004675 radians
   - Increase to ~0.1 for stability

3. **Lunar Radiance Scale**: Moon is often too dim by default
   - Default: 1
   - Try 3-5 for more visible moon

4. **Frame Buffer Type**: Use HalfFloatType for EffectComposer
   - Stores HDR radiance/luminance values
   - Required for proper tone mapping

5. **Tone Mapping**: Use ACESFilmicToneMapping or AGX
   - Converts HDR to displayable range
   - Critical for realistic appearance

### Limitations

1. **Fixed to ECEF**: Cannot configure reference frame
2. **Horizon artifacts**: Due to floating-point precision
3. **No volumetric light shafts**: Would require ray tracing or depth pass
4. **Earth-specific**: Not suitable for other planets
5. **GLSL only**: No TSL/WebGPU support yet (planned)

### Integration with Our Project

**Potential applications**:
1. Replace current HDRI environment with physically accurate sky
2. Add time-of-day simulation with proper sun position
3. Implement realistic outdoor lighting for venue visualization
4. Add atmospheric perspective for depth perception
5. Use mixed lighting: post-process for building, light-source for details

**Considerations**:
- Our venue is indoor/outdoor hybrid
- May need to blend HDRI with atmospheric sky
- Post-process lighting perfect for large venue geometry
- Light-source lighting for detailed furniture/decorations
- Could add day/night cycle for presentations

**Next steps**:
- Study clouds package for weather effects
- Study effects package for additional post-processing
- Experiment with mixed lighting approach
- Consider performance impact on target devices

### Related Functions

```ts
// Get sun direction for specific date
getSunDirectionECEF(date: Date | number, target: Vector3): Vector3

// Get moon direction
getMoonDirectionECEF(date: Date | number, target: Vector3): Vector3

// Get ECI to ECEF rotation matrix
getECIToECEFRotationMatrix(date: Date | number, target: Matrix4): Matrix4

// Get sun color based on transmittance
getSunLightColor(
  transmittanceTexture: Texture,
  sunDirection: Vector3,
  position: Vector3,
  target: Color
): Color
```

### Performance Notes

- Precomputed textures eliminate runtime calculations
- Post-process lighting is single-pass (very fast)
- Light-source lighting uses standard Three.js pipeline
- Mixed lighting adds one extra pass (LightingMaskPass)
- Stars are rendered as GL_POINTS (very efficient)

### Comparison to Our Current Setup

**Current**:
- HDRI environment maps
- Static lighting
- Manual rotation control
- No atmospheric effects
- Simple ambient + directional lights

**With three-geospatial**:
- Physically accurate atmosphere
- Dynamic sun/moon position by date
- Automatic atmospheric scattering
- Realistic aerial perspective
- Proper indirect lighting from sky

**Trade-offs**:
- More complex setup
- Additional dependencies
- Learning curve for coordinate systems
- May be overkill for indoor venue
- But: much more realistic outdoor scenes
