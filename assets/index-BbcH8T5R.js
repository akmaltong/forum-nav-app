var IB=Object.defineProperty;var BB=(i,e,t)=>e in i?IB(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Sr=(i,e,t)=>BB(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Tv(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var JS={exports:{}},pg={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jw;function NB(){if(jw)return pg;jw=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,s){var o=null;if(s!==void 0&&(o=""+s),r.key!==void 0&&(o=""+r.key),"key"in r){s={};for(var u in r)u!=="key"&&(s[u]=r[u])}else s=r;return r=s.ref,{$$typeof:i,type:n,key:o,ref:r!==void 0?r:null,props:s}}return pg.Fragment=e,pg.jsx=t,pg.jsxs=t,pg}var Ww;function OB(){return Ww||(Ww=1,JS.exports=NB()),JS.exports}var D=OB(),KS={exports:{}},wn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xw;function LB(){if(Xw)return wn;Xw=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function A(Y){return Y===null||typeof Y!="object"?null:(Y=y&&Y[y]||Y["@@iterator"],typeof Y=="function"?Y:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,M={};function E(Y,me,Ce){this.props=Y,this.context=me,this.refs=M,this.updater=Ce||S}E.prototype.isReactComponent={},E.prototype.setState=function(Y,me){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,me,"setState")},E.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function R(){}R.prototype=E.prototype;function I(Y,me,Ce){this.props=Y,this.context=me,this.refs=M,this.updater=Ce||S}var O=I.prototype=new R;O.constructor=I,T(O,E.prototype),O.isPureReactComponent=!0;var F=Array.isArray;function z(){}var j={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function L(Y,me,Ce){var Ze=Ce.ref;return{$$typeof:i,type:Y,key:me,ref:Ze!==void 0?Ze:null,props:Ce}}function H(Y,me){return L(Y.type,me,Y.props)}function K(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===i}function de(Y){var me={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(Ce){return me[Ce]})}var ce=/\/+/g;function ne(Y,me){return typeof Y=="object"&&Y!==null&&Y.key!=null?de(""+Y.key):me.toString(36)}function fe(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(z,z):(Y.status="pending",Y.then(function(me){Y.status==="pending"&&(Y.status="fulfilled",Y.value=me)},function(me){Y.status==="pending"&&(Y.status="rejected",Y.reason=me)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function X(Y,me,Ce,Ze,xt){var ve=typeof Y;(ve==="undefined"||ve==="boolean")&&(Y=null);var ze=!1;if(Y===null)ze=!0;else switch(ve){case"bigint":case"string":case"number":ze=!0;break;case"object":switch(Y.$$typeof){case i:case e:ze=!0;break;case g:return ze=Y._init,X(ze(Y._payload),me,Ce,Ze,xt)}}if(ze)return xt=xt(Y),ze=Ze===""?"."+ne(Y,0):Ze,F(xt)?(Ce="",ze!=null&&(Ce=ze.replace(ce,"$&/")+"/"),X(xt,me,Ce,"",function(yt){return yt})):xt!=null&&(K(xt)&&(xt=H(xt,Ce+(xt.key==null||Y&&Y.key===xt.key?"":(""+xt.key).replace(ce,"$&/")+"/")+ze)),me.push(xt)),1;ze=0;var dt=Ze===""?".":Ze+":";if(F(Y))for(var Ee=0;Ee<Y.length;Ee++)Ze=Y[Ee],ve=dt+ne(Ze,Ee),ze+=X(Ze,me,Ce,ve,xt);else if(Ee=A(Y),typeof Ee=="function")for(Y=Ee.call(Y),Ee=0;!(Ze=Y.next()).done;)Ze=Ze.value,ve=dt+ne(Ze,Ee++),ze+=X(Ze,me,Ce,ve,xt);else if(ve==="object"){if(typeof Y.then=="function")return X(fe(Y),me,Ce,Ze,xt);throw me=String(Y),Error("Objects are not valid as a React child (found: "+(me==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":me)+"). If you meant to render a collection of children, use an array instead.")}return ze}function re(Y,me,Ce){if(Y==null)return Y;var Ze=[],xt=0;return X(Y,Ze,"","",function(ve){return me.call(Ce,ve,xt++)}),Ze}function ge(Y){if(Y._status===-1){var me=Y._result;me=me(),me.then(function(Ce){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=Ce)},function(Ce){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=Ce)}),Y._status===-1&&(Y._status=0,Y._result=me)}if(Y._status===1)return Y._result.default;throw Y._result}var Te=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var me=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(me))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)},Se={map:re,forEach:function(Y,me,Ce){re(Y,function(){me.apply(this,arguments)},Ce)},count:function(Y){var me=0;return re(Y,function(){me++}),me},toArray:function(Y){return re(Y,function(me){return me})||[]},only:function(Y){if(!K(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}};return wn.Activity=v,wn.Children=Se,wn.Component=E,wn.Fragment=t,wn.Profiler=r,wn.PureComponent=I,wn.StrictMode=n,wn.Suspense=f,wn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,wn.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return j.H.useMemoCache(Y)}},wn.cache=function(Y){return function(){return Y.apply(null,arguments)}},wn.cacheSignal=function(){return null},wn.cloneElement=function(Y,me,Ce){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var Ze=T({},Y.props),xt=Y.key;if(me!=null)for(ve in me.key!==void 0&&(xt=""+me.key),me)!W.call(me,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&me.ref===void 0||(Ze[ve]=me[ve]);var ve=arguments.length-2;if(ve===1)Ze.children=Ce;else if(1<ve){for(var ze=Array(ve),dt=0;dt<ve;dt++)ze[dt]=arguments[dt+2];Ze.children=ze}return L(Y.type,xt,Ze)},wn.createContext=function(Y){return Y={$$typeof:o,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:s,_context:Y},Y},wn.createElement=function(Y,me,Ce){var Ze,xt={},ve=null;if(me!=null)for(Ze in me.key!==void 0&&(ve=""+me.key),me)W.call(me,Ze)&&Ze!=="key"&&Ze!=="__self"&&Ze!=="__source"&&(xt[Ze]=me[Ze]);var ze=arguments.length-2;if(ze===1)xt.children=Ce;else if(1<ze){for(var dt=Array(ze),Ee=0;Ee<ze;Ee++)dt[Ee]=arguments[Ee+2];xt.children=dt}if(Y&&Y.defaultProps)for(Ze in ze=Y.defaultProps,ze)xt[Ze]===void 0&&(xt[Ze]=ze[Ze]);return L(Y,ve,xt)},wn.createRef=function(){return{current:null}},wn.forwardRef=function(Y){return{$$typeof:u,render:Y}},wn.isValidElement=K,wn.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:ge}},wn.memo=function(Y,me){return{$$typeof:p,type:Y,compare:me===void 0?null:me}},wn.startTransition=function(Y){var me=j.T,Ce={};j.T=Ce;try{var Ze=Y(),xt=j.S;xt!==null&&xt(Ce,Ze),typeof Ze=="object"&&Ze!==null&&typeof Ze.then=="function"&&Ze.then(z,Te)}catch(ve){Te(ve)}finally{me!==null&&Ce.types!==null&&(me.types=Ce.types),j.T=me}},wn.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},wn.use=function(Y){return j.H.use(Y)},wn.useActionState=function(Y,me,Ce){return j.H.useActionState(Y,me,Ce)},wn.useCallback=function(Y,me){return j.H.useCallback(Y,me)},wn.useContext=function(Y){return j.H.useContext(Y)},wn.useDebugValue=function(){},wn.useDeferredValue=function(Y,me){return j.H.useDeferredValue(Y,me)},wn.useEffect=function(Y,me){return j.H.useEffect(Y,me)},wn.useEffectEvent=function(Y){return j.H.useEffectEvent(Y)},wn.useId=function(){return j.H.useId()},wn.useImperativeHandle=function(Y,me,Ce){return j.H.useImperativeHandle(Y,me,Ce)},wn.useInsertionEffect=function(Y,me){return j.H.useInsertionEffect(Y,me)},wn.useLayoutEffect=function(Y,me){return j.H.useLayoutEffect(Y,me)},wn.useMemo=function(Y,me){return j.H.useMemo(Y,me)},wn.useOptimistic=function(Y,me){return j.H.useOptimistic(Y,me)},wn.useReducer=function(Y,me,Ce){return j.H.useReducer(Y,me,Ce)},wn.useRef=function(Y){return j.H.useRef(Y)},wn.useState=function(Y){return j.H.useState(Y)},wn.useSyncExternalStore=function(Y,me,Ce){return j.H.useSyncExternalStore(Y,me,Ce)},wn.useTransition=function(){return j.H.useTransition()},wn.version="19.2.4",wn}var Yw;function wv(){return Yw||(Yw=1,KS.exports=LB()),KS.exports}var le=wv();const Cv=Tv(le);var ZS={exports:{}},mg={},$S={exports:{}},eb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qw;function PB(){return Qw||(Qw=1,(function(i){function e(X,re){var ge=X.length;X.push(re);e:for(;0<ge;){var Te=ge-1>>>1,Se=X[Te];if(0<r(Se,re))X[Te]=re,X[ge]=Se,ge=Te;else break e}}function t(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var re=X[0],ge=X.pop();if(ge!==re){X[0]=ge;e:for(var Te=0,Se=X.length,Y=Se>>>1;Te<Y;){var me=2*(Te+1)-1,Ce=X[me],Ze=me+1,xt=X[Ze];if(0>r(Ce,ge))Ze<Se&&0>r(xt,Ce)?(X[Te]=xt,X[Ze]=ge,Te=Ze):(X[Te]=Ce,X[me]=ge,Te=me);else if(Ze<Se&&0>r(xt,ge))X[Te]=xt,X[Ze]=ge,Te=Ze;else break e}}return re}function r(X,re){var ge=X.sortIndex-re.sortIndex;return ge!==0?ge:X.id-re.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();i.unstable_now=function(){return o.now()-u}}var f=[],p=[],g=1,v=null,y=3,A=!1,S=!1,T=!1,M=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function O(X){for(var re=t(p);re!==null;){if(re.callback===null)n(p);else if(re.startTime<=X)n(p),re.sortIndex=re.expirationTime,e(f,re);else break;re=t(p)}}function F(X){if(T=!1,O(X),!S)if(t(f)!==null)S=!0,z||(z=!0,de());else{var re=t(p);re!==null&&fe(F,re.startTime-X)}}var z=!1,j=-1,W=5,L=-1;function H(){return M?!0:!(i.unstable_now()-L<W)}function K(){if(M=!1,z){var X=i.unstable_now();L=X;var re=!0;try{e:{S=!1,T&&(T=!1,R(j),j=-1),A=!0;var ge=y;try{t:{for(O(X),v=t(f);v!==null&&!(v.expirationTime>X&&H());){var Te=v.callback;if(typeof Te=="function"){v.callback=null,y=v.priorityLevel;var Se=Te(v.expirationTime<=X);if(X=i.unstable_now(),typeof Se=="function"){v.callback=Se,O(X),re=!0;break t}v===t(f)&&n(f),O(X)}else n(f);v=t(f)}if(v!==null)re=!0;else{var Y=t(p);Y!==null&&fe(F,Y.startTime-X),re=!1}}break e}finally{v=null,y=ge,A=!1}re=void 0}}finally{re?de():z=!1}}}var de;if(typeof I=="function")de=function(){I(K)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ne=ce.port2;ce.port1.onmessage=K,de=function(){ne.postMessage(null)}}else de=function(){E(K,0)};function fe(X,re){j=E(function(){X(i.unstable_now())},re)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(X){X.callback=null},i.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<X?Math.floor(1e3/X):5},i.unstable_getCurrentPriorityLevel=function(){return y},i.unstable_next=function(X){switch(y){case 1:case 2:case 3:var re=3;break;default:re=y}var ge=y;y=re;try{return X()}finally{y=ge}},i.unstable_requestPaint=function(){M=!0},i.unstable_runWithPriority=function(X,re){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ge=y;y=X;try{return re()}finally{y=ge}},i.unstable_scheduleCallback=function(X,re,ge){var Te=i.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?Te+ge:Te):ge=Te,X){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ge+Se,X={id:g++,callback:re,priorityLevel:X,startTime:ge,expirationTime:Se,sortIndex:-1},ge>Te?(X.sortIndex=ge,e(p,X),t(f)===null&&X===t(p)&&(T?(R(j),j=-1):T=!0,fe(F,ge-Te))):(X.sortIndex=Se,e(f,X),S||A||(S=!0,z||(z=!0,de()))),X},i.unstable_shouldYield=H,i.unstable_wrapCallback=function(X){var re=y;return function(){var ge=y;y=re;try{return X.apply(this,arguments)}finally{y=ge}}}})(eb)),eb}var qw;function o2(){return qw||(qw=1,$S.exports=PB()),$S.exports}var tb={exports:{}},Us={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jw;function UB(){if(Jw)return Us;Jw=1;var i=wv();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(f,p,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:v==null?null:""+v,children:f,containerInfo:p,implementation:g}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Us.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Us.createPortal=function(f,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return s(f,p,null,g)},Us.flushSync=function(f){var p=o.T,g=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=p,n.p=g,n.d.f()}},Us.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(f,p))},Us.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Us.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var g=p.as,v=u(g,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,A=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?n.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:A}):g==="script"&&n.d.X(f,{crossOrigin:v,integrity:y,fetchPriority:A,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Us.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=u(p.as,p.crossOrigin);n.d.M(f,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(f)},Us.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,v=u(g,p.crossOrigin);n.d.L(f,g,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Us.preloadModule=function(f,p){if(typeof f=="string")if(p){var g=u(p.as,p.crossOrigin);n.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(f)},Us.requestFormReset=function(f){n.d.r(f)},Us.unstable_batchedUpdates=function(f,p){return f(p)},Us.useFormState=function(f,p,g){return o.H.useFormState(f,p,g)},Us.useFormStatus=function(){return o.H.useHostTransitionStatus()},Us.version="19.2.4",Us}var Kw;function FB(){if(Kw)return tb.exports;Kw=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),tb.exports=UB(),tb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zw;function zB(){if(Zw)return mg;Zw=1;var i=o2(),e=wv(),t=FB();function n(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var l=a,h=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(h=l.return),a=l.return;while(a)}return l.tag===3?h:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function u(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function f(a){if(s(a)!==a)throw Error(n(188))}function p(a){var l=a.alternate;if(!l){if(l=s(a),l===null)throw Error(n(188));return l!==a?null:a}for(var h=a,m=l;;){var b=h.return;if(b===null)break;var w=b.alternate;if(w===null){if(m=b.return,m!==null){h=m;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===h)return f(b),a;if(w===m)return f(b),l;w=w.sibling}throw Error(n(188))}if(h.return!==m.return)h=b,m=w;else{for(var U=!1,J=b.child;J;){if(J===h){U=!0,h=b,m=w;break}if(J===m){U=!0,m=b,h=w;break}J=J.sibling}if(!U){for(J=w.child;J;){if(J===h){U=!0,h=w,m=b;break}if(J===m){U=!0,m=w,h=b;break}J=J.sibling}if(!U)throw Error(n(189))}}if(h.alternate!==m)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?a:l}function g(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=g(a),l!==null)return l;a=a.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),I=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function de(a){return a===null||typeof a!="object"?null:(a=K&&a[K]||a["@@iterator"],typeof a=="function"?a:null)}var ce=Symbol.for("react.client.reference");function ne(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===ce?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case T:return"Fragment";case E:return"Profiler";case M:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case L:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case S:return"Portal";case I:return a.displayName||"Context";case R:return(a._context.displayName||"Context")+".Consumer";case O:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case j:return l=a.displayName||null,l!==null?l:ne(a.type)||"Memo";case W:l=a._payload,a=a._init;try{return ne(a(l))}catch{}}return null}var fe=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},Te=[],Se=-1;function Y(a){return{current:a}}function me(a){0>Se||(a.current=Te[Se],Te[Se]=null,Se--)}function Ce(a,l){Se++,Te[Se]=a.current,a.current=l}var Ze=Y(null),xt=Y(null),ve=Y(null),ze=Y(null);function dt(a,l){switch(Ce(ve,l),Ce(xt,a),Ce(Ze,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?hw(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=hw(l),a=pw(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}me(Ze),Ce(Ze,a)}function Ee(){me(Ze),me(xt),me(ve)}function yt(a){a.memoizedState!==null&&Ce(ze,a);var l=Ze.current,h=pw(l,a.type);l!==h&&(Ce(xt,a),Ce(Ze,h))}function Pt(a){xt.current===a&&(me(Ze),me(xt)),ze.current===a&&(me(ze),ug._currentValue=ge)}var Ot,Mt;function je(a){if(Ot===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);Ot=l&&l[1]||"",Mt=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ot+a+Mt}var st=!1;function et(a,l){if(!a||st)return"";st=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var gt=function(){throw Error()};if(Object.defineProperty(gt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(gt,[])}catch(rt){var Xe=rt}Reflect.construct(a,[],gt)}else{try{gt.call()}catch(rt){Xe=rt}a.call(gt.prototype)}}else{try{throw Error()}catch(rt){Xe=rt}(gt=a())&&typeof gt.catch=="function"&&gt.catch(function(){})}}catch(rt){if(rt&&Xe&&typeof rt.stack=="string")return[rt.stack,Xe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=m.DetermineComponentFrameRoot(),U=w[0],J=w[1];if(U&&J){var ye=U.split(`
`),Ve=J.split(`
`);for(b=m=0;m<ye.length&&!ye[m].includes("DetermineComponentFrameRoot");)m++;for(;b<Ve.length&&!Ve[b].includes("DetermineComponentFrameRoot");)b++;if(m===ye.length||b===Ve.length)for(m=ye.length-1,b=Ve.length-1;1<=m&&0<=b&&ye[m]!==Ve[b];)b--;for(;1<=m&&0<=b;m--,b--)if(ye[m]!==Ve[b]){if(m!==1||b!==1)do if(m--,b--,0>b||ye[m]!==Ve[b]){var lt=`
`+ye[m].replace(" at new "," at ");return a.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",a.displayName)),lt}while(1<=m&&0<=b);break}}}finally{st=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?je(h):""}function At(a,l){switch(a.tag){case 26:case 27:case 5:return je(a.type);case 16:return je("Lazy");case 13:return a.child!==l&&l!==null?je("Suspense Fallback"):je("Suspense");case 19:return je("SuspenseList");case 0:case 15:return et(a.type,!1);case 11:return et(a.type.render,!1);case 1:return et(a.type,!0);case 31:return je("Activity");default:return""}}function oe(a){try{var l="",h=null;do l+=At(a,h),h=a,a=a.return;while(a);return l}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Gt=Object.prototype.hasOwnProperty,Dt=i.unstable_scheduleCallback,qt=i.unstable_cancelCallback,Tt=i.unstable_shouldYield,te=i.unstable_requestPaint,G=i.unstable_now,be=i.unstable_getCurrentPriorityLevel,Ye=i.unstable_ImmediatePriority,ot=i.unstable_UserBlockingPriority,Qe=i.unstable_NormalPriority,Ut=i.unstable_LowPriority,Rt=i.unstable_IdlePriority,Vt=i.log,$t=i.unstable_setDisableYieldValue,vt=null,ct=null;function Bt(a){if(typeof Vt=="function"&&$t(a),ct&&typeof ct.setStrictMode=="function")try{ct.setStrictMode(vt,a)}catch{}}var he=Math.clz32?Math.clz32:pe,Be=Math.log,ft=Math.LN2;function pe(a){return a>>>=0,a===0?32:31-(Be(a)/ft|0)|0}var Fe=256,Oe=262144,It=4194304;function _t(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function ut(a,l,h){var m=a.pendingLanes;if(m===0)return 0;var b=0,w=a.suspendedLanes,U=a.pingedLanes;a=a.warmLanes;var J=m&134217727;return J!==0?(m=J&~w,m!==0?b=_t(m):(U&=J,U!==0?b=_t(U):h||(h=J&~a,h!==0&&(b=_t(h))))):(J=m&~w,J!==0?b=_t(J):U!==0?b=_t(U):h||(h=m&~a,h!==0&&(b=_t(h)))),b===0?0:l!==0&&l!==b&&(l&w)===0&&(w=b&-b,h=l&-l,w>=h||w===32&&(h&4194048)!==0)?l:b}function wt(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function Zt(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yn(){var a=It;return It<<=1,(It&62914560)===0&&(It=4194304),a}function _n(a){for(var l=[],h=0;31>h;h++)l.push(a);return l}function Si(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function ji(a,l,h,m,b,w){var U=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var J=a.entanglements,ye=a.expirationTimes,Ve=a.hiddenUpdates;for(h=U&~h;0<h;){var lt=31-he(h),gt=1<<lt;J[lt]=0,ye[lt]=-1;var Xe=Ve[lt];if(Xe!==null)for(Ve[lt]=null,lt=0;lt<Xe.length;lt++){var rt=Xe[lt];rt!==null&&(rt.lane&=-536870913)}h&=~gt}m!==0&&ha(a,m,0),w!==0&&b===0&&a.tag!==0&&(a.suspendedLanes|=w&~(U&~l))}function ha(a,l,h){a.pendingLanes|=l,a.suspendedLanes&=~l;var m=31-he(l);a.entangledLanes|=l,a.entanglements[m]=a.entanglements[m]|1073741824|h&261930}function pa(a,l){var h=a.entangledLanes|=l;for(a=a.entanglements;h;){var m=31-he(h),b=1<<m;b&l|a[m]&l&&(a[m]|=l),h&=~b}}function Ts(a,l){var h=l&-l;return h=(h&42)!==0?1:ma(h),(h&(a.suspendedLanes|l))!==0?0:h}function ma(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Xr(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function is(){var a=re.p;return a!==0?a:(a=window.event,a===void 0?32:Uw(a.type))}function rn(a,l){var h=re.p;try{return re.p=a,l()}finally{re.p=h}}var Br=Math.random().toString(36).slice(2),bi="__reactFiber$"+Br,V="__reactProps$"+Br,ee="__reactContainer$"+Br,xe="__reactEvents$"+Br,Ge="__reactListeners$"+Br,Je="__reactHandles$"+Br,Ke="__reactResources$"+Br,N="__reactMarker$"+Br;function k(a){delete a[bi],delete a[V],delete a[xe],delete a[Ge],delete a[Je]}function $(a){var l=a[bi];if(l)return l;for(var h=a.parentNode;h;){if(l=h[ee]||h[bi]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(a=_w(a);a!==null;){if(h=a[bi])return h;a=_w(a)}return l}a=h,h=a.parentNode}return null}function ue(a){if(a=a[bi]||a[ee]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function _e(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(n(33))}function De(a){var l=a[Ke];return l||(l=a[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function P(a){a[N]=!0}var Z=new Set,se={};function ae(a,l){ie(a,l),ie(a+"Capture",l)}function ie(a,l){for(se[a]=l,a=0;a<l.length;a++)Z.add(l[a])}var we=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ie={},Re={};function tt(a){return Gt.call(Re,a)?!0:Gt.call(Ie,a)?!1:we.test(a)?Re[a]=!0:(Ie[a]=!0,!1)}function He(a,l,h){if(tt(l))if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+h)}}function at(a,l,h){if(h===null)a.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+h)}}function nt(a,l,h,m){if(m===null)a.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(l,h,""+m)}}function Et(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Wt(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function ln(a,l,h){var m=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var b=m.get,w=m.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return b.call(this)},set:function(U){h=""+U,w.call(this,U)}}),Object.defineProperty(a,l,{enumerable:m.enumerable}),{getValue:function(){return h},setValue:function(U){h=""+U},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Yt(a){if(!a._valueTracker){var l=Wt(a)?"checked":"value";a._valueTracker=ln(a,l,""+a[l])}}function mt(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var h=l.getValue(),m="";return a&&(m=Wt(a)?a.checked?"true":"false":a.value),a=m,a!==h?(l.setValue(a),!0):!1}function ht(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var zt=/[\n"\\]/g;function St(a){return a.replace(zt,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Qt(a,l,h,m,b,w,U,J){a.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?a.type=U:a.removeAttribute("type"),l!=null?U==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+Et(l)):a.value!==""+Et(l)&&(a.value=""+Et(l)):U!=="submit"&&U!=="reset"||a.removeAttribute("value"),l!=null?fn(a,U,Et(l)):h!=null?fn(a,U,Et(h)):m!=null&&a.removeAttribute("value"),b==null&&w!=null&&(a.defaultChecked=!!w),b!=null&&(a.checked=b&&typeof b!="function"&&typeof b!="symbol"),J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"?a.name=""+Et(J):a.removeAttribute("name")}function vn(a,l,h,m,b,w,U,J){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(a.type=w),l!=null||h!=null){if(!(w!=="submit"&&w!=="reset"||l!=null)){Yt(a);return}h=h!=null?""+Et(h):"",l=l!=null?""+Et(l):h,J||l===a.value||(a.value=l),a.defaultValue=l}m=m??b,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=J?a.checked:!!m,a.defaultChecked=!!m,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(a.name=U),Yt(a)}function fn(a,l,h){l==="number"&&ht(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function oi(a,l,h,m){if(a=a.options,l){l={};for(var b=0;b<h.length;b++)l["$"+h[b]]=!0;for(h=0;h<a.length;h++)b=l.hasOwnProperty("$"+a[h].value),a[h].selected!==b&&(a[h].selected=b),b&&m&&(a[h].defaultSelected=!0)}else{for(h=""+Et(h),l=null,b=0;b<a.length;b++){if(a[b].value===h){a[b].selected=!0,m&&(a[b].defaultSelected=!0);return}l!==null||a[b].disabled||(l=a[b])}l!==null&&(l.selected=!0)}}function En(a,l,h){if(l!=null&&(l=""+Et(l),l!==a.value&&(a.value=l),h==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=h!=null?""+Et(h):""}function Ui(a,l,h,m){if(l==null){if(m!=null){if(h!=null)throw Error(n(92));if(fe(m)){if(1<m.length)throw Error(n(93));m=m[0]}h=m}h==null&&(h=""),l=h}h=Et(l),a.defaultValue=h,m=a.textContent,m===h&&m!==""&&m!==null&&(a.value=m),Yt(a)}function vr(a,l){if(l){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=l;return}}a.textContent=l}var Nr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Or(a,l,h){var m=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?m?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":m?a.setProperty(l,h):typeof h!="number"||h===0||Nr.has(l)?l==="float"?a.cssFloat=h:a[l]=(""+h).trim():a[l]=h+"px"}function cc(a,l,h){if(l!=null&&typeof l!="object")throw Error(n(62));if(a=a.style,h!=null){for(var m in h)!h.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var b in l)m=l[b],l.hasOwnProperty(b)&&h[b]!==m&&Or(a,b,m)}else for(var w in l)l.hasOwnProperty(w)&&Or(a,w,l[w])}function ga(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cd(a){return jm.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function zo(){}var hh=null;function ph(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var uc=null,Al=null;function Wm(a){var l=ue(a);if(l&&(a=l.stateNode)){var h=a[V]||null;e:switch(a=l.stateNode,l.type){case"input":if(Qt(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+St(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var m=h[l];if(m!==a&&m.form===a.form){var b=m[V]||null;if(!b)throw Error(n(90));Qt(m,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(l=0;l<h.length;l++)m=h[l],m.form===a.form&&mt(m)}break e;case"textarea":En(a,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&oi(a,!!h.multiple,l,!1)}}}var mh=!1;function Xm(a,l,h){if(mh)return a(l,h);mh=!0;try{var m=a(l);return m}finally{if(mh=!1,(uc!==null||Al!==null)&&(Xa(),uc&&(l=uc,a=Al,Al=uc=null,Wm(l),a)))for(l=0;l<a.length;l++)Wm(a[l])}}function uu(a,l){var h=a.stateNode;if(h===null)return null;var m=h[V]||null;if(m===null)return null;h=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(n(231,l,typeof h));return h}var io=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ym=!1;if(io)try{var du={};Object.defineProperty(du,"passive",{get:function(){Ym=!0}}),window.addEventListener("test",du,du),window.removeEventListener("test",du,du)}catch{Ym=!1}var Ws=null,gh=null,dc=null;function Rd(){if(dc)return dc;var a,l=gh,h=l.length,m,b="value"in Ws?Ws.value:Ws.textContent,w=b.length;for(a=0;a<h&&l[a]===b[a];a++);var U=h-a;for(m=1;m<=U&&l[h-m]===b[w-m];m++);return dc=b.slice(a,1<m?1-m:void 0)}function Dd(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function fu(){return!0}function $v(){return!1}function ps(a){function l(h,m,b,w,U){this._reactName=h,this._targetInst=b,this.type=m,this.nativeEvent=w,this.target=U,this.currentTarget=null;for(var J in a)a.hasOwnProperty(J)&&(h=a[J],this[J]=h?h(w):w[J]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?fu:$v,this.isPropagationStopped=$v,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=fu)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=fu)},persist:function(){},isPersistent:fu}),l}var _l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Id=ps(_l),hu=v({},_l,{view:0,detail:0}),e1=ps(hu),Bd,vh,pu,mu=v({},hu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_h,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==pu&&(pu&&a.type==="mousemove"?(Bd=a.screenX-pu.screenX,vh=a.screenY-pu.screenY):vh=Bd=0,pu=a),Bd)},movementY:function(a){return"movementY"in a?a.movementY:vh}}),Qm=ps(mu),t1=v({},mu,{dataTransfer:0}),n1=ps(t1),qm=v({},hu,{relatedTarget:0}),xh=ps(qm),i1=v({},_l,{animationName:0,elapsedTime:0,pseudoElement:0}),gS=ps(i1),vS=v({},_l,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),r1=ps(vS),Nd=v({},_l,{data:0}),yh=ps(Nd),Ah={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jm(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=a1[a])?!!l[a]:!1}function _h(){return Jm}var o1=v({},hu,{key:function(a){if(a.key){var l=Ah[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Dd(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?s1[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_h,charCode:function(a){return a.type==="keypress"?Dd(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Dd(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),fc=ps(o1),Sh=v({},mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Km=ps(Sh),Zm=v({},hu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_h}),l1=ps(Zm),c1=v({},_l,{propertyName:0,elapsedTime:0,pseudoElement:0}),xS=ps(c1),Yr=v({},mu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),u1=ps(Yr),d1=v({},_l,{newState:0,oldState:0}),f1=ps(d1),h1=[9,13,27,32],hc=io&&"CompositionEvent"in window,gu=null;io&&"documentMode"in document&&(gu=document.documentMode);var bh=io&&"TextEvent"in window&&!gu,$m=io&&(!hc||gu&&8<gu&&11>=gu),p1=" ",Od=!1;function Eh(a,l){switch(a){case"keyup":return h1.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e0(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var pc=!1;function m1(a,l){switch(a){case"compositionend":return e0(l);case"keypress":return l.which!==32?null:(Od=!0,p1);case"textInput":return a=l.data,a===p1&&Od?null:a;default:return null}}function t0(a,l){if(pc)return a==="compositionend"||!hc&&Eh(a,l)?(a=Rd(),dc=gh=Ws=null,pc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return $m&&l.locale!=="ko"?null:l.data;default:return null}}var n0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i0(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!n0[a.type]:l==="textarea"}function Mh(a,l,h,m){uc?Al?Al.push(m):Al=[m]:uc=m,l=Ax(l,"onChange"),0<l.length&&(h=new Id("onChange","change",null,h,m),a.push({event:h,listeners:l}))}var Sl=null,mc=null;function g1(a){ow(a,0)}function vu(a){var l=_e(a);if(mt(l))return a}function r0(a,l){if(a==="change")return l}var ro=!1;if(io){var Ld;if(io){var s0="oninput"in document;if(!s0){var a0=document.createElement("div");a0.setAttribute("oninput","return;"),s0=typeof a0.oninput=="function"}Ld=s0}else Ld=!1;ro=Ld&&(!document.documentMode||9<document.documentMode)}function va(){Sl&&(Sl.detachEvent("onpropertychange",Pd),mc=Sl=null)}function Pd(a){if(a.propertyName==="value"&&vu(mc)){var l=[];Mh(l,mc,a,ph(a)),Xm(g1,l)}}function v1(a,l,h){a==="focusin"?(va(),Sl=l,mc=h,Sl.attachEvent("onpropertychange",Pd)):a==="focusout"&&va()}function o0(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return vu(mc)}function x1(a,l){if(a==="click")return vu(l)}function y1(a,l){if(a==="input"||a==="change")return vu(l)}function l0(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var ms=typeof Object.is=="function"?Object.is:l0;function xu(a,l){if(ms(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var h=Object.keys(a),m=Object.keys(l);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var b=h[m];if(!Gt.call(l,b)||!ms(a[b],l[b]))return!1}return!0}function Ud(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function yu(a,l){var h=Ud(a);a=0;for(var m;h;){if(h.nodeType===3){if(m=a+h.textContent.length,a<=l&&m>=l)return{node:h,offset:l-a};a=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Ud(h)}}function wi(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?wi(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function A1(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=ht(a.document);l instanceof a.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)a=l.contentWindow;else break;l=ht(a.document)}return l}function c0(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var _1=io&&"documentMode"in document&&11>=document.documentMode,so=null,ao=null,Au=null,Th=!1;function _u(a,l,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Th||so==null||so!==ht(m)||(m=so,"selectionStart"in m&&c0(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Au&&xu(Au,m)||(Au=m,m=Ax(ao,"onSelect"),0<m.length&&(l=new Id("onSelect","select",null,l,h),a.push({event:l,listeners:m}),l.target=so)))}function rs(a,l){var h={};return h[a.toLowerCase()]=l.toLowerCase(),h["Webkit"+a]="webkit"+l,h["Moz"+a]="moz"+l,h}var gc={animationend:rs("Animation","AnimationEnd"),animationiteration:rs("Animation","AnimationIteration"),animationstart:rs("Animation","AnimationStart"),transitionrun:rs("Transition","TransitionRun"),transitionstart:rs("Transition","TransitionStart"),transitioncancel:rs("Transition","TransitionCancel"),transitionend:rs("Transition","TransitionEnd")},Fd={},u0={};io&&(u0=document.createElement("div").style,"AnimationEvent"in window||(delete gc.animationend.animation,delete gc.animationiteration.animation,delete gc.animationstart.animation),"TransitionEvent"in window||delete gc.transitionend.transition);function Ho(a){if(Fd[a])return Fd[a];if(!gc[a])return a;var l=gc[a],h;for(h in l)if(l.hasOwnProperty(h)&&h in u0)return Fd[a]=l[h];return a}var wh=Ho("animationend"),zd=Ho("animationiteration"),d0=Ho("animationstart"),S1=Ho("transitionrun"),yS=Ho("transitionstart"),b1=Ho("transitioncancel"),f0=Ho("transitionend"),xa=new Map,Hd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hd.push("scrollEnd");function ya(a,l){xa.set(a,l),ae(l,[a])}var Gd=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Aa=[],Go=0,Lr=0;function kd(){for(var a=Go,l=Lr=Go=0;l<a;){var h=Aa[l];Aa[l++]=null;var m=Aa[l];Aa[l++]=null;var b=Aa[l];Aa[l++]=null;var w=Aa[l];if(Aa[l++]=null,m!==null&&b!==null){var U=m.pending;U===null?b.next=b:(b.next=U.next,U.next=b),m.pending=b}w!==0&&bl(h,b,w)}}function Pr(a,l,h,m){Aa[Go++]=a,Aa[Go++]=l,Aa[Go++]=h,Aa[Go++]=m,Lr|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function Ch(a,l,h,m){return Pr(a,l,h,m),_a(a)}function gs(a,l){return Pr(a,null,null,l),_a(a)}function bl(a,l,h){a.lanes|=h;var m=a.alternate;m!==null&&(m.lanes|=h);for(var b=!1,w=a.return;w!==null;)w.childLanes|=h,m=w.alternate,m!==null&&(m.childLanes|=h),w.tag===22&&(a=w.stateNode,a===null||a._visibility&1||(b=!0)),a=w,w=w.return;return a.tag===3?(w=a.stateNode,b&&l!==null&&(b=31-he(h),a=w.hiddenUpdates,m=a[b],m===null?a[b]=[l]:m.push(l),l.lane=h|536870912),w):null}function _a(a){if(50<kl)throw kl=0,Lc=null,Error(n(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var El={};function h0(a,l,h,m){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wi(a,l,h,m){return new h0(a,l,h,m)}function Rh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function ws(a,l){var h=a.alternate;return h===null?(h=Wi(a.tag,l,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=l,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,l=a.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function Su(a,l){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,l=h.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function oo(a,l,h,m,b,w){var U=0;if(m=a,typeof a=="function")Rh(a)&&(U=1);else if(typeof a=="string")U=yB(a,h,Ze.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case L:return a=Wi(31,h,l,b),a.elementType=L,a.lanes=w,a;case T:return Ml(h.children,b,w,l);case M:U=8,b|=24;break;case E:return a=Wi(12,h,l,b|2),a.elementType=E,a.lanes=w,a;case F:return a=Wi(13,h,l,b),a.elementType=F,a.lanes=w,a;case z:return a=Wi(19,h,l,b),a.elementType=z,a.lanes=w,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case I:U=10;break e;case R:U=9;break e;case O:U=11;break e;case j:U=14;break e;case W:U=16,m=null;break e}U=29,h=Error(n(130,a===null?"null":typeof a,"")),m=null}return l=Wi(U,h,l,b),l.elementType=a,l.type=m,l.lanes=w,l}function Ml(a,l,h,m){return a=Wi(7,a,m,l),a.lanes=h,a}function Dh(a,l,h){return a=Wi(6,a,null,l),a.lanes=h,a}function bu(a){var l=Wi(18,null,null,0);return l.stateNode=a,l}function Ih(a,l,h){return l=Wi(4,a.children!==null?a.children:[],a.key,l),l.lanes=h,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var Vd=new WeakMap;function Xs(a,l){if(typeof a=="object"&&a!==null){var h=Vd.get(a);return h!==void 0?h:(l={value:a,source:l,stack:oe(l)},Vd.set(a,l),l)}return{value:a,source:l,stack:oe(l)}}var Tl=[],wl=0,Eu=null,Mu=0,Cs=[],Fi=0,ko=null,Xi=1,ka="";function lo(a,l){Tl[wl++]=Mu,Tl[wl++]=Eu,Eu=a,Mu=l}function E1(a,l,h){Cs[Fi++]=Xi,Cs[Fi++]=ka,Cs[Fi++]=ko,ko=a;var m=Xi;a=ka;var b=32-he(m)-1;m&=~(1<<b),h+=1;var w=32-he(l)+b;if(30<w){var U=b-b%5;w=(m&(1<<U)-1).toString(32),m>>=U,b-=U,Xi=1<<32-he(l)+b|h<<b|m,ka=w+a}else Xi=1<<w|h<<b|m,ka=a}function co(a){a.return!==null&&(lo(a,1),E1(a,1,0))}function Bh(a){for(;a===Eu;)Eu=Tl[--wl],Tl[wl]=null,Mu=Tl[--wl],Tl[wl]=null;for(;a===ko;)ko=Cs[--Fi],Cs[Fi]=null,ka=Cs[--Fi],Cs[Fi]=null,Xi=Cs[--Fi],Cs[Fi]=null}function Nh(a,l){Cs[Fi++]=Xi,Cs[Fi++]=ka,Cs[Fi++]=ko,Xi=l.id,ka=l.overflow,ko=a}var tr=null,Ci=null,Wn=!1,Vo=null,Ys=!1,Tu=Error(n(519));function uo(a){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fo(Xs(l,a)),Tu}function M1(a){var l=a.stateNode,h=a.type,m=a.memoizedProps;switch(l[bi]=a,l[V]=m,h){case"dialog":Qn("cancel",l),Qn("close",l);break;case"iframe":case"object":case"embed":Qn("load",l);break;case"video":case"audio":for(h=0;h<Oa.length;h++)Qn(Oa[h],l);break;case"source":Qn("error",l);break;case"img":case"image":case"link":Qn("error",l),Qn("load",l);break;case"details":Qn("toggle",l);break;case"input":Qn("invalid",l),vn(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Qn("invalid",l);break;case"textarea":Qn("invalid",l),Ui(l,m.value,m.defaultValue,m.children)}h=m.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||m.suppressHydrationWarning===!0||dw(l.textContent,h)?(m.popover!=null&&(Qn("beforetoggle",l),Qn("toggle",l)),m.onScroll!=null&&Qn("scroll",l),m.onScrollEnd!=null&&Qn("scrollend",l),m.onClick!=null&&(l.onclick=zo),l=!0):l=!1,l||uo(a,!0)}function T1(a){for(tr=a.return;tr;)switch(tr.tag){case 5:case 31:case 13:Ys=!1;return;case 27:case 3:Ys=!0;return;default:tr=tr.return}}function wu(a){if(a!==tr)return!1;if(!Wn)return T1(a),Wn=!0,!1;var l=a.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||LS(a.type,a.memoizedProps)),h=!h),h&&Ci&&uo(a),T1(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Ci=Aw(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Ci=Aw(a)}else l===27?(l=Ci,Yu(a.type)?(a=HS,HS=null,Ci=a):Ci=l):Ci=tr?To(a.stateNode.nextSibling):null;return!0}function Cl(){Ci=tr=null,Wn=!1}function Oh(){var a=Vo;return a!==null&&(ir===null?ir=a:ir.push.apply(ir,a),Vo=null),a}function fo(a){Vo===null?Vo=[a]:Vo.push(a)}var Cu=Y(null),Rl=null,ho=null;function jo(a,l,h){Ce(Cu,l._currentValue),l._currentValue=h}function po(a){a._currentValue=Cu.current,me(Cu)}function Lh(a,l,h){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===h)break;a=a.return}}function Ph(a,l,h,m){var b=a.child;for(b!==null&&(b.return=a);b!==null;){var w=b.dependencies;if(w!==null){var U=b.child;w=w.firstContext;e:for(;w!==null;){var J=w;w=b;for(var ye=0;ye<l.length;ye++)if(J.context===l[ye]){w.lanes|=h,J=w.alternate,J!==null&&(J.lanes|=h),Lh(w.return,h,a),m||(U=null);break e}w=J.next}}else if(b.tag===18){if(U=b.return,U===null)throw Error(n(341));U.lanes|=h,w=U.alternate,w!==null&&(w.lanes|=h),Lh(U,h,a),U=null}else U=b.child;if(U!==null)U.return=b;else for(U=b;U!==null;){if(U===a){U=null;break}if(b=U.sibling,b!==null){b.return=U.return,U=b;break}U=U.return}b=U}}function mo(a,l,h,m){a=null;for(var b=l,w=!1;b!==null;){if(!w){if((b.flags&524288)!==0)w=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var U=b.alternate;if(U===null)throw Error(n(387));if(U=U.memoizedProps,U!==null){var J=b.type;ms(b.pendingProps.value,U.value)||(a!==null?a.push(J):a=[J])}}else if(b===ze.current){if(U=b.alternate,U===null)throw Error(n(387));U.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(a!==null?a.push(ug):a=[ug])}b=b.return}a!==null&&Ph(l,a,h,m),l.flags|=262144}function jd(a){for(a=a.firstContext;a!==null;){if(!ms(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Dl(a){Rl=a,ho=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function mn(a){return w1(Rl,a)}function Ru(a,l){return Rl===null&&Dl(a),w1(a,l)}function w1(a,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},ho===null){if(a===null)throw Error(n(308));ho=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else ho=ho.next=l;return h}var C1=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(h,m){a.push(m)}};this.abort=function(){l.aborted=!0,a.forEach(function(h){return h()})}},AS=i.unstable_scheduleCallback,_S=i.unstable_NormalPriority,xr={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function p0(){return{controller:new C1,data:new Map,refCount:0}}function vc(a){a.refCount--,a.refCount===0&&AS(_S,function(){a.controller.abort()})}var Qs=null,Uh=0,Wo=0,Sa=null;function m0(a,l){if(Qs===null){var h=Qs=[];Uh=0,Wo=$e(),Sa={status:"pending",value:void 0,then:function(m){h.push(m)}}}return Uh++,l.then(g0,g0),l}function g0(){if(--Uh===0&&Qs!==null){Sa!==null&&(Sa.status="fulfilled");var a=Qs;Qs=null,Wo=0,Sa=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function v0(a,l){var h=[],m={status:"pending",value:null,reason:null,then:function(b){h.push(b)}};return a.then(function(){m.status="fulfilled",m.value=l;for(var b=0;b<h.length;b++)(0,h[b])(l)},function(b){for(m.status="rejected",m.reason=b,b=0;b<h.length;b++)(0,h[b])(void 0)}),m}var R1=X.S;X.S=function(a,l){rg=G(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&m0(a,l),R1!==null&&R1(a,l)};var Il=Y(null);function Fh(){var a=Il.current;return a!==null?a:xn.pooledCache}function Wd(a,l){l===null?Ce(Il,Il.current):Ce(Il,l.pool)}function x0(){var a=Fh();return a===null?null:{parent:xr._currentValue,pool:a}}var xc=Error(n(460)),Xd=Error(n(474)),Rn=Error(n(542)),zh={then:function(){}};function Rs(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Hh(a,l,h){switch(h=a[h],h===void 0?a.push(l):h!==l&&(l.then(zo,zo),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,_c(a),a;default:if(typeof l.status=="string")l.then(zo,zo);else{if(a=xn,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=l,a.status="pending",a.then(function(m){if(l.status==="pending"){var b=l;b.status="fulfilled",b.value=m}},function(m){if(l.status==="pending"){var b=l;b.status="rejected",b.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,_c(a),a}throw go=l,xc}}function yc(a){try{var l=a._init;return l(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(go=h,xc):h}}var go=null;function Ac(){if(go===null)throw Error(n(459));var a=go;return go=null,a}function _c(a){if(a===xc||a===Rn)throw Error(n(483))}var Sc=null,bc=0;function Yd(a){var l=bc;return bc+=1,Sc===null&&(Sc=[]),Hh(Sc,a,l)}function ba(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function Du(a,l){throw l.$$typeof===y?Error(n(525)):(a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function Gh(a){function l(Le,Me){if(a){var ke=Le.deletions;ke===null?(Le.deletions=[Me],Le.flags|=16):ke.push(Me)}}function h(Le,Me){if(!a)return null;for(;Me!==null;)l(Le,Me),Me=Me.sibling;return null}function m(Le){for(var Me=new Map;Le!==null;)Le.key!==null?Me.set(Le.key,Le):Me.set(Le.index,Le),Le=Le.sibling;return Me}function b(Le,Me){return Le=ws(Le,Me),Le.index=0,Le.sibling=null,Le}function w(Le,Me,ke){return Le.index=ke,a?(ke=Le.alternate,ke!==null?(ke=ke.index,ke<Me?(Le.flags|=67108866,Me):ke):(Le.flags|=67108866,Me)):(Le.flags|=1048576,Me)}function U(Le){return a&&Le.alternate===null&&(Le.flags|=67108866),Le}function J(Le,Me,ke,pt){return Me===null||Me.tag!==6?(Me=Dh(ke,Le.mode,pt),Me.return=Le,Me):(Me=b(Me,ke),Me.return=Le,Me)}function ye(Le,Me,ke,pt){var an=ke.type;return an===T?lt(Le,Me,ke.props.children,pt,ke.key):Me!==null&&(Me.elementType===an||typeof an=="object"&&an!==null&&an.$$typeof===W&&yc(an)===Me.type)?(Me=b(Me,ke.props),ba(Me,ke),Me.return=Le,Me):(Me=oo(ke.type,ke.key,ke.props,null,Le.mode,pt),ba(Me,ke),Me.return=Le,Me)}function Ve(Le,Me,ke,pt){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==ke.containerInfo||Me.stateNode.implementation!==ke.implementation?(Me=Ih(ke,Le.mode,pt),Me.return=Le,Me):(Me=b(Me,ke.children||[]),Me.return=Le,Me)}function lt(Le,Me,ke,pt,an){return Me===null||Me.tag!==7?(Me=Ml(ke,Le.mode,pt,an),Me.return=Le,Me):(Me=b(Me,ke),Me.return=Le,Me)}function gt(Le,Me,ke){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=Dh(""+Me,Le.mode,ke),Me.return=Le,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case A:return ke=oo(Me.type,Me.key,Me.props,null,Le.mode,ke),ba(ke,Me),ke.return=Le,ke;case S:return Me=Ih(Me,Le.mode,ke),Me.return=Le,Me;case W:return Me=yc(Me),gt(Le,Me,ke)}if(fe(Me)||de(Me))return Me=Ml(Me,Le.mode,ke,null),Me.return=Le,Me;if(typeof Me.then=="function")return gt(Le,Yd(Me),ke);if(Me.$$typeof===I)return gt(Le,Ru(Le,Me),ke);Du(Le,Me)}return null}function Xe(Le,Me,ke,pt){var an=Me!==null?Me.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return an!==null?null:J(Le,Me,""+ke,pt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case A:return ke.key===an?ye(Le,Me,ke,pt):null;case S:return ke.key===an?Ve(Le,Me,ke,pt):null;case W:return ke=yc(ke),Xe(Le,Me,ke,pt)}if(fe(ke)||de(ke))return an!==null?null:lt(Le,Me,ke,pt,null);if(typeof ke.then=="function")return Xe(Le,Me,Yd(ke),pt);if(ke.$$typeof===I)return Xe(Le,Me,Ru(Le,ke),pt);Du(Le,ke)}return null}function rt(Le,Me,ke,pt,an){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return Le=Le.get(ke)||null,J(Me,Le,""+pt,an);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case A:return Le=Le.get(pt.key===null?ke:pt.key)||null,ye(Me,Le,pt,an);case S:return Le=Le.get(pt.key===null?ke:pt.key)||null,Ve(Me,Le,pt,an);case W:return pt=yc(pt),rt(Le,Me,ke,pt,an)}if(fe(pt)||de(pt))return Le=Le.get(ke)||null,lt(Me,Le,pt,an,null);if(typeof pt.then=="function")return rt(Le,Me,ke,Yd(pt),an);if(pt.$$typeof===I)return rt(Le,Me,ke,Ru(Me,pt),an);Du(Me,pt)}return null}function Kt(Le,Me,ke,pt){for(var an=null,li=null,en=Me,Ln=Me=0,Zn=null;en!==null&&Ln<ke.length;Ln++){en.index>Ln?(Zn=en,en=null):Zn=en.sibling;var ci=Xe(Le,en,ke[Ln],pt);if(ci===null){en===null&&(en=Zn);break}a&&en&&ci.alternate===null&&l(Le,en),Me=w(ci,Me,Ln),li===null?an=ci:li.sibling=ci,li=ci,en=Zn}if(Ln===ke.length)return h(Le,en),Wn&&lo(Le,Ln),an;if(en===null){for(;Ln<ke.length;Ln++)en=gt(Le,ke[Ln],pt),en!==null&&(Me=w(en,Me,Ln),li===null?an=en:li.sibling=en,li=en);return Wn&&lo(Le,Ln),an}for(en=m(en);Ln<ke.length;Ln++)Zn=rt(en,Le,Ln,ke[Ln],pt),Zn!==null&&(a&&Zn.alternate!==null&&en.delete(Zn.key===null?Ln:Zn.key),Me=w(Zn,Me,Ln),li===null?an=Zn:li.sibling=Zn,li=Zn);return a&&en.forEach(function(Zu){return l(Le,Zu)}),Wn&&lo(Le,Ln),an}function hn(Le,Me,ke,pt){if(ke==null)throw Error(n(151));for(var an=null,li=null,en=Me,Ln=Me=0,Zn=null,ci=ke.next();en!==null&&!ci.done;Ln++,ci=ke.next()){en.index>Ln?(Zn=en,en=null):Zn=en.sibling;var Zu=Xe(Le,en,ci.value,pt);if(Zu===null){en===null&&(en=Zn);break}a&&en&&Zu.alternate===null&&l(Le,en),Me=w(Zu,Me,Ln),li===null?an=Zu:li.sibling=Zu,li=Zu,en=Zn}if(ci.done)return h(Le,en),Wn&&lo(Le,Ln),an;if(en===null){for(;!ci.done;Ln++,ci=ke.next())ci=gt(Le,ci.value,pt),ci!==null&&(Me=w(ci,Me,Ln),li===null?an=ci:li.sibling=ci,li=ci);return Wn&&lo(Le,Ln),an}for(en=m(en);!ci.done;Ln++,ci=ke.next())ci=rt(en,Le,Ln,ci.value,pt),ci!==null&&(a&&ci.alternate!==null&&en.delete(ci.key===null?Ln:ci.key),Me=w(ci,Me,Ln),li===null?an=ci:li.sibling=ci,li=ci);return a&&en.forEach(function(DB){return l(Le,DB)}),Wn&&lo(Le,Ln),an}function Ii(Le,Me,ke,pt){if(typeof ke=="object"&&ke!==null&&ke.type===T&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case A:e:{for(var an=ke.key;Me!==null;){if(Me.key===an){if(an=ke.type,an===T){if(Me.tag===7){h(Le,Me.sibling),pt=b(Me,ke.props.children),pt.return=Le,Le=pt;break e}}else if(Me.elementType===an||typeof an=="object"&&an!==null&&an.$$typeof===W&&yc(an)===Me.type){h(Le,Me.sibling),pt=b(Me,ke.props),ba(pt,ke),pt.return=Le,Le=pt;break e}h(Le,Me);break}else l(Le,Me);Me=Me.sibling}ke.type===T?(pt=Ml(ke.props.children,Le.mode,pt,ke.key),pt.return=Le,Le=pt):(pt=oo(ke.type,ke.key,ke.props,null,Le.mode,pt),ba(pt,ke),pt.return=Le,Le=pt)}return U(Le);case S:e:{for(an=ke.key;Me!==null;){if(Me.key===an)if(Me.tag===4&&Me.stateNode.containerInfo===ke.containerInfo&&Me.stateNode.implementation===ke.implementation){h(Le,Me.sibling),pt=b(Me,ke.children||[]),pt.return=Le,Le=pt;break e}else{h(Le,Me);break}else l(Le,Me);Me=Me.sibling}pt=Ih(ke,Le.mode,pt),pt.return=Le,Le=pt}return U(Le);case W:return ke=yc(ke),Ii(Le,Me,ke,pt)}if(fe(ke))return Kt(Le,Me,ke,pt);if(de(ke)){if(an=de(ke),typeof an!="function")throw Error(n(150));return ke=an.call(ke),hn(Le,Me,ke,pt)}if(typeof ke.then=="function")return Ii(Le,Me,Yd(ke),pt);if(ke.$$typeof===I)return Ii(Le,Me,Ru(Le,ke),pt);Du(Le,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint"?(ke=""+ke,Me!==null&&Me.tag===6?(h(Le,Me.sibling),pt=b(Me,ke),pt.return=Le,Le=pt):(h(Le,Me),pt=Dh(ke,Le.mode,pt),pt.return=Le,Le=pt),U(Le)):h(Le,Me)}return function(Le,Me,ke,pt){try{bc=0;var an=Ii(Le,Me,ke,pt);return Sc=null,an}catch(en){if(en===xc||en===Rn)throw en;var li=Wi(29,en,null,Le.mode);return li.lanes=pt,li.return=Le,li}finally{}}}var Xo=Gh(!0),kh=Gh(!1),vs=!1;function Qd(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function y0(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Yo(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Bl(a,l,h){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(tn&2)!==0){var b=m.pending;return b===null?l.next=l:(l.next=b.next,b.next=l),m.pending=l,l=_a(a),bl(a,null,h),l}return Pr(a,m,l,h),_a(a)}function Nl(a,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var m=l.lanes;m&=a.pendingLanes,h|=m,l.lanes=h,pa(a,h)}}function sn(a,l){var h=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var b=null,w=null;if(h=h.firstBaseUpdate,h!==null){do{var U={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};w===null?b=w=U:w=w.next=U,h=h.next}while(h!==null);w===null?b=w=l:w=w.next=l}else b=w=l;h={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:m.shared,callbacks:m.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=l:a.next=l,h.lastBaseUpdate=l}var A0=!1;function qd(){if(A0){var a=Sa;if(a!==null)throw a}}function Iu(a,l,h,m){A0=!1;var b=a.updateQueue;vs=!1;var w=b.firstBaseUpdate,U=b.lastBaseUpdate,J=b.shared.pending;if(J!==null){b.shared.pending=null;var ye=J,Ve=ye.next;ye.next=null,U===null?w=Ve:U.next=Ve,U=ye;var lt=a.alternate;lt!==null&&(lt=lt.updateQueue,J=lt.lastBaseUpdate,J!==U&&(J===null?lt.firstBaseUpdate=Ve:J.next=Ve,lt.lastBaseUpdate=ye))}if(w!==null){var gt=b.baseState;U=0,lt=Ve=ye=null,J=w;do{var Xe=J.lane&-536870913,rt=Xe!==J.lane;if(rt?(Cn&Xe)===Xe:(m&Xe)===Xe){Xe!==0&&Xe===Wo&&(A0=!0),lt!==null&&(lt=lt.next={lane:0,tag:J.tag,payload:J.payload,callback:null,next:null});e:{var Kt=a,hn=J;Xe=l;var Ii=h;switch(hn.tag){case 1:if(Kt=hn.payload,typeof Kt=="function"){gt=Kt.call(Ii,gt,Xe);break e}gt=Kt;break e;case 3:Kt.flags=Kt.flags&-65537|128;case 0:if(Kt=hn.payload,Xe=typeof Kt=="function"?Kt.call(Ii,gt,Xe):Kt,Xe==null)break e;gt=v({},gt,Xe);break e;case 2:vs=!0}}Xe=J.callback,Xe!==null&&(a.flags|=64,rt&&(a.flags|=8192),rt=b.callbacks,rt===null?b.callbacks=[Xe]:rt.push(Xe))}else rt={lane:Xe,tag:J.tag,payload:J.payload,callback:J.callback,next:null},lt===null?(Ve=lt=rt,ye=gt):lt=lt.next=rt,U|=Xe;if(J=J.next,J===null){if(J=b.shared.pending,J===null)break;rt=J,J=rt.next,rt.next=null,b.lastBaseUpdate=rt,b.shared.pending=null}}while(!0);lt===null&&(ye=gt),b.baseState=ye,b.firstBaseUpdate=Ve,b.lastBaseUpdate=lt,w===null&&(b.shared.lanes=0),bo|=U,a.lanes=U,a.memoizedState=gt}}function Bu(a,l){if(typeof a!="function")throw Error(n(191,a));a.call(l)}function D1(a,l){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)Bu(h[a],l)}var Nu=Y(null),Vh=Y(0);function I1(a,l){a=Zs,Ce(Vh,a),Ce(Nu,l),Zs=a|l.baseLanes}function _0(){Ce(Vh,Zs),Ce(Nu,Nu.current)}function Jd(){Zs=Vh.current,me(Nu),me(Vh)}var Ds=Y(null),xs=null;function Qo(a){var l=a.alternate;Ce(Xn,Xn.current&1),Ce(Ds,a),xs===null&&(l===null||Nu.current!==null||l.memoizedState!==null)&&(xs=a)}function S0(a){Ce(Xn,Xn.current),Ce(Ds,a),xs===null&&(xs=a)}function B1(a){a.tag===22?(Ce(Xn,Xn.current),Ce(Ds,a),xs===null&&(xs=a)):Is()}function Is(){Ce(Xn,Xn.current),Ce(Ds,Ds.current)}function lr(a){me(Ds),xs===a&&(xs=null),me(Xn)}var Xn=Y(0);function qs(a){for(var l=a;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||FS(h)||zS(h)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var zi=0,Mn=null,mi=null,Gn=null,Ea=!1,Ou=!1,Ec=!1,jh=0,Kd=0,Lu=null,b0=0;function Yi(){throw Error(n(321))}function E0(a,l){if(l===null)return!1;for(var h=0;h<l.length&&h<a.length;h++)if(!ms(a[h],l[h]))return!1;return!0}function Wh(a,l,h,m,b,w){return zi=w,Mn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,X.H=a===null||a.memoizedState===null?ux:j0,Ec=!1,w=h(m,b),Ec=!1,Ou&&(w=Mc(l,h,m,b)),N1(a),w}function N1(a){X.H=Pu;var l=mi!==null&&mi.next!==null;if(zi=0,Gn=mi=Mn=null,Ea=!1,Kd=0,Lu=null,l)throw Error(n(300));a===null||yr||(a=a.dependencies,a!==null&&jd(a)&&(yr=!0))}function Mc(a,l,h,m){Mn=a;var b=0;do{if(Ou&&(Lu=null),Kd=0,Ou=!1,25<=b)throw Error(n(301));if(b+=1,Gn=mi=null,a.updateQueue!=null){var w=a.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}X.H=Ma,w=l(h,m)}while(Ou);return w}function Tc(){var a=X.H,l=a.useState()[0];return l=typeof l.then=="function"?Zd(l):l,a=a.useState()[0],(mi!==null?mi.memoizedState:null)!==a&&(Mn.flags|=1024),l}function M0(){var a=jh!==0;return jh=0,a}function T0(a,l,h){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~h}function w0(a){if(Ea){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}Ea=!1}zi=0,Gn=mi=Mn=null,Ou=!1,Kd=jh=0,Lu=null}function Mr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gn===null?Mn.memoizedState=Gn=a:Gn=Gn.next=a,Gn}function cr(){if(mi===null){var a=Mn.alternate;a=a!==null?a.memoizedState:null}else a=mi.next;var l=Gn===null?Mn.memoizedState:Gn.next;if(l!==null)Gn=l,mi=a;else{if(a===null)throw Mn.alternate===null?Error(n(467)):Error(n(310));mi=a,a={memoizedState:mi.memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},Gn===null?Mn.memoizedState=Gn=a:Gn=Gn.next=a}return Gn}function Xh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zd(a){var l=Kd;return Kd+=1,Lu===null&&(Lu=[]),a=Hh(Lu,a,l),l=Mn,(Gn===null?l.memoizedState:Gn.next)===null&&(l=l.alternate,X.H=l===null||l.memoizedState===null?ux:j0),a}function Ol(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Zd(a);if(a.$$typeof===I)return mn(a)}throw Error(n(438,String(a)))}function C0(a){var l=null,h=Mn.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var m=Mn.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(b){return b.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=Xh(),Mn.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(a),m=0;m<a;m++)h[m]=H;return l.index++,h}function qo(a,l){return typeof l=="function"?l(a):l}function Yh(a){var l=cr();return R0(l,mi,a)}function R0(a,l,h){var m=a.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=h;var b=a.baseQueue,w=m.pending;if(w!==null){if(b!==null){var U=b.next;b.next=w.next,w.next=U}l.baseQueue=b=w,m.pending=null}if(w=a.baseState,b===null)a.memoizedState=w;else{l=b.next;var J=U=null,ye=null,Ve=l,lt=!1;do{var gt=Ve.lane&-536870913;if(gt!==Ve.lane?(Cn&gt)===gt:(zi&gt)===gt){var Xe=Ve.revertLane;if(Xe===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),gt===Wo&&(lt=!0);else if((zi&Xe)===Xe){Ve=Ve.next,Xe===Wo&&(lt=!0);continue}else gt={lane:0,revertLane:Ve.revertLane,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},ye===null?(J=ye=gt,U=w):ye=ye.next=gt,Mn.lanes|=Xe,bo|=Xe;gt=Ve.action,Ec&&h(w,gt),w=Ve.hasEagerState?Ve.eagerState:h(w,gt)}else Xe={lane:gt,revertLane:Ve.revertLane,gesture:Ve.gesture,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},ye===null?(J=ye=Xe,U=w):ye=ye.next=Xe,Mn.lanes|=gt,bo|=gt;Ve=Ve.next}while(Ve!==null&&Ve!==l);if(ye===null?U=w:ye.next=J,!ms(w,a.memoizedState)&&(yr=!0,lt&&(h=Sa,h!==null)))throw h;a.memoizedState=w,a.baseState=U,a.baseQueue=ye,m.lastRenderedState=w}return b===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function D0(a){var l=cr(),h=l.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=a;var m=h.dispatch,b=h.pending,w=l.memoizedState;if(b!==null){h.pending=null;var U=b=b.next;do w=a(w,U.action),U=U.next;while(U!==b);ms(w,l.memoizedState)||(yr=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),h.lastRenderedState=w}return[w,m]}function O1(a,l,h){var m=Mn,b=cr(),w=Wn;if(w){if(h===void 0)throw Error(n(407));h=h()}else h=l();var U=!ms((mi||b).memoizedState,h);if(U&&(b.memoizedState=h,yr=!0),b=b.queue,F0(U1.bind(null,m,b,a),[a]),b.getSnapshot!==l||U||Gn!==null&&Gn.memoizedState.tag&1){if(m.flags|=2048,Ll(9,{destroy:void 0},P1.bind(null,m,b,h,l),null),xn===null)throw Error(n(349));w||(zi&127)!==0||L1(m,l,h)}return h}function L1(a,l,h){a.flags|=16384,a={getSnapshot:l,value:h},l=Mn.updateQueue,l===null?(l=Xh(),Mn.updateQueue=l,l.stores=[a]):(h=l.stores,h===null?l.stores=[a]:h.push(a))}function P1(a,l,h,m){l.value=h,l.getSnapshot=m,F1(l)&&z1(a)}function U1(a,l,h){return h(function(){F1(l)&&z1(a)})}function F1(a){var l=a.getSnapshot;a=a.value;try{var h=l();return!ms(a,h)}catch{return!0}}function z1(a){var l=gs(a,2);l!==null&&In(l,a,2)}function I0(a){var l=Mr();if(typeof a=="function"){var h=a;if(a=h(),Ec){Bt(!0);try{h()}finally{Bt(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:a},l}function B0(a,l,h,m){return a.baseState=h,R0(a,mi,typeof m=="function"?m:qo)}function SS(a,l,h,m,b){if(Kh(a))throw Error(n(485));if(a=l.action,a!==null){var w={payload:b,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){w.listeners.push(U)}};X.T!==null?h(!0):w.isTransition=!1,m(w),h=l.pending,h===null?(w.next=l.pending=w,H1(l,w)):(w.next=h.next,l.pending=h.next=w)}}function H1(a,l){var h=l.action,m=l.payload,b=a.state;if(l.isTransition){var w=X.T,U={};X.T=U;try{var J=h(b,m),ye=X.S;ye!==null&&ye(U,J),G1(a,l,J)}catch(Ve){N0(a,l,Ve)}finally{w!==null&&U.types!==null&&(w.types=U.types),X.T=w}}else try{w=h(b,m),G1(a,l,w)}catch(Ve){N0(a,l,Ve)}}function G1(a,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(m){k1(a,l,m)},function(m){return N0(a,l,m)}):k1(a,l,h)}function k1(a,l,h){l.status="fulfilled",l.value=h,V1(l),a.state=h,l=a.pending,l!==null&&(h=l.next,h===l?a.pending=null:(h=h.next,l.next=h,H1(a,h)))}function N0(a,l,h){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=h,V1(l),l=l.next;while(l!==m)}a.action=null}function V1(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function O0(a,l){return l}function L0(a,l){if(Wn){var h=xn.formState;if(h!==null){e:{var m=Mn;if(Wn){if(Ci){t:{for(var b=Ci,w=Ys;b.nodeType!==8;){if(!w){b=null;break t}if(b=To(b.nextSibling),b===null){b=null;break t}}w=b.data,b=w==="F!"||w==="F"?b:null}if(b){Ci=To(b.nextSibling),m=b.data==="F!";break e}}uo(m)}m=!1}m&&(l=h[0])}}return h=Mr(),h.memoizedState=h.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:O0,lastRenderedState:l},h.queue=m,h=ox.bind(null,Mn,m),m.dispatch=h,m=I0(!1),w=V0.bind(null,Mn,!1,m.queue),m=Mr(),b={state:l,dispatch:null,action:a,pending:null},m.queue=b,h=SS.bind(null,Mn,b,w,h),b.dispatch=h,m.memoizedState=a,[l,h,!1]}function j1(a){var l=cr();return P0(l,mi,a)}function P0(a,l,h){if(l=R0(a,l,O0)[0],a=Yh(qo)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var m=Zd(l)}catch(U){throw U===xc?Rn:U}else m=l;l=cr();var b=l.queue,w=b.dispatch;return h!==l.memoizedState&&(Mn.flags|=2048,Ll(9,{destroy:void 0},W1.bind(null,b,h),null)),[m,w,a]}function W1(a,l){a.action=l}function U0(a){var l=cr(),h=mi;if(h!==null)return P0(l,h,a);cr(),l=l.memoizedState,h=cr();var m=h.queue.dispatch;return h.memoizedState=a,[l,m,!1]}function Ll(a,l,h,m){return a={tag:a,create:h,deps:m,inst:l,next:null},l=Mn.updateQueue,l===null&&(l=Xh(),Mn.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=a.next=a:(m=h.next,h.next=a,a.next=m,l.lastEffect=a),a}function Qh(){return cr().memoizedState}function qh(a,l,h,m){var b=Mr();Mn.flags|=a,b.memoizedState=Ll(1|l,{destroy:void 0},h,m===void 0?null:m)}function Jh(a,l,h,m){var b=cr();m=m===void 0?null:m;var w=b.memoizedState.inst;mi!==null&&m!==null&&E0(m,mi.memoizedState.deps)?b.memoizedState=Ll(l,w,h,m):(Mn.flags|=a,b.memoizedState=Ll(1|l,w,h,m))}function X1(a,l){qh(8390656,8,a,l)}function F0(a,l){Jh(2048,8,a,l)}function Y1(a){Mn.flags|=4;var l=Mn.updateQueue;if(l===null)l=Xh(),Mn.updateQueue=l,l.events=[a];else{var h=l.events;h===null?l.events=[a]:h.push(a)}}function Q1(a){var l=cr().memoizedState;return Y1({ref:l,nextImpl:a}),function(){if((tn&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function q1(a,l){return Jh(4,2,a,l)}function J1(a,l){return Jh(4,4,a,l)}function K1(a,l){if(typeof l=="function"){a=a();var h=l(a);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Z1(a,l,h){h=h!=null?h.concat([a]):null,Jh(4,4,K1.bind(null,l,a),h)}function z0(){}function $1(a,l){var h=cr();l=l===void 0?null:l;var m=h.memoizedState;return l!==null&&E0(l,m[1])?m[0]:(h.memoizedState=[a,l],a)}function ex(a,l){var h=cr();l=l===void 0?null:l;var m=h.memoizedState;if(l!==null&&E0(l,m[1]))return m[0];if(m=a(),Ec){Bt(!0);try{a()}finally{Bt(!1)}}return h.memoizedState=[m,l],m}function H0(a,l,h){return h===void 0||(zi&1073741824)!==0&&(Cn&261930)===0?a.memoizedState=l:(a.memoizedState=h,a=Un(),Mn.lanes|=a,bo|=a,h)}function tx(a,l,h,m){return ms(h,l)?h:Nu.current!==null?(a=H0(a,h,m),ms(a,l)||(yr=!0),a):(zi&42)===0||(zi&1073741824)!==0&&(Cn&261930)===0?(yr=!0,a.memoizedState=h):(a=Un(),Mn.lanes|=a,bo|=a,l)}function nx(a,l,h,m,b){var w=re.p;re.p=w!==0&&8>w?w:8;var U=X.T,J={};X.T=J,V0(a,!1,l,h);try{var ye=b(),Ve=X.S;if(Ve!==null&&Ve(J,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var lt=v0(ye,m);$d(a,l,lt,ea(a))}else $d(a,l,m,ea(a))}catch(gt){$d(a,l,{then:function(){},status:"rejected",reason:gt},ea())}finally{re.p=w,U!==null&&J.types!==null&&(U.types=J.types),X.T=U}}function bS(){}function G0(a,l,h,m){if(a.tag!==5)throw Error(n(476));var b=ix(a).queue;nx(a,b,l,ge,h===null?bS:function(){return rx(a),h(m)})}function ix(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:ge},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qo,lastRenderedState:h},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function rx(a){var l=ix(a);l.next===null&&(l=a.alternate.memoizedState),$d(a,l.next.queue,{},ea())}function k0(){return mn(ug)}function sx(){return cr().memoizedState}function ax(){return cr().memoizedState}function ES(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var h=ea();a=Yo(h);var m=Bl(l,a,h);m!==null&&(In(m,l,h),Nl(m,l,h)),l={cache:p0()},a.payload=l;return}l=l.return}}function MS(a,l,h){var m=ea();h={lane:m,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Kh(a)?lx(l,h):(h=Ch(a,l,h,m),h!==null&&(In(h,a,m),cx(h,l,m)))}function ox(a,l,h){var m=ea();$d(a,l,h,m)}function $d(a,l,h,m){var b={lane:m,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Kh(a))lx(l,b);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var U=l.lastRenderedState,J=w(U,h);if(b.hasEagerState=!0,b.eagerState=J,ms(J,U))return Pr(a,l,b,0),xn===null&&kd(),!1}catch{}finally{}if(h=Ch(a,l,b,m),h!==null)return In(h,a,m),cx(h,l,m),!0}return!1}function V0(a,l,h,m){if(m={lane:2,revertLane:$e(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Kh(a)){if(l)throw Error(n(479))}else l=Ch(a,h,m,2),l!==null&&In(l,a,2)}function Kh(a){var l=a.alternate;return a===Mn||l!==null&&l===Mn}function lx(a,l){Ou=Ea=!0;var h=a.pending;h===null?l.next=l:(l.next=h.next,h.next=l),a.pending=l}function cx(a,l,h){if((h&4194048)!==0){var m=l.lanes;m&=a.pendingLanes,h|=m,l.lanes=h,pa(a,h)}}var Pu={readContext:mn,use:Ol,useCallback:Yi,useContext:Yi,useEffect:Yi,useImperativeHandle:Yi,useLayoutEffect:Yi,useInsertionEffect:Yi,useMemo:Yi,useReducer:Yi,useRef:Yi,useState:Yi,useDebugValue:Yi,useDeferredValue:Yi,useTransition:Yi,useSyncExternalStore:Yi,useId:Yi,useHostTransitionStatus:Yi,useFormState:Yi,useActionState:Yi,useOptimistic:Yi,useMemoCache:Yi,useCacheRefresh:Yi};Pu.useEffectEvent=Yi;var ux={readContext:mn,use:Ol,useCallback:function(a,l){return Mr().memoizedState=[a,l===void 0?null:l],a},useContext:mn,useEffect:X1,useImperativeHandle:function(a,l,h){h=h!=null?h.concat([a]):null,qh(4194308,4,K1.bind(null,l,a),h)},useLayoutEffect:function(a,l){return qh(4194308,4,a,l)},useInsertionEffect:function(a,l){qh(4,2,a,l)},useMemo:function(a,l){var h=Mr();l=l===void 0?null:l;var m=a();if(Ec){Bt(!0);try{a()}finally{Bt(!1)}}return h.memoizedState=[m,l],m},useReducer:function(a,l,h){var m=Mr();if(h!==void 0){var b=h(l);if(Ec){Bt(!0);try{h(l)}finally{Bt(!1)}}}else b=l;return m.memoizedState=m.baseState=b,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b},m.queue=a,a=a.dispatch=MS.bind(null,Mn,a),[m.memoizedState,a]},useRef:function(a){var l=Mr();return a={current:a},l.memoizedState=a},useState:function(a){a=I0(a);var l=a.queue,h=ox.bind(null,Mn,l);return l.dispatch=h,[a.memoizedState,h]},useDebugValue:z0,useDeferredValue:function(a,l){var h=Mr();return H0(h,a,l)},useTransition:function(){var a=I0(!1);return a=nx.bind(null,Mn,a.queue,!0,!1),Mr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,h){var m=Mn,b=Mr();if(Wn){if(h===void 0)throw Error(n(407));h=h()}else{if(h=l(),xn===null)throw Error(n(349));(Cn&127)!==0||L1(m,l,h)}b.memoizedState=h;var w={value:h,getSnapshot:l};return b.queue=w,X1(U1.bind(null,m,w,a),[a]),m.flags|=2048,Ll(9,{destroy:void 0},P1.bind(null,m,w,h,l),null),h},useId:function(){var a=Mr(),l=xn.identifierPrefix;if(Wn){var h=ka,m=Xi;h=(m&~(1<<32-he(m)-1)).toString(32)+h,l="_"+l+"R_"+h,h=jh++,0<h&&(l+="H"+h.toString(32)),l+="_"}else h=b0++,l="_"+l+"r_"+h.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:k0,useFormState:L0,useActionState:L0,useOptimistic:function(a){var l=Mr();l.memoizedState=l.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=V0.bind(null,Mn,!0,h),h.dispatch=l,[a,l]},useMemoCache:C0,useCacheRefresh:function(){return Mr().memoizedState=ES.bind(null,Mn)},useEffectEvent:function(a){var l=Mr(),h={impl:a};return l.memoizedState=h,function(){if((tn&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}},j0={readContext:mn,use:Ol,useCallback:$1,useContext:mn,useEffect:F0,useImperativeHandle:Z1,useInsertionEffect:q1,useLayoutEffect:J1,useMemo:ex,useReducer:Yh,useRef:Qh,useState:function(){return Yh(qo)},useDebugValue:z0,useDeferredValue:function(a,l){var h=cr();return tx(h,mi.memoizedState,a,l)},useTransition:function(){var a=Yh(qo)[0],l=cr().memoizedState;return[typeof a=="boolean"?a:Zd(a),l]},useSyncExternalStore:O1,useId:sx,useHostTransitionStatus:k0,useFormState:j1,useActionState:j1,useOptimistic:function(a,l){var h=cr();return B0(h,mi,a,l)},useMemoCache:C0,useCacheRefresh:ax};j0.useEffectEvent=Q1;var Ma={readContext:mn,use:Ol,useCallback:$1,useContext:mn,useEffect:F0,useImperativeHandle:Z1,useInsertionEffect:q1,useLayoutEffect:J1,useMemo:ex,useReducer:D0,useRef:Qh,useState:function(){return D0(qo)},useDebugValue:z0,useDeferredValue:function(a,l){var h=cr();return mi===null?H0(h,a,l):tx(h,mi.memoizedState,a,l)},useTransition:function(){var a=D0(qo)[0],l=cr().memoizedState;return[typeof a=="boolean"?a:Zd(a),l]},useSyncExternalStore:O1,useId:sx,useHostTransitionStatus:k0,useFormState:U0,useActionState:U0,useOptimistic:function(a,l){var h=cr();return mi!==null?B0(h,mi,a,l):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:C0,useCacheRefresh:ax};Ma.useEffectEvent=Q1;function Zh(a,l,h,m){l=a.memoizedState,h=h(m,l),h=h==null?l:v({},l,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var ef={enqueueSetState:function(a,l,h){a=a._reactInternals;var m=ea(),b=Yo(m);b.payload=l,h!=null&&(b.callback=h),l=Bl(a,b,m),l!==null&&(In(l,a,m),Nl(l,a,m))},enqueueReplaceState:function(a,l,h){a=a._reactInternals;var m=ea(),b=Yo(m);b.tag=1,b.payload=l,h!=null&&(b.callback=h),l=Bl(a,b,m),l!==null&&(In(l,a,m),Nl(l,a,m))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var h=ea(),m=Yo(h);m.tag=2,l!=null&&(m.callback=l),l=Bl(a,m,h),l!==null&&(In(l,a,h),Nl(l,a,h))}};function W0(a,l,h,m,b,w,U){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,U):l.prototype&&l.prototype.isPureReactComponent?!xu(h,m)||!xu(b,w):!0}function X0(a,l,h,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,m),l.state!==a&&ef.enqueueReplaceState(l,l.state,null)}function Pl(a,l){var h=l;if("ref"in l){h={};for(var m in l)m!=="ref"&&(h[m]=l[m])}if(a=a.defaultProps){h===l&&(h=v({},h));for(var b in a)h[b]===void 0&&(h[b]=a[b])}return h}function dx(a){Gd(a)}function Y0(a){console.error(a)}function Q0(a){Gd(a)}function $h(a,l){try{var h=a.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function fx(a,l,h){try{var m=a.onCaughtError;m(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function q0(a,l,h){return h=Yo(h),h.tag=3,h.payload={element:null},h.callback=function(){$h(a,l)},h}function J0(a){return a=Yo(a),a.tag=3,a}function hx(a,l,h,m){var b=h.type.getDerivedStateFromError;if(typeof b=="function"){var w=m.value;a.payload=function(){return b(w)},a.callback=function(){fx(l,h,m)}}var U=h.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(a.callback=function(){fx(l,h,m),typeof b!="function"&&(fr===null?fr=new Set([this]):fr.add(this));var J=m.stack;this.componentDidCatch(m.value,{componentStack:J!==null?J:""})})}function Tr(a,l,h,m,b){if(h.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=h.alternate,l!==null&&mo(l,h,b,!0),h=Ds.current,h!==null){switch(h.tag){case 31:case 13:return xs===null?Vu():h.alternate===null&&Qi===0&&(Qi=3),h.flags&=-257,h.flags|=65536,h.lanes=b,m===zh?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([m]):l.add(m),hf(a,m,b)),!1;case 22:return h.flags|=65536,m===zh?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([m]):h.add(m)),hf(a,m,b)),!1}throw Error(n(435,h.tag))}return hf(a,m,b),Vu(),!1}if(Wn)return l=Ds.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=b,m!==Tu&&(a=Error(n(422),{cause:m}),fo(Xs(a,h)))):(m!==Tu&&(l=Error(n(423),{cause:m}),fo(Xs(l,h))),a=a.current.alternate,a.flags|=65536,b&=-b,a.lanes|=b,m=Xs(m,h),b=q0(a.stateNode,m,b),sn(a,b),Qi!==4&&(Qi=2)),!1;var w=Error(n(520),{cause:m});if(w=Xs(w,h),Oc===null?Oc=[w]:Oc.push(w),Qi!==4&&(Qi=2),l===null)return!0;m=Xs(m,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,a=b&-b,h.lanes|=a,a=q0(h.stateNode,m,a),sn(h,a),!1;case 1:if(l=h.type,w=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(fr===null||!fr.has(w))))return h.flags|=65536,b&=-b,h.lanes|=b,b=J0(b),hx(b,a,h,m),sn(h,b),!1}h=h.return}while(h!==null);return!1}var ep=Error(n(461)),yr=!1;function Ur(a,l,h,m){l.child=a===null?kh(l,null,h,m):Xo(l,a.child,h,m)}function K0(a,l,h,m,b){h=h.render;var w=l.ref;if("ref"in m){var U={};for(var J in m)J!=="ref"&&(U[J]=m[J])}else U=m;return Dl(l),m=Wh(a,l,h,U,w,b),J=M0(),a!==null&&!yr?(T0(a,l,b),ur(a,l,b)):(Wn&&J&&co(l),l.flags|=1,Ur(a,l,m,b),l.child)}function wc(a,l,h,m,b){if(a===null){var w=h.type;return typeof w=="function"&&!Rh(w)&&w.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=w,tp(a,l,w,m,b)):(a=oo(h.type,null,m,l,l.mode,b),a.ref=l.ref,a.return=l,l.child=a)}if(w=a.child,!op(a,b)){var U=w.memoizedProps;if(h=h.compare,h=h!==null?h:xu,h(U,m)&&a.ref===l.ref)return ur(a,l,b)}return l.flags|=1,a=ws(w,m),a.ref=l.ref,a.return=l,l.child=a}function tp(a,l,h,m,b){if(a!==null){var w=a.memoizedProps;if(xu(w,m)&&a.ref===l.ref)if(yr=!1,l.pendingProps=m=w,op(a,b))(a.flags&131072)!==0&&(yr=!0);else return l.lanes=a.lanes,ur(a,l,b)}return Uu(a,l,h,m,b)}function Cc(a,l,h,m){var b=m.children,w=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((l.flags&128)!==0){if(w=w!==null?w.baseLanes|h:h,a!==null){for(m=l.child=a.child,b=0;m!==null;)b=b|m.lanes|m.childLanes,m=m.sibling;m=b&~w}else m=0,l.child=null;return Bs(a,l,w,h,m)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&Wd(l,w!==null?w.cachePool:null),w!==null?I1(l,w):_0(),B1(l);else return m=l.lanes=536870912,Bs(a,l,w!==null?w.baseLanes|h:h,h,m)}else w!==null?(Wd(l,w.cachePool),I1(l,w),Is(),l.memoizedState=null):(a!==null&&Wd(l,null),_0(),Is());return Ur(a,l,b,h),l.child}function vo(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function Bs(a,l,h,m,b){var w=Fh();return w=w===null?null:{parent:xr._currentValue,pool:w},l.memoizedState={baseLanes:h,cachePool:w},a!==null&&Wd(l,null),_0(),B1(l),a!==null&&mo(a,l,m,!0),l.childLanes=b,null}function np(a,l){return l=ap({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function px(a,l,h){return Xo(l,a.child,null,h),a=np(l,l.pendingProps),a.flags|=2,lr(l),l.memoizedState=null,a}function ip(a,l,h){var m=l.pendingProps,b=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(Wn){if(m.mode==="hidden")return a=np(l,m),l.lanes=536870912,vo(null,a);if(S0(l),(a=Ci)?(a=yw(a,Ys),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:ko!==null?{id:Xi,overflow:ka}:null,retryLane:536870912,hydrationErrors:null},h=bu(a),h.return=l,l.child=h,tr=l,Ci=null)):a=null,a===null)throw uo(l);return l.lanes=536870912,null}return np(l,m)}var w=a.memoizedState;if(w!==null){var U=w.dehydrated;if(S0(l),b)if(l.flags&256)l.flags&=-257,l=px(a,l,h);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(n(558));else if(yr||mo(a,l,h,!1),b=(h&a.childLanes)!==0,yr||b){if(m=xn,m!==null&&(U=Ts(m,h),U!==0&&U!==w.retryLane))throw w.retryLane=U,gs(a,U),In(m,a,U),ep;Vu(),l=px(a,l,h)}else a=w.treeContext,Ci=To(U.nextSibling),tr=l,Wn=!0,Vo=null,Ys=!1,a!==null&&Nh(l,a),l=np(l,m),l.flags|=4096;return l}return a=ws(a.child,{mode:m.mode,children:m.children}),a.ref=l.ref,l.child=a,a.return=l,a}function Rc(a,l){var h=l.ref;if(h===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(a===null||a.ref!==h)&&(l.flags|=4194816)}}function Uu(a,l,h,m,b){return Dl(l),h=Wh(a,l,h,m,void 0,b),m=M0(),a!==null&&!yr?(T0(a,l,b),ur(a,l,b)):(Wn&&m&&co(l),l.flags|=1,Ur(a,l,h,b),l.child)}function tf(a,l,h,m,b,w){return Dl(l),l.updateQueue=null,h=Mc(l,m,h,b),N1(a),m=M0(),a!==null&&!yr?(T0(a,l,w),ur(a,l,w)):(Wn&&m&&co(l),l.flags|=1,Ur(a,l,h,w),l.child)}function rp(a,l,h,m,b){if(Dl(l),l.stateNode===null){var w=El,U=h.contextType;typeof U=="object"&&U!==null&&(w=mn(U)),w=new h(m,w),l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=ef,l.stateNode=w,w._reactInternals=l,w=l.stateNode,w.props=m,w.state=l.memoizedState,w.refs={},Qd(l),U=h.contextType,w.context=typeof U=="object"&&U!==null?mn(U):El,w.state=l.memoizedState,U=h.getDerivedStateFromProps,typeof U=="function"&&(Zh(l,h,U,m),w.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(U=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),U!==w.state&&ef.enqueueReplaceState(w,w.state,null),Iu(l,m,w,b),qd(),w.state=l.memoizedState),typeof w.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(a===null){w=l.stateNode;var J=l.memoizedProps,ye=Pl(h,J);w.props=ye;var Ve=w.context,lt=h.contextType;U=El,typeof lt=="object"&&lt!==null&&(U=mn(lt));var gt=h.getDerivedStateFromProps;lt=typeof gt=="function"||typeof w.getSnapshotBeforeUpdate=="function",J=l.pendingProps!==J,lt||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(J||Ve!==U)&&X0(l,w,m,U),vs=!1;var Xe=l.memoizedState;w.state=Xe,Iu(l,m,w,b),qd(),Ve=l.memoizedState,J||Xe!==Ve||vs?(typeof gt=="function"&&(Zh(l,h,gt,m),Ve=l.memoizedState),(ye=vs||W0(l,h,ye,m,Xe,Ve,U))?(lt||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(l.flags|=4194308)):(typeof w.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=Ve),w.props=m,w.state=Ve,w.context=U,m=ye):(typeof w.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{w=l.stateNode,y0(a,l),U=l.memoizedProps,lt=Pl(h,U),w.props=lt,gt=l.pendingProps,Xe=w.context,Ve=h.contextType,ye=El,typeof Ve=="object"&&Ve!==null&&(ye=mn(Ve)),J=h.getDerivedStateFromProps,(Ve=typeof J=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(U!==gt||Xe!==ye)&&X0(l,w,m,ye),vs=!1,Xe=l.memoizedState,w.state=Xe,Iu(l,m,w,b),qd();var rt=l.memoizedState;U!==gt||Xe!==rt||vs||a!==null&&a.dependencies!==null&&jd(a.dependencies)?(typeof J=="function"&&(Zh(l,h,J,m),rt=l.memoizedState),(lt=vs||W0(l,h,lt,m,Xe,rt,ye)||a!==null&&a.dependencies!==null&&jd(a.dependencies))?(Ve||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(m,rt,ye),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(m,rt,ye)),typeof w.componentDidUpdate=="function"&&(l.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof w.componentDidUpdate!="function"||U===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=rt),w.props=m,w.state=rt,w.context=ye,m=lt):(typeof w.componentDidUpdate!="function"||U===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=1024),m=!1)}return w=m,Rc(a,l),m=(l.flags&128)!==0,w||m?(w=l.stateNode,h=m&&typeof h.getDerivedStateFromError!="function"?null:w.render(),l.flags|=1,a!==null&&m?(l.child=Xo(l,a.child,null,b),l.child=Xo(l,null,h,b)):Ur(a,l,h,b),l.memoizedState=w.state,a=l.child):a=ur(a,l,b),a}function mx(a,l,h,m){return Cl(),l.flags|=256,Ur(a,l,h,m),l.child}var Z0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ss(a){return{baseLanes:a,cachePool:x0()}}function sp(a,l,h){return a=a!==null?a.childLanes&~h:0,l&&(a|=_s),a}function gx(a,l,h){var m=l.pendingProps,b=!1,w=(l.flags&128)!==0,U;if((U=w)||(U=a!==null&&a.memoizedState===null?!1:(Xn.current&2)!==0),U&&(b=!0,l.flags&=-129),U=(l.flags&32)!==0,l.flags&=-33,a===null){if(Wn){if(b?Qo(l):Is(),(a=Ci)?(a=yw(a,Ys),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:ko!==null?{id:Xi,overflow:ka}:null,retryLane:536870912,hydrationErrors:null},h=bu(a),h.return=l,l.child=h,tr=l,Ci=null)):a=null,a===null)throw uo(l);return zS(a)?l.lanes=32:l.lanes=536870912,null}var J=m.children;return m=m.fallback,b?(Is(),b=l.mode,J=ap({mode:"hidden",children:J},b),m=Ml(m,b,h,null),J.return=l,m.return=l,J.sibling=m,l.child=J,m=l.child,m.memoizedState=ss(h),m.childLanes=sp(a,U,h),l.memoizedState=Z0,vo(null,m)):(Qo(l),nf(l,J))}var ye=a.memoizedState;if(ye!==null&&(J=ye.dehydrated,J!==null)){if(w)l.flags&256?(Qo(l),l.flags&=-257,l=$0(a,l,h)):l.memoizedState!==null?(Is(),l.child=a.child,l.flags|=128,l=null):(Is(),J=m.fallback,b=l.mode,m=ap({mode:"visible",children:m.children},b),J=Ml(J,b,h,null),J.flags|=2,m.return=l,J.return=l,m.sibling=J,l.child=m,Xo(l,a.child,null,h),m=l.child,m.memoizedState=ss(h),m.childLanes=sp(a,U,h),l.memoizedState=Z0,l=vo(null,m));else if(Qo(l),zS(J)){if(U=J.nextSibling&&J.nextSibling.dataset,U)var Ve=U.dgst;U=Ve,m=Error(n(419)),m.stack="",m.digest=U,fo({value:m,source:null,stack:null}),l=$0(a,l,h)}else if(yr||mo(a,l,h,!1),U=(h&a.childLanes)!==0,yr||U){if(U=xn,U!==null&&(m=Ts(U,h),m!==0&&m!==ye.retryLane))throw ye.retryLane=m,gs(a,m),In(U,a,m),ep;FS(J)||Vu(),l=$0(a,l,h)}else FS(J)?(l.flags|=192,l.child=a.child,l=null):(a=ye.treeContext,Ci=To(J.nextSibling),tr=l,Wn=!0,Vo=null,Ys=!1,a!==null&&Nh(l,a),l=nf(l,m.children),l.flags|=4096);return l}return b?(Is(),J=m.fallback,b=l.mode,ye=a.child,Ve=ye.sibling,m=ws(ye,{mode:"hidden",children:m.children}),m.subtreeFlags=ye.subtreeFlags&65011712,Ve!==null?J=ws(Ve,J):(J=Ml(J,b,h,null),J.flags|=2),J.return=l,m.return=l,m.sibling=J,l.child=m,vo(null,m),m=l.child,J=a.child.memoizedState,J===null?J=ss(h):(b=J.cachePool,b!==null?(ye=xr._currentValue,b=b.parent!==ye?{parent:ye,pool:ye}:b):b=x0(),J={baseLanes:J.baseLanes|h,cachePool:b}),m.memoizedState=J,m.childLanes=sp(a,U,h),l.memoizedState=Z0,vo(a.child,m)):(Qo(l),h=a.child,a=h.sibling,h=ws(h,{mode:"visible",children:m.children}),h.return=l,h.sibling=null,a!==null&&(U=l.deletions,U===null?(l.deletions=[a],l.flags|=16):U.push(a)),l.child=h,l.memoizedState=null,h)}function nf(a,l){return l=ap({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function ap(a,l){return a=Wi(22,a,null,l),a.lanes=0,a}function $0(a,l,h){return Xo(l,a.child,null,h),a=nf(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function vx(a,l,h){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),Lh(a.return,l,h)}function Dc(a,l,h,m,b,w){var U=a.memoizedState;U===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:b,treeForkCount:w}:(U.isBackwards=l,U.rendering=null,U.renderingStartTime=0,U.last=m,U.tail=h,U.tailMode=b,U.treeForkCount=w)}function Ns(a,l,h){var m=l.pendingProps,b=m.revealOrder,w=m.tail;m=m.children;var U=Xn.current,J=(U&2)!==0;if(J?(U=U&1|2,l.flags|=128):U&=1,Ce(Xn,U),Ur(a,l,m,h),m=Wn?Mu:0,!J&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&vx(a,h,l);else if(a.tag===19)vx(a,h,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(b){case"forwards":for(h=l.child,b=null;h!==null;)a=h.alternate,a!==null&&qs(a)===null&&(b=h),h=h.sibling;h=b,h===null?(b=l.child,l.child=null):(b=h.sibling,h.sibling=null),Dc(l,!1,b,h,w,m);break;case"backwards":case"unstable_legacy-backwards":for(h=null,b=l.child,l.child=null;b!==null;){if(a=b.alternate,a!==null&&qs(a)===null){l.child=b;break}a=b.sibling,b.sibling=h,h=b,b=a}Dc(l,!0,h,null,w,m);break;case"together":Dc(l,!1,null,null,void 0,m);break;default:l.memoizedState=null}return l.child}function ur(a,l,h){if(a!==null&&(l.dependencies=a.dependencies),bo|=l.lanes,(h&l.childLanes)===0)if(a!==null){if(mo(a,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,h=ws(a,a.pendingProps),l.child=h,h.return=l;a.sibling!==null;)a=a.sibling,h=h.sibling=ws(a,a.pendingProps),h.return=l;h.sibling=null}return l.child}function op(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&jd(a)))}function TS(a,l,h){switch(l.tag){case 3:dt(l,l.stateNode.containerInfo),jo(l,xr,a.memoizedState.cache),Cl();break;case 27:case 5:yt(l);break;case 4:dt(l,l.stateNode.containerInfo);break;case 10:jo(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,S0(l),null;break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(Qo(l),l.flags|=128,null):(h&l.child.childLanes)!==0?gx(a,l,h):(Qo(l),a=ur(a,l,h),a!==null?a.sibling:null);Qo(l);break;case 19:var b=(a.flags&128)!==0;if(m=(h&l.childLanes)!==0,m||(mo(a,l,h,!1),m=(h&l.childLanes)!==0),b){if(m)return Ns(a,l,h);l.flags|=128}if(b=l.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Ce(Xn,Xn.current),m)break;return null;case 22:return l.lanes=0,Cc(a,l,h,l.pendingProps);case 24:jo(l,xr,a.memoizedState.cache)}return ur(a,l,h)}function lp(a,l,h){if(a!==null)if(a.memoizedProps!==l.pendingProps)yr=!0;else{if(!op(a,h)&&(l.flags&128)===0)return yr=!1,TS(a,l,h);yr=(a.flags&131072)!==0}else yr=!1,Wn&&(l.flags&1048576)!==0&&E1(l,Mu,l.index);switch(l.lanes=0,l.tag){case 16:e:{var m=l.pendingProps;if(a=yc(l.elementType),l.type=a,typeof a=="function")Rh(a)?(m=Pl(a,m),l.tag=1,l=rp(null,l,a,m,h)):(l.tag=0,l=Uu(null,l,a,m,h));else{if(a!=null){var b=a.$$typeof;if(b===O){l.tag=11,l=K0(null,l,a,m,h);break e}else if(b===j){l.tag=14,l=wc(null,l,a,m,h);break e}}throw l=ne(a)||a,Error(n(306,l,""))}}return l;case 0:return Uu(a,l,l.type,l.pendingProps,h);case 1:return m=l.type,b=Pl(m,l.pendingProps),rp(a,l,m,b,h);case 3:e:{if(dt(l,l.stateNode.containerInfo),a===null)throw Error(n(387));m=l.pendingProps;var w=l.memoizedState;b=w.element,y0(a,l),Iu(l,m,null,h);var U=l.memoizedState;if(m=U.cache,jo(l,xr,m),m!==w.cache&&Ph(l,[xr],h,!0),qd(),m=U.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:U.cache},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){l=mx(a,l,m,h);break e}else if(m!==b){b=Xs(Error(n(424)),l),fo(b),l=mx(a,l,m,h);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ci=To(a.firstChild),tr=l,Wn=!0,Vo=null,Ys=!0,h=kh(l,null,m,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Cl(),m===b){l=ur(a,l,h);break e}Ur(a,l,m,h)}l=l.child}return l;case 26:return Rc(a,l),a===null?(h=Mw(l.type,null,l.pendingProps,null))?l.memoizedState=h:Wn||(h=l.type,a=l.pendingProps,m=_x(ve.current).createElement(h),m[bi]=l,m[V]=a,bs(m,h,a),P(m),l.stateNode=m):l.memoizedState=Mw(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return yt(l),a===null&&Wn&&(m=l.stateNode=Sw(l.type,l.pendingProps,ve.current),tr=l,Ys=!0,b=Ci,Yu(l.type)?(HS=b,Ci=To(m.firstChild)):Ci=b),Ur(a,l,l.pendingProps.children,h),Rc(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&Wn&&((b=m=Ci)&&(m=aB(m,l.type,l.pendingProps,Ys),m!==null?(l.stateNode=m,tr=l,Ci=To(m.firstChild),Ys=!1,b=!0):b=!1),b||uo(l)),yt(l),b=l.type,w=l.pendingProps,U=a!==null?a.memoizedProps:null,m=w.children,LS(b,w)?m=null:U!==null&&LS(b,U)&&(l.flags|=32),l.memoizedState!==null&&(b=Wh(a,l,Tc,null,null,h),ug._currentValue=b),Rc(a,l),Ur(a,l,m,h),l.child;case 6:return a===null&&Wn&&((a=h=Ci)&&(h=oB(h,l.pendingProps,Ys),h!==null?(l.stateNode=h,tr=l,Ci=null,a=!0):a=!1),a||uo(l)),null;case 13:return gx(a,l,h);case 4:return dt(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=Xo(l,null,m,h):Ur(a,l,m,h),l.child;case 11:return K0(a,l,l.type,l.pendingProps,h);case 7:return Ur(a,l,l.pendingProps,h),l.child;case 8:return Ur(a,l,l.pendingProps.children,h),l.child;case 12:return Ur(a,l,l.pendingProps.children,h),l.child;case 10:return m=l.pendingProps,jo(l,l.type,m.value),Ur(a,l,m.children,h),l.child;case 9:return b=l.type._context,m=l.pendingProps.children,Dl(l),b=mn(b),m=m(b),l.flags|=1,Ur(a,l,m,h),l.child;case 14:return wc(a,l,l.type,l.pendingProps,h);case 15:return tp(a,l,l.type,l.pendingProps,h);case 19:return Ns(a,l,h);case 31:return ip(a,l,h);case 22:return Cc(a,l,h,l.pendingProps);case 24:return Dl(l),m=mn(xr),a===null?(b=Fh(),b===null&&(b=xn,w=p0(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=h),b=w),l.memoizedState={parent:m,cache:b},Qd(l),jo(l,xr,b)):((a.lanes&h)!==0&&(y0(a,l),Iu(l,null,null,h),qd()),b=a.memoizedState,w=l.memoizedState,b.parent!==m?(b={parent:m,cache:m},l.memoizedState=b,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=b),jo(l,xr,m)):(m=w.cache,jo(l,xr,m),m!==b.cache&&Ph(l,[xr],h,!0))),Ur(a,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function xo(a){a.flags|=4}function rf(a,l,h,m,b){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(b&335544128)===b)if(a.stateNode.complete)a.flags|=8192;else if(Ji())a.flags|=8192;else throw go=zh,Xd}else a.flags&=-16777217}function eg(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Dw(l))if(Ji())a.flags|=8192;else throw go=zh,Xd}function Jo(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?yn():536870912,a.lanes|=l,Li|=l)}function yo(a,l){if(!Wn)switch(a.tailMode){case"hidden":l=a.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function gi(a){var l=a.alternate!==null&&a.alternate.child===a.child,h=0,m=0;if(l)for(var b=a.child;b!==null;)h|=b.lanes|b.childLanes,m|=b.subtreeFlags&65011712,m|=b.flags&65011712,b.return=a,b=b.sibling;else for(b=a.child;b!==null;)h|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=a,b=b.sibling;return a.subtreeFlags|=m,a.childLanes=h,l}function sf(a,l,h){var m=l.pendingProps;switch(Bh(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gi(l),null;case 1:return gi(l),null;case 3:return h=l.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),po(xr),Ee(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(wu(l)?xo(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Oh())),gi(l),null;case 26:var b=l.type,w=l.memoizedState;return a===null?(xo(l),w!==null?(gi(l),eg(l,w)):(gi(l),rf(l,b,null,m,h))):w?w!==a.memoizedState?(xo(l),gi(l),eg(l,w)):(gi(l),l.flags&=-16777217):(a=a.memoizedProps,a!==m&&xo(l),gi(l),rf(l,b,a,m,h)),null;case 27:if(Pt(l),h=ve.current,b=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&xo(l);else{if(!m){if(l.stateNode===null)throw Error(n(166));return gi(l),null}a=Ze.current,wu(l)?M1(l):(a=Sw(b,m,h),l.stateNode=a,xo(l))}return gi(l),null;case 5:if(Pt(l),b=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&xo(l);else{if(!m){if(l.stateNode===null)throw Error(n(166));return gi(l),null}if(w=Ze.current,wu(l))M1(l);else{var U=_x(ve.current);switch(w){case 1:w=U.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:w=U.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":w=U.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":w=U.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":w=U.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof m.is=="string"?U.createElement("select",{is:m.is}):U.createElement("select"),m.multiple?w.multiple=!0:m.size&&(w.size=m.size);break;default:w=typeof m.is=="string"?U.createElement(b,{is:m.is}):U.createElement(b)}}w[bi]=l,w[V]=m;e:for(U=l.child;U!==null;){if(U.tag===5||U.tag===6)w.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===l)break e;for(;U.sibling===null;){if(U.return===null||U.return===l)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}l.stateNode=w;e:switch(bs(w,b,m),b){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&xo(l)}}return gi(l),rf(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,h),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==m&&xo(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(n(166));if(a=ve.current,wu(l)){if(a=l.stateNode,h=l.memoizedProps,m=null,b=tr,b!==null)switch(b.tag){case 27:case 5:m=b.memoizedProps}a[bi]=l,a=!!(a.nodeValue===h||m!==null&&m.suppressHydrationWarning===!0||dw(a.nodeValue,h)),a||uo(l,!0)}else a=_x(a).createTextNode(m),a[bi]=l,l.stateNode=a}return gi(l),null;case 31:if(h=l.memoizedState,a===null||a.memoizedState!==null){if(m=wu(l),h!==null){if(a===null){if(!m)throw Error(n(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[bi]=l}else Cl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gi(l),a=!1}else h=Oh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return l.flags&256?(lr(l),l):(lr(l),null);if((l.flags&128)!==0)throw Error(n(558))}return gi(l),null;case 13:if(m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(b=wu(l),m!==null&&m.dehydrated!==null){if(a===null){if(!b)throw Error(n(318));if(b=l.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(n(317));b[bi]=l}else Cl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gi(l),b=!1}else b=Oh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=b),b=!0;if(!b)return l.flags&256?(lr(l),l):(lr(l),null)}return lr(l),(l.flags&128)!==0?(l.lanes=h,l):(h=m!==null,a=a!==null&&a.memoizedState!==null,h&&(m=l.child,b=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(b=m.alternate.memoizedState.cachePool.pool),w=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(w=m.memoizedState.cachePool.pool),w!==b&&(m.flags|=2048)),h!==a&&h&&(l.child.flags|=8192),Jo(l,l.updateQueue),gi(l),null);case 4:return Ee(),a===null&&DS(l.stateNode.containerInfo),gi(l),null;case 10:return po(l.type),gi(l),null;case 19:if(me(Xn),m=l.memoizedState,m===null)return gi(l),null;if(b=(l.flags&128)!==0,w=m.rendering,w===null)if(b)yo(m,!1);else{if(Qi!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(w=qs(a),w!==null){for(l.flags|=128,yo(m,!1),a=w.updateQueue,l.updateQueue=a,Jo(l,a),l.subtreeFlags=0,a=h,h=l.child;h!==null;)Su(h,a),h=h.sibling;return Ce(Xn,Xn.current&1|2),Wn&&lo(l,m.treeForkCount),l.child}a=a.sibling}m.tail!==null&&G()>dr&&(l.flags|=128,b=!0,yo(m,!1),l.lanes=4194304)}else{if(!b)if(a=qs(w),a!==null){if(l.flags|=128,b=!0,a=a.updateQueue,l.updateQueue=a,Jo(l,a),yo(m,!0),m.tail===null&&m.tailMode==="hidden"&&!w.alternate&&!Wn)return gi(l),null}else 2*G()-m.renderingStartTime>dr&&h!==536870912&&(l.flags|=128,b=!0,yo(m,!1),l.lanes=4194304);m.isBackwards?(w.sibling=l.child,l.child=w):(a=m.last,a!==null?a.sibling=w:l.child=w,m.last=w)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=G(),a.sibling=null,h=Xn.current,Ce(Xn,b?h&1|2:h&1),Wn&&lo(l,m.treeForkCount),a):(gi(l),null);case 22:case 23:return lr(l),Jd(),m=l.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?(h&536870912)!==0&&(l.flags&128)===0&&(gi(l),l.subtreeFlags&6&&(l.flags|=8192)):gi(l),h=l.updateQueue,h!==null&&Jo(l,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==h&&(l.flags|=2048),a!==null&&me(Il),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),po(xr),gi(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function Ta(a,l){switch(Bh(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return po(xr),Ee(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return Pt(l),null;case 31:if(l.memoizedState!==null){if(lr(l),l.alternate===null)throw Error(n(340));Cl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(lr(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));Cl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return me(Xn),null;case 4:return Ee(),null;case 10:return po(l.type),null;case 22:case 23:return lr(l),Jd(),a!==null&&me(Il),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return po(xr),null;case 25:return null;default:return null}}function Js(a,l){switch(Bh(l),l.tag){case 3:po(xr),Ee();break;case 26:case 27:case 5:Pt(l);break;case 4:Ee();break;case 31:l.memoizedState!==null&&lr(l);break;case 13:lr(l);break;case 19:me(Xn);break;case 10:po(l.type);break;case 22:case 23:lr(l),Jd(),a!==null&&me(Il);break;case 24:po(xr)}}function wa(a,l){try{var h=l.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var b=m.next;h=b;do{if((h.tag&a)===a){m=void 0;var w=h.create,U=h.inst;m=w(),U.destroy=m}h=h.next}while(h!==b)}}catch(J){ei(l,l.return,J)}}function Qr(a,l,h){try{var m=l.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var w=b.next;m=w;do{if((m.tag&a)===a){var U=m.inst,J=U.destroy;if(J!==void 0){U.destroy=void 0,b=l;var ye=h,Ve=J;try{Ve()}catch(lt){ei(b,ye,lt)}}}m=m.next}while(m!==w)}}catch(lt){ei(l,l.return,lt)}}function Va(a){var l=a.updateQueue;if(l!==null){var h=a.stateNode;try{D1(l,h)}catch(m){ei(a,a.return,m)}}}function Fr(a,l,h){h.props=Pl(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(m){ei(a,l,m)}}function Ko(a,l){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var m=a.stateNode;break;case 30:m=a.stateNode;break;default:m=a.stateNode}typeof h=="function"?a.refCleanup=h(m):h.current=m}}catch(b){ei(a,l,b)}}function qr(a,l){var h=a.ref,m=a.refCleanup;if(h!==null)if(typeof m=="function")try{m()}catch(b){ei(a,l,b)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(b){ei(a,l,b)}else h.current=null}function af(a){var l=a.type,h=a.memoizedProps,m=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&m.focus();break e;case"img":h.src?m.src=h.src:h.srcSet&&(m.srcset=h.srcSet)}}catch(b){ei(a,a.return,b)}}function wr(a,l,h){try{var m=a.stateNode;eB(m,a.type,h,l),m[V]=l}catch(b){ei(a,a.return,b)}}function Hi(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Yu(a.type)||a.tag===4}function kn(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Hi(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Yu(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Ao(a,l,h){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(a),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=zo));else if(m!==4&&(m===27&&Yu(a.type)&&(h=a.stateNode,l=null),a=a.child,a!==null))for(Ao(a,l,h),a=a.sibling;a!==null;)Ao(a,l,h),a=a.sibling}function ys(a,l,h){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?h.insertBefore(a,l):h.appendChild(a);else if(m!==4&&(m===27&&Yu(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(ys(a,l,h),a=a.sibling;a!==null;)ys(a,l,h),a=a.sibling}function cp(a){var l=a.stateNode,h=a.memoizedProps;try{for(var m=a.type,b=l.attributes;b.length;)l.removeAttributeNode(b[0]);bs(l,m,h),l[bi]=a,l[V]=h}catch(w){ei(a,a.return,w)}}var Ca=!1,Ri=!1,ja=!1,xx=typeof WeakSet=="function"?WeakSet:Set,zr=null;function wS(a,l){if(a=a.containerInfo,NS=Cx,a=A1(a),c0(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var b=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{h.nodeType,w.nodeType}catch{h=null;break e}var U=0,J=-1,ye=-1,Ve=0,lt=0,gt=a,Xe=null;t:for(;;){for(var rt;gt!==h||b!==0&&gt.nodeType!==3||(J=U+b),gt!==w||m!==0&&gt.nodeType!==3||(ye=U+m),gt.nodeType===3&&(U+=gt.nodeValue.length),(rt=gt.firstChild)!==null;)Xe=gt,gt=rt;for(;;){if(gt===a)break t;if(Xe===h&&++Ve===b&&(J=U),Xe===w&&++lt===m&&(ye=U),(rt=gt.nextSibling)!==null)break;gt=Xe,Xe=gt.parentNode}gt=rt}h=J===-1||ye===-1?null:{start:J,end:ye}}else h=null}h=h||{start:0,end:0}}else h=null;for(OS={focusedElem:a,selectionRange:h},Cx=!1,zr=l;zr!==null;)if(l=zr,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,zr=a;else for(;zr!==null;){switch(l=zr,w=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)b=a[h],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&w!==null){a=void 0,h=l,b=w.memoizedProps,w=w.memoizedState,m=h.stateNode;try{var Kt=Pl(h.type,b);a=m.getSnapshotBeforeUpdate(Kt,w),m.__reactInternalSnapshotBeforeUpdate=a}catch(hn){ei(h,h.return,hn)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,h=a.nodeType,h===9)US(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":US(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=l.sibling,a!==null){a.return=l.return,zr=a;break}zr=l.return}}function Gi(a,l,h){var m=h.flags;switch(h.tag){case 0:case 11:case 15:Ia(a,h),m&4&&wa(5,h);break;case 1:if(Ia(a,h),m&4)if(a=h.stateNode,l===null)try{a.componentDidMount()}catch(U){ei(h,h.return,U)}else{var b=Pl(h.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(b,l,a.__reactInternalSnapshotBeforeUpdate)}catch(U){ei(h,h.return,U)}}m&64&&Va(h),m&512&&Ko(h,h.return);break;case 3:if(Ia(a,h),m&64&&(a=h.updateQueue,a!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{D1(a,l)}catch(U){ei(h,h.return,U)}}break;case 27:l===null&&m&4&&cp(h);case 26:case 5:Ia(a,h),l===null&&m&4&&af(h),m&512&&Ko(h,h.return);break;case 12:Ia(a,h);break;case 31:Ia(a,h),m&4&&Ul(a,h);break;case 13:Ia(a,h),m&4&&Fu(a,h),m&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=x.bind(null,h),lB(a,h))));break;case 22:if(m=h.memoizedState!==null||Ca,!m){l=l!==null&&l.memoizedState!==null||Ri,b=Ca;var w=Ri;Ca=m,(Ri=l)&&!w?As(a,h,(h.subtreeFlags&8772)!==0):Ia(a,h),Ca=b,Ri=w}break;case 30:break;default:Ia(a,h)}}function of(a){var l=a.alternate;l!==null&&(a.alternate=null,of(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&k(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var fi=null,as=!1;function Ra(a,l,h){for(h=h.child;h!==null;)up(a,l,h),h=h.sibling}function up(a,l,h){if(ct&&typeof ct.onCommitFiberUnmount=="function")try{ct.onCommitFiberUnmount(vt,h)}catch{}switch(h.tag){case 26:Ri||qr(h,l),Ra(a,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ri||qr(h,l);var m=fi,b=as;Yu(h.type)&&(fi=h.stateNode,as=!1),Ra(a,l,h),og(h.stateNode),fi=m,as=b;break;case 5:Ri||qr(h,l);case 6:if(m=fi,b=as,fi=null,Ra(a,l,h),fi=m,as=b,fi!==null)if(as)try{(fi.nodeType===9?fi.body:fi.nodeName==="HTML"?fi.ownerDocument.body:fi).removeChild(h.stateNode)}catch(w){ei(h,l,w)}else try{fi.removeChild(h.stateNode)}catch(w){ei(h,l,w)}break;case 18:fi!==null&&(as?(a=fi,vw(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),xp(a)):vw(fi,h.stateNode));break;case 4:m=fi,b=as,fi=h.stateNode.containerInfo,as=!0,Ra(a,l,h),fi=m,as=b;break;case 0:case 11:case 14:case 15:Qr(2,h,l),Ri||Qr(4,h,l),Ra(a,l,h);break;case 1:Ri||(qr(h,l),m=h.stateNode,typeof m.componentWillUnmount=="function"&&Fr(h,l,m)),Ra(a,l,h);break;case 21:Ra(a,l,h);break;case 22:Ri=(m=Ri)||h.memoizedState!==null,Ra(a,l,h),Ri=m;break;default:Ra(a,l,h)}}function Ul(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{xp(a)}catch(h){ei(l,l.return,h)}}}function Fu(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{xp(a)}catch(h){ei(l,l.return,h)}}function tg(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new xx),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new xx),l;default:throw Error(n(435,a.tag))}}function Zo(a,l){var h=tg(a);l.forEach(function(m){if(!h.has(m)){h.add(m);var b=_.bind(null,a,m);m.then(b,b)}})}function Cr(a,l){var h=l.deletions;if(h!==null)for(var m=0;m<h.length;m++){var b=h[m],w=a,U=l,J=U;e:for(;J!==null;){switch(J.tag){case 27:if(Yu(J.type)){fi=J.stateNode,as=!1;break e}break;case 5:fi=J.stateNode,as=!1;break e;case 3:case 4:fi=J.stateNode.containerInfo,as=!0;break e}J=J.return}if(fi===null)throw Error(n(160));up(w,U,b),fi=null,as=!1,w=b.alternate,w!==null&&(w.return=null),b.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Fl(l,a),l=l.sibling}var Da=null;function Fl(a,l){var h=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Cr(l,a),Rr(a),m&4&&(Qr(3,a,a.return),wa(3,a),Qr(5,a,a.return));break;case 1:Cr(l,a),Rr(a),m&512&&(Ri||h===null||qr(h,h.return)),m&64&&Ca&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?m:h.concat(m))));break;case 26:var b=Da;if(Cr(l,a),Rr(a),m&512&&(Ri||h===null||qr(h,h.return)),m&4){var w=h!==null?h.memoizedState:null;if(m=a.memoizedState,h===null)if(m===null)if(a.stateNode===null){e:{m=a.type,h=a.memoizedProps,b=b.ownerDocument||b;t:switch(m){case"title":w=b.getElementsByTagName("title")[0],(!w||w[N]||w[bi]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=b.createElement(m),b.head.insertBefore(w,b.querySelector("head > title"))),bs(w,m,h),w[bi]=a,P(w),m=w;break e;case"link":var U=Cw("link","href",b).get(m+(h.href||""));if(U){for(var J=0;J<U.length;J++)if(w=U[J],w.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&w.getAttribute("rel")===(h.rel==null?null:h.rel)&&w.getAttribute("title")===(h.title==null?null:h.title)&&w.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){U.splice(J,1);break t}}w=b.createElement(m),bs(w,m,h),b.head.appendChild(w);break;case"meta":if(U=Cw("meta","content",b).get(m+(h.content||""))){for(J=0;J<U.length;J++)if(w=U[J],w.getAttribute("content")===(h.content==null?null:""+h.content)&&w.getAttribute("name")===(h.name==null?null:h.name)&&w.getAttribute("property")===(h.property==null?null:h.property)&&w.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&w.getAttribute("charset")===(h.charSet==null?null:h.charSet)){U.splice(J,1);break t}}w=b.createElement(m),bs(w,m,h),b.head.appendChild(w);break;default:throw Error(n(468,m))}w[bi]=a,P(w),m=w}a.stateNode=m}else Rw(b,a.type,a.stateNode);else a.stateNode=ww(b,m,a.memoizedProps);else w!==m?(w===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):w.count--,m===null?Rw(b,a.type,a.stateNode):ww(b,m,a.memoizedProps)):m===null&&a.stateNode!==null&&wr(a,a.memoizedProps,h.memoizedProps)}break;case 27:Cr(l,a),Rr(a),m&512&&(Ri||h===null||qr(h,h.return)),h!==null&&m&4&&wr(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Cr(l,a),Rr(a),m&512&&(Ri||h===null||qr(h,h.return)),a.flags&32){b=a.stateNode;try{vr(b,"")}catch(Kt){ei(a,a.return,Kt)}}m&4&&a.stateNode!=null&&(b=a.memoizedProps,wr(a,b,h!==null?h.memoizedProps:b)),m&1024&&(ja=!0);break;case 6:if(Cr(l,a),Rr(a),m&4){if(a.stateNode===null)throw Error(n(162));m=a.memoizedProps,h=a.stateNode;try{h.nodeValue=m}catch(Kt){ei(a,a.return,Kt)}}break;case 3:if(Ex=null,b=Da,Da=Sx(l.containerInfo),Cr(l,a),Da=b,Rr(a),m&4&&h!==null&&h.memoizedState.isDehydrated)try{xp(l.containerInfo)}catch(Kt){ei(a,a.return,Kt)}ja&&(ja=!1,dp(a));break;case 4:m=Da,Da=Sx(a.stateNode.containerInfo),Cr(l,a),Rr(a),Da=m;break;case 12:Cr(l,a),Rr(a);break;case 31:Cr(l,a),Rr(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Zo(a,m)));break;case 13:Cr(l,a),Rr(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(zu=G()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Zo(a,m)));break;case 22:b=a.memoizedState!==null;var ye=h!==null&&h.memoizedState!==null,Ve=Ca,lt=Ri;if(Ca=Ve||b,Ri=lt||ye,Cr(l,a),Ri=lt,Ca=Ve,Rr(a),m&8192)e:for(l=a.stateNode,l._visibility=b?l._visibility&-2:l._visibility|1,b&&(h===null||ye||Ca||Ri||_o(a)),h=null,l=a;;){if(l.tag===5||l.tag===26){if(h===null){ye=h=l;try{if(w=ye.stateNode,b)U=w.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{J=ye.stateNode;var gt=ye.memoizedProps.style,Xe=gt!=null&&gt.hasOwnProperty("display")?gt.display:null;J.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Kt){ei(ye,ye.return,Kt)}}}else if(l.tag===6){if(h===null){ye=l;try{ye.stateNode.nodeValue=b?"":ye.memoizedProps}catch(Kt){ei(ye,ye.return,Kt)}}}else if(l.tag===18){if(h===null){ye=l;try{var rt=ye.stateNode;b?xw(rt,!0):xw(ye.stateNode,!1)}catch(Kt){ei(ye,ye.return,Kt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=a.updateQueue,m!==null&&(h=m.retryQueue,h!==null&&(m.retryQueue=null,Zo(a,h))));break;case 19:Cr(l,a),Rr(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Zo(a,m)));break;case 30:break;case 21:break;default:Cr(l,a),Rr(a)}}function Rr(a){var l=a.flags;if(l&2){try{for(var h,m=a.return;m!==null;){if(Hi(m)){h=m;break}m=m.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var b=h.stateNode,w=kn(a);ys(a,w,b);break;case 5:var U=h.stateNode;h.flags&32&&(vr(U,""),h.flags&=-33);var J=kn(a);ys(a,J,U);break;case 3:case 4:var ye=h.stateNode.containerInfo,Ve=kn(a);Ao(a,Ve,ye);break;default:throw Error(n(161))}}catch(lt){ei(a,a.return,lt)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function dp(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;dp(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function Ia(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Gi(a,l.alternate,l),l=l.sibling}function _o(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:Qr(4,l,l.return),_o(l);break;case 1:qr(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&Fr(l,l.return,h),_o(l);break;case 27:og(l.stateNode);case 26:case 5:qr(l,l.return),_o(l);break;case 22:l.memoizedState===null&&_o(l);break;case 30:_o(l);break;default:_o(l)}a=a.sibling}}function As(a,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,b=a,w=l,U=w.flags;switch(w.tag){case 0:case 11:case 15:As(b,w,h),wa(4,w);break;case 1:if(As(b,w,h),m=w,b=m.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Ve){ei(m,m.return,Ve)}if(m=w,b=m.updateQueue,b!==null){var J=m.stateNode;try{var ye=b.shared.hiddenCallbacks;if(ye!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ye.length;b++)Bu(ye[b],J)}catch(Ve){ei(m,m.return,Ve)}}h&&U&64&&Va(w),Ko(w,w.return);break;case 27:cp(w);case 26:case 5:As(b,w,h),h&&m===null&&U&4&&af(w),Ko(w,w.return);break;case 12:As(b,w,h);break;case 31:As(b,w,h),h&&U&4&&Ul(b,w);break;case 13:As(b,w,h),h&&U&4&&Fu(b,w);break;case 22:w.memoizedState===null&&As(b,w,h),Ko(w,w.return);break;case 30:break;default:As(b,w,h)}l=l.sibling}}function zl(a,l){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&vc(h))}function Ic(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&vc(a))}function Jr(a,l,h,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)ng(a,l,h,m),l=l.sibling}function ng(a,l,h,m){var b=l.flags;switch(l.tag){case 0:case 11:case 15:Jr(a,l,h,m),b&2048&&wa(9,l);break;case 1:Jr(a,l,h,m);break;case 3:Jr(a,l,h,m),b&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&vc(a)));break;case 12:if(b&2048){Jr(a,l,h,m),a=l.stateNode;try{var w=l.memoizedProps,U=w.id,J=w.onPostCommit;typeof J=="function"&&J(U,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ye){ei(l,l.return,ye)}}else Jr(a,l,h,m);break;case 31:Jr(a,l,h,m);break;case 13:Jr(a,l,h,m);break;case 23:break;case 22:w=l.stateNode,U=l.alternate,l.memoizedState!==null?w._visibility&2?Jr(a,l,h,m):So(a,l):w._visibility&2?Jr(a,l,h,m):(w._visibility|=2,Kr(a,l,h,m,(l.subtreeFlags&10256)!==0||!1)),b&2048&&zl(U,l);break;case 24:Jr(a,l,h,m),b&2048&&Ic(l.alternate,l);break;default:Jr(a,l,h,m)}}function Kr(a,l,h,m,b){for(b=b&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var w=a,U=l,J=h,ye=m,Ve=U.flags;switch(U.tag){case 0:case 11:case 15:Kr(w,U,J,ye,b),wa(8,U);break;case 23:break;case 22:var lt=U.stateNode;U.memoizedState!==null?lt._visibility&2?Kr(w,U,J,ye,b):So(w,U):(lt._visibility|=2,Kr(w,U,J,ye,b)),b&&Ve&2048&&zl(U.alternate,U);break;case 24:Kr(w,U,J,ye,b),b&&Ve&2048&&Ic(U.alternate,U);break;default:Kr(w,U,J,ye,b)}l=l.sibling}}function So(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=a,m=l,b=m.flags;switch(m.tag){case 22:So(h,m),b&2048&&zl(m.alternate,m);break;case 24:So(h,m),b&2048&&Ic(m.alternate,m);break;default:So(h,m)}l=l.sibling}}var Bc=8192;function Ks(a,l,h){if(a.subtreeFlags&Bc)for(a=a.child;a!==null;)fp(a,l,h),a=a.sibling}function fp(a,l,h){switch(a.tag){case 26:Ks(a,l,h),a.flags&Bc&&a.memoizedState!==null&&AB(h,Da,a.memoizedState,a.memoizedProps);break;case 5:Ks(a,l,h);break;case 3:case 4:var m=Da;Da=Sx(a.stateNode.containerInfo),Ks(a,l,h),Da=m;break;case 22:a.memoizedState===null&&(m=a.alternate,m!==null&&m.memoizedState!==null?(m=Bc,Bc=16777216,Ks(a,l,h),Bc=m):Ks(a,l,h));break;default:Ks(a,l,h)}}function Nc(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function Hl(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var m=l[h];zr=m,nr(m,a)}Nc(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Os(a),a=a.sibling}function Os(a){switch(a.tag){case 0:case 11:case 15:Hl(a),a.flags&2048&&Qr(9,a,a.return);break;case 3:Hl(a);break;case 12:Hl(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,Ls(a)):Hl(a);break;default:Hl(a)}}function Ls(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var m=l[h];zr=m,nr(m,a)}Nc(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:Qr(8,l,l.return),Ls(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,Ls(l));break;default:Ls(l)}a=a.sibling}}function nr(a,l){for(;zr!==null;){var h=zr;switch(h.tag){case 0:case 11:case 15:Qr(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var m=h.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:vc(h.memoizedState.cache)}if(m=h.child,m!==null)m.return=h,zr=m;else e:for(h=a;zr!==null;){m=zr;var b=m.sibling,w=m.return;if(of(m),m===h){zr=null;break e}if(b!==null){b.return=w,zr=b;break e}zr=w}}}var $o={getCacheForType:function(a){var l=mn(xr),h=l.data.get(a);return h===void 0&&(h=a(),l.data.set(a,h)),h},cacheSignal:function(){return mn(xr).controller.signal}},Tn=typeof WeakMap=="function"?WeakMap:Map,tn=0,xn=null,Dn=null,Cn=0,Yn=0,os=null,Ba=!1,Wa=!1,ig=!1,Zs=0,Qi=0,bo=0,Gl=0,lf=0,_s=0,Li=0,Oc=null,ir=null,rr=!1,zu=0,rg=0,dr=1/0,qi=null,fr=null,hi=0,$s=null,Hu=null,Na=0,Gu=0,ku=null,cf=null,kl=0,Lc=null;function ea(){return(tn&2)!==0&&Cn!==0?Cn&-Cn:X.T!==null?$e():is()}function Un(){if(_s===0)if((Cn&536870912)===0||Wn){var a=Oe;Oe<<=1,(Oe&3932160)===0&&(Oe=262144),_s=a}else _s=536870912;return a=Ds.current,a!==null&&(a.flags|=32),_s}function In(a,l,h){(a===xn&&(Yn===2||Yn===9)||a.cancelPendingCommit!==null)&&(jl(a,0),Ar(a,Cn,_s,!1)),Si(a,h),((tn&2)===0||a!==xn)&&(a===xn&&((tn&2)===0&&(Gl|=h),Qi===4&&Ar(a,Cn,_s,!1)),Ct(a))}function Fn(a,l,h){if((tn&6)!==0)throw Error(n(327));var m=!h&&(l&127)===0&&(l&a.expiredLanes)===0||wt(a,l),b=m?uf(a,l):Ss(a,l,!0),w=m;do{if(b===0){Wa&&!m&&Ar(a,l,0,!1);break}else{if(h=a.current.alternate,w&&!pi(h)){b=Ss(a,l,!1),w=!1;continue}if(b===2){if(w=l,a.errorRecoveryDisabledLanes&w)var U=0;else U=a.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){l=U;e:{var J=a;b=Oc;var ye=J.current.memoizedState.isDehydrated;if(ye&&(jl(J,U).flags|=256),U=Ss(J,U,!1),U!==2){if(ig&&!ye){J.errorRecoveryDisabledLanes|=w,Gl|=w,b=4;break e}w=ir,ir=b,w!==null&&(ir===null?ir=w:ir.push.apply(ir,w))}b=U}if(w=!1,b!==2)continue}}if(b===1){jl(a,0),Ar(a,l,0,!0);break}e:{switch(m=a,w=b,w){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Ar(m,l,_s,!Ba);break e;case 2:ir=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(b=zu+300-G(),10<b)){if(Ar(m,l,_s,!Ba),ut(m,0,!0)!==0)break e;Na=l,m.timeoutHandle=mw(Vn.bind(null,m,h,ir,qi,rr,l,_s,Gl,Li,Ba,w,"Throttled",-0,0),b);break e}Vn(m,h,ir,qi,rr,l,_s,Gl,Li,Ba,w,null,-0,0)}}break}while(!0);Ct(a)}function Vn(a,l,h,m,b,w,U,J,ye,Ve,lt,gt,Xe,rt){if(a.timeoutHandle=-1,gt=l.subtreeFlags,gt&8192||(gt&16785408)===16785408){gt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:zo},fp(l,w,gt);var Kt=(w&62914560)===w?zu-G():(w&4194048)===w?rg-G():0;if(Kt=_B(gt,Kt),Kt!==null){Na=w,a.cancelPendingCommit=Kt(tl.bind(null,a,l,w,h,m,b,U,J,ye,lt,gt,null,Xe,rt)),Ar(a,w,U,!Ve);return}}tl(a,l,w,h,m,b,U,J,ye)}function pi(a){for(var l=a;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var m=0;m<h.length;m++){var b=h[m],w=b.getSnapshot;b=b.value;try{if(!ms(w(),b))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ar(a,l,h,m){l&=~lf,l&=~Gl,a.suspendedLanes|=l,a.pingedLanes&=~l,m&&(a.warmLanes|=l),m=a.expirationTimes;for(var b=l;0<b;){var w=31-he(b),U=1<<w;m[w]=-1,b&=~U}h!==0&&ha(a,h,l)}function Xa(){return(tn&6)===0?(Xt(0),!1):!0}function Vl(){if(Dn!==null){if(Yn===0)var a=Dn.return;else a=Dn,ho=Rl=null,w0(a),Sc=null,bc=0,a=Dn;for(;a!==null;)Js(a.alternate,a),a=a.return;Dn=null}}function jl(a,l){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,iB(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),Na=0,Vl(),xn=a,Dn=h=ws(a.current,null),Cn=l,Yn=0,os=null,Ba=!1,Wa=wt(a,l),ig=!1,Li=_s=lf=Gl=bo=Qi=0,ir=Oc=null,rr=!1,(l&8)!==0&&(l|=l&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=l;0<m;){var b=31-he(m),w=1<<b;l|=a[b],m&=~w}return Zs=l,kd(),h}function Eo(a,l){Mn=null,X.H=Pu,l===xc||l===Rn?(l=Ac(),Yn=3):l===Xd?(l=Ac(),Yn=4):Yn=l===ep?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,os=l,Dn===null&&(Qi=1,$h(a,Xs(l,a.current)))}function Ji(){var a=Ds.current;return a===null?!0:(Cn&4194048)===Cn?xs===null:(Cn&62914560)===Cn||(Cn&536870912)!==0?a===xs:!1}function el(){var a=X.H;return X.H=Pu,a===null?Pu:a}function Wl(){var a=X.A;return X.A=$o,a}function Vu(){Qi=4,Ba||(Cn&4194048)!==Cn&&Ds.current!==null||(Wa=!0),(bo&134217727)===0&&(Gl&134217727)===0||xn===null||Ar(xn,Cn,_s,!1)}function Ss(a,l,h){var m=tn;tn|=2;var b=el(),w=Wl();(xn!==a||Cn!==l)&&(qi=null,jl(a,l)),l=!1;var U=Qi;e:do try{if(Yn!==0&&Dn!==null){var J=Dn,ye=os;switch(Yn){case 8:Vl(),U=6;break e;case 3:case 2:case 9:case 6:Ds.current===null&&(l=!0);var Ve=Yn;if(Yn=0,os=null,Pc(a,J,ye,Ve),h&&Wa){U=0;break e}break;default:Ve=Yn,Yn=0,os=null,Pc(a,J,ye,Ve)}}ju(),U=Qi;break}catch(lt){Eo(a,lt)}while(!0);return l&&a.shellSuspendCounter++,ho=Rl=null,tn=m,X.H=b,X.A=w,Dn===null&&(xn=null,Cn=0,kd()),U}function ju(){for(;Dn!==null;)hp(Dn)}function uf(a,l){var h=tn;tn|=2;var m=el(),b=Wl();xn!==a||Cn!==l?(qi=null,dr=G()+500,jl(a,l)):Wa=wt(a,l);e:do try{if(Yn!==0&&Dn!==null){l=Dn;var w=os;t:switch(Yn){case 1:Yn=0,os=null,Pc(a,l,w,1);break;case 2:case 9:if(Rs(w)){Yn=0,os=null,df(l);break}l=function(){Yn!==2&&Yn!==9||xn!==a||(Yn=7),Ct(a)},w.then(l,l);break e;case 3:Yn=7;break e;case 4:Yn=5;break e;case 7:Rs(w)?(Yn=0,os=null,df(l)):(Yn=0,os=null,Pc(a,l,w,7));break;case 5:var U=null;switch(Dn.tag){case 26:U=Dn.memoizedState;case 5:case 27:var J=Dn;if(U?Dw(U):J.stateNode.complete){Yn=0,os=null;var ye=J.sibling;if(ye!==null)Dn=ye;else{var Ve=J.return;Ve!==null?(Dn=Ve,Xl(Ve)):Dn=null}break t}}Yn=0,os=null,Pc(a,l,w,5);break;case 6:Yn=0,os=null,Pc(a,l,w,6);break;case 8:Vl(),Qi=6;break e;default:throw Error(n(462))}}Ps();break}catch(lt){Eo(a,lt)}while(!0);return ho=Rl=null,X.H=m,X.A=b,tn=h,Dn!==null?0:(xn=null,Cn=0,kd(),Qi)}function Ps(){for(;Dn!==null&&!Tt();)hp(Dn)}function hp(a){var l=lp(a.alternate,a,Zs);a.memoizedProps=a.pendingProps,l===null?Xl(a):Dn=l}function df(a){var l=a,h=l.alternate;switch(l.tag){case 15:case 0:l=tf(h,l,l.pendingProps,l.type,void 0,Cn);break;case 11:l=tf(h,l,l.pendingProps,l.type.render,l.ref,Cn);break;case 5:w0(l);default:Js(h,l),l=Dn=Su(l,Zs),l=lp(h,l,Zs)}a.memoizedProps=a.pendingProps,l===null?Xl(a):Dn=l}function Pc(a,l,h,m){ho=Rl=null,w0(l),Sc=null,bc=0;var b=l.return;try{if(Tr(a,b,l,h,Cn)){Qi=1,$h(a,Xs(h,a.current)),Dn=null;return}}catch(w){if(b!==null)throw Dn=b,w;Qi=1,$h(a,Xs(h,a.current)),Dn=null;return}l.flags&32768?(Wn||m===1?a=!0:Wa||(Cn&536870912)!==0?a=!1:(Ba=a=!0,(m===2||m===9||m===3||m===6)&&(m=Ds.current,m!==null&&m.tag===13&&(m.flags|=16384))),ff(l,a)):Xl(l)}function Xl(a){var l=a;do{if((l.flags&32768)!==0){ff(l,Ba);return}a=l.return;var h=sf(l.alternate,l,Zs);if(h!==null){Dn=h;return}if(l=l.sibling,l!==null){Dn=l;return}Dn=l=a}while(l!==null);Qi===0&&(Qi=5)}function ff(a,l){do{var h=Ta(a.alternate,a);if(h!==null){h.flags&=32767,Dn=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(a=a.sibling,a!==null)){Dn=a;return}Dn=a=h}while(a!==null);Qi=6,Dn=null}function tl(a,l,h,m,b,w,U,J,ye){a.cancelPendingCommit=null;do Wu();while(hi!==0);if((tn&6)!==0)throw Error(n(327));if(l!==null){if(l===a.current)throw Error(n(177));if(w=l.lanes|l.childLanes,w|=Lr,ji(a,h,w,U,J,ye),a===xn&&(Dn=xn=null,Cn=0),Hu=l,$s=a,Na=h,Gu=w,ku=b,cf=m,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,C(Qe,function(){return pp(),null})):(a.callbackNode=null,a.callbackPriority=0),m=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||m){m=X.T,X.T=null,b=re.p,re.p=2,U=tn,tn|=4;try{wS(a,l,h)}finally{tn=U,re.p=b,X.T=m}}hi=1,_r(),nl(),Uc()}}function _r(){if(hi===1){hi=0;var a=$s,l=Hu,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=X.T,X.T=null;var m=re.p;re.p=2;var b=tn;tn|=4;try{Fl(l,a);var w=OS,U=A1(a.containerInfo),J=w.focusedElem,ye=w.selectionRange;if(U!==J&&J&&J.ownerDocument&&wi(J.ownerDocument.documentElement,J)){if(ye!==null&&c0(J)){var Ve=ye.start,lt=ye.end;if(lt===void 0&&(lt=Ve),"selectionStart"in J)J.selectionStart=Ve,J.selectionEnd=Math.min(lt,J.value.length);else{var gt=J.ownerDocument||document,Xe=gt&&gt.defaultView||window;if(Xe.getSelection){var rt=Xe.getSelection(),Kt=J.textContent.length,hn=Math.min(ye.start,Kt),Ii=ye.end===void 0?hn:Math.min(ye.end,Kt);!rt.extend&&hn>Ii&&(U=Ii,Ii=hn,hn=U);var Le=yu(J,hn),Me=yu(J,Ii);if(Le&&Me&&(rt.rangeCount!==1||rt.anchorNode!==Le.node||rt.anchorOffset!==Le.offset||rt.focusNode!==Me.node||rt.focusOffset!==Me.offset)){var ke=gt.createRange();ke.setStart(Le.node,Le.offset),rt.removeAllRanges(),hn>Ii?(rt.addRange(ke),rt.extend(Me.node,Me.offset)):(ke.setEnd(Me.node,Me.offset),rt.addRange(ke))}}}}for(gt=[],rt=J;rt=rt.parentNode;)rt.nodeType===1&&gt.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof J.focus=="function"&&J.focus(),J=0;J<gt.length;J++){var pt=gt[J];pt.element.scrollLeft=pt.left,pt.element.scrollTop=pt.top}}Cx=!!NS,OS=NS=null}finally{tn=b,re.p=m,X.T=h}}a.current=l,hi=2}}function nl(){if(hi===2){hi=0;var a=$s,l=Hu,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=X.T,X.T=null;var m=re.p;re.p=2;var b=tn;tn|=4;try{Gi(a,l.alternate,l)}finally{tn=b,re.p=m,X.T=h}}hi=3}}function Uc(){if(hi===4||hi===3){hi=0,te();var a=$s,l=Hu,h=Na,m=cf;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?hi=5:(hi=0,Hu=$s=null,Mo(a,a.pendingLanes));var b=a.pendingLanes;if(b===0&&(fr=null),Xr(h),l=l.stateNode,ct&&typeof ct.onCommitFiberRoot=="function")try{ct.onCommitFiberRoot(vt,l,void 0,(l.current.flags&128)===128)}catch{}if(m!==null){l=X.T,b=re.p,re.p=2,X.T=null;try{for(var w=a.onRecoverableError,U=0;U<m.length;U++){var J=m[U];w(J.value,{componentStack:J.stack})}}finally{X.T=l,re.p=b}}(Na&3)!==0&&Wu(),Ct(a),b=a.pendingLanes,(h&261930)!==0&&(b&42)!==0?a===Lc?kl++:(kl=0,Lc=a):kl=0,Xt(0)}}function Mo(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,vc(l)))}function Wu(){return _r(),nl(),Uc(),pp()}function pp(){if(hi!==5)return!1;var a=$s,l=Gu;Gu=0;var h=Xr(Na),m=X.T,b=re.p;try{re.p=32>h?32:h,X.T=null,h=ku,ku=null;var w=$s,U=Na;if(hi=0,Hu=$s=null,Na=0,(tn&6)!==0)throw Error(n(331));var J=tn;if(tn|=4,Os(w.current),ng(w,w.current,U,h),tn=J,Xt(0,!1),ct&&typeof ct.onPostCommitFiberRoot=="function")try{ct.onPostCommitFiberRoot(vt,w)}catch{}return!0}finally{re.p=b,X.T=m,Mo(a,l)}}function sg(a,l,h){l=Xs(h,l),l=q0(a.stateNode,l,2),a=Bl(a,l,2),a!==null&&(Si(a,2),Ct(a))}function ei(a,l,h){if(a.tag===3)sg(a,a,h);else for(;l!==null;){if(l.tag===3){sg(l,a,h);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(fr===null||!fr.has(m))){a=Xs(h,a),h=J0(2),m=Bl(l,h,2),m!==null&&(hx(h,m,l,a),Si(m,2),Ct(m));break}}l=l.return}}function hf(a,l,h){var m=a.pingCache;if(m===null){m=a.pingCache=new Tn;var b=new Set;m.set(l,b)}else b=m.get(l),b===void 0&&(b=new Set,m.set(l,b));b.has(h)||(ig=!0,b.add(h),a=c.bind(null,a,l,h),l.then(a,a))}function c(a,l,h){var m=a.pingCache;m!==null&&m.delete(l),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,xn===a&&(Cn&h)===h&&(Qi===4||Qi===3&&(Cn&62914560)===Cn&&300>G()-zu?(tn&2)===0&&jl(a,0):lf|=h,Li===Cn&&(Li=0)),Ct(a)}function d(a,l){l===0&&(l=yn()),a=gs(a,l),a!==null&&(Si(a,l),Ct(a))}function x(a){var l=a.memoizedState,h=0;l!==null&&(h=l.retryLane),d(a,h)}function _(a,l){var h=0;switch(a.tag){case 31:case 13:var m=a.stateNode,b=a.memoizedState;b!==null&&(h=b.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(l),d(a,h)}function C(a,l){return Dt(a,l)}var B=null,q=null,Ae=!1,it=!1,bt=!1,Lt=0;function Ct(a){a!==q&&a.next===null&&(q===null?B=q=a:q=q.next=a),it=!0,Ae||(Ae=!0,Pe())}function Xt(a,l){if(!bt&&it){bt=!0;do for(var h=!1,m=B;m!==null;){if(a!==0){var b=m.pendingLanes;if(b===0)var w=0;else{var U=m.suspendedLanes,J=m.pingedLanes;w=(1<<31-he(42|a)+1)-1,w&=b&~(U&~J),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(h=!0,We(m,w))}else w=Cn,w=ut(m,m===xn?w:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(w&3)===0||wt(m,w)||(h=!0,We(m,w));m=m.next}while(h);bt=!1}}function Sn(){hr()}function hr(){it=Ae=!1;var a=0;Lt!==0&&nB()&&(a=Lt);for(var l=G(),h=null,m=B;m!==null;){var b=m.next,w=Xu(m,l);w===0?(m.next=null,h===null?B=b:h.next=b,b===null&&(q=h)):(h=m,(a!==0||(w&3)!==0)&&(it=!0)),m=b}hi!==0&&hi!==5||Xt(a),Lt!==0&&(Lt=0)}function Xu(a,l){for(var h=a.suspendedLanes,m=a.pingedLanes,b=a.expirationTimes,w=a.pendingLanes&-62914561;0<w;){var U=31-he(w),J=1<<U,ye=b[U];ye===-1?((J&h)===0||(J&m)!==0)&&(b[U]=Zt(J,l)):ye<=l&&(a.expiredLanes|=J),w&=~J}if(l=xn,h=Cn,h=ut(a,a===l?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m=a.callbackNode,h===0||a===l&&(Yn===2||Yn===9)||a.cancelPendingCommit!==null)return m!==null&&m!==null&&qt(m),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||wt(a,h)){if(l=h&-h,l===a.callbackPriority)return l;switch(m!==null&&qt(m),Xr(h)){case 2:case 8:h=ot;break;case 32:h=Qe;break;case 268435456:h=Rt;break;default:h=Qe}return m=Yl.bind(null,a),h=Dt(h,m),a.callbackPriority=l,a.callbackNode=h,l}return m!==null&&m!==null&&qt(m),a.callbackPriority=2,a.callbackNode=null,2}function Yl(a,l){if(hi!==0&&hi!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(Wu()&&a.callbackNode!==h)return null;var m=Cn;return m=ut(a,a===xn?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m===0?null:(Fn(a,m,l),Xu(a,G()),a.callbackNode!=null&&a.callbackNode===h?Yl.bind(null,a):null)}function We(a,l){if(Wu())return null;Fn(a,l,!0)}function Pe(){rB(function(){(tn&6)!==0?Dt(Ye,Sn):hr()})}function $e(){if(Lt===0){var a=Wo;a===0&&(a=Fe,Fe<<=1,(Fe&261888)===0&&(Fe=256)),Lt=a}return Lt}function Nt(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Cd(""+a)}function cn(a,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,a.id&&h.setAttribute("form",a.id),l.parentNode.insertBefore(h,l),a=new FormData(a),h.parentNode.removeChild(h),a}function Ki(a,l,h,m,b){if(l==="submit"&&h&&h.stateNode===b){var w=Nt((b[V]||null).action),U=m.submitter;U&&(l=(l=U[V]||null)?Nt(l.formAction):U.getAttribute("formAction"),l!==null&&(w=l,U=null));var J=new Id("action","action",null,m,b);a.push({event:J,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Lt!==0){var ye=U?cn(b,U):new FormData(b);G0(h,{pending:!0,data:ye,method:b.method,action:w},null,ye)}}else typeof w=="function"&&(J.preventDefault(),ye=U?cn(b,U):new FormData(b),G0(h,{pending:!0,data:ye,method:b.method,action:w},w,ye))},currentTarget:b}]})}}for(var un=0;un<Hd.length;un++){var Kn=Hd[un],Hr=Kn.toLowerCase(),ii=Kn[0].toUpperCase()+Kn.slice(1);ya(Hr,"on"+ii)}ya(wh,"onAnimationEnd"),ya(zd,"onAnimationIteration"),ya(d0,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(S1,"onTransitionRun"),ya(yS,"onTransitionStart"),ya(b1,"onTransitionCancel"),ya(f0,"onTransitionEnd"),ie("onMouseEnter",["mouseout","mouseover"]),ie("onMouseLeave",["mouseout","mouseover"]),ie("onPointerEnter",["pointerout","pointerover"]),ie("onPointerLeave",["pointerout","pointerover"]),ae("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ae("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ae("onBeforeInput",["compositionend","keypress","textInput","paste"]),ae("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ae("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ae("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oa));function ow(a,l){l=(l&4)!==0;for(var h=0;h<a.length;h++){var m=a[h],b=m.event;m=m.listeners;e:{var w=void 0;if(l)for(var U=m.length-1;0<=U;U--){var J=m[U],ye=J.instance,Ve=J.currentTarget;if(J=J.listener,ye!==w&&b.isPropagationStopped())break e;w=J,b.currentTarget=Ve;try{w(b)}catch(lt){Gd(lt)}b.currentTarget=null,w=ye}else for(U=0;U<m.length;U++){if(J=m[U],ye=J.instance,Ve=J.currentTarget,J=J.listener,ye!==w&&b.isPropagationStopped())break e;w=J,b.currentTarget=Ve;try{w(b)}catch(lt){Gd(lt)}b.currentTarget=null,w=ye}}}}function Qn(a,l){var h=l[xe];h===void 0&&(h=l[xe]=new Set);var m=a+"__bubble";h.has(m)||(lw(l,a,2,!1),h.add(m))}function RS(a,l,h){var m=0;l&&(m|=4),lw(h,a,m,l)}var yx="_reactListening"+Math.random().toString(36).slice(2);function DS(a){if(!a[yx]){a[yx]=!0,Z.forEach(function(h){h!=="selectionchange"&&(CS.has(h)||RS(h,!1,a),RS(h,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[yx]||(l[yx]=!0,RS("selectionchange",!1,l))}}function lw(a,l,h,m){switch(Uw(l)){case 2:var b=EB;break;case 8:b=MB;break;default:b=WS}h=b.bind(null,l,h,a),b=void 0,!Ym||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(b=!0),m?b!==void 0?a.addEventListener(l,h,{capture:!0,passive:b}):a.addEventListener(l,h,!0):b!==void 0?a.addEventListener(l,h,{passive:b}):a.addEventListener(l,h,!1)}function IS(a,l,h,m,b){var w=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var U=m.tag;if(U===3||U===4){var J=m.stateNode.containerInfo;if(J===b)break;if(U===4)for(U=m.return;U!==null;){var ye=U.tag;if((ye===3||ye===4)&&U.stateNode.containerInfo===b)return;U=U.return}for(;J!==null;){if(U=$(J),U===null)return;if(ye=U.tag,ye===5||ye===6||ye===26||ye===27){m=w=U;continue e}J=J.parentNode}}m=m.return}Xm(function(){var Ve=w,lt=ph(h),gt=[];e:{var Xe=xa.get(a);if(Xe!==void 0){var rt=Id,Kt=a;switch(a){case"keypress":if(Dd(h)===0)break e;case"keydown":case"keyup":rt=fc;break;case"focusin":Kt="focus",rt=xh;break;case"focusout":Kt="blur",rt=xh;break;case"beforeblur":case"afterblur":rt=xh;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Qm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=n1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=l1;break;case wh:case zd:case d0:rt=gS;break;case f0:rt=xS;break;case"scroll":case"scrollend":rt=e1;break;case"wheel":rt=u1;break;case"copy":case"cut":case"paste":rt=r1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=Km;break;case"toggle":case"beforetoggle":rt=f1}var hn=(l&4)!==0,Ii=!hn&&(a==="scroll"||a==="scrollend"),Le=hn?Xe!==null?Xe+"Capture":null:Xe;hn=[];for(var Me=Ve,ke;Me!==null;){var pt=Me;if(ke=pt.stateNode,pt=pt.tag,pt!==5&&pt!==26&&pt!==27||ke===null||Le===null||(pt=uu(Me,Le),pt!=null&&hn.push(ag(Me,pt,ke))),Ii)break;Me=Me.return}0<hn.length&&(Xe=new rt(Xe,Kt,null,h,lt),gt.push({event:Xe,listeners:hn}))}}if((l&7)===0){e:{if(Xe=a==="mouseover"||a==="pointerover",rt=a==="mouseout"||a==="pointerout",Xe&&h!==hh&&(Kt=h.relatedTarget||h.fromElement)&&($(Kt)||Kt[ee]))break e;if((rt||Xe)&&(Xe=lt.window===lt?lt:(Xe=lt.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,rt?(Kt=h.relatedTarget||h.toElement,rt=Ve,Kt=Kt?$(Kt):null,Kt!==null&&(Ii=s(Kt),hn=Kt.tag,Kt!==Ii||hn!==5&&hn!==27&&hn!==6)&&(Kt=null)):(rt=null,Kt=Ve),rt!==Kt)){if(hn=Qm,pt="onMouseLeave",Le="onMouseEnter",Me="mouse",(a==="pointerout"||a==="pointerover")&&(hn=Km,pt="onPointerLeave",Le="onPointerEnter",Me="pointer"),Ii=rt==null?Xe:_e(rt),ke=Kt==null?Xe:_e(Kt),Xe=new hn(pt,Me+"leave",rt,h,lt),Xe.target=Ii,Xe.relatedTarget=ke,pt=null,$(lt)===Ve&&(hn=new hn(Le,Me+"enter",Kt,h,lt),hn.target=ke,hn.relatedTarget=Ii,pt=hn),Ii=pt,rt&&Kt)t:{for(hn=KI,Le=rt,Me=Kt,ke=0,pt=Le;pt;pt=hn(pt))ke++;pt=0;for(var an=Me;an;an=hn(an))pt++;for(;0<ke-pt;)Le=hn(Le),ke--;for(;0<pt-ke;)Me=hn(Me),pt--;for(;ke--;){if(Le===Me||Me!==null&&Le===Me.alternate){hn=Le;break t}Le=hn(Le),Me=hn(Me)}hn=null}else hn=null;rt!==null&&cw(gt,Xe,rt,hn,!1),Kt!==null&&Ii!==null&&cw(gt,Ii,Kt,hn,!0)}}e:{if(Xe=Ve?_e(Ve):window,rt=Xe.nodeName&&Xe.nodeName.toLowerCase(),rt==="select"||rt==="input"&&Xe.type==="file")var li=r0;else if(i0(Xe))if(ro)li=y1;else{li=o0;var en=v1}else rt=Xe.nodeName,!rt||rt.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?Ve&&ga(Ve.elementType)&&(li=r0):li=x1;if(li&&(li=li(a,Ve))){Mh(gt,li,h,lt);break e}en&&en(a,Xe,Ve),a==="focusout"&&Ve&&Xe.type==="number"&&Ve.memoizedProps.value!=null&&fn(Xe,"number",Xe.value)}switch(en=Ve?_e(Ve):window,a){case"focusin":(i0(en)||en.contentEditable==="true")&&(so=en,ao=Ve,Au=null);break;case"focusout":Au=ao=so=null;break;case"mousedown":Th=!0;break;case"contextmenu":case"mouseup":case"dragend":Th=!1,_u(gt,h,lt);break;case"selectionchange":if(_1)break;case"keydown":case"keyup":_u(gt,h,lt)}var Ln;if(hc)e:{switch(a){case"compositionstart":var Zn="onCompositionStart";break e;case"compositionend":Zn="onCompositionEnd";break e;case"compositionupdate":Zn="onCompositionUpdate";break e}Zn=void 0}else pc?Eh(a,h)&&(Zn="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(Zn="onCompositionStart");Zn&&($m&&h.locale!=="ko"&&(pc||Zn!=="onCompositionStart"?Zn==="onCompositionEnd"&&pc&&(Ln=Rd()):(Ws=lt,gh="value"in Ws?Ws.value:Ws.textContent,pc=!0)),en=Ax(Ve,Zn),0<en.length&&(Zn=new yh(Zn,a,null,h,lt),gt.push({event:Zn,listeners:en}),Ln?Zn.data=Ln:(Ln=e0(h),Ln!==null&&(Zn.data=Ln)))),(Ln=bh?m1(a,h):t0(a,h))&&(Zn=Ax(Ve,"onBeforeInput"),0<Zn.length&&(en=new yh("onBeforeInput","beforeinput",null,h,lt),gt.push({event:en,listeners:Zn}),en.data=Ln)),Ki(gt,a,Ve,h,lt)}ow(gt,l)})}function ag(a,l,h){return{instance:a,listener:l,currentTarget:h}}function Ax(a,l){for(var h=l+"Capture",m=[];a!==null;){var b=a,w=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||w===null||(b=uu(a,h),b!=null&&m.unshift(ag(a,b,w)),b=uu(a,l),b!=null&&m.push(ag(a,b,w))),a.tag===3)return m;a=a.return}return[]}function KI(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function cw(a,l,h,m,b){for(var w=l._reactName,U=[];h!==null&&h!==m;){var J=h,ye=J.alternate,Ve=J.stateNode;if(J=J.tag,ye!==null&&ye===m)break;J!==5&&J!==26&&J!==27||Ve===null||(ye=Ve,b?(Ve=uu(h,w),Ve!=null&&U.unshift(ag(h,Ve,ye))):b||(Ve=uu(h,w),Ve!=null&&U.push(ag(h,Ve,ye)))),h=h.return}U.length!==0&&a.push({event:l,listeners:U})}var ZI=/\r\n?/g,$I=/\u0000|\uFFFD/g;function uw(a){return(typeof a=="string"?a:""+a).replace(ZI,`
`).replace($I,"")}function dw(a,l){return l=uw(l),uw(a)===l}function Di(a,l,h,m,b,w){switch(h){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||vr(a,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&vr(a,""+m);break;case"className":at(a,"class",m);break;case"tabIndex":at(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":at(a,h,m);break;case"style":cc(a,m,w);break;case"data":if(l!=="object"){at(a,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||h!=="href")){a.removeAttribute(h);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(h);break}m=Cd(""+m),a.setAttribute(h,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(h==="formAction"?(l!=="input"&&Di(a,l,"name",b.name,b,null),Di(a,l,"formEncType",b.formEncType,b,null),Di(a,l,"formMethod",b.formMethod,b,null),Di(a,l,"formTarget",b.formTarget,b,null)):(Di(a,l,"encType",b.encType,b,null),Di(a,l,"method",b.method,b,null),Di(a,l,"target",b.target,b,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(h);break}m=Cd(""+m),a.setAttribute(h,m);break;case"onClick":m!=null&&(a.onclick=zo);break;case"onScroll":m!=null&&Qn("scroll",a);break;case"onScrollEnd":m!=null&&Qn("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(h=m.__html,h!=null){if(b.children!=null)throw Error(n(60));a.innerHTML=h}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}h=Cd(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(h,""+m):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":m===!0?a.setAttribute(h,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(h,m):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(h,m):a.removeAttribute(h);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(h):a.setAttribute(h,m);break;case"popover":Qn("beforetoggle",a),Qn("toggle",a),He(a,"popover",m);break;case"xlinkActuate":nt(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":nt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":nt(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":nt(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":nt(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":nt(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":nt(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":nt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":nt(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":He(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Zv.get(h)||h,He(a,h,m))}}function BS(a,l,h,m,b,w){switch(h){case"style":cc(a,m,w);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(h=m.__html,h!=null){if(b.children!=null)throw Error(n(60));a.innerHTML=h}}break;case"children":typeof m=="string"?vr(a,m):(typeof m=="number"||typeof m=="bigint")&&vr(a,""+m);break;case"onScroll":m!=null&&Qn("scroll",a);break;case"onScrollEnd":m!=null&&Qn("scrollend",a);break;case"onClick":m!=null&&(a.onclick=zo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!se.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(b=h.endsWith("Capture"),l=h.slice(2,b?h.length-7:void 0),w=a[V]||null,w=w!=null?w[h]:null,typeof w=="function"&&a.removeEventListener(l,w,b),typeof m=="function")){typeof w!="function"&&w!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(l,m,b);break e}h in a?a[h]=m:m===!0?a.setAttribute(h,""):He(a,h,m)}}}function bs(a,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qn("error",a),Qn("load",a);var m=!1,b=!1,w;for(w in h)if(h.hasOwnProperty(w)){var U=h[w];if(U!=null)switch(w){case"src":m=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Di(a,l,w,U,h,null)}}b&&Di(a,l,"srcSet",h.srcSet,h,null),m&&Di(a,l,"src",h.src,h,null);return;case"input":Qn("invalid",a);var J=w=U=b=null,ye=null,Ve=null;for(m in h)if(h.hasOwnProperty(m)){var lt=h[m];if(lt!=null)switch(m){case"name":b=lt;break;case"type":U=lt;break;case"checked":ye=lt;break;case"defaultChecked":Ve=lt;break;case"value":w=lt;break;case"defaultValue":J=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(n(137,l));break;default:Di(a,l,m,lt,h,null)}}vn(a,w,J,ye,Ve,U,b,!1);return;case"select":Qn("invalid",a),m=U=w=null;for(b in h)if(h.hasOwnProperty(b)&&(J=h[b],J!=null))switch(b){case"value":w=J;break;case"defaultValue":U=J;break;case"multiple":m=J;default:Di(a,l,b,J,h,null)}l=w,h=U,a.multiple=!!m,l!=null?oi(a,!!m,l,!1):h!=null&&oi(a,!!m,h,!0);return;case"textarea":Qn("invalid",a),w=b=m=null;for(U in h)if(h.hasOwnProperty(U)&&(J=h[U],J!=null))switch(U){case"value":m=J;break;case"defaultValue":b=J;break;case"children":w=J;break;case"dangerouslySetInnerHTML":if(J!=null)throw Error(n(91));break;default:Di(a,l,U,J,h,null)}Ui(a,m,b,w);return;case"option":for(ye in h)if(h.hasOwnProperty(ye)&&(m=h[ye],m!=null))switch(ye){case"selected":a.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Di(a,l,ye,m,h,null)}return;case"dialog":Qn("beforetoggle",a),Qn("toggle",a),Qn("cancel",a),Qn("close",a);break;case"iframe":case"object":Qn("load",a);break;case"video":case"audio":for(m=0;m<Oa.length;m++)Qn(Oa[m],a);break;case"image":Qn("error",a),Qn("load",a);break;case"details":Qn("toggle",a);break;case"embed":case"source":case"link":Qn("error",a),Qn("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ve in h)if(h.hasOwnProperty(Ve)&&(m=h[Ve],m!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Di(a,l,Ve,m,h,null)}return;default:if(ga(l)){for(lt in h)h.hasOwnProperty(lt)&&(m=h[lt],m!==void 0&&BS(a,l,lt,m,h,void 0));return}}for(J in h)h.hasOwnProperty(J)&&(m=h[J],m!=null&&Di(a,l,J,m,h,null))}function eB(a,l,h,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,w=null,U=null,J=null,ye=null,Ve=null,lt=null;for(rt in h){var gt=h[rt];if(h.hasOwnProperty(rt)&&gt!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":ye=gt;default:m.hasOwnProperty(rt)||Di(a,l,rt,null,m,gt)}}for(var Xe in m){var rt=m[Xe];if(gt=h[Xe],m.hasOwnProperty(Xe)&&(rt!=null||gt!=null))switch(Xe){case"type":w=rt;break;case"name":b=rt;break;case"checked":Ve=rt;break;case"defaultChecked":lt=rt;break;case"value":U=rt;break;case"defaultValue":J=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,l));break;default:rt!==gt&&Di(a,l,Xe,rt,m,gt)}}Qt(a,U,J,ye,Ve,lt,w,b);return;case"select":rt=U=J=Xe=null;for(w in h)if(ye=h[w],h.hasOwnProperty(w)&&ye!=null)switch(w){case"value":break;case"multiple":rt=ye;default:m.hasOwnProperty(w)||Di(a,l,w,null,m,ye)}for(b in m)if(w=m[b],ye=h[b],m.hasOwnProperty(b)&&(w!=null||ye!=null))switch(b){case"value":Xe=w;break;case"defaultValue":J=w;break;case"multiple":U=w;default:w!==ye&&Di(a,l,b,w,m,ye)}l=J,h=U,m=rt,Xe!=null?oi(a,!!h,Xe,!1):!!m!=!!h&&(l!=null?oi(a,!!h,l,!0):oi(a,!!h,h?[]:"",!1));return;case"textarea":rt=Xe=null;for(J in h)if(b=h[J],h.hasOwnProperty(J)&&b!=null&&!m.hasOwnProperty(J))switch(J){case"value":break;case"children":break;default:Di(a,l,J,null,m,b)}for(U in m)if(b=m[U],w=h[U],m.hasOwnProperty(U)&&(b!=null||w!=null))switch(U){case"value":Xe=b;break;case"defaultValue":rt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(n(91));break;default:b!==w&&Di(a,l,U,b,m,w)}En(a,Xe,rt);return;case"option":for(var Kt in h)if(Xe=h[Kt],h.hasOwnProperty(Kt)&&Xe!=null&&!m.hasOwnProperty(Kt))switch(Kt){case"selected":a.selected=!1;break;default:Di(a,l,Kt,null,m,Xe)}for(ye in m)if(Xe=m[ye],rt=h[ye],m.hasOwnProperty(ye)&&Xe!==rt&&(Xe!=null||rt!=null))switch(ye){case"selected":a.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:Di(a,l,ye,Xe,m,rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var hn in h)Xe=h[hn],h.hasOwnProperty(hn)&&Xe!=null&&!m.hasOwnProperty(hn)&&Di(a,l,hn,null,m,Xe);for(Ve in m)if(Xe=m[Ve],rt=h[Ve],m.hasOwnProperty(Ve)&&Xe!==rt&&(Xe!=null||rt!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(n(137,l));break;default:Di(a,l,Ve,Xe,m,rt)}return;default:if(ga(l)){for(var Ii in h)Xe=h[Ii],h.hasOwnProperty(Ii)&&Xe!==void 0&&!m.hasOwnProperty(Ii)&&BS(a,l,Ii,void 0,m,Xe);for(lt in m)Xe=m[lt],rt=h[lt],!m.hasOwnProperty(lt)||Xe===rt||Xe===void 0&&rt===void 0||BS(a,l,lt,Xe,m,rt);return}}for(var Le in h)Xe=h[Le],h.hasOwnProperty(Le)&&Xe!=null&&!m.hasOwnProperty(Le)&&Di(a,l,Le,null,m,Xe);for(gt in m)Xe=m[gt],rt=h[gt],!m.hasOwnProperty(gt)||Xe===rt||Xe==null&&rt==null||Di(a,l,gt,Xe,m,rt)}function fw(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tB(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,h=performance.getEntriesByType("resource"),m=0;m<h.length;m++){var b=h[m],w=b.transferSize,U=b.initiatorType,J=b.duration;if(w&&J&&fw(U)){for(U=0,J=b.responseEnd,m+=1;m<h.length;m++){var ye=h[m],Ve=ye.startTime;if(Ve>J)break;var lt=ye.transferSize,gt=ye.initiatorType;lt&&fw(gt)&&(ye=ye.responseEnd,U+=lt*(ye<J?1:(J-Ve)/(ye-Ve)))}if(--m,l+=8*(w+U)/(b.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var NS=null,OS=null;function _x(a){return a.nodeType===9?a:a.ownerDocument}function hw(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pw(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function LS(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var PS=null;function nB(){var a=window.event;return a&&a.type==="popstate"?a===PS?!1:(PS=a,!0):(PS=null,!1)}var mw=typeof setTimeout=="function"?setTimeout:void 0,iB=typeof clearTimeout=="function"?clearTimeout:void 0,gw=typeof Promise=="function"?Promise:void 0,rB=typeof queueMicrotask=="function"?queueMicrotask:typeof gw<"u"?function(a){return gw.resolve(null).then(a).catch(sB)}:mw;function sB(a){setTimeout(function(){throw a})}function Yu(a){return a==="head"}function vw(a,l){var h=l,m=0;do{var b=h.nextSibling;if(a.removeChild(h),b&&b.nodeType===8)if(h=b.data,h==="/$"||h==="/&"){if(m===0){a.removeChild(b),xp(l);return}m--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")m++;else if(h==="html")og(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,og(h);for(var w=h.firstChild;w;){var U=w.nextSibling,J=w.nodeName;w[N]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&w.rel.toLowerCase()==="stylesheet"||h.removeChild(w),w=U}}else h==="body"&&og(a.ownerDocument.body);h=b}while(h);xp(l)}function xw(a,l){var h=a;a=0;do{var m=h.nextSibling;if(h.nodeType===1?l?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(l?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),m&&m.nodeType===8)if(h=m.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=m}while(h)}function US(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":US(h),k(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function aB(a,l,h,m){for(;a.nodeType===1;){var b=h;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[N])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(w=a.getAttribute("rel"),w==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(w!==b.rel||a.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||a.getAttribute("title")!==(b.title==null?null:b.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(w=a.getAttribute("src"),(w!==(b.src==null?null:b.src)||a.getAttribute("type")!==(b.type==null?null:b.type)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&w&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var w=b.name==null?null:""+b.name;if(b.type==="hidden"&&a.getAttribute("name")===w)return a}else return a;if(a=To(a.nextSibling),a===null)break}return null}function oB(a,l,h){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=To(a.nextSibling),a===null))return null;return a}function yw(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=To(a.nextSibling),a===null))return null;return a}function FS(a){return a.data==="$?"||a.data==="$~"}function zS(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function lB(a,l){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||h.readyState!=="loading")l();else{var m=function(){l(),h.removeEventListener("DOMContentLoaded",m)};h.addEventListener("DOMContentLoaded",m),a._reactRetry=m}}function To(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var HS=null;function Aw(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(l===0)return To(a.nextSibling);l--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||l++}a=a.nextSibling}return null}function _w(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(l===0)return a;l--}else h!=="/$"&&h!=="/&"||l++}a=a.previousSibling}return null}function Sw(a,l,h){switch(l=_x(h),a){case"html":if(a=l.documentElement,!a)throw Error(n(452));return a;case"head":if(a=l.head,!a)throw Error(n(453));return a;case"body":if(a=l.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function og(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);k(a)}var wo=new Map,bw=new Set;function Sx(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Fc=re.d;re.d={f:cB,r:uB,D:dB,C:fB,L:hB,m:pB,X:gB,S:mB,M:vB};function cB(){var a=Fc.f(),l=Xa();return a||l}function uB(a){var l=ue(a);l!==null&&l.tag===5&&l.type==="form"?rx(l):Fc.r(a)}var mp=typeof document>"u"?null:document;function Ew(a,l,h){var m=mp;if(m&&typeof l=="string"&&l){var b=St(l);b='link[rel="'+a+'"][href="'+b+'"]',typeof h=="string"&&(b+='[crossorigin="'+h+'"]'),bw.has(b)||(bw.add(b),a={rel:a,crossOrigin:h,href:l},m.querySelector(b)===null&&(l=m.createElement("link"),bs(l,"link",a),P(l),m.head.appendChild(l)))}}function dB(a){Fc.D(a),Ew("dns-prefetch",a,null)}function fB(a,l){Fc.C(a,l),Ew("preconnect",a,l)}function hB(a,l,h){Fc.L(a,l,h);var m=mp;if(m&&a&&l){var b='link[rel="preload"][as="'+St(l)+'"]';l==="image"&&h&&h.imageSrcSet?(b+='[imagesrcset="'+St(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(b+='[imagesizes="'+St(h.imageSizes)+'"]')):b+='[href="'+St(a)+'"]';var w=b;switch(l){case"style":w=gp(a);break;case"script":w=vp(a)}wo.has(w)||(a=v({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:a,as:l},h),wo.set(w,a),m.querySelector(b)!==null||l==="style"&&m.querySelector(lg(w))||l==="script"&&m.querySelector(cg(w))||(l=m.createElement("link"),bs(l,"link",a),P(l),m.head.appendChild(l)))}}function pB(a,l){Fc.m(a,l);var h=mp;if(h&&a){var m=l&&typeof l.as=="string"?l.as:"script",b='link[rel="modulepreload"][as="'+St(m)+'"][href="'+St(a)+'"]',w=b;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=vp(a)}if(!wo.has(w)&&(a=v({rel:"modulepreload",href:a},l),wo.set(w,a),h.querySelector(b)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(cg(w)))return}m=h.createElement("link"),bs(m,"link",a),P(m),h.head.appendChild(m)}}}function mB(a,l,h){Fc.S(a,l,h);var m=mp;if(m&&a){var b=De(m).hoistableStyles,w=gp(a);l=l||"default";var U=b.get(w);if(!U){var J={loading:0,preload:null};if(U=m.querySelector(lg(w)))J.loading=5;else{a=v({rel:"stylesheet",href:a,"data-precedence":l},h),(h=wo.get(w))&&GS(a,h);var ye=U=m.createElement("link");P(ye),bs(ye,"link",a),ye._p=new Promise(function(Ve,lt){ye.onload=Ve,ye.onerror=lt}),ye.addEventListener("load",function(){J.loading|=1}),ye.addEventListener("error",function(){J.loading|=2}),J.loading|=4,bx(U,l,m)}U={type:"stylesheet",instance:U,count:1,state:J},b.set(w,U)}}}function gB(a,l){Fc.X(a,l);var h=mp;if(h&&a){var m=De(h).hoistableScripts,b=vp(a),w=m.get(b);w||(w=h.querySelector(cg(b)),w||(a=v({src:a,async:!0},l),(l=wo.get(b))&&kS(a,l),w=h.createElement("script"),P(w),bs(w,"link",a),h.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},m.set(b,w))}}function vB(a,l){Fc.M(a,l);var h=mp;if(h&&a){var m=De(h).hoistableScripts,b=vp(a),w=m.get(b);w||(w=h.querySelector(cg(b)),w||(a=v({src:a,async:!0,type:"module"},l),(l=wo.get(b))&&kS(a,l),w=h.createElement("script"),P(w),bs(w,"link",a),h.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},m.set(b,w))}}function Mw(a,l,h,m){var b=(b=ve.current)?Sx(b):null;if(!b)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=gp(h.href),h=De(b).hoistableStyles,m=h.get(l),m||(m={type:"style",instance:null,count:0,state:null},h.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=gp(h.href);var w=De(b).hoistableStyles,U=w.get(a);if(U||(b=b.ownerDocument||b,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(a,U),(w=b.querySelector(lg(a)))&&!w._p&&(U.instance=w,U.state.loading=5),wo.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},wo.set(a,h),w||xB(b,a,h,U.state))),l&&m===null)throw Error(n(528,""));return U}if(l&&m!==null)throw Error(n(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=vp(h),h=De(b).hoistableScripts,m=h.get(l),m||(m={type:"script",instance:null,count:0,state:null},h.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function gp(a){return'href="'+St(a)+'"'}function lg(a){return'link[rel="stylesheet"]['+a+"]"}function Tw(a){return v({},a,{"data-precedence":a.precedence,precedence:null})}function xB(a,l,h,m){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=a.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),bs(l,"link",h),P(l),a.head.appendChild(l))}function vp(a){return'[src="'+St(a)+'"]'}function cg(a){return"script[async]"+a}function ww(a,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var m=a.querySelector('style[data-href~="'+St(h.href)+'"]');if(m)return l.instance=m,P(m),m;var b=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),P(m),bs(m,"style",b),bx(m,h.precedence,a),l.instance=m;case"stylesheet":b=gp(h.href);var w=a.querySelector(lg(b));if(w)return l.state.loading|=4,l.instance=w,P(w),w;m=Tw(h),(b=wo.get(b))&&GS(m,b),w=(a.ownerDocument||a).createElement("link"),P(w);var U=w;return U._p=new Promise(function(J,ye){U.onload=J,U.onerror=ye}),bs(w,"link",m),l.state.loading|=4,bx(w,h.precedence,a),l.instance=w;case"script":return w=vp(h.src),(b=a.querySelector(cg(w)))?(l.instance=b,P(b),b):(m=h,(b=wo.get(w))&&(m=v({},h),kS(m,b)),a=a.ownerDocument||a,b=a.createElement("script"),P(b),bs(b,"link",m),a.head.appendChild(b),l.instance=b);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(m=l.instance,l.state.loading|=4,bx(m,h.precedence,a));return l.instance}function bx(a,l,h){for(var m=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=m.length?m[m.length-1]:null,w=b,U=0;U<m.length;U++){var J=m[U];if(J.dataset.precedence===l)w=J;else if(w!==b)break}w?w.parentNode.insertBefore(a,w.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(a,l.firstChild))}function GS(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function kS(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var Ex=null;function Cw(a,l,h){if(Ex===null){var m=new Map,b=Ex=new Map;b.set(h,m)}else b=Ex,m=b.get(h),m||(m=new Map,b.set(h,m));if(m.has(a))return m;for(m.set(a,null),h=h.getElementsByTagName(a),b=0;b<h.length;b++){var w=h[b];if(!(w[N]||w[bi]||a==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var U=w.getAttribute(l)||"";U=a+U;var J=m.get(U);J?J.push(w):m.set(U,[w])}}return m}function Rw(a,l,h){a=a.ownerDocument||a,a.head.insertBefore(h,l==="title"?a.querySelector("head > title"):null)}function yB(a,l,h){if(h===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Dw(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function AB(a,l,h,m){if(h.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var b=gp(m.href),w=l.querySelector(lg(b));if(w){l=w._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=Mx.bind(a),l.then(a,a)),h.state.loading|=4,h.instance=w,P(w);return}w=l.ownerDocument||l,m=Tw(m),(b=wo.get(b))&&GS(m,b),w=w.createElement("link"),P(w);var U=w;U._p=new Promise(function(J,ye){U.onload=J,U.onerror=ye}),bs(w,"link",m),h.instance=w}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=Mx.bind(a),l.addEventListener("load",h),l.addEventListener("error",h))}}var VS=0;function _B(a,l){return a.stylesheets&&a.count===0&&wx(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var m=setTimeout(function(){if(a.stylesheets&&wx(a,a.stylesheets),a.unsuspend){var w=a.unsuspend;a.unsuspend=null,w()}},6e4+l);0<a.imgBytes&&VS===0&&(VS=62500*tB());var b=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&wx(a,a.stylesheets),a.unsuspend)){var w=a.unsuspend;a.unsuspend=null,w()}},(a.imgBytes>VS?50:800)+l);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(m),clearTimeout(b)}}:null}function Mx(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)wx(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Tx=null;function wx(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Tx=new Map,l.forEach(SB,a),Tx=null,Mx.call(a))}function SB(a,l){if(!(l.state.loading&4)){var h=Tx.get(a);if(h)var m=h.get(null);else{h=new Map,Tx.set(a,h);for(var b=a.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<b.length;w++){var U=b[w];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(h.set(U.dataset.precedence,U),m=U)}m&&h.set(null,m)}b=l.instance,U=b.getAttribute("data-precedence"),w=h.get(U)||m,w===m&&h.set(null,b),h.set(U,b),this.count++,m=Mx.bind(this),b.addEventListener("load",m),b.addEventListener("error",m),w?w.parentNode.insertBefore(b,w.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(b,a.firstChild)),l.state.loading|=4}}var ug={$$typeof:I,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function bB(a,l,h,m,b,w,U,J,ye){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_n(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_n(0),this.hiddenUpdates=_n(null),this.identifierPrefix=m,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ye,this.incompleteTransitions=new Map}function Iw(a,l,h,m,b,w,U,J,ye,Ve,lt,gt){return a=new bB(a,l,h,U,ye,Ve,lt,gt,J),l=1,w===!0&&(l|=24),w=Wi(3,null,null,l),a.current=w,w.stateNode=a,l=p0(),l.refCount++,a.pooledCache=l,l.refCount++,w.memoizedState={element:m,isDehydrated:h,cache:l},Qd(w),a}function Bw(a){return a?(a=El,a):El}function Nw(a,l,h,m,b,w){b=Bw(b),m.context===null?m.context=b:m.pendingContext=b,m=Yo(l),m.payload={element:h},w=w===void 0?null:w,w!==null&&(m.callback=w),h=Bl(a,m,l),h!==null&&(In(h,a,l),Nl(h,a,l))}function Ow(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<l?h:l}}function jS(a,l){Ow(a,l),(a=a.alternate)&&Ow(a,l)}function Lw(a){if(a.tag===13||a.tag===31){var l=gs(a,67108864);l!==null&&In(l,a,67108864),jS(a,67108864)}}function Pw(a){if(a.tag===13||a.tag===31){var l=ea();l=ma(l);var h=gs(a,l);h!==null&&In(h,a,l),jS(a,l)}}var Cx=!0;function EB(a,l,h,m){var b=X.T;X.T=null;var w=re.p;try{re.p=2,WS(a,l,h,m)}finally{re.p=w,X.T=b}}function MB(a,l,h,m){var b=X.T;X.T=null;var w=re.p;try{re.p=8,WS(a,l,h,m)}finally{re.p=w,X.T=b}}function WS(a,l,h,m){if(Cx){var b=XS(m);if(b===null)IS(a,l,m,Rx,h),Fw(a,m);else if(wB(b,a,l,h,m))m.stopPropagation();else if(Fw(a,m),l&4&&-1<TB.indexOf(a)){for(;b!==null;){var w=ue(b);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var U=_t(w.pendingLanes);if(U!==0){var J=w;for(J.pendingLanes|=2,J.entangledLanes|=2;U;){var ye=1<<31-he(U);J.entanglements[1]|=ye,U&=~ye}Ct(w),(tn&6)===0&&(dr=G()+500,Xt(0))}}break;case 31:case 13:J=gs(w,2),J!==null&&In(J,w,2),Xa(),jS(w,2)}if(w=XS(m),w===null&&IS(a,l,m,Rx,h),w===b)break;b=w}b!==null&&m.stopPropagation()}else IS(a,l,m,null,h)}}function XS(a){return a=ph(a),YS(a)}var Rx=null;function YS(a){if(Rx=null,a=$(a),a!==null){var l=s(a);if(l===null)a=null;else{var h=l.tag;if(h===13){if(a=o(l),a!==null)return a;a=null}else if(h===31){if(a=u(l),a!==null)return a;a=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return Rx=a,null}function Uw(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(be()){case Ye:return 2;case ot:return 8;case Qe:case Ut:return 32;case Rt:return 268435456;default:return 32}default:return 32}}var QS=!1,Qu=null,qu=null,Ju=null,dg=new Map,fg=new Map,Ku=[],TB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Fw(a,l){switch(a){case"focusin":case"focusout":Qu=null;break;case"dragenter":case"dragleave":qu=null;break;case"mouseover":case"mouseout":Ju=null;break;case"pointerover":case"pointerout":dg.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":fg.delete(l.pointerId)}}function hg(a,l,h,m,b,w){return a===null||a.nativeEvent!==w?(a={blockedOn:l,domEventName:h,eventSystemFlags:m,nativeEvent:w,targetContainers:[b]},l!==null&&(l=ue(l),l!==null&&Lw(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,b!==null&&l.indexOf(b)===-1&&l.push(b),a)}function wB(a,l,h,m,b){switch(l){case"focusin":return Qu=hg(Qu,a,l,h,m,b),!0;case"dragenter":return qu=hg(qu,a,l,h,m,b),!0;case"mouseover":return Ju=hg(Ju,a,l,h,m,b),!0;case"pointerover":var w=b.pointerId;return dg.set(w,hg(dg.get(w)||null,a,l,h,m,b)),!0;case"gotpointercapture":return w=b.pointerId,fg.set(w,hg(fg.get(w)||null,a,l,h,m,b)),!0}return!1}function zw(a){var l=$(a.target);if(l!==null){var h=s(l);if(h!==null){if(l=h.tag,l===13){if(l=o(h),l!==null){a.blockedOn=l,rn(a.priority,function(){Pw(h)});return}}else if(l===31){if(l=u(h),l!==null){a.blockedOn=l,rn(a.priority,function(){Pw(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Dx(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var h=XS(a.nativeEvent);if(h===null){h=a.nativeEvent;var m=new h.constructor(h.type,h);hh=m,h.target.dispatchEvent(m),hh=null}else return l=ue(h),l!==null&&Lw(l),a.blockedOn=h,!1;l.shift()}return!0}function Hw(a,l,h){Dx(a)&&h.delete(l)}function CB(){QS=!1,Qu!==null&&Dx(Qu)&&(Qu=null),qu!==null&&Dx(qu)&&(qu=null),Ju!==null&&Dx(Ju)&&(Ju=null),dg.forEach(Hw),fg.forEach(Hw)}function Ix(a,l){a.blockedOn===l&&(a.blockedOn=null,QS||(QS=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,CB)))}var Bx=null;function Gw(a){Bx!==a&&(Bx=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Bx===a&&(Bx=null);for(var l=0;l<a.length;l+=3){var h=a[l],m=a[l+1],b=a[l+2];if(typeof m!="function"){if(YS(m||h)===null)continue;break}var w=ue(h);w!==null&&(a.splice(l,3),l-=3,G0(w,{pending:!0,data:b,method:h.method,action:m},m,b))}}))}function xp(a){function l(ye){return Ix(ye,a)}Qu!==null&&Ix(Qu,a),qu!==null&&Ix(qu,a),Ju!==null&&Ix(Ju,a),dg.forEach(l),fg.forEach(l);for(var h=0;h<Ku.length;h++){var m=Ku[h];m.blockedOn===a&&(m.blockedOn=null)}for(;0<Ku.length&&(h=Ku[0],h.blockedOn===null);)zw(h),h.blockedOn===null&&Ku.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(m=0;m<h.length;m+=3){var b=h[m],w=h[m+1],U=b[V]||null;if(typeof w=="function")U||Gw(h);else if(U){var J=null;if(w&&w.hasAttribute("formAction")){if(b=w,U=w[V]||null)J=U.formAction;else if(YS(b)!==null)continue}else J=U.action;typeof J=="function"?h[m+1]=J:(h.splice(m,3),m-=3),Gw(h)}}}function kw(){function a(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(U){return b=U})},focusReset:"manual",scroll:"manual"})}function l(){b!==null&&(b(),b=null),m||setTimeout(h,20)}function h(){if(!m&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,b=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(h,100),function(){m=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),b!==null&&(b(),b=null)}}}function qS(a){this._internalRoot=a}Nx.prototype.render=qS.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));var h=l.current,m=ea();Nw(h,m,a,l,null,null)},Nx.prototype.unmount=qS.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Nw(a.current,2,null,a,null,null),Xa(),l[ee]=null}};function Nx(a){this._internalRoot=a}Nx.prototype.unstable_scheduleHydration=function(a){if(a){var l=is();a={blockedOn:null,target:a,priority:l};for(var h=0;h<Ku.length&&l!==0&&l<Ku[h].priority;h++);Ku.splice(h,0,a),h===0&&zw(a)}};var Vw=e.version;if(Vw!=="19.2.4")throw Error(n(527,Vw,"19.2.4"));re.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=p(l),a=a!==null?g(a):null,a=a===null?null:a.stateNode,a};var RB={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ox=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ox.isDisabled&&Ox.supportsFiber)try{vt=Ox.inject(RB),ct=Ox}catch{}}return mg.createRoot=function(a,l){if(!r(a))throw Error(n(299));var h=!1,m="",b=dx,w=Y0,U=Q0;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(b=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(U=l.onRecoverableError)),l=Iw(a,1,!1,null,null,h,m,null,b,w,U,kw),a[ee]=l.current,DS(a),new qS(l)},mg.hydrateRoot=function(a,l,h){if(!r(a))throw Error(n(299));var m=!1,b="",w=dx,U=Y0,J=Q0,ye=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(b=h.identifierPrefix),h.onUncaughtError!==void 0&&(w=h.onUncaughtError),h.onCaughtError!==void 0&&(U=h.onCaughtError),h.onRecoverableError!==void 0&&(J=h.onRecoverableError),h.formState!==void 0&&(ye=h.formState)),l=Iw(a,1,!0,l,h??null,m,b,ye,w,U,J,kw),l.context=Bw(null),h=l.current,m=ea(),m=ma(m),b=Yo(m),b.callback=null,Bl(h,b,m),h=m,l.current.lanes=h,Si(l,h),Ct(l),a[ee]=l.current,DS(a),new Nx(l)},mg.version="19.2.4",mg}var $w;function HB(){if($w)return ZS.exports;$w=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),ZS.exports=zB(),ZS.exports}var l2=HB();const GB=Tv(l2);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const lu="182",If={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Bf={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},c2=0,TE=1,u2=2,kB=3,d2=0,am=1,Qg=2,Pf=3,ml=0,jr=1,Vr=2,Pi=0,jf=1,wE=2,CE=3,RE=4,CM=5,$l=100,f2=101,h2=102,p2=103,m2=104,g2=200,$p=201,v2=202,x2=203,eA=204,tA=205,y2=206,A2=207,_2=208,S2=209,b2=210,E2=211,M2=212,T2=213,w2=214,nA=0,uv=1,iA=2,Jf=3,rA=4,sA=5,aA=6,oA=7,Rv=0,C2=1,R2=2,aa=0,RM=1,DM=2,IM=3,Dv=4,BM=5,NM=6,OM=7,DE="attached",D2="detached",vd=300,gl=301,xd=302,hm=303,dv=304,Dm=306,Lo=1e3,Ni=1001,pm=1002,di=1003,h_=1004,VB=1004,Uf=1005,jB=1005,on=1006,om=1007,WB=1007,Ka=1008,IE=1008,_i=1009,Iv=1010,Bv=1011,Kf=1012,Im=1013,ca=1014,si=1015,On=1016,p_=1017,m_=1018,Zf=1020,LM=35902,PM=35899,UM=1021,FM=1022,Ai=1023,rc=1026,nu=1027,tc=1028,Nv=1029,Bo=1030,g_=1031,XB=1032,v_=1033,qg=33776,Jg=33777,Kg=33778,Zg=33779,lA=35840,cA=35841,uA=35842,dA=35843,fA=36196,hA=37492,pA=37496,mA=37488,gA=37489,vA=37490,xA=37491,yA=37808,AA=37809,_A=37810,SA=37811,bA=37812,EA=37813,MA=37814,TA=37815,wA=37816,CA=37817,RA=37818,DA=37819,IA=37820,BA=37821,NA=36492,OA=36494,LA=36495,PA=36283,UA=36284,FA=36285,zA=36286,I2=2200,B2=2201,N2=2202,mm=2300,gm=2301,Xy=2302,Ff=2400,zf=2401,fv=2402,x_=2500,zM=2501,O2=0,HM=1,HA=2,Uo=3200,YB=3201,QB=3202,qB=3203,Sd=0,L2=1,Ja="",Hn="srgb",kr="srgb-linear",hv="linear",yi="srgb",JB="",KB="rg",ZB="ga",$B=0,Nf=7680,eN=7681,tN=7682,nN=7683,iN=34055,rN=34056,sN=5386,aN=512,oN=513,lN=514,cN=515,uN=516,dN=517,fN=518,BE=519,P2=512,U2=513,F2=514,y_=515,z2=516,H2=517,A_=518,G2=519,pv=35044,hN=35048,pN=35040,mN=35045,gN=35049,vN=35041,xN=35046,yN=35050,AN=35042,_N="100",vm="300 es",Za=2e3,xm=2001,SN={COMPUTE:"compute",RENDER:"render"},bN={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},EN={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function k2(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const MN={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function em(i,e){return new MN[i](e)}function V2(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function mv(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function j2(){const i=mv("canvas");return i.style.display="block",i}const eC={};let yd=null;function TN(i){yd=i}function wN(){return yd}function gv(...i){const e="THREE."+i.shift();yd?yd("log",e,...i):console.log(e,...i)}function Ht(...i){const e="THREE."+i.shift();yd?yd("warn",e,...i):console.warn(e,...i)}function nn(...i){const e="THREE."+i.shift();yd?yd("error",e,...i):console.error(e,...i)}function ym(...i){const e=i.join(" ");e in eC||(eC[e]=!0,Ht(...i))}function CN(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}let eo=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const Fs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let tC=1234567;const Wf=Math.PI/180,Am=180/Math.PI;function $a(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Fs[i&255]+Fs[i>>8&255]+Fs[i>>16&255]+Fs[i>>24&255]+"-"+Fs[e&255]+Fs[e>>8&255]+"-"+Fs[e>>16&15|64]+Fs[e>>24&255]+"-"+Fs[t&63|128]+Fs[t>>8&255]+"-"+Fs[t>>16&255]+Fs[t>>24&255]+Fs[n&255]+Fs[n>>8&255]+Fs[n>>16&255]+Fs[n>>24&255]).toLowerCase()}function gn(i,e,t){return Math.max(e,Math.min(t,i))}function GM(i,e){return(i%e+e)%e}function RN(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function DN(i,e,t){return i!==e?(t-i)/(e-i):0}function $g(i,e,t){return(1-t)*i+t*e}function IN(i,e,t,n){return $g(i,e,1-Math.exp(-t*n))}function BN(i,e=1){return e-Math.abs(GM(i,e*2)-e)}function NN(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function ON(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function LN(i,e){return i+Math.floor(Math.random()*(e-i+1))}function PN(i,e){return i+Math.random()*(e-i)}function UN(i){return i*(.5-Math.random())}function FN(i){i!==void 0&&(tC=i);let e=tC+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function zN(i){return i*Wf}function HN(i){return i*Am}function GN(i){return(i&i-1)===0&&i!==0}function kN(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function VN(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function jN(i,e,t,n,r){const s=Math.cos,o=Math.sin,u=s(t/2),f=o(t/2),p=s((e+n)/2),g=o((e+n)/2),v=s((e-n)/2),y=o((e-n)/2),A=s((n-e)/2),S=o((n-e)/2);switch(r){case"XYX":i.set(u*g,f*v,f*y,u*p);break;case"YZY":i.set(f*y,u*g,f*v,u*p);break;case"ZXZ":i.set(f*v,f*y,u*g,u*p);break;case"XZX":i.set(u*g,f*S,f*A,u*p);break;case"YXY":i.set(f*A,u*g,f*S,u*p);break;case"ZYZ":i.set(f*S,f*A,u*g,u*p);break;default:Ht("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function sa(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Bn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const to={DEG2RAD:Wf,RAD2DEG:Am,generateUUID:$a,clamp:gn,euclideanModulo:GM,mapLinear:RN,inverseLerp:DN,lerp:$g,damp:IN,pingpong:BN,smoothstep:NN,smootherstep:ON,randInt:LN,randFloat:PN,randFloatSpread:UN,seededRandom:FN,degToRad:zN,radToDeg:HN,isPowerOfTwo:GN,ceilPowerOfTwo:kN,floorPowerOfTwo:VN,setQuaternionFromProperEuler:jN,normalize:Bn,denormalize:sa};class qe{constructor(e=0,t=0){qe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=gn(this.x,e.x,t.x),this.y=gn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=gn(this.x,e,t),this.y=gn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(gn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(gn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class es{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,u){let f=n[r+0],p=n[r+1],g=n[r+2],v=n[r+3],y=s[o+0],A=s[o+1],S=s[o+2],T=s[o+3];if(u<=0){e[t+0]=f,e[t+1]=p,e[t+2]=g,e[t+3]=v;return}if(u>=1){e[t+0]=y,e[t+1]=A,e[t+2]=S,e[t+3]=T;return}if(v!==T||f!==y||p!==A||g!==S){let M=f*y+p*A+g*S+v*T;M<0&&(y=-y,A=-A,S=-S,T=-T,M=-M);let E=1-u;if(M<.9995){const R=Math.acos(M),I=Math.sin(R);E=Math.sin(E*R)/I,u=Math.sin(u*R)/I,f=f*E+y*u,p=p*E+A*u,g=g*E+S*u,v=v*E+T*u}else{f=f*E+y*u,p=p*E+A*u,g=g*E+S*u,v=v*E+T*u;const R=1/Math.sqrt(f*f+p*p+g*g+v*v);f*=R,p*=R,g*=R,v*=R}}e[t]=f,e[t+1]=p,e[t+2]=g,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,r,s,o){const u=n[r],f=n[r+1],p=n[r+2],g=n[r+3],v=s[o],y=s[o+1],A=s[o+2],S=s[o+3];return e[t]=u*S+g*v+f*A-p*y,e[t+1]=f*S+g*y+p*v-u*A,e[t+2]=p*S+g*A+u*y-f*v,e[t+3]=g*S-u*v-f*y-p*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,o=e._order,u=Math.cos,f=Math.sin,p=u(n/2),g=u(r/2),v=u(s/2),y=f(n/2),A=f(r/2),S=f(s/2);switch(o){case"XYZ":this._x=y*g*v+p*A*S,this._y=p*A*v-y*g*S,this._z=p*g*S+y*A*v,this._w=p*g*v-y*A*S;break;case"YXZ":this._x=y*g*v+p*A*S,this._y=p*A*v-y*g*S,this._z=p*g*S-y*A*v,this._w=p*g*v+y*A*S;break;case"ZXY":this._x=y*g*v-p*A*S,this._y=p*A*v+y*g*S,this._z=p*g*S+y*A*v,this._w=p*g*v-y*A*S;break;case"ZYX":this._x=y*g*v-p*A*S,this._y=p*A*v+y*g*S,this._z=p*g*S-y*A*v,this._w=p*g*v+y*A*S;break;case"YZX":this._x=y*g*v+p*A*S,this._y=p*A*v+y*g*S,this._z=p*g*S-y*A*v,this._w=p*g*v-y*A*S;break;case"XZY":this._x=y*g*v-p*A*S,this._y=p*A*v-y*g*S,this._z=p*g*S+y*A*v,this._w=p*g*v+y*A*S;break;default:Ht("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],u=t[5],f=t[9],p=t[2],g=t[6],v=t[10],y=n+u+v;if(y>0){const A=.5/Math.sqrt(y+1);this._w=.25/A,this._x=(g-f)*A,this._y=(s-p)*A,this._z=(o-r)*A}else if(n>u&&n>v){const A=2*Math.sqrt(1+n-u-v);this._w=(g-f)/A,this._x=.25*A,this._y=(r+o)/A,this._z=(s+p)/A}else if(u>v){const A=2*Math.sqrt(1+u-n-v);this._w=(s-p)/A,this._x=(r+o)/A,this._y=.25*A,this._z=(f+g)/A}else{const A=2*Math.sqrt(1+v-n-u);this._w=(o-r)/A,this._x=(s+p)/A,this._y=(f+g)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(gn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,u=t._x,f=t._y,p=t._z,g=t._w;return this._x=n*g+o*u+r*p-s*f,this._y=r*g+o*f+s*u-n*p,this._z=s*g+o*p+n*f-r*u,this._w=o*g-n*u-r*f-s*p,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,s=e._z,o=e._w,u=this.dot(e);u<0&&(n=-n,r=-r,s=-s,o=-o,u=-u);let f=1-t;if(u<.9995){const p=Math.acos(u),g=Math.sin(p);f=Math.sin(f*p)/g,t=Math.sin(t*p)/g,this._x=this._x*f+n*t,this._y=this._y*f+r*t,this._z=this._z*f+s*t,this._w=this._w*f+o*t,this._onChangeCallback()}else this._x=this._x*f+n*t,this._y=this._y*f+r*t,this._z=this._z*f+s*t,this._w=this._w*f+o*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,n=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(nC.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(nC.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,u=e.z,f=e.w,p=2*(o*r-u*n),g=2*(u*t-s*r),v=2*(s*n-o*t);return this.x=t+f*p+o*v-u*g,this.y=n+f*g+u*p-s*v,this.z=r+f*v+s*g-o*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=gn(this.x,e.x,t.x),this.y=gn(this.y,e.y,t.y),this.z=gn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=gn(this.x,e,t),this.y=gn(this.y,e,t),this.z=gn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(gn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,u=t.y,f=t.z;return this.x=r*f-s*u,this.y=s*o-n*f,this.z=n*u-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return nb.copy(this).projectOnVector(e),this.sub(nb)}reflect(e){return this.sub(nb.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(gn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const nb=new Q,nC=new es;class An{constructor(e,t,n,r,s,o,u,f,p){An.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,u,f,p)}set(e,t,n,r,s,o,u,f,p){const g=this.elements;return g[0]=e,g[1]=r,g[2]=u,g[3]=t,g[4]=s,g[5]=f,g[6]=n,g[7]=o,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],u=n[3],f=n[6],p=n[1],g=n[4],v=n[7],y=n[2],A=n[5],S=n[8],T=r[0],M=r[3],E=r[6],R=r[1],I=r[4],O=r[7],F=r[2],z=r[5],j=r[8];return s[0]=o*T+u*R+f*F,s[3]=o*M+u*I+f*z,s[6]=o*E+u*O+f*j,s[1]=p*T+g*R+v*F,s[4]=p*M+g*I+v*z,s[7]=p*E+g*O+v*j,s[2]=y*T+A*R+S*F,s[5]=y*M+A*I+S*z,s[8]=y*E+A*O+S*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],u=e[5],f=e[6],p=e[7],g=e[8];return t*o*g-t*u*p-n*s*g+n*u*f+r*s*p-r*o*f}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],u=e[5],f=e[6],p=e[7],g=e[8],v=g*o-u*p,y=u*f-g*s,A=p*s-o*f,S=t*v+n*y+r*A;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=v*T,e[1]=(r*p-g*n)*T,e[2]=(u*n-r*o)*T,e[3]=y*T,e[4]=(g*t-r*f)*T,e[5]=(r*s-u*t)*T,e[6]=A*T,e[7]=(n*f-p*t)*T,e[8]=(o*t-n*s)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,u){const f=Math.cos(s),p=Math.sin(s);return this.set(n*f,n*p,-n*(f*o+p*u)+o+e,-r*p,r*f,-r*(-p*o+f*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(ib.makeScale(e,t)),this}rotate(e){return this.premultiply(ib.makeRotation(-e)),this}translate(e,t){return this.premultiply(ib.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ib=new An,iC=new An().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),rC=new An().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function WN(){const i={enabled:!0,workingColorSpace:kr,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===yi&&(r.r=ru(r.r),r.g=ru(r.g),r.b=ru(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===yi&&(r.r=lm(r.r),r.g=lm(r.g),r.b=lm(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Ja?hv:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return ym("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return ym("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[kr]:{primaries:e,whitePoint:n,transfer:hv,toXYZ:iC,fromXYZ:rC,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Hn},outputColorSpaceConfig:{drawingBufferColorSpace:Hn}},[Hn]:{primaries:e,whitePoint:n,transfer:yi,toXYZ:iC,fromXYZ:rC,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Hn}}}),i}const $n=WN();function ru(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function lm(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let yp;class W2{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{yp===void 0&&(yp=mv("canvas")),yp.width=e.width,yp.height=e.height;const r=yp.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=yp}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=mv("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=ru(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(ru(t[n]/255)*255):t[n]=ru(t[n]);return{data:t,width:e.width,height:e.height}}else return Ht("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let XN=0;class fd{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:XN++}),this.uuid=$a(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,u=r.length;o<u;o++)r[o].isDataTexture?s.push(rb(r[o].image)):s.push(rb(r[o]))}else s=rb(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function rb(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?W2.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Ht("Texture: Unable to serialize Texture."),{})}let YN=0;const sb=new Q;class Jn extends eo{constructor(e=Jn.DEFAULT_IMAGE,t=Jn.DEFAULT_MAPPING,n=Ni,r=Ni,s=on,o=Ka,u=Ai,f=_i,p=Jn.DEFAULT_ANISOTROPY,g=Ja){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:YN++}),this.uuid=$a(),this.name="",this.source=new fd(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=f,this.offset=new qe(0,0),this.repeat=new qe(1,1),this.center=new qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new An,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(sb).x}get height(){return this.source.getSize(sb).y}get depth(){return this.source.getSize(sb).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Ht(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Ht(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Lo:e.x=e.x-Math.floor(e.x);break;case Ni:e.x=e.x<0?0:1;break;case pm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Lo:e.y=e.y-Math.floor(e.y);break;case Ni:e.y=e.y<0?0:1;break;case pm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Jn.DEFAULT_IMAGE=null;Jn.DEFAULT_MAPPING=vd;Jn.DEFAULT_ANISOTROPY=1;class Ti{constructor(e=0,t=0,n=0,r=1){Ti.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const f=e.elements,p=f[0],g=f[4],v=f[8],y=f[1],A=f[5],S=f[9],T=f[2],M=f[6],E=f[10];if(Math.abs(g-y)<.01&&Math.abs(v-T)<.01&&Math.abs(S-M)<.01){if(Math.abs(g+y)<.1&&Math.abs(v+T)<.1&&Math.abs(S+M)<.1&&Math.abs(p+A+E-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const I=(p+1)/2,O=(A+1)/2,F=(E+1)/2,z=(g+y)/4,j=(v+T)/4,W=(S+M)/4;return I>O&&I>F?I<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(I),r=z/n,s=j/n):O>F?O<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(O),n=z/r,s=W/r):F<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(F),n=j/s,r=W/s),this.set(n,r,s,t),this}let R=Math.sqrt((M-S)*(M-S)+(v-T)*(v-T)+(y-g)*(y-g));return Math.abs(R)<.001&&(R=1),this.x=(M-S)/R,this.y=(v-T)/R,this.z=(y-g)/R,this.w=Math.acos((p+A+E-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=gn(this.x,e.x,t.x),this.y=gn(this.y,e.y,t.y),this.z=gn(this.z,e.z,t.z),this.w=gn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=gn(this.x,e,t),this.y=gn(this.y,e,t),this.z=gn(this.z,e,t),this.w=gn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(gn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class kM extends eo{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:on,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Ti(0,0,e,t),this.scissorTest=!1,this.viewport=new Ti(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new Jn(r);this.textures=[];const o=n.count;for(let u=0;u<o;u++)this.textures[u]=s.clone(),this.textures[u].isRenderTargetTexture=!0,this.textures[u].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:on,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new fd(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ti extends kM{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class __ extends Jn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=di,this.minFilter=di,this.wrapR=Ni,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class QN extends ti{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new __(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class su extends Jn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=di,this.minFilter=di,this.wrapR=Ni,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class X2 extends ti{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new su(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Es{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(il.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(il.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=il.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,u=s.count;o<u;o++)e.isMesh===!0?e.getVertexPosition(o,il):il.fromBufferAttribute(s,o),il.applyMatrix4(e.matrixWorld),this.expandByPoint(il);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Lx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Lx.copy(n.boundingBox)),Lx.applyMatrix4(e.matrixWorld),this.union(Lx)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,il),il.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gg),Px.subVectors(this.max,gg),Ap.subVectors(e.a,gg),_p.subVectors(e.b,gg),Sp.subVectors(e.c,gg),$u.subVectors(_p,Ap),ed.subVectors(Sp,_p),pf.subVectors(Ap,Sp);let t=[0,-$u.z,$u.y,0,-ed.z,ed.y,0,-pf.z,pf.y,$u.z,0,-$u.x,ed.z,0,-ed.x,pf.z,0,-pf.x,-$u.y,$u.x,0,-ed.y,ed.x,0,-pf.y,pf.x,0];return!ab(t,Ap,_p,Sp,Px)||(t=[1,0,0,0,1,0,0,0,1],!ab(t,Ap,_p,Sp,Px))?!1:(Ux.crossVectors($u,ed),t=[Ux.x,Ux.y,Ux.z],ab(t,Ap,_p,Sp,Px))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,il).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(il).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(zc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),zc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),zc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),zc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),zc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),zc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),zc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),zc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(zc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const zc=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],il=new Q,Lx=new Es,Ap=new Q,_p=new Q,Sp=new Q,$u=new Q,ed=new Q,pf=new Q,gg=new Q,Px=new Q,Ux=new Q,mf=new Q;function ab(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){mf.fromArray(i,s);const u=r.x*Math.abs(mf.x)+r.y*Math.abs(mf.y)+r.z*Math.abs(mf.z),f=e.dot(mf),p=t.dot(mf),g=n.dot(mf);if(Math.max(-Math.max(f,p,g),Math.min(f,p,g))>u)return!1}return!0}const qN=new Es,vg=new Q,ob=new Q;class Wr{constructor(e=new Q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):qN.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;vg.subVectors(e,this.center);const t=vg.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(vg,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ob.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(vg.copy(e.center).add(ob)),this.expandByPoint(vg.copy(e.center).sub(ob))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Hc=new Q,lb=new Q,Fx=new Q,td=new Q,cb=new Q,zx=new Q,ub=new Q;class bd{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Hc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Hc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Hc.copy(this.origin).addScaledVector(this.direction,t),Hc.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){lb.copy(e).add(t).multiplyScalar(.5),Fx.copy(t).sub(e).normalize(),td.copy(this.origin).sub(lb);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Fx),u=td.dot(this.direction),f=-td.dot(Fx),p=td.lengthSq(),g=Math.abs(1-o*o);let v,y,A,S;if(g>0)if(v=o*f-u,y=o*u-f,S=s*g,v>=0)if(y>=-S)if(y<=S){const T=1/g;v*=T,y*=T,A=v*(v+o*y+2*u)+y*(o*v+y+2*f)+p}else y=s,v=Math.max(0,-(o*y+u)),A=-v*v+y*(y+2*f)+p;else y=-s,v=Math.max(0,-(o*y+u)),A=-v*v+y*(y+2*f)+p;else y<=-S?(v=Math.max(0,-(-o*s+u)),y=v>0?-s:Math.min(Math.max(-s,-f),s),A=-v*v+y*(y+2*f)+p):y<=S?(v=0,y=Math.min(Math.max(-s,-f),s),A=y*(y+2*f)+p):(v=Math.max(0,-(o*s+u)),y=v>0?s:Math.min(Math.max(-s,-f),s),A=-v*v+y*(y+2*f)+p);else y=o>0?-s:s,v=Math.max(0,-(o*y+u)),A=-v*v+y*(y+2*f)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,v),r&&r.copy(lb).addScaledVector(Fx,y),A}intersectSphere(e,t){Hc.subVectors(e.center,this.origin);const n=Hc.dot(this.direction),r=Hc.dot(Hc)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),u=n-o,f=n+o;return f<0?null:u<0?this.at(f,t):this.at(u,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,u,f;const p=1/this.direction.x,g=1/this.direction.y,v=1/this.direction.z,y=this.origin;return p>=0?(n=(e.min.x-y.x)*p,r=(e.max.x-y.x)*p):(n=(e.max.x-y.x)*p,r=(e.min.x-y.x)*p),g>=0?(s=(e.min.y-y.y)*g,o=(e.max.y-y.y)*g):(s=(e.max.y-y.y)*g,o=(e.min.y-y.y)*g),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),v>=0?(u=(e.min.z-y.z)*v,f=(e.max.z-y.z)*v):(u=(e.max.z-y.z)*v,f=(e.min.z-y.z)*v),n>f||u>r)||((u>n||n!==n)&&(n=u),(f<r||r!==r)&&(r=f),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Hc)!==null}intersectTriangle(e,t,n,r,s){cb.subVectors(t,e),zx.subVectors(n,e),ub.crossVectors(cb,zx);let o=this.direction.dot(ub),u;if(o>0){if(r)return null;u=1}else if(o<0)u=-1,o=-o;else return null;td.subVectors(this.origin,e);const f=u*this.direction.dot(zx.crossVectors(td,zx));if(f<0)return null;const p=u*this.direction.dot(cb.cross(td));if(p<0||f+p>o)return null;const g=-u*td.dot(ub);return g<0?null:this.at(g/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class jt{constructor(e,t,n,r,s,o,u,f,p,g,v,y,A,S,T,M){jt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,u,f,p,g,v,y,A,S,T,M)}set(e,t,n,r,s,o,u,f,p,g,v,y,A,S,T,M){const E=this.elements;return E[0]=e,E[4]=t,E[8]=n,E[12]=r,E[1]=s,E[5]=o,E[9]=u,E[13]=f,E[2]=p,E[6]=g,E[10]=v,E[14]=y,E[3]=A,E[7]=S,E[11]=T,E[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new jt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/bp.setFromMatrixColumn(e,0).length(),s=1/bp.setFromMatrixColumn(e,1).length(),o=1/bp.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),u=Math.sin(n),f=Math.cos(r),p=Math.sin(r),g=Math.cos(s),v=Math.sin(s);if(e.order==="XYZ"){const y=o*g,A=o*v,S=u*g,T=u*v;t[0]=f*g,t[4]=-f*v,t[8]=p,t[1]=A+S*p,t[5]=y-T*p,t[9]=-u*f,t[2]=T-y*p,t[6]=S+A*p,t[10]=o*f}else if(e.order==="YXZ"){const y=f*g,A=f*v,S=p*g,T=p*v;t[0]=y+T*u,t[4]=S*u-A,t[8]=o*p,t[1]=o*v,t[5]=o*g,t[9]=-u,t[2]=A*u-S,t[6]=T+y*u,t[10]=o*f}else if(e.order==="ZXY"){const y=f*g,A=f*v,S=p*g,T=p*v;t[0]=y-T*u,t[4]=-o*v,t[8]=S+A*u,t[1]=A+S*u,t[5]=o*g,t[9]=T-y*u,t[2]=-o*p,t[6]=u,t[10]=o*f}else if(e.order==="ZYX"){const y=o*g,A=o*v,S=u*g,T=u*v;t[0]=f*g,t[4]=S*p-A,t[8]=y*p+T,t[1]=f*v,t[5]=T*p+y,t[9]=A*p-S,t[2]=-p,t[6]=u*f,t[10]=o*f}else if(e.order==="YZX"){const y=o*f,A=o*p,S=u*f,T=u*p;t[0]=f*g,t[4]=T-y*v,t[8]=S*v+A,t[1]=v,t[5]=o*g,t[9]=-u*g,t[2]=-p*g,t[6]=A*v+S,t[10]=y-T*v}else if(e.order==="XZY"){const y=o*f,A=o*p,S=u*f,T=u*p;t[0]=f*g,t[4]=-v,t[8]=p*g,t[1]=y*v+T,t[5]=o*g,t[9]=A*v-S,t[2]=S*v-A,t[6]=u*g,t[10]=T*v+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(JN,e,KN)}lookAt(e,t,n){const r=this.elements;return Ya.subVectors(e,t),Ya.lengthSq()===0&&(Ya.z=1),Ya.normalize(),nd.crossVectors(n,Ya),nd.lengthSq()===0&&(Math.abs(n.z)===1?Ya.x+=1e-4:Ya.z+=1e-4,Ya.normalize(),nd.crossVectors(n,Ya)),nd.normalize(),Hx.crossVectors(Ya,nd),r[0]=nd.x,r[4]=Hx.x,r[8]=Ya.x,r[1]=nd.y,r[5]=Hx.y,r[9]=Ya.y,r[2]=nd.z,r[6]=Hx.z,r[10]=Ya.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],u=n[4],f=n[8],p=n[12],g=n[1],v=n[5],y=n[9],A=n[13],S=n[2],T=n[6],M=n[10],E=n[14],R=n[3],I=n[7],O=n[11],F=n[15],z=r[0],j=r[4],W=r[8],L=r[12],H=r[1],K=r[5],de=r[9],ce=r[13],ne=r[2],fe=r[6],X=r[10],re=r[14],ge=r[3],Te=r[7],Se=r[11],Y=r[15];return s[0]=o*z+u*H+f*ne+p*ge,s[4]=o*j+u*K+f*fe+p*Te,s[8]=o*W+u*de+f*X+p*Se,s[12]=o*L+u*ce+f*re+p*Y,s[1]=g*z+v*H+y*ne+A*ge,s[5]=g*j+v*K+y*fe+A*Te,s[9]=g*W+v*de+y*X+A*Se,s[13]=g*L+v*ce+y*re+A*Y,s[2]=S*z+T*H+M*ne+E*ge,s[6]=S*j+T*K+M*fe+E*Te,s[10]=S*W+T*de+M*X+E*Se,s[14]=S*L+T*ce+M*re+E*Y,s[3]=R*z+I*H+O*ne+F*ge,s[7]=R*j+I*K+O*fe+F*Te,s[11]=R*W+I*de+O*X+F*Se,s[15]=R*L+I*ce+O*re+F*Y,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],u=e[5],f=e[9],p=e[13],g=e[2],v=e[6],y=e[10],A=e[14],S=e[3],T=e[7],M=e[11],E=e[15],R=f*A-p*y,I=u*A-p*v,O=u*y-f*v,F=o*A-p*g,z=o*y-f*g,j=o*v-u*g;return t*(T*R-M*I+E*O)-n*(S*R-M*F+E*z)+r*(S*I-T*F+E*j)-s*(S*O-T*z+M*j)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],u=e[5],f=e[6],p=e[7],g=e[8],v=e[9],y=e[10],A=e[11],S=e[12],T=e[13],M=e[14],E=e[15],R=v*M*p-T*y*p+T*f*A-u*M*A-v*f*E+u*y*E,I=S*y*p-g*M*p-S*f*A+o*M*A+g*f*E-o*y*E,O=g*T*p-S*v*p+S*u*A-o*T*A-g*u*E+o*v*E,F=S*v*f-g*T*f-S*u*y+o*T*y+g*u*M-o*v*M,z=t*R+n*I+r*O+s*F;if(z===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const j=1/z;return e[0]=R*j,e[1]=(T*y*s-v*M*s-T*r*A+n*M*A+v*r*E-n*y*E)*j,e[2]=(u*M*s-T*f*s+T*r*p-n*M*p-u*r*E+n*f*E)*j,e[3]=(v*f*s-u*y*s-v*r*p+n*y*p+u*r*A-n*f*A)*j,e[4]=I*j,e[5]=(g*M*s-S*y*s+S*r*A-t*M*A-g*r*E+t*y*E)*j,e[6]=(S*f*s-o*M*s-S*r*p+t*M*p+o*r*E-t*f*E)*j,e[7]=(o*y*s-g*f*s+g*r*p-t*y*p-o*r*A+t*f*A)*j,e[8]=O*j,e[9]=(S*v*s-g*T*s-S*n*A+t*T*A+g*n*E-t*v*E)*j,e[10]=(o*T*s-S*u*s+S*n*p-t*T*p-o*n*E+t*u*E)*j,e[11]=(g*u*s-o*v*s-g*n*p+t*v*p+o*n*A-t*u*A)*j,e[12]=F*j,e[13]=(g*T*r-S*v*r+S*n*y-t*T*y-g*n*M+t*v*M)*j,e[14]=(S*u*r-o*T*r-S*n*f+t*T*f+o*n*M-t*u*M)*j,e[15]=(o*v*r-g*u*r+g*n*f-t*v*f-o*n*y+t*u*y)*j,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,u=e.y,f=e.z,p=s*o,g=s*u;return this.set(p*o+n,p*u-r*f,p*f+r*u,0,p*u+r*f,g*u+n,g*f-r*o,0,p*f-r*u,g*f+r*o,s*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,u=t._z,f=t._w,p=s+s,g=o+o,v=u+u,y=s*p,A=s*g,S=s*v,T=o*g,M=o*v,E=u*v,R=f*p,I=f*g,O=f*v,F=n.x,z=n.y,j=n.z;return r[0]=(1-(T+E))*F,r[1]=(A+O)*F,r[2]=(S-I)*F,r[3]=0,r[4]=(A-O)*z,r[5]=(1-(y+E))*z,r[6]=(M+R)*z,r[7]=0,r[8]=(S+I)*j,r[9]=(M-R)*j,r[10]=(1-(y+T))*j,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let s=bp.set(r[0],r[1],r[2]).length();const o=bp.set(r[4],r[5],r[6]).length(),u=bp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),rl.copy(this);const p=1/s,g=1/o,v=1/u;return rl.elements[0]*=p,rl.elements[1]*=p,rl.elements[2]*=p,rl.elements[4]*=g,rl.elements[5]*=g,rl.elements[6]*=g,rl.elements[8]*=v,rl.elements[9]*=v,rl.elements[10]*=v,t.setFromRotationMatrix(rl),n.x=s,n.y=o,n.z=u,this}makePerspective(e,t,n,r,s,o,u=Za,f=!1){const p=this.elements,g=2*s/(t-e),v=2*s/(n-r),y=(t+e)/(t-e),A=(n+r)/(n-r);let S,T;if(f)S=s/(o-s),T=o*s/(o-s);else if(u===Za)S=-(o+s)/(o-s),T=-2*o*s/(o-s);else if(u===xm)S=-o/(o-s),T=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return p[0]=g,p[4]=0,p[8]=y,p[12]=0,p[1]=0,p[5]=v,p[9]=A,p[13]=0,p[2]=0,p[6]=0,p[10]=S,p[14]=T,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,r,s,o,u=Za,f=!1){const p=this.elements,g=2/(t-e),v=2/(n-r),y=-(t+e)/(t-e),A=-(n+r)/(n-r);let S,T;if(f)S=1/(o-s),T=o/(o-s);else if(u===Za)S=-2/(o-s),T=-(o+s)/(o-s);else if(u===xm)S=-1/(o-s),T=-s/(o-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return p[0]=g,p[4]=0,p[8]=0,p[12]=y,p[1]=0,p[5]=v,p[9]=0,p[13]=A,p[2]=0,p[6]=0,p[10]=S,p[14]=T,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const bp=new Q,rl=new jt,JN=new Q(0,0,0),KN=new Q(1,1,1),nd=new Q,Hx=new Q,Ya=new Q,sC=new jt,aC=new es;class Ga{constructor(e=0,t=0,n=0,r=Ga.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],u=r[8],f=r[1],p=r[5],g=r[9],v=r[2],y=r[6],A=r[10];switch(t){case"XYZ":this._y=Math.asin(gn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-g,A),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(y,p),this._z=0);break;case"YXZ":this._x=Math.asin(-gn(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(u,A),this._z=Math.atan2(f,p)):(this._y=Math.atan2(-v,s),this._z=0);break;case"ZXY":this._x=Math.asin(gn(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-v,A),this._z=Math.atan2(-o,p)):(this._y=0,this._z=Math.atan2(f,s));break;case"ZYX":this._y=Math.asin(-gn(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(y,A),this._z=Math.atan2(f,s)):(this._x=0,this._z=Math.atan2(-o,p));break;case"YZX":this._z=Math.asin(gn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-g,p),this._y=Math.atan2(-v,s)):(this._x=0,this._y=Math.atan2(u,A));break;case"XZY":this._z=Math.asin(-gn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(y,p),this._y=Math.atan2(u,s)):(this._x=Math.atan2(-g,A),this._y=0);break;default:Ht("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return sC.makeRotationFromQuaternion(e),this.setFromRotationMatrix(sC,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return aC.setFromEuler(this),this.setFromQuaternion(aC,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ga.DEFAULT_ORDER="XYZ";class _m{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ZN=0;const oC=new Q,Ep=new es,Gc=new jt,Gx=new Q,xg=new Q,$N=new Q,e5=new es,lC=new Q(1,0,0),cC=new Q(0,1,0),uC=new Q(0,0,1),dC={type:"added"},t5={type:"removed"},Mp={type:"childadded",child:null},db={type:"childremoved",child:null};class ni extends eo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ZN++}),this.uuid=$a(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ni.DEFAULT_UP.clone();const e=new Q,t=new Ga,n=new es,r=new Q(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new jt},normalMatrix:{value:new An}}),this.matrix=new jt,this.matrixWorld=new jt,this.matrixAutoUpdate=ni.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ni.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new _m,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ep.setFromAxisAngle(e,t),this.quaternion.multiply(Ep),this}rotateOnWorldAxis(e,t){return Ep.setFromAxisAngle(e,t),this.quaternion.premultiply(Ep),this}rotateX(e){return this.rotateOnAxis(lC,e)}rotateY(e){return this.rotateOnAxis(cC,e)}rotateZ(e){return this.rotateOnAxis(uC,e)}translateOnAxis(e,t){return oC.copy(e).applyQuaternion(this.quaternion),this.position.add(oC.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(lC,e)}translateY(e){return this.translateOnAxis(cC,e)}translateZ(e){return this.translateOnAxis(uC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Gc.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Gx.copy(e):Gx.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),xg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gc.lookAt(xg,Gx,this.up):Gc.lookAt(Gx,xg,this.up),this.quaternion.setFromRotationMatrix(Gc),r&&(Gc.extractRotation(r.matrixWorld),Ep.setFromRotationMatrix(Gc),this.quaternion.premultiply(Ep.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(nn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(dC),Mp.child=e,this.dispatchEvent(Mp),Mp.child=null):nn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(t5),db.child=e,this.dispatchEvent(db),db.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Gc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Gc.multiply(e.parent.matrixWorld)),e.applyMatrix4(Gc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(dC),Mp.child=e,this.dispatchEvent(Mp),Mp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xg,e,$N),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xg,e5,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(u=>({...u,boundingBox:u.boundingBox?u.boundingBox.toJSON():void 0,boundingSphere:u.boundingSphere?u.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(u=>({...u})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(u,f){return u[f.uuid]===void 0&&(u[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const f=u.shapes;if(Array.isArray(f))for(let p=0,g=f.length;p<g;p++){const v=f[p];s(e.shapes,v)}else s(e.shapes,f)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let f=0,p=this.material.length;f<p;f++)u.push(s(e.materials,this.material[f]));r.material=u}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let u=0;u<this.children.length;u++)r.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let u=0;u<this.animations.length;u++){const f=this.animations[u];r.animations.push(s(e.animations,f))}}if(t){const u=o(e.geometries),f=o(e.materials),p=o(e.textures),g=o(e.images),v=o(e.shapes),y=o(e.skeletons),A=o(e.animations),S=o(e.nodes);u.length>0&&(n.geometries=u),f.length>0&&(n.materials=f),p.length>0&&(n.textures=p),g.length>0&&(n.images=g),v.length>0&&(n.shapes=v),y.length>0&&(n.skeletons=y),A.length>0&&(n.animations=A),S.length>0&&(n.nodes=S)}return n.object=r,n;function o(u){const f=[];for(const p in u){const g=u[p];delete g.metadata,f.push(g)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}ni.DEFAULT_UP=new Q(0,1,0);ni.DEFAULT_MATRIX_AUTO_UPDATE=!0;ni.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const sl=new Q,kc=new Q,fb=new Q,Vc=new Q,Tp=new Q,wp=new Q,fC=new Q,hb=new Q,pb=new Q,mb=new Q,gb=new Ti,vb=new Ti,xb=new Ti;class Fa{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),sl.subVectors(e,t),r.cross(sl);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){sl.subVectors(r,t),kc.subVectors(n,t),fb.subVectors(e,t);const o=sl.dot(sl),u=sl.dot(kc),f=sl.dot(fb),p=kc.dot(kc),g=kc.dot(fb),v=o*p-u*u;if(v===0)return s.set(0,0,0),null;const y=1/v,A=(p*f-u*g)*y,S=(o*g-u*f)*y;return s.set(1-A-S,S,A)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Vc)===null?!1:Vc.x>=0&&Vc.y>=0&&Vc.x+Vc.y<=1}static getInterpolation(e,t,n,r,s,o,u,f){return this.getBarycoord(e,t,n,r,Vc)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(s,Vc.x),f.addScaledVector(o,Vc.y),f.addScaledVector(u,Vc.z),f)}static getInterpolatedAttribute(e,t,n,r,s,o){return gb.setScalar(0),vb.setScalar(0),xb.setScalar(0),gb.fromBufferAttribute(e,t),vb.fromBufferAttribute(e,n),xb.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(gb,s.x),o.addScaledVector(vb,s.y),o.addScaledVector(xb,s.z),o}static isFrontFacing(e,t,n,r){return sl.subVectors(n,t),kc.subVectors(e,t),sl.cross(kc).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return sl.subVectors(this.c,this.b),kc.subVectors(this.a,this.b),sl.cross(kc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fa.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Fa.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return Fa.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Fa.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fa.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,u;Tp.subVectors(r,n),wp.subVectors(s,n),hb.subVectors(e,n);const f=Tp.dot(hb),p=wp.dot(hb);if(f<=0&&p<=0)return t.copy(n);pb.subVectors(e,r);const g=Tp.dot(pb),v=wp.dot(pb);if(g>=0&&v<=g)return t.copy(r);const y=f*v-g*p;if(y<=0&&f>=0&&g<=0)return o=f/(f-g),t.copy(n).addScaledVector(Tp,o);mb.subVectors(e,s);const A=Tp.dot(mb),S=wp.dot(mb);if(S>=0&&A<=S)return t.copy(s);const T=A*p-f*S;if(T<=0&&p>=0&&S<=0)return u=p/(p-S),t.copy(n).addScaledVector(wp,u);const M=g*S-A*v;if(M<=0&&v-g>=0&&A-S>=0)return fC.subVectors(s,r),u=(v-g)/(v-g+(A-S)),t.copy(r).addScaledVector(fC,u);const E=1/(M+T+y);return o=T*E,u=y*E,t.copy(n).addScaledVector(Tp,o).addScaledVector(wp,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Y2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},id={h:0,s:0,l:0},kx={h:0,s:0,l:0};function yb(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class Ft{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Hn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$n.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=$n.workingColorSpace){return this.r=e,this.g=t,this.b=n,$n.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=$n.workingColorSpace){if(e=GM(e,1),t=gn(t,0,1),n=gn(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=yb(o,s,e+1/3),this.g=yb(o,s,e),this.b=yb(o,s,e-1/3)}return $n.colorSpaceToWorking(this,r),this}setStyle(e,t=Hn){function n(s){s!==void 0&&parseFloat(s)<1&&Ht("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],u=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Ht("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);Ht("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Hn){const n=Y2[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Ht("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ru(e.r),this.g=ru(e.g),this.b=ru(e.b),this}copyLinearToSRGB(e){return this.r=lm(e.r),this.g=lm(e.g),this.b=lm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Hn){return $n.workingToColorSpace(zs.copy(this),e),Math.round(gn(zs.r*255,0,255))*65536+Math.round(gn(zs.g*255,0,255))*256+Math.round(gn(zs.b*255,0,255))}getHexString(e=Hn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$n.workingColorSpace){$n.workingToColorSpace(zs.copy(this),t);const n=zs.r,r=zs.g,s=zs.b,o=Math.max(n,r,s),u=Math.min(n,r,s);let f,p;const g=(u+o)/2;if(u===o)f=0,p=0;else{const v=o-u;switch(p=g<=.5?v/(o+u):v/(2-o-u),o){case n:f=(r-s)/v+(r<s?6:0);break;case r:f=(s-n)/v+2;break;case s:f=(n-r)/v+4;break}f/=6}return e.h=f,e.s=p,e.l=g,e}getRGB(e,t=$n.workingColorSpace){return $n.workingToColorSpace(zs.copy(this),t),e.r=zs.r,e.g=zs.g,e.b=zs.b,e}getStyle(e=Hn){$n.workingToColorSpace(zs.copy(this),e);const t=zs.r,n=zs.g,r=zs.b;return e!==Hn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(id),this.setHSL(id.h+e,id.s+t,id.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(id),e.getHSL(kx);const n=$g(id.h,kx.h,t),r=$g(id.s,kx.s,t),s=$g(id.l,kx.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zs=new Ft;Ft.NAMES=Y2;let n5=0;class mr extends eo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:n5++}),this.uuid=$a(),this.name="",this.type="Material",this.blending=jf,this.side=ml,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=eA,this.blendDst=tA,this.blendEquation=$l,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ft(0,0,0),this.blendAlpha=0,this.depthFunc=Jf,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=BE,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nf,this.stencilZFail=Nf,this.stencilZPass=Nf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Ht(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Ht(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==jf&&(n.blending=this.blending),this.side!==ml&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==eA&&(n.blendSrc=this.blendSrc),this.blendDst!==tA&&(n.blendDst=this.blendDst),this.blendEquation!==$l&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Jf&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==BE&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Nf&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Nf&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Nf&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const u in s){const f=s[u];delete f.metadata,o.push(f)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class za extends mr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ga,this.combine=Rv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const eu=i5();function i5(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let f=0;f<256;++f){const p=f-127;p<-27?(n[f]=0,n[f|256]=32768,r[f]=24,r[f|256]=24):p<-14?(n[f]=1024>>-p-14,n[f|256]=1024>>-p-14|32768,r[f]=-p-1,r[f|256]=-p-1):p<=15?(n[f]=p+15<<10,n[f|256]=p+15<<10|32768,r[f]=13,r[f|256]=13):p<128?(n[f]=31744,n[f|256]=64512,r[f]=24,r[f|256]=24):(n[f]=31744,n[f|256]=64512,r[f]=13,r[f|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),u=new Uint32Array(64);for(let f=1;f<1024;++f){let p=f<<13,g=0;for(;(p&8388608)===0;)p<<=1,g-=8388608;p&=-8388609,g+=947912704,s[f]=p|g}for(let f=1024;f<2048;++f)s[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)o[f]=f<<23;o[31]=1199570944,o[32]=2147483648;for(let f=33;f<63;++f)o[f]=2147483648+(f-32<<23);o[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(u[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:u}}function Pa(i){Math.abs(i)>65504&&Ht("DataUtils.toHalfFloat(): Value out of range."),i=gn(i,-65504,65504),eu.floatView[0]=i;const e=eu.uint32View[0],t=e>>23&511;return eu.baseTable[t]+((e&8388607)>>eu.shiftTable[t])}function Gg(i){const e=i>>10;return eu.uint32View[0]=eu.mantissaTable[eu.offsetTable[e]+(i&1023)]+eu.exponentTable[e],eu.floatView[0]}class iu{static toHalfFloat(e){return Pa(e)}static fromHalfFloat(e){return Gg(e)}}const Gr=new Q,Vx=new qe;let r5=0;class jn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:r5++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=pv,this.updateRanges=[],this.gpuType=si,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Vx.fromBufferAttribute(this,t),Vx.applyMatrix3(e),this.setXY(t,Vx.x,Vx.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.applyMatrix3(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.applyMatrix4(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.applyNormalMatrix(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Gr.fromBufferAttribute(this,t),Gr.transformDirection(e),this.setXYZ(t,Gr.x,Gr.y,Gr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=sa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Bn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=sa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=sa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=sa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=sa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array),r=Bn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array),r=Bn(r,this.array),s=Bn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==pv&&(e.usage=this.usage),e}}class s5 extends jn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class a5 extends jn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class o5 extends jn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class l5 extends jn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class VM extends jn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class c5 extends jn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class jM extends jn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class u5 extends jn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Gg(this.array[e*this.itemSize]);return this.normalized&&(t=sa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize]=Pa(t),this}getY(e){let t=Gg(this.array[e*this.itemSize+1]);return this.normalized&&(t=sa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize+1]=Pa(t),this}getZ(e){let t=Gg(this.array[e*this.itemSize+2]);return this.normalized&&(t=sa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize+2]=Pa(t),this}getW(e){let t=Gg(this.array[e*this.itemSize+3]);return this.normalized&&(t=sa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Bn(t,this.array)),this.array[e*this.itemSize+3]=Pa(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array)),this.array[e+0]=Pa(t),this.array[e+1]=Pa(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array),r=Bn(r,this.array)),this.array[e+0]=Pa(t),this.array[e+1]=Pa(n),this.array[e+2]=Pa(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array),r=Bn(r,this.array),s=Bn(s,this.array)),this.array[e+0]=Pa(t),this.array[e+1]=Pa(n),this.array[e+2]=Pa(r),this.array[e+3]=Pa(s),this}}class Jt extends jn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let d5=0;const Co=new jt,Ab=new ni,Cp=new Q,Qa=new Es,yg=new Es,ls=new Q;class pn extends eo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:d5++}),this.uuid=$a(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(k2(e)?jM:VM)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new An().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Co.makeRotationFromQuaternion(e),this.applyMatrix4(Co),this}rotateX(e){return Co.makeRotationX(e),this.applyMatrix4(Co),this}rotateY(e){return Co.makeRotationY(e),this.applyMatrix4(Co),this}rotateZ(e){return Co.makeRotationZ(e),this.applyMatrix4(Co),this}translate(e,t,n){return Co.makeTranslation(e,t,n),this.applyMatrix4(Co),this}scale(e,t,n){return Co.makeScale(e,t,n),this.applyMatrix4(Co),this}lookAt(e){return Ab.lookAt(e),Ab.updateMatrix(),this.applyMatrix4(Ab.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cp).negate(),this.translate(Cp.x,Cp.y,Cp.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Jt(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&Ht("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Es);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){nn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];Qa.setFromBufferAttribute(s),this.morphTargetsRelative?(ls.addVectors(this.boundingBox.min,Qa.min),this.boundingBox.expandByPoint(ls),ls.addVectors(this.boundingBox.max,Qa.max),this.boundingBox.expandByPoint(ls)):(this.boundingBox.expandByPoint(Qa.min),this.boundingBox.expandByPoint(Qa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&nn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Wr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){nn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Q,1/0);return}if(e){const n=this.boundingSphere.center;if(Qa.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const u=t[s];yg.setFromBufferAttribute(u),this.morphTargetsRelative?(ls.addVectors(Qa.min,yg.min),Qa.expandByPoint(ls),ls.addVectors(Qa.max,yg.max),Qa.expandByPoint(ls)):(Qa.expandByPoint(yg.min),Qa.expandByPoint(yg.max))}Qa.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)ls.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(ls));if(t)for(let s=0,o=t.length;s<o;s++){const u=t[s],f=this.morphTargetsRelative;for(let p=0,g=u.count;p<g;p++)ls.fromBufferAttribute(u,p),f&&(Cp.fromBufferAttribute(e,p),ls.add(Cp)),r=Math.max(r,n.distanceToSquared(ls))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&nn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){nn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new jn(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),u=[],f=[];for(let W=0;W<n.count;W++)u[W]=new Q,f[W]=new Q;const p=new Q,g=new Q,v=new Q,y=new qe,A=new qe,S=new qe,T=new Q,M=new Q;function E(W,L,H){p.fromBufferAttribute(n,W),g.fromBufferAttribute(n,L),v.fromBufferAttribute(n,H),y.fromBufferAttribute(s,W),A.fromBufferAttribute(s,L),S.fromBufferAttribute(s,H),g.sub(p),v.sub(p),A.sub(y),S.sub(y);const K=1/(A.x*S.y-S.x*A.y);isFinite(K)&&(T.copy(g).multiplyScalar(S.y).addScaledVector(v,-A.y).multiplyScalar(K),M.copy(v).multiplyScalar(A.x).addScaledVector(g,-S.x).multiplyScalar(K),u[W].add(T),u[L].add(T),u[H].add(T),f[W].add(M),f[L].add(M),f[H].add(M))}let R=this.groups;R.length===0&&(R=[{start:0,count:e.count}]);for(let W=0,L=R.length;W<L;++W){const H=R[W],K=H.start,de=H.count;for(let ce=K,ne=K+de;ce<ne;ce+=3)E(e.getX(ce+0),e.getX(ce+1),e.getX(ce+2))}const I=new Q,O=new Q,F=new Q,z=new Q;function j(W){F.fromBufferAttribute(r,W),z.copy(F);const L=u[W];I.copy(L),I.sub(F.multiplyScalar(F.dot(L))).normalize(),O.crossVectors(z,L);const K=O.dot(f[W])<0?-1:1;o.setXYZW(W,I.x,I.y,I.z,K)}for(let W=0,L=R.length;W<L;++W){const H=R[W],K=H.start,de=H.count;for(let ce=K,ne=K+de;ce<ne;ce+=3)j(e.getX(ce+0)),j(e.getX(ce+1)),j(e.getX(ce+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new jn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let y=0,A=n.count;y<A;y++)n.setXYZ(y,0,0,0);const r=new Q,s=new Q,o=new Q,u=new Q,f=new Q,p=new Q,g=new Q,v=new Q;if(e)for(let y=0,A=e.count;y<A;y+=3){const S=e.getX(y+0),T=e.getX(y+1),M=e.getX(y+2);r.fromBufferAttribute(t,S),s.fromBufferAttribute(t,T),o.fromBufferAttribute(t,M),g.subVectors(o,s),v.subVectors(r,s),g.cross(v),u.fromBufferAttribute(n,S),f.fromBufferAttribute(n,T),p.fromBufferAttribute(n,M),u.add(g),f.add(g),p.add(g),n.setXYZ(S,u.x,u.y,u.z),n.setXYZ(T,f.x,f.y,f.z),n.setXYZ(M,p.x,p.y,p.z)}else for(let y=0,A=t.count;y<A;y+=3)r.fromBufferAttribute(t,y+0),s.fromBufferAttribute(t,y+1),o.fromBufferAttribute(t,y+2),g.subVectors(o,s),v.subVectors(r,s),g.cross(v),n.setXYZ(y+0,g.x,g.y,g.z),n.setXYZ(y+1,g.x,g.y,g.z),n.setXYZ(y+2,g.x,g.y,g.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)ls.fromBufferAttribute(e,t),ls.normalize(),e.setXYZ(t,ls.x,ls.y,ls.z)}toNonIndexed(){function e(u,f){const p=u.array,g=u.itemSize,v=u.normalized,y=new p.constructor(f.length*g);let A=0,S=0;for(let T=0,M=f.length;T<M;T++){u.isInterleavedBufferAttribute?A=f[T]*u.data.stride+u.offset:A=f[T]*g;for(let E=0;E<g;E++)y[S++]=p[A++]}return new jn(y,g,v)}if(this.index===null)return Ht("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new pn,n=this.index.array,r=this.attributes;for(const u in r){const f=r[u],p=e(f,n);t.setAttribute(u,p)}const s=this.morphAttributes;for(const u in s){const f=[],p=s[u];for(let g=0,v=p.length;g<v;g++){const y=p[g],A=e(y,n);f.push(A)}t.morphAttributes[u]=f}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let u=0,f=o.length;u<f;u++){const p=o[u];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const p in f)f[p]!==void 0&&(e[p]=f[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const p=n[f];e.data.attributes[f]=p.toJSON(e.data)}const r={};let s=!1;for(const f in this.morphAttributes){const p=this.morphAttributes[f],g=[];for(let v=0,y=p.length;v<y;v++){const A=p[v];g.push(A.toJSON(e.data))}g.length>0&&(r[f]=g,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere=u.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const g=r[p];this.setAttribute(p,g.clone(t))}const s=e.morphAttributes;for(const p in s){const g=[],v=s[p];for(let y=0,A=v.length;y<A;y++)g.push(v[y].clone(t));this.morphAttributes[p]=g}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let p=0,g=o.length;p<g;p++){const v=o[p];this.addGroup(v.start,v.count,v.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const hC=new jt,gf=new bd,jx=new Wr,pC=new Q,Wx=new Q,Xx=new Q,Yx=new Q,_b=new Q,Qx=new Q,mC=new Q,qx=new Q;class Oi extends ni{constructor(e=new pn,t=new za){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const u=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const u=this.morphTargetInfluences;if(s&&u){Qx.set(0,0,0);for(let f=0,p=s.length;f<p;f++){const g=u[f],v=s[f];g!==0&&(_b.fromBufferAttribute(v,e),o?Qx.addScaledVector(_b,g):Qx.addScaledVector(_b.sub(t),g))}t.add(Qx)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),jx.copy(n.boundingSphere),jx.applyMatrix4(s),gf.copy(e.ray).recast(e.near),!(jx.containsPoint(gf.origin)===!1&&(gf.intersectSphere(jx,pC)===null||gf.origin.distanceToSquared(pC)>(e.far-e.near)**2))&&(hC.copy(s).invert(),gf.copy(e.ray).applyMatrix4(hC),!(n.boundingBox!==null&&gf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,gf)))}_computeIntersections(e,t,n){let r;const s=this.geometry,o=this.material,u=s.index,f=s.attributes.position,p=s.attributes.uv,g=s.attributes.uv1,v=s.attributes.normal,y=s.groups,A=s.drawRange;if(u!==null)if(Array.isArray(o))for(let S=0,T=y.length;S<T;S++){const M=y[S],E=o[M.materialIndex],R=Math.max(M.start,A.start),I=Math.min(u.count,Math.min(M.start+M.count,A.start+A.count));for(let O=R,F=I;O<F;O+=3){const z=u.getX(O),j=u.getX(O+1),W=u.getX(O+2);r=Jx(this,E,e,n,p,g,v,z,j,W),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=M.materialIndex,t.push(r))}}else{const S=Math.max(0,A.start),T=Math.min(u.count,A.start+A.count);for(let M=S,E=T;M<E;M+=3){const R=u.getX(M),I=u.getX(M+1),O=u.getX(M+2);r=Jx(this,o,e,n,p,g,v,R,I,O),r&&(r.faceIndex=Math.floor(M/3),t.push(r))}}else if(f!==void 0)if(Array.isArray(o))for(let S=0,T=y.length;S<T;S++){const M=y[S],E=o[M.materialIndex],R=Math.max(M.start,A.start),I=Math.min(f.count,Math.min(M.start+M.count,A.start+A.count));for(let O=R,F=I;O<F;O+=3){const z=O,j=O+1,W=O+2;r=Jx(this,E,e,n,p,g,v,z,j,W),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=M.materialIndex,t.push(r))}}else{const S=Math.max(0,A.start),T=Math.min(f.count,A.start+A.count);for(let M=S,E=T;M<E;M+=3){const R=M,I=M+1,O=M+2;r=Jx(this,o,e,n,p,g,v,R,I,O),r&&(r.faceIndex=Math.floor(M/3),t.push(r))}}}}function f5(i,e,t,n,r,s,o,u){let f;if(e.side===jr?f=n.intersectTriangle(o,s,r,!0,u):f=n.intersectTriangle(r,s,o,e.side===ml,u),f===null)return null;qx.copy(u),qx.applyMatrix4(i.matrixWorld);const p=t.ray.origin.distanceTo(qx);return p<t.near||p>t.far?null:{distance:p,point:qx.clone(),object:i}}function Jx(i,e,t,n,r,s,o,u,f,p){i.getVertexPosition(u,Wx),i.getVertexPosition(f,Xx),i.getVertexPosition(p,Yx);const g=f5(i,e,t,n,Wx,Xx,Yx,mC);if(g){const v=new Q;Fa.getBarycoord(mC,Wx,Xx,Yx,v),r&&(g.uv=Fa.getInterpolatedAttribute(r,u,f,p,v,new qe)),s&&(g.uv1=Fa.getInterpolatedAttribute(s,u,f,p,v,new qe)),o&&(g.normal=Fa.getInterpolatedAttribute(o,u,f,p,v,new Q),g.normal.dot(n.direction)>0&&g.normal.multiplyScalar(-1));const y={a:u,b:f,c:p,normal:new Q,materialIndex:0};Fa.getNormal(Wx,Xx,Yx,y.normal),g.face=y,g.barycoord=v}return g}class Ed extends pn{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const u=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const f=[],p=[],g=[],v=[];let y=0,A=0;S("z","y","x",-1,-1,n,t,e,o,s,0),S("z","y","x",1,-1,n,t,-e,o,s,1),S("x","z","y",1,1,e,n,t,r,o,2),S("x","z","y",1,-1,e,n,-t,r,o,3),S("x","y","z",1,-1,e,t,n,r,s,4),S("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(f),this.setAttribute("position",new Jt(p,3)),this.setAttribute("normal",new Jt(g,3)),this.setAttribute("uv",new Jt(v,2));function S(T,M,E,R,I,O,F,z,j,W,L){const H=O/j,K=F/W,de=O/2,ce=F/2,ne=z/2,fe=j+1,X=W+1;let re=0,ge=0;const Te=new Q;for(let Se=0;Se<X;Se++){const Y=Se*K-ce;for(let me=0;me<fe;me++){const Ce=me*H-de;Te[T]=Ce*R,Te[M]=Y*I,Te[E]=ne,p.push(Te.x,Te.y,Te.z),Te[T]=0,Te[M]=0,Te[E]=z>0?1:-1,g.push(Te.x,Te.y,Te.z),v.push(me/j),v.push(1-Se/W),re+=1}}for(let Se=0;Se<W;Se++)for(let Y=0;Y<j;Y++){const me=y+Y+fe*Se,Ce=y+Y+fe*(Se+1),Ze=y+(Y+1)+fe*(Se+1),xt=y+(Y+1)+fe*Se;f.push(me,Ce,xt),f.push(Ce,Ze,xt),ge+=6}u.addGroup(A,ge,L),A+=ge,y+=re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ed(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Sm(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Ht("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function ia(i){const e={};for(let t=0;t<i.length;t++){const n=Sm(i[t]);for(const r in n)e[r]=n[r]}return e}function h5(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function Q2(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:$n.workingColorSpace}const WM={clone:Sm,merge:ia};var p5=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,m5=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ai extends mr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=p5,this.fragmentShader=m5,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sm(e.uniforms),this.uniformsGroups=h5(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Bm extends ni{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new jt,this.projectionMatrix=new jt,this.projectionMatrixInverse=new jt,this.coordinateSystem=Za,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const rd=new Q,gC=new qe,vC=new qe;let ki=class extends Bm{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Am*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Wf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Am*2*Math.atan(Math.tan(Wf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){rd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(rd.x,rd.y).multiplyScalar(-e/rd.z),rd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(rd.x,rd.y).multiplyScalar(-e/rd.z)}getViewSize(e,t){return this.getViewBounds(e,gC,vC),t.subVectors(vC,gC)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Wf*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const f=o.fullWidth,p=o.fullHeight;s+=o.offsetX*r/f,t-=o.offsetY*n/p,r*=o.width/f,n*=o.height/p}const u=this.filmOffset;u!==0&&(s+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Rp=-90,Dp=1;class q2 extends ni{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ki(Rp,Dp,e,t);r.layers=this.layers,this.add(r);const s=new ki(Rp,Dp,e,t);s.layers=this.layers,this.add(s);const o=new ki(Rp,Dp,e,t);o.layers=this.layers,this.add(o);const u=new ki(Rp,Dp,e,t);u.layers=this.layers,this.add(u);const f=new ki(Rp,Dp,e,t);f.layers=this.layers,this.add(f);const p=new ki(Rp,Dp,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,u,f]=t;for(const p of t)this.remove(p);if(e===Za)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===xm)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,u,f,p,g]=this.children,v=e.getRenderTarget(),y=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),S=e.xr.enabled;e.xr.enabled=!1;const T=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,u),e.setRenderTarget(n,3,r),e.render(t,f),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=T,e.setRenderTarget(n,5,r),e.render(t,g),e.setRenderTarget(v,y,A),e.xr.enabled=S,n.texture.needsPMREMUpdate=!0}}class Ov extends Jn{constructor(e=[],t=gl,n,r,s,o,u,f,p,g){super(e,t,n,r,s,o,u,f,p,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class S_ extends ti{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Ov(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Ed(5,5,5),s=new ai({name:"CubemapFromEquirect",uniforms:Sm(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:jr,blending:Pi});s.uniforms.tEquirect.value=t;const o=new Oi(r,s),u=t.minFilter;return t.minFilter===Ka&&(t.minFilter=on),new q2(1,10,this).update(e,o),t.minFilter=u,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}class nc extends ni{constructor(){super(),this.isGroup=!0,this.type="Group"}}const g5={type:"move"};class Yy{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new nc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new nc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new nc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const u=this._targetRay,f=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){o=!0;for(const T of e.hand.values()){const M=t.getJointPose(T,n),E=this._getHandJoint(p,T);M!==null&&(E.matrix.fromArray(M.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=M.radius),E.visible=M!==null}const g=p.joints["index-finger-tip"],v=p.joints["thumb-tip"],y=g.position.distanceTo(v.position),A=.02,S=.005;p.inputState.pinching&&y>A+S?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&y<=A-S&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1));u!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(u.matrix.fromArray(r.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,r.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(r.linearVelocity)):u.hasLinearVelocity=!1,r.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(r.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(g5)))}return u!==null&&(u.visible=r!==null),f!==null&&(f.visible=s!==null),p!==null&&(p.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new nc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class b_{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ft(e),this.density=t}clone(){return new b_(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class E_{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ft(e),this.near=t,this.far=n}clone(){return new E_(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Ad extends ni{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ga,this.environmentIntensity=1,this.environmentRotation=new Ga,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class $f{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=pv,this.updateRanges=[],this.version=0,this.uuid=$a()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=$a()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=$a()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ta=new Q;class pl{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.applyMatrix4(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.applyNormalMatrix(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.transformDirection(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=sa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Bn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Bn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Bn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Bn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Bn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=sa(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=sa(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=sa(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=sa(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array),r=Bn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Bn(t,this.array),n=Bn(n,this.array),r=Bn(r,this.array),s=Bn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){gv("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new jn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new pl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){gv("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class XM extends mr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ip;const Ag=new Q,Bp=new Q,Np=new Q,Op=new qe,_g=new qe,J2=new jt,Kx=new Q,Sg=new Q,Zx=new Q,xC=new qe,Sb=new qe,yC=new qe;class K2 extends ni{constructor(e=new XM){if(super(),this.isSprite=!0,this.type="Sprite",Ip===void 0){Ip=new pn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new $f(t,5);Ip.setIndex([0,1,2,0,2,3]),Ip.setAttribute("position",new pl(n,3,0,!1)),Ip.setAttribute("uv",new pl(n,2,3,!1))}this.geometry=Ip,this.material=e,this.center=new qe(.5,.5),this.count=1}raycast(e,t){e.camera===null&&nn('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Bp.setFromMatrixScale(this.matrixWorld),J2.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Np.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Bp.multiplyScalar(-Np.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;$x(Kx.set(-.5,-.5,0),Np,o,Bp,r,s),$x(Sg.set(.5,-.5,0),Np,o,Bp,r,s),$x(Zx.set(.5,.5,0),Np,o,Bp,r,s),xC.set(0,0),Sb.set(1,0),yC.set(1,1);let u=e.ray.intersectTriangle(Kx,Sg,Zx,!1,Ag);if(u===null&&($x(Sg.set(-.5,.5,0),Np,o,Bp,r,s),Sb.set(0,1),u=e.ray.intersectTriangle(Kx,Zx,Sg,!1,Ag),u===null))return;const f=e.ray.origin.distanceTo(Ag);f<e.near||f>e.far||t.push({distance:f,point:Ag.clone(),uv:Fa.getInterpolation(Ag,Kx,Sg,Zx,xC,Sb,yC,new qe),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function $x(i,e,t,n,r,s){Op.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(_g.x=s*Op.x-r*Op.y,_g.y=r*Op.x+s*Op.y):_g.copy(Op),i.copy(e),i.x+=_g.x,i.y+=_g.y,i.applyMatrix4(J2)}const ey=new Q,AC=new Q;class Z2 extends ni{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ey.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(ey);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ey.setFromMatrixPosition(e.matrixWorld),AC.setFromMatrixPosition(this.matrixWorld);const n=ey.distanceTo(AC)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),n>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const _C=new Q,SC=new Ti,bC=new Ti,v5=new Q,EC=new jt,ty=new Q,bb=new Wr,MC=new jt,Eb=new bd;class YM extends Oi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=DE,this.bindMatrix=new jt,this.bindMatrixInverse=new jt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Es),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ty),this.boundingBox.expandByPoint(ty)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Wr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ty),this.boundingSphere.expandByPoint(ty)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),bb.copy(this.boundingSphere),bb.applyMatrix4(r),e.ray.intersectsSphere(bb)!==!1&&(MC.copy(r).invert(),Eb.copy(e.ray).applyMatrix4(MC),!(this.boundingBox!==null&&Eb.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Eb)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ti,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===DE?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===D2?this.bindMatrixInverse.copy(this.bindMatrix).invert():Ht("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;SC.fromBufferAttribute(r.attributes.skinIndex,e),bC.fromBufferAttribute(r.attributes.skinWeight,e),_C.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=bC.getComponent(s);if(o!==0){const u=SC.getComponent(s);EC.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),t.addScaledVector(v5.copy(_C).applyMatrix4(EC),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class M_ extends ni{constructor(){super(),this.isBone=!0,this.type="Bone"}}class oa extends Jn{constructor(e=null,t=1,n=1,r,s,o,u,f,p=di,g=di,v,y){super(null,o,u,f,p,g,r,s,v,y),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const TC=new jt,x5=new jt;class Lv{constructor(e=[],t=[]){this.uuid=$a(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Ht("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new jt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new jt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const u=e[s]?e[s].matrixWorld:x5;TC.multiplyMatrices(u,t[s]),TC.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Lv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new oa(t,e,e,Ai,si);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];o===void 0&&(Ht("Skeleton: No bone found with UUID:",s),o=new M_),this.bones.push(o),this.boneInverses.push(new jt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const u=n[r];e.boneInverses.push(u.toArray())}return e}}class eh extends jn{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Lp=new jt,wC=new jt,ny=[],CC=new Es,y5=new jt,bg=new Oi,Eg=new Wr;class QM extends Oi{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new eh(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,y5)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Es),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Lp),CC.copy(e.boundingBox).applyMatrix4(Lp),this.boundingBox.union(CC)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Wr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Lp),Eg.copy(e.boundingSphere).applyMatrix4(Lp),this.boundingSphere.union(Eg)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let u=0;u<n.length;u++)n[u]=r[o+u]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(bg.geometry=this.geometry,bg.material=this.material,bg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Eg.copy(this.boundingSphere),Eg.applyMatrix4(n),e.ray.intersectsSphere(Eg)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Lp),wC.multiplyMatrices(n,Lp),bg.matrixWorld=wC,bg.raycast(e,ny);for(let o=0,u=ny.length;o<u;o++){const f=ny[o];f.instanceId=s,f.object=this,t.push(f)}ny.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new eh(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new oa(new Float32Array(r*this.count),r,this.count,tc,si));const s=this.morphTexture.source.data.data;let o=0;for(let p=0;p<n.length;p++)o+=n[p];const u=this.geometry.morphTargetsRelative?1:1-o,f=r*e;s[f]=u,s.set(n,f+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Mb=new Q,A5=new Q,_5=new An;class Kc{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Mb.subVectors(n,t).cross(A5.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Mb),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||_5.getNormalMatrix(e),r=this.coplanarPoint(Mb).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const vf=new Wr,S5=new qe(.5,.5),iy=new Q;class Nm{constructor(e=new Kc,t=new Kc,n=new Kc,r=new Kc,s=new Kc,o=new Kc){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(r),u[4].copy(s),u[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Za,n=!1){const r=this.planes,s=e.elements,o=s[0],u=s[1],f=s[2],p=s[3],g=s[4],v=s[5],y=s[6],A=s[7],S=s[8],T=s[9],M=s[10],E=s[11],R=s[12],I=s[13],O=s[14],F=s[15];if(r[0].setComponents(p-o,A-g,E-S,F-R).normalize(),r[1].setComponents(p+o,A+g,E+S,F+R).normalize(),r[2].setComponents(p+u,A+v,E+T,F+I).normalize(),r[3].setComponents(p-u,A-v,E-T,F-I).normalize(),n)r[4].setComponents(f,y,M,O).normalize(),r[5].setComponents(p-f,A-y,E-M,F-O).normalize();else if(r[4].setComponents(p-f,A-y,E-M,F-O).normalize(),t===Za)r[5].setComponents(p+f,A+y,E+M,F+O).normalize();else if(t===xm)r[5].setComponents(f,y,M,O).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),vf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),vf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(vf)}intersectsSprite(e){vf.center.set(0,0,0);const t=S5.distanceTo(e.center);return vf.radius=.7071067811865476+t,vf.applyMatrix4(e.matrixWorld),this.intersectsSphere(vf)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(iy.x=r.normal.x>0?e.max.x:e.min.x,iy.y=r.normal.y>0?e.max.y:e.min.y,iy.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(iy)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Ql=new jt,ql=new Nm;class T_{constructor(){this.coordinateSystem=Za}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Ql.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ql.setFromProjectionMatrix(Ql,r.coordinateSystem,r.reversedDepth),ql.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Ql.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ql.setFromProjectionMatrix(Ql,r.coordinateSystem,r.reversedDepth),ql.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Ql.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ql.setFromProjectionMatrix(Ql,r.coordinateSystem,r.reversedDepth),ql.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Ql.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ql.setFromProjectionMatrix(Ql,r.coordinateSystem,r.reversedDepth),ql.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Ql.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ql.setFromProjectionMatrix(Ql,r.coordinateSystem,r.reversedDepth),ql.containsPoint(e))return!0}return!1}clone(){return new T_}}function Tb(i,e){return i-e}function b5(i,e){return i.z-e.z}function E5(i,e){return e.z-i.z}class M5{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const u=s[this.index];o.push(u),this.index++,u.start=e,u.count=t,u.z=n,u.index=r}reset(){this.list.length=0,this.index=0}}const La=new jt,T5=new Ft(1,1,1),RC=new Nm,w5=new T_,ry=new Es,xf=new Wr,Mg=new Q,DC=new Q,C5=new Q,wb=new M5,Hs=new Oi,sy=[];function R5(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const r=i.count;for(let s=0;s<r;s++)for(let o=0;o<n;o++)e.setComponent(s+t,o,i.getComponent(s,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function yf(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class $2 extends Oi{constructor(e,t,n=t*2,r){super(new pn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new oa(t,e,e,Ai,si);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new oa(t,e,e,Nv,ca);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new oa(t,e,e,Ai,si);n.colorSpace=$n.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:u,itemSize:f,normalized:p}=o,g=new u.constructor(n*f),v=new jn(g,f,p);t.setAttribute(s,v)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new jn(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Es);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,La),this.getBoundingBoxAt(s,ry).applyMatrix4(La),e.union(ry)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Wr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,La),this.getBoundingSphereAt(s,xf).applyMatrix4(La),e.union(xf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(Tb),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));const s=this._matricesTexture;La.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const o=this._colorsTexture;return o&&(T5.toArray(o.image.data,r*4),o.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?o.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let f;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(Tb),f=this._availableGeometryIds.shift(),s[f]=r):(f=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(f,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,f}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),o=t.getIndex(),u=this._geometryInfo[e];if(r&&o.count>u.reservedIndexCount||t.attributes.position.count>u.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const f=u.vertexStart,p=u.reservedVertexCount;u.vertexCount=t.getAttribute("position").count;for(const g in n.attributes){const v=t.getAttribute(g),y=n.getAttribute(g);R5(v,y,f);const A=v.itemSize;for(let S=v.count,T=p;S<T;S++){const M=f+S;for(let E=0;E<A;E++)y.setComponent(M,E,0)}y.needsUpdate=!0,y.addUpdateRange(f*A,p*A)}if(r){const g=u.indexStart,v=u.reservedIndexCount;u.indexCount=t.getIndex().count;for(let y=0;y<o.count;y++)s.setX(g+y,f+o.getX(y));for(let y=o.count,A=v;y<A;y++)s.setX(g+y,f);s.needsUpdate=!0,s.addUpdateRange(g,u.reservedIndexCount)}return u.start=r?u.indexStart:u.vertexStart,u.count=r?u.indexCount:u.vertexCount,u.boundingBox=null,t.boundingBox!==null&&(u.boundingBox=t.boundingBox.clone()),u.boundingSphere=null,t.boundingSphere!==null&&(u.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let r=0,s=n.length;r<s;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((o,u)=>u).sort((o,u)=>n[o].vertexStart-n[u].vertexStart),s=this.geometry;for(let o=0,u=n.length;o<u;o++){const f=r[o],p=n[f];if(p.active!==!1){if(s.index!==null){if(p.indexStart!==t){const{indexStart:g,vertexStart:v,reservedIndexCount:y}=p,A=s.index,S=A.array,T=e-v;for(let M=g;M<g+y;M++)S[M]=S[M]+T;A.array.copyWithin(t,g,g+y),A.addUpdateRange(t,y),A.needsUpdate=!0,p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:g,reservedVertexCount:v}=p,y=s.attributes;for(const A in y){const S=y[A],{array:T,itemSize:M}=S;T.copyWithin(e*M,g*M,(g+v)*M),S.addUpdateRange(e*M,v*M),S.needsUpdate=!0}p.vertexStart=e}e+=p.reservedVertexCount,p.start=s.index?p.indexStart:p.vertexStart,this._nextIndexStart=s.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new Es,o=n.index,u=n.attributes.position;for(let f=r.start,p=r.start+r.count;f<p;f++){let g=f;o&&(g=o.getX(g)),s.expandByPoint(Mg.fromBufferAttribute(u,g))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Wr;this.getBoundingBoxAt(e,ry),ry.getCenter(s.center);const o=n.index,u=n.attributes.position;let f=0;for(let p=r.start,g=r.start+r.count;p<g;p++){let v=p;o&&(v=o.getX(v)),Mg.fromBufferAttribute(u,v),f=Math.max(f,s.center.distanceToSquared(Mg))}s.radius=Math.sqrt(f),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(Tb);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);yf(this._multiDrawCounts,r),yf(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const o=this._indirectTexture,u=this._matricesTexture,f=this._colorsTexture;o.dispose(),this._initIndirectTexture(),yf(o.image.data,this._indirectTexture.image.data),u.dispose(),this._initMatricesTexture(),yf(u.image.data,this._matricesTexture.image.data),f&&(f.dispose(),this._initColorsTexture(),yf(f.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(u=>u.active);if(Math.max(...n.map(u=>u.vertexStart+u.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(f=>f.indexStart+f.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new pn,this._initializeGeometry(s));const o=this.geometry;s.index&&yf(s.index.array,o.index.array);for(const u in s.attributes)yf(s.attributes[u].array,o.attributes[u].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,o=this.geometry;Hs.material=this.material,Hs.geometry.index=o.index,Hs.geometry.attributes=o.attributes,Hs.geometry.boundingBox===null&&(Hs.geometry.boundingBox=new Es),Hs.geometry.boundingSphere===null&&(Hs.geometry.boundingSphere=new Wr);for(let u=0,f=n.length;u<f;u++){if(!n[u].visible||!n[u].active)continue;const p=n[u].geometryIndex,g=r[p];Hs.geometry.setDrawRange(g.start,g.count),this.getMatrixAt(u,Hs.matrixWorld).premultiply(s),this.getBoundingBoxAt(p,Hs.geometry.boundingBox),this.getBoundingSphereAt(p,Hs.geometry.boundingSphere),Hs.raycast(e,sy);for(let v=0,y=sy.length;v<y;v++){const A=sy[v];A.object=this,A.batchId=u,t.push(A)}sy.length=0}Hs.material=null,Hs.geometry.index=null,Hs.geometry.attributes={},Hs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),u=o===null?1:o.array.BYTES_PER_ELEMENT,f=this._instanceInfo,p=this._multiDrawStarts,g=this._multiDrawCounts,v=this._geometryInfo,y=this.perObjectFrustumCulled,A=this._indirectTexture,S=A.image.data,T=n.isArrayCamera?w5:RC;y&&!n.isArrayCamera&&(La.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),RC.setFromProjectionMatrix(La,n.coordinateSystem,n.reversedDepth));let M=0;if(this.sortObjects){La.copy(this.matrixWorld).invert(),Mg.setFromMatrixPosition(n.matrixWorld).applyMatrix4(La),DC.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(La);for(let I=0,O=f.length;I<O;I++)if(f[I].visible&&f[I].active){const F=f[I].geometryIndex;this.getMatrixAt(I,La),this.getBoundingSphereAt(F,xf).applyMatrix4(La);let z=!1;if(y&&(z=!T.intersectsSphere(xf,n)),!z){const j=v[F],W=C5.subVectors(xf.center,Mg).dot(DC);wb.push(j.start,j.count,W,I)}}const E=wb.list,R=this.customSort;R===null?E.sort(s.transparent?E5:b5):R.call(this,E,n);for(let I=0,O=E.length;I<O;I++){const F=E[I];p[M]=F.start*u,g[M]=F.count,S[M]=F.index,M++}wb.reset()}else for(let E=0,R=f.length;E<R;E++)if(f[E].visible&&f[E].active){const I=f[E].geometryIndex;let O=!1;if(y&&(this.getMatrixAt(E,La),this.getBoundingSphereAt(I,xf).applyMatrix4(La),O=!T.intersectsSphere(xf,n)),!O){const F=v[I];p[M]=F.start*u,g[M]=F.count,S[M]=E,M++}}A.needsUpdate=!0,this._multiDrawCount=M,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class Ms extends mr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ft(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const GA=new Q,kA=new Q,IC=new jt,Tg=new bd,ay=new Wr,Cb=new Q,BC=new Q;class sc extends ni{constructor(e=new pn,t=new Ms){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)GA.fromBufferAttribute(t,r-1),kA.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=GA.distanceTo(kA);e.setAttribute("lineDistance",new Jt(n,1))}else Ht("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ay.copy(n.boundingSphere),ay.applyMatrix4(r),ay.radius+=s,e.ray.intersectsSphere(ay)===!1)return;IC.copy(r).invert(),Tg.copy(e.ray).applyMatrix4(IC);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,p=this.isLineSegments?2:1,g=n.index,y=n.attributes.position;if(g!==null){const A=Math.max(0,o.start),S=Math.min(g.count,o.start+o.count);for(let T=A,M=S-1;T<M;T+=p){const E=g.getX(T),R=g.getX(T+1),I=oy(this,e,Tg,f,E,R,T);I&&t.push(I)}if(this.isLineLoop){const T=g.getX(S-1),M=g.getX(A),E=oy(this,e,Tg,f,T,M,S-1);E&&t.push(E)}}else{const A=Math.max(0,o.start),S=Math.min(y.count,o.start+o.count);for(let T=A,M=S-1;T<M;T+=p){const E=oy(this,e,Tg,f,T,T+1,T);E&&t.push(E)}if(this.isLineLoop){const T=oy(this,e,Tg,f,S-1,A,S-1);T&&t.push(T)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const u=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}function oy(i,e,t,n,r,s,o){const u=i.geometry.attributes.position;if(GA.fromBufferAttribute(u,r),kA.fromBufferAttribute(u,s),t.distanceSqToSegment(GA,kA,Cb,BC)>n)return;Cb.applyMatrix4(i.matrixWorld);const p=e.ray.origin.distanceTo(Cb);if(!(p<e.near||p>e.far))return{distance:p,point:BC.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const NC=new Q,OC=new Q;class xl extends sc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)NC.fromBufferAttribute(t,r),OC.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+NC.distanceTo(OC);e.setAttribute("lineDistance",new Jt(n,1))}else Ht("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class qM extends sc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class w_ extends mr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const LC=new jt,NE=new bd,ly=new Wr,cy=new Q;class JM extends ni{constructor(e=new pn,t=new w_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ly.copy(n.boundingSphere),ly.applyMatrix4(r),ly.radius+=s,e.ray.intersectsSphere(ly)===!1)return;LC.copy(r).invert(),NE.copy(e.ray).applyMatrix4(LC);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,p=n.index,v=n.attributes.position;if(p!==null){const y=Math.max(0,o.start),A=Math.min(p.count,o.start+o.count);for(let S=y,T=A;S<T;S++){const M=p.getX(S);cy.fromBufferAttribute(v,M),PC(cy,M,f,r,e,t,this)}}else{const y=Math.max(0,o.start),A=Math.min(v.count,o.start+o.count);for(let S=y,T=A;S<T;S++)cy.fromBufferAttribute(v,S),PC(cy,S,f,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const u=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}function PC(i,e,t,n,r,s,o){const u=NE.distanceSqToPoint(i);if(u<t){const f=new Q;NE.closestPointToPoint(i,f),f.applyMatrix4(n);const p=r.ray.origin.distanceTo(f);if(p<r.near||p>r.far)return;s.push({distance:p,distanceToRay:Math.sqrt(u),point:f,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class e4 extends Jn{constructor(e,t,n,r,s=on,o=on,u,f,p){super(e,t,n,r,s,o,u,f,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const g=this;function v(){g.needsUpdate=!0,g._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class D5 extends e4{constructor(e,t,n,r,s,o,u,f){super({},e,t,n,r,s,o,u,f),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class I5 extends Jn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=di,this.minFilter=di,this.generateMipmaps=!1,this.needsUpdate=!0}}class C_ extends Jn{constructor(e,t,n,r,s,o,u,f,p,g,v,y){super(null,o,u,f,p,g,r,s,v,y),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class B5 extends C_{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Ni,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class N5 extends C_{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,gl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class O5 extends Jn{constructor(e,t,n,r,s,o,u,f,p){super(e,t,n,r,s,o,u,f,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class _d extends Jn{constructor(e,t,n=ca,r,s,o,u=di,f=di,p,g=rc,v=1){if(g!==rc&&g!==nu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const y={width:e,height:t,depth:v};super(y,r,s,o,u,f,g,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new fd(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class t4 extends _d{constructor(e,t=ca,n=gl,r,s,o=di,u=di,f,p=rc){const g={width:e,height:e,depth:1},v=[g,g,g,g,g,g];super(e,e,t,n,r,s,o,u,f,p),this.image=v,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class KM extends Jn{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class R_ extends pn{constructor(e=1,t=1,n=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:s},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const o=[],u=[],f=[],p=[],g=t/2,v=Math.PI/2*e,y=t,A=2*v+y,S=n*2+s,T=r+1,M=new Q,E=new Q;for(let R=0;R<=S;R++){let I=0,O=0,F=0,z=0;if(R<=n){const L=R/n,H=L*Math.PI/2;O=-g-e*Math.cos(H),F=e*Math.sin(H),z=-e*Math.cos(H),I=L*v}else if(R<=n+s){const L=(R-n)/s;O=-g+L*t,F=e,z=0,I=v+L*y}else{const L=(R-n-s)/n,H=L*Math.PI/2;O=g+e*Math.sin(H),F=e*Math.cos(H),z=e*Math.sin(H),I=v+y+L*v}const j=Math.max(0,Math.min(1,I/A));let W=0;R===0?W=.5/r:R===S&&(W=-.5/r);for(let L=0;L<=r;L++){const H=L/r,K=H*Math.PI*2,de=Math.sin(K),ce=Math.cos(K);E.x=-F*ce,E.y=O,E.z=F*de,u.push(E.x,E.y,E.z),M.set(-F*ce,z,F*de),M.normalize(),f.push(M.x,M.y,M.z),p.push(H+W,j)}if(R>0){const L=(R-1)*T;for(let H=0;H<r;H++){const K=L+H,de=L+H+1,ce=R*T+H,ne=R*T+H+1;o.push(K,de,ce),o.push(de,ne,ce)}}}this.setIndex(o),this.setAttribute("position",new Jt(u,3)),this.setAttribute("normal",new Jt(f,3)),this.setAttribute("uv",new Jt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new R_(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class D_ extends pn{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],u=[],f=[],p=new Q,g=new qe;o.push(0,0,0),u.push(0,0,1),f.push(.5,.5);for(let v=0,y=3;v<=t;v++,y+=3){const A=n+v/t*r;p.x=e*Math.cos(A),p.y=e*Math.sin(A),o.push(p.x,p.y,p.z),u.push(0,0,1),g.x=(o[y]/e+1)/2,g.y=(o[y+1]/e+1)/2,f.push(g.x,g.y)}for(let v=1;v<=t;v++)s.push(v,v+1,0);this.setIndex(s),this.setAttribute("position",new Jt(o,3)),this.setAttribute("normal",new Jt(u,3)),this.setAttribute("uv",new Jt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new D_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Pv extends pn{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,u=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:u,thetaLength:f};const p=this;r=Math.floor(r),s=Math.floor(s);const g=[],v=[],y=[],A=[];let S=0;const T=[],M=n/2;let E=0;R(),o===!1&&(e>0&&I(!0),t>0&&I(!1)),this.setIndex(g),this.setAttribute("position",new Jt(v,3)),this.setAttribute("normal",new Jt(y,3)),this.setAttribute("uv",new Jt(A,2));function R(){const O=new Q,F=new Q;let z=0;const j=(t-e)/n;for(let W=0;W<=s;W++){const L=[],H=W/s,K=H*(t-e)+e;for(let de=0;de<=r;de++){const ce=de/r,ne=ce*f+u,fe=Math.sin(ne),X=Math.cos(ne);F.x=K*fe,F.y=-H*n+M,F.z=K*X,v.push(F.x,F.y,F.z),O.set(fe,j,X).normalize(),y.push(O.x,O.y,O.z),A.push(ce,1-H),L.push(S++)}T.push(L)}for(let W=0;W<r;W++)for(let L=0;L<s;L++){const H=T[L][W],K=T[L+1][W],de=T[L+1][W+1],ce=T[L][W+1];(e>0||L!==0)&&(g.push(H,K,ce),z+=3),(t>0||L!==s-1)&&(g.push(K,de,ce),z+=3)}p.addGroup(E,z,0),E+=z}function I(O){const F=S,z=new qe,j=new Q;let W=0;const L=O===!0?e:t,H=O===!0?1:-1;for(let de=1;de<=r;de++)v.push(0,M*H,0),y.push(0,H,0),A.push(.5,.5),S++;const K=S;for(let de=0;de<=r;de++){const ne=de/r*f+u,fe=Math.cos(ne),X=Math.sin(ne);j.x=L*X,j.y=M*H,j.z=L*fe,v.push(j.x,j.y,j.z),y.push(0,H,0),z.x=fe*.5+.5,z.y=X*.5*H+.5,A.push(z.x,z.y),S++}for(let de=0;de<r;de++){const ce=F+de,ne=K+de;O===!0?g.push(ne,ne+1,ce):g.push(ne+1,ne,ce),W+=3}p.addGroup(E,W,O===!0?1:2),E+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pv(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Uv extends Pv{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,u=Math.PI*2){super(0,e,t,n,r,s,o,u),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:u}}static fromJSON(e){return new Uv(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Md extends pn{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];u(r),p(n),g(),this.setAttribute("position",new Jt(s,3)),this.setAttribute("normal",new Jt(s.slice(),3)),this.setAttribute("uv",new Jt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function u(R){const I=new Q,O=new Q,F=new Q;for(let z=0;z<t.length;z+=3)A(t[z+0],I),A(t[z+1],O),A(t[z+2],F),f(I,O,F,R)}function f(R,I,O,F){const z=F+1,j=[];for(let W=0;W<=z;W++){j[W]=[];const L=R.clone().lerp(O,W/z),H=I.clone().lerp(O,W/z),K=z-W;for(let de=0;de<=K;de++)de===0&&W===z?j[W][de]=L:j[W][de]=L.clone().lerp(H,de/K)}for(let W=0;W<z;W++)for(let L=0;L<2*(z-W)-1;L++){const H=Math.floor(L/2);L%2===0?(y(j[W][H+1]),y(j[W+1][H]),y(j[W][H])):(y(j[W][H+1]),y(j[W+1][H+1]),y(j[W+1][H]))}}function p(R){const I=new Q;for(let O=0;O<s.length;O+=3)I.x=s[O+0],I.y=s[O+1],I.z=s[O+2],I.normalize().multiplyScalar(R),s[O+0]=I.x,s[O+1]=I.y,s[O+2]=I.z}function g(){const R=new Q;for(let I=0;I<s.length;I+=3){R.x=s[I+0],R.y=s[I+1],R.z=s[I+2];const O=M(R)/2/Math.PI+.5,F=E(R)/Math.PI+.5;o.push(O,1-F)}S(),v()}function v(){for(let R=0;R<o.length;R+=6){const I=o[R+0],O=o[R+2],F=o[R+4],z=Math.max(I,O,F),j=Math.min(I,O,F);z>.9&&j<.1&&(I<.2&&(o[R+0]+=1),O<.2&&(o[R+2]+=1),F<.2&&(o[R+4]+=1))}}function y(R){s.push(R.x,R.y,R.z)}function A(R,I){const O=R*3;I.x=e[O+0],I.y=e[O+1],I.z=e[O+2]}function S(){const R=new Q,I=new Q,O=new Q,F=new Q,z=new qe,j=new qe,W=new qe;for(let L=0,H=0;L<s.length;L+=9,H+=6){R.set(s[L+0],s[L+1],s[L+2]),I.set(s[L+3],s[L+4],s[L+5]),O.set(s[L+6],s[L+7],s[L+8]),z.set(o[H+0],o[H+1]),j.set(o[H+2],o[H+3]),W.set(o[H+4],o[H+5]),F.copy(R).add(I).add(O).divideScalar(3);const K=M(F);T(z,H+0,R,K),T(j,H+2,I,K),T(W,H+4,O,K)}}function T(R,I,O,F){F<0&&R.x===1&&(o[I]=R.x-1),O.x===0&&O.z===0&&(o[I]=F/2/Math.PI+.5)}function M(R){return Math.atan2(R.z,-R.x)}function E(R){return Math.atan2(-R.y,Math.sqrt(R.x*R.x+R.z*R.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Md(e.vertices,e.indices,e.radius,e.detail)}}class I_ extends Md{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new I_(e.radius,e.detail)}}const uy=new Q,dy=new Q,Rb=new Q,fy=new Fa;class n4 extends pn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Wf*t),o=e.getIndex(),u=e.getAttribute("position"),f=o?o.count:u.count,p=[0,0,0],g=["a","b","c"],v=new Array(3),y={},A=[];for(let S=0;S<f;S+=3){o?(p[0]=o.getX(S),p[1]=o.getX(S+1),p[2]=o.getX(S+2)):(p[0]=S,p[1]=S+1,p[2]=S+2);const{a:T,b:M,c:E}=fy;if(T.fromBufferAttribute(u,p[0]),M.fromBufferAttribute(u,p[1]),E.fromBufferAttribute(u,p[2]),fy.getNormal(Rb),v[0]=`${Math.round(T.x*r)},${Math.round(T.y*r)},${Math.round(T.z*r)}`,v[1]=`${Math.round(M.x*r)},${Math.round(M.y*r)},${Math.round(M.z*r)}`,v[2]=`${Math.round(E.x*r)},${Math.round(E.y*r)},${Math.round(E.z*r)}`,!(v[0]===v[1]||v[1]===v[2]||v[2]===v[0]))for(let R=0;R<3;R++){const I=(R+1)%3,O=v[R],F=v[I],z=fy[g[R]],j=fy[g[I]],W=`${O}_${F}`,L=`${F}_${O}`;L in y&&y[L]?(Rb.dot(y[L].normal)<=s&&(A.push(z.x,z.y,z.z),A.push(j.x,j.y,j.z)),y[L]=null):W in y||(y[W]={index0:p[R],index1:p[I],normal:Rb.clone()})}}for(const S in y)if(y[S]){const{index0:T,index1:M}=y[S];uy.fromBufferAttribute(u,T),dy.fromBufferAttribute(u,M),A.push(uy.x,uy.y,uy.z),A.push(dy.x,dy.y,dy.z)}this.setAttribute("position",new Jt(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class yl{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Ht("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let u=0,f=s-1,p;for(;u<=f;)if(r=Math.floor(u+(f-u)/2),p=n[r]-o,p<0)u=r+1;else if(p>0)f=r-1;else{f=r;break}if(r=f,n[r]===o)return r/(s-1);const g=n[r],y=n[r+1]-g,A=(o-g)/y;return(r+A)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),u=this.getPoint(s),f=t||(o.isVector2?new qe:new Q);return f.copy(u).sub(o).normalize(),f}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Q,r=[],s=[],o=[],u=new Q,f=new jt;for(let A=0;A<=e;A++){const S=A/e;r[A]=this.getTangentAt(S,new Q)}s[0]=new Q,o[0]=new Q;let p=Number.MAX_VALUE;const g=Math.abs(r[0].x),v=Math.abs(r[0].y),y=Math.abs(r[0].z);g<=p&&(p=g,n.set(1,0,0)),v<=p&&(p=v,n.set(0,1,0)),y<=p&&n.set(0,0,1),u.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],u),o[0].crossVectors(r[0],s[0]);for(let A=1;A<=e;A++){if(s[A]=s[A-1].clone(),o[A]=o[A-1].clone(),u.crossVectors(r[A-1],r[A]),u.length()>Number.EPSILON){u.normalize();const S=Math.acos(gn(r[A-1].dot(r[A]),-1,1));s[A].applyMatrix4(f.makeRotationAxis(u,S))}o[A].crossVectors(r[A],s[A])}if(t===!0){let A=Math.acos(gn(s[0].dot(s[e]),-1,1));A/=e,r[0].dot(u.crossVectors(s[0],s[e]))>0&&(A=-A);for(let S=1;S<=e;S++)s[S].applyMatrix4(f.makeRotationAxis(r[S],A*S)),o[S].crossVectors(r[S],s[S])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class B_ extends yl{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,u=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=u,this.aRotation=f}getPoint(e,t=new qe){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const u=this.aStartAngle+e*s;let f=this.aX+this.xRadius*Math.cos(u),p=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const g=Math.cos(this.aRotation),v=Math.sin(this.aRotation),y=f-this.aX,A=p-this.aY;f=y*g-A*v+this.aX,p=y*v+A*g+this.aY}return n.set(f,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class i4 extends B_{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function ZM(){let i=0,e=0,t=0,n=0;function r(s,o,u,f){i=s,e=u,t=-3*s+3*o-2*u-f,n=2*s-2*o+u+f}return{initCatmullRom:function(s,o,u,f,p){r(o,u,p*(u-s),p*(f-o))},initNonuniformCatmullRom:function(s,o,u,f,p,g,v){let y=(o-s)/p-(u-s)/(p+g)+(u-o)/g,A=(u-o)/g-(f-o)/(g+v)+(f-u)/v;y*=g,A*=g,r(o,u,y,A)},calc:function(s){const o=s*s,u=o*s;return i+e*s+t*o+n*u}}}const hy=new Q,Db=new ZM,Ib=new ZM,Bb=new ZM;class r4 extends yl{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Q){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let u=Math.floor(o),f=o-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/s)+1)*s:f===0&&u===s-1&&(u=s-2,f=1);let p,g;this.closed||u>0?p=r[(u-1)%s]:(hy.subVectors(r[0],r[1]).add(r[0]),p=hy);const v=r[u%s],y=r[(u+1)%s];if(this.closed||u+2<s?g=r[(u+2)%s]:(hy.subVectors(r[s-1],r[s-2]).add(r[s-1]),g=hy),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let S=Math.pow(p.distanceToSquared(v),A),T=Math.pow(v.distanceToSquared(y),A),M=Math.pow(y.distanceToSquared(g),A);T<1e-4&&(T=1),S<1e-4&&(S=T),M<1e-4&&(M=T),Db.initNonuniformCatmullRom(p.x,v.x,y.x,g.x,S,T,M),Ib.initNonuniformCatmullRom(p.y,v.y,y.y,g.y,S,T,M),Bb.initNonuniformCatmullRom(p.z,v.z,y.z,g.z,S,T,M)}else this.curveType==="catmullrom"&&(Db.initCatmullRom(p.x,v.x,y.x,g.x,this.tension),Ib.initCatmullRom(p.y,v.y,y.y,g.y,this.tension),Bb.initCatmullRom(p.z,v.z,y.z,g.z,this.tension));return n.set(Db.calc(f),Ib.calc(f),Bb.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Q().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function UC(i,e,t,n,r){const s=(n-e)*.5,o=(r-t)*.5,u=i*i,f=i*u;return(2*t-2*n+s+o)*f+(-3*t+3*n-2*s-o)*u+s*i+t}function L5(i,e){const t=1-i;return t*t*e}function P5(i,e){return 2*(1-i)*i*e}function U5(i,e){return i*i*e}function ev(i,e,t,n){return L5(i,e)+P5(i,t)+U5(i,n)}function F5(i,e){const t=1-i;return t*t*t*e}function z5(i,e){const t=1-i;return 3*t*t*i*e}function H5(i,e){return 3*(1-i)*i*i*e}function G5(i,e){return i*i*i*e}function tv(i,e,t,n,r){return F5(i,e)+z5(i,t)+H5(i,n)+G5(i,r)}class $M extends yl{constructor(e=new qe,t=new qe,n=new qe,r=new qe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new qe){const n=t,r=this.v0,s=this.v1,o=this.v2,u=this.v3;return n.set(tv(e,r.x,s.x,o.x,u.x),tv(e,r.y,s.y,o.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class s4 extends yl{constructor(e=new Q,t=new Q,n=new Q,r=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Q){const n=t,r=this.v0,s=this.v1,o=this.v2,u=this.v3;return n.set(tv(e,r.x,s.x,o.x,u.x),tv(e,r.y,s.y,o.y,u.y),tv(e,r.z,s.z,o.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class eT extends yl{constructor(e=new qe,t=new qe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new qe){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new qe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class VA extends yl{constructor(e=new Q,t=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Q){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Q){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tT extends yl{constructor(e=new qe,t=new qe,n=new qe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new qe){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(ev(e,r.x,s.x,o.x),ev(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class N_ extends yl{constructor(e=new Q,t=new Q,n=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Q){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(ev(e,r.x,s.x,o.x),ev(e,r.y,s.y,o.y),ev(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nT extends yl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new qe){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),u=s-o,f=r[o===0?o:o-1],p=r[o],g=r[o>r.length-2?r.length-1:o+1],v=r[o>r.length-3?r.length-1:o+2];return n.set(UC(u,f.x,p.x,g.x,v.x),UC(u,f.y,p.y,g.y,v.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new qe().fromArray(r))}return this}}var jA=Object.freeze({__proto__:null,ArcCurve:i4,CatmullRomCurve3:r4,CubicBezierCurve:$M,CubicBezierCurve3:s4,EllipseCurve:B_,LineCurve:eT,LineCurve3:VA,QuadraticBezierCurve:tT,QuadraticBezierCurve3:N_,SplineCurve:nT});class iT extends yl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new jA[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,u=this.curves[s],f=u.getLength(),p=f===0?0:1-o/f;return u.getPointAt(p,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],u=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,f=o.getPoints(u);for(let p=0;p<f.length;p++){const g=f[p];n&&n.equals(g)||(t.push(g),n=g)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new jA[r.type]().fromJSON(r))}return this}}class WA extends iT{constructor(e){super(),this.type="Path",this.currentPoint=new qe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new eT(this.currentPoint.clone(),new qe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new tT(this.currentPoint.clone(),new qe(e,t),new qe(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const u=new $M(this.currentPoint.clone(),new qe(e,t),new qe(n,r),new qe(s,o));return this.curves.push(u),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new nT(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){const u=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+u,t+f,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,u,f){const p=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(e+p,t+g,n,r,s,o,u,f),this}absellipse(e,t,n,r,s,o,u,f){const p=new B_(e,t,n,r,s,o,u,f);if(this.curves.length>0){const v=p.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(p);const g=p.getPoint(1);return this.currentPoint.copy(g),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Xf extends WA{constructor(e){super(e),this.uuid=$a(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new WA().fromJSON(r))}return this}}function k5(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=a4(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let u,f,p;if(n&&(s=Y5(i,e,s,t)),i.length>80*t){u=i[0],f=i[1];let g=u,v=f;for(let y=t;y<r;y+=t){const A=i[y],S=i[y+1];A<u&&(u=A),S<f&&(f=S),A>g&&(g=A),S>v&&(v=S)}p=Math.max(g-u,v-f),p=p!==0?32767/p:0}return vv(s,o,t,u,f,p,0),o}function a4(i,e,t,n,r){let s;if(r===r8(i,e,t,n)>0)for(let o=e;o<t;o+=n)s=FC(o/n|0,i[o],i[o+1],s);else for(let o=t-n;o>=e;o-=n)s=FC(o/n|0,i[o],i[o+1],s);return s&&bm(s,s.next)&&(yv(s),s=s.next),s}function th(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(bm(t,t.next)||pr(t.prev,t,t.next)===0)){if(yv(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function vv(i,e,t,n,r,s,o){if(!i)return;!o&&s&&Z5(i,n,r,s);let u=i;for(;i.prev!==i.next;){const f=i.prev,p=i.next;if(s?j5(i,n,r,s):V5(i)){e.push(f.i,i.i,p.i),yv(i),i=p.next,u=p.next;continue}if(i=p,i===u){o?o===1?(i=W5(th(i),e),vv(i,e,t,n,r,s,2)):o===2&&X5(i,e,t,n,r,s):vv(th(i),e,t,n,r,s,1);break}}}function V5(i){const e=i.prev,t=i,n=i.next;if(pr(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,u=e.y,f=t.y,p=n.y,g=Math.min(r,s,o),v=Math.min(u,f,p),y=Math.max(r,s,o),A=Math.max(u,f,p);let S=n.next;for(;S!==e;){if(S.x>=g&&S.x<=y&&S.y>=v&&S.y<=A&&kg(r,u,s,f,o,p,S.x,S.y)&&pr(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function j5(i,e,t,n){const r=i.prev,s=i,o=i.next;if(pr(r,s,o)>=0)return!1;const u=r.x,f=s.x,p=o.x,g=r.y,v=s.y,y=o.y,A=Math.min(u,f,p),S=Math.min(g,v,y),T=Math.max(u,f,p),M=Math.max(g,v,y),E=OE(A,S,e,t,n),R=OE(T,M,e,t,n);let I=i.prevZ,O=i.nextZ;for(;I&&I.z>=E&&O&&O.z<=R;){if(I.x>=A&&I.x<=T&&I.y>=S&&I.y<=M&&I!==r&&I!==o&&kg(u,g,f,v,p,y,I.x,I.y)&&pr(I.prev,I,I.next)>=0||(I=I.prevZ,O.x>=A&&O.x<=T&&O.y>=S&&O.y<=M&&O!==r&&O!==o&&kg(u,g,f,v,p,y,O.x,O.y)&&pr(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;I&&I.z>=E;){if(I.x>=A&&I.x<=T&&I.y>=S&&I.y<=M&&I!==r&&I!==o&&kg(u,g,f,v,p,y,I.x,I.y)&&pr(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;O&&O.z<=R;){if(O.x>=A&&O.x<=T&&O.y>=S&&O.y<=M&&O!==r&&O!==o&&kg(u,g,f,v,p,y,O.x,O.y)&&pr(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function W5(i,e){let t=i;do{const n=t.prev,r=t.next.next;!bm(n,r)&&l4(n,t,t.next,r)&&xv(n,r)&&xv(r,n)&&(e.push(n.i,t.i,r.i),yv(t),yv(t.next),t=i=r),t=t.next}while(t!==i);return th(t)}function X5(i,e,t,n,r,s){let o=i;do{let u=o.next.next;for(;u!==o.prev;){if(o.i!==u.i&&t8(o,u)){let f=c4(o,u);o=th(o,o.next),f=th(f,f.next),vv(o,e,t,n,r,s,0),vv(f,e,t,n,r,s,0);return}u=u.next}o=o.next}while(o!==i)}function Y5(i,e,t,n){const r=[];for(let s=0,o=e.length;s<o;s++){const u=e[s]*n,f=s<o-1?e[s+1]*n:i.length,p=a4(i,u,f,n,!1);p===p.next&&(p.steiner=!0),r.push(e8(p))}r.sort(Q5);for(let s=0;s<r.length;s++)t=q5(r[s],t);return t}function Q5(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function q5(i,e){const t=J5(i,e);if(!t)return e;const n=c4(t,i);return th(n,n.next),th(t,t.next)}function J5(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,o;if(bm(i,t))return t;do{if(bm(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const v=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=n&&v>s&&(s=v,o=t.x<t.next.x?t:t.next,v===n))return o}t=t.next}while(t!==e);if(!o)return null;const u=o,f=o.x,p=o.y;let g=1/0;t=o;do{if(n>=t.x&&t.x>=f&&n!==t.x&&o4(r<p?n:s,r,f,p,r<p?s:n,r,t.x,t.y)){const v=Math.abs(r-t.y)/(n-t.x);xv(t,i)&&(v<g||v===g&&(t.x>o.x||t.x===o.x&&K5(o,t)))&&(o=t,g=v)}t=t.next}while(t!==u);return o}function K5(i,e){return pr(i.prev,i,e.prev)<0&&pr(e.next,i,i.next)<0}function Z5(i,e,t,n){let r=i;do r.z===0&&(r.z=OE(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,$5(r)}function $5(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let o=n,u=0;for(let p=0;p<t&&(u++,o=o.nextZ,!!o);p++);let f=t;for(;u>0||f>0&&o;)u!==0&&(f===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,u--):(r=o,o=o.nextZ,f--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=o}s.nextZ=null,t*=2}while(e>1);return i}function OE(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function e8(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function o4(i,e,t,n,r,s,o,u){return(r-o)*(e-u)>=(i-o)*(s-u)&&(i-o)*(n-u)>=(t-o)*(e-u)&&(t-o)*(s-u)>=(r-o)*(n-u)}function kg(i,e,t,n,r,s,o,u){return!(i===o&&e===u)&&o4(i,e,t,n,r,s,o,u)}function t8(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!n8(i,e)&&(xv(i,e)&&xv(e,i)&&i8(i,e)&&(pr(i.prev,i,e.prev)||pr(i,e.prev,e))||bm(i,e)&&pr(i.prev,i,i.next)>0&&pr(e.prev,e,e.next)>0)}function pr(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function bm(i,e){return i.x===e.x&&i.y===e.y}function l4(i,e,t,n){const r=my(pr(i,e,t)),s=my(pr(i,e,n)),o=my(pr(t,n,i)),u=my(pr(t,n,e));return!!(r!==s&&o!==u||r===0&&py(i,t,e)||s===0&&py(i,n,e)||o===0&&py(t,i,n)||u===0&&py(t,e,n))}function py(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function my(i){return i>0?1:i<0?-1:0}function n8(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&l4(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function xv(i,e){return pr(i.prev,i,i.next)<0?pr(i,e,i.next)>=0&&pr(i,i.prev,e)>=0:pr(i,e,i.prev)<0||pr(i,i.next,e)<0}function i8(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function c4(i,e){const t=LE(i.i,i.x,i.y),n=LE(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function FC(i,e,t,n){const r=LE(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function yv(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function LE(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function r8(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}class s8{static triangulate(e,t,n=2){return k5(e,t,n)}}class fl{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return fl.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];zC(e),HC(n,e);let o=e.length;t.forEach(zC);for(let f=0;f<t.length;f++)r.push(o),o+=t[f].length,HC(n,t[f]);const u=s8.triangulate(n,r);for(let f=0;f<u.length;f+=3)s.push(u.slice(f,f+3));return s}}function zC(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function HC(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class O_ extends pn{constructor(e=new Xf([new qe(.5,.5),new qe(-.5,.5),new qe(-.5,-.5),new qe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let u=0,f=e.length;u<f;u++){const p=e[u];o(p)}this.setAttribute("position",new Jt(r,3)),this.setAttribute("uv",new Jt(s,2)),this.computeVertexNormals();function o(u){const f=[],p=t.curveSegments!==void 0?t.curveSegments:12,g=t.steps!==void 0?t.steps:1,v=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,A=t.bevelThickness!==void 0?t.bevelThickness:.2,S=t.bevelSize!==void 0?t.bevelSize:A-.1,T=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const E=t.extrudePath,R=t.UVGenerator!==void 0?t.UVGenerator:a8;let I,O=!1,F,z,j,W;if(E){I=E.getSpacedPoints(g),O=!0,y=!1;const je=E.isCatmullRomCurve3?E.closed:!1;F=E.computeFrenetFrames(g,je),z=new Q,j=new Q,W=new Q}y||(M=0,A=0,S=0,T=0);const L=u.extractPoints(p);let H=L.shape;const K=L.holes;if(!fl.isClockWise(H)){H=H.reverse();for(let je=0,st=K.length;je<st;je++){const et=K[je];fl.isClockWise(et)&&(K[je]=et.reverse())}}function ce(je){const et=10000000000000001e-36;let At=je[0];for(let oe=1;oe<=je.length;oe++){const Gt=oe%je.length,Dt=je[Gt],qt=Dt.x-At.x,Tt=Dt.y-At.y,te=qt*qt+Tt*Tt,G=Math.max(Math.abs(Dt.x),Math.abs(Dt.y),Math.abs(At.x),Math.abs(At.y)),be=et*G*G;if(te<=be){je.splice(Gt,1),oe--;continue}At=Dt}}ce(H),K.forEach(ce);const ne=K.length,fe=H;for(let je=0;je<ne;je++){const st=K[je];H=H.concat(st)}function X(je,st,et){return st||nn("ExtrudeGeometry: vec does not exist"),je.clone().addScaledVector(st,et)}const re=H.length;function ge(je,st,et){let At,oe,Gt;const Dt=je.x-st.x,qt=je.y-st.y,Tt=et.x-je.x,te=et.y-je.y,G=Dt*Dt+qt*qt,be=Dt*te-qt*Tt;if(Math.abs(be)>Number.EPSILON){const Ye=Math.sqrt(G),ot=Math.sqrt(Tt*Tt+te*te),Qe=st.x-qt/Ye,Ut=st.y+Dt/Ye,Rt=et.x-te/ot,Vt=et.y+Tt/ot,$t=((Rt-Qe)*te-(Vt-Ut)*Tt)/(Dt*te-qt*Tt);At=Qe+Dt*$t-je.x,oe=Ut+qt*$t-je.y;const vt=At*At+oe*oe;if(vt<=2)return new qe(At,oe);Gt=Math.sqrt(vt/2)}else{let Ye=!1;Dt>Number.EPSILON?Tt>Number.EPSILON&&(Ye=!0):Dt<-Number.EPSILON?Tt<-Number.EPSILON&&(Ye=!0):Math.sign(qt)===Math.sign(te)&&(Ye=!0),Ye?(At=-qt,oe=Dt,Gt=Math.sqrt(G)):(At=Dt,oe=qt,Gt=Math.sqrt(G/2))}return new qe(At/Gt,oe/Gt)}const Te=[];for(let je=0,st=fe.length,et=st-1,At=je+1;je<st;je++,et++,At++)et===st&&(et=0),At===st&&(At=0),Te[je]=ge(fe[je],fe[et],fe[At]);const Se=[];let Y,me=Te.concat();for(let je=0,st=ne;je<st;je++){const et=K[je];Y=[];for(let At=0,oe=et.length,Gt=oe-1,Dt=At+1;At<oe;At++,Gt++,Dt++)Gt===oe&&(Gt=0),Dt===oe&&(Dt=0),Y[At]=ge(et[At],et[Gt],et[Dt]);Se.push(Y),me=me.concat(Y)}let Ce;if(M===0)Ce=fl.triangulateShape(fe,K);else{const je=[],st=[];for(let et=0;et<M;et++){const At=et/M,oe=A*Math.cos(At*Math.PI/2),Gt=S*Math.sin(At*Math.PI/2)+T;for(let Dt=0,qt=fe.length;Dt<qt;Dt++){const Tt=X(fe[Dt],Te[Dt],Gt);Ee(Tt.x,Tt.y,-oe),At===0&&je.push(Tt)}for(let Dt=0,qt=ne;Dt<qt;Dt++){const Tt=K[Dt];Y=Se[Dt];const te=[];for(let G=0,be=Tt.length;G<be;G++){const Ye=X(Tt[G],Y[G],Gt);Ee(Ye.x,Ye.y,-oe),At===0&&te.push(Ye)}At===0&&st.push(te)}}Ce=fl.triangulateShape(je,st)}const Ze=Ce.length,xt=S+T;for(let je=0;je<re;je++){const st=y?X(H[je],me[je],xt):H[je];O?(j.copy(F.normals[0]).multiplyScalar(st.x),z.copy(F.binormals[0]).multiplyScalar(st.y),W.copy(I[0]).add(j).add(z),Ee(W.x,W.y,W.z)):Ee(st.x,st.y,0)}for(let je=1;je<=g;je++)for(let st=0;st<re;st++){const et=y?X(H[st],me[st],xt):H[st];O?(j.copy(F.normals[je]).multiplyScalar(et.x),z.copy(F.binormals[je]).multiplyScalar(et.y),W.copy(I[je]).add(j).add(z),Ee(W.x,W.y,W.z)):Ee(et.x,et.y,v/g*je)}for(let je=M-1;je>=0;je--){const st=je/M,et=A*Math.cos(st*Math.PI/2),At=S*Math.sin(st*Math.PI/2)+T;for(let oe=0,Gt=fe.length;oe<Gt;oe++){const Dt=X(fe[oe],Te[oe],At);Ee(Dt.x,Dt.y,v+et)}for(let oe=0,Gt=K.length;oe<Gt;oe++){const Dt=K[oe];Y=Se[oe];for(let qt=0,Tt=Dt.length;qt<Tt;qt++){const te=X(Dt[qt],Y[qt],At);O?Ee(te.x,te.y+I[g-1].y,I[g-1].x+et):Ee(te.x,te.y,v+et)}}}ve(),ze();function ve(){const je=r.length/3;if(y){let st=0,et=re*st;for(let At=0;At<Ze;At++){const oe=Ce[At];yt(oe[2]+et,oe[1]+et,oe[0]+et)}st=g+M*2,et=re*st;for(let At=0;At<Ze;At++){const oe=Ce[At];yt(oe[0]+et,oe[1]+et,oe[2]+et)}}else{for(let st=0;st<Ze;st++){const et=Ce[st];yt(et[2],et[1],et[0])}for(let st=0;st<Ze;st++){const et=Ce[st];yt(et[0]+re*g,et[1]+re*g,et[2]+re*g)}}n.addGroup(je,r.length/3-je,0)}function ze(){const je=r.length/3;let st=0;dt(fe,st),st+=fe.length;for(let et=0,At=K.length;et<At;et++){const oe=K[et];dt(oe,st),st+=oe.length}n.addGroup(je,r.length/3-je,1)}function dt(je,st){let et=je.length;for(;--et>=0;){const At=et;let oe=et-1;oe<0&&(oe=je.length-1);for(let Gt=0,Dt=g+M*2;Gt<Dt;Gt++){const qt=re*Gt,Tt=re*(Gt+1),te=st+At+qt,G=st+oe+qt,be=st+oe+Tt,Ye=st+At+Tt;Pt(te,G,be,Ye)}}}function Ee(je,st,et){f.push(je),f.push(st),f.push(et)}function yt(je,st,et){Ot(je),Ot(st),Ot(et);const At=r.length/3,oe=R.generateTopUV(n,r,At-3,At-2,At-1);Mt(oe[0]),Mt(oe[1]),Mt(oe[2])}function Pt(je,st,et,At){Ot(je),Ot(st),Ot(At),Ot(st),Ot(et),Ot(At);const oe=r.length/3,Gt=R.generateSideWallUV(n,r,oe-6,oe-3,oe-2,oe-1);Mt(Gt[0]),Mt(Gt[1]),Mt(Gt[3]),Mt(Gt[1]),Mt(Gt[2]),Mt(Gt[3])}function Ot(je){r.push(f[je*3+0]),r.push(f[je*3+1]),r.push(f[je*3+2])}function Mt(je){s.push(je.x),s.push(je.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return o8(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const u=t[e.shapes[s]];n.push(u)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new jA[r.type]().fromJSON(r)),new O_(n,e.options)}}const a8={generateTopUV:function(i,e,t,n,r){const s=e[t*3],o=e[t*3+1],u=e[n*3],f=e[n*3+1],p=e[r*3],g=e[r*3+1];return[new qe(s,o),new qe(u,f),new qe(p,g)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[t*3],u=e[t*3+1],f=e[t*3+2],p=e[n*3],g=e[n*3+1],v=e[n*3+2],y=e[r*3],A=e[r*3+1],S=e[r*3+2],T=e[s*3],M=e[s*3+1],E=e[s*3+2];return Math.abs(u-g)<Math.abs(o-p)?[new qe(o,1-f),new qe(p,1-v),new qe(y,1-S),new qe(T,1-E)]:[new qe(u,1-f),new qe(g,1-v),new qe(A,1-S),new qe(M,1-E)]}};function o8(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Fv extends Md{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Fv(e.radius,e.detail)}}class L_ extends pn{constructor(e=[new qe(0,-.5),new qe(.5,0),new qe(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=gn(r,0,Math.PI*2);const s=[],o=[],u=[],f=[],p=[],g=1/t,v=new Q,y=new qe,A=new Q,S=new Q,T=new Q;let M=0,E=0;for(let R=0;R<=e.length-1;R++)switch(R){case 0:M=e[R+1].x-e[R].x,E=e[R+1].y-e[R].y,A.x=E*1,A.y=-M,A.z=E*0,T.copy(A),A.normalize(),f.push(A.x,A.y,A.z);break;case e.length-1:f.push(T.x,T.y,T.z);break;default:M=e[R+1].x-e[R].x,E=e[R+1].y-e[R].y,A.x=E*1,A.y=-M,A.z=E*0,S.copy(A),A.x+=T.x,A.y+=T.y,A.z+=T.z,A.normalize(),f.push(A.x,A.y,A.z),T.copy(S)}for(let R=0;R<=t;R++){const I=n+R*g*r,O=Math.sin(I),F=Math.cos(I);for(let z=0;z<=e.length-1;z++){v.x=e[z].x*O,v.y=e[z].y,v.z=e[z].x*F,o.push(v.x,v.y,v.z),y.x=R/t,y.y=z/(e.length-1),u.push(y.x,y.y);const j=f[3*z+0]*O,W=f[3*z+1],L=f[3*z+0]*F;p.push(j,W,L)}}for(let R=0;R<t;R++)for(let I=0;I<e.length-1;I++){const O=I+R*e.length,F=O,z=O+e.length,j=O+e.length+1,W=O+1;s.push(F,z,W),s.push(j,W,z)}this.setIndex(s),this.setAttribute("position",new Jt(o,3)),this.setAttribute("uv",new Jt(u,2)),this.setAttribute("normal",new Jt(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new L_(e.points,e.segments,e.phiStart,e.phiLength)}}class zv extends Md{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zv(e.radius,e.detail)}}class lc extends pn{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,u=Math.floor(n),f=Math.floor(r),p=u+1,g=f+1,v=e/u,y=t/f,A=[],S=[],T=[],M=[];for(let E=0;E<g;E++){const R=E*y-o;for(let I=0;I<p;I++){const O=I*v-s;S.push(O,-R,0),T.push(0,0,1),M.push(I/u),M.push(1-E/f)}}for(let E=0;E<f;E++)for(let R=0;R<u;R++){const I=R+p*E,O=R+p*(E+1),F=R+1+p*(E+1),z=R+1+p*E;A.push(I,O,z),A.push(O,F,z)}this.setIndex(A),this.setAttribute("position",new Jt(S,3)),this.setAttribute("normal",new Jt(T,3)),this.setAttribute("uv",new Jt(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lc(e.width,e.height,e.widthSegments,e.heightSegments)}}class P_ extends pn{constructor(e=.5,t=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const u=[],f=[],p=[],g=[];let v=e;const y=(t-e)/r,A=new Q,S=new qe;for(let T=0;T<=r;T++){for(let M=0;M<=n;M++){const E=s+M/n*o;A.x=v*Math.cos(E),A.y=v*Math.sin(E),f.push(A.x,A.y,A.z),p.push(0,0,1),S.x=(A.x/t+1)/2,S.y=(A.y/t+1)/2,g.push(S.x,S.y)}v+=y}for(let T=0;T<r;T++){const M=T*(n+1);for(let E=0;E<n;E++){const R=E+M,I=R,O=R+n+1,F=R+n+2,z=R+1;u.push(I,O,z),u.push(O,F,z)}}this.setIndex(u),this.setAttribute("position",new Jt(f,3)),this.setAttribute("normal",new Jt(p,3)),this.setAttribute("uv",new Jt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new P_(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class U_ extends pn{constructor(e=new Xf([new qe(0,.5),new qe(-.5,-.5),new qe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let u=0,f=0;if(Array.isArray(e)===!1)p(e);else for(let g=0;g<e.length;g++)p(e[g]),this.addGroup(u,f,g),u+=f,f=0;this.setIndex(n),this.setAttribute("position",new Jt(r,3)),this.setAttribute("normal",new Jt(s,3)),this.setAttribute("uv",new Jt(o,2));function p(g){const v=r.length/3,y=g.extractPoints(t);let A=y.shape;const S=y.holes;fl.isClockWise(A)===!1&&(A=A.reverse());for(let M=0,E=S.length;M<E;M++){const R=S[M];fl.isClockWise(R)===!0&&(S[M]=R.reverse())}const T=fl.triangulateShape(A,S);for(let M=0,E=S.length;M<E;M++){const R=S[M];A=A.concat(R)}for(let M=0,E=A.length;M<E;M++){const R=A[M];r.push(R.x,R.y,0),s.push(0,0,1),o.push(R.x,R.y)}for(let M=0,E=T.length;M<E;M++){const R=T[M],I=R[0]+v,O=R[1]+v,F=R[2]+v;n.push(I,O,F),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return l8(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];n.push(o)}return new U_(n,e.curveSegments)}}function l8(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class Hv extends pn{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,o=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:u},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const f=Math.min(o+u,Math.PI);let p=0;const g=[],v=new Q,y=new Q,A=[],S=[],T=[],M=[];for(let E=0;E<=n;E++){const R=[],I=E/n;let O=0;E===0&&o===0?O=.5/t:E===n&&f===Math.PI&&(O=-.5/t);for(let F=0;F<=t;F++){const z=F/t;v.x=-e*Math.cos(r+z*s)*Math.sin(o+I*u),v.y=e*Math.cos(o+I*u),v.z=e*Math.sin(r+z*s)*Math.sin(o+I*u),S.push(v.x,v.y,v.z),y.copy(v).normalize(),T.push(y.x,y.y,y.z),M.push(z+O,1-I),R.push(p++)}g.push(R)}for(let E=0;E<n;E++)for(let R=0;R<t;R++){const I=g[E][R+1],O=g[E][R],F=g[E+1][R],z=g[E+1][R+1];(E!==0||o>0)&&A.push(I,O,z),(E!==n-1||f<Math.PI)&&A.push(O,F,z)}this.setIndex(A),this.setAttribute("position",new Jt(S,3)),this.setAttribute("normal",new Jt(T,3)),this.setAttribute("uv",new Jt(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hv(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class F_ extends Md{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new F_(e.radius,e.detail)}}class z_ extends pn{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],u=[],f=[],p=[],g=new Q,v=new Q,y=new Q;for(let A=0;A<=n;A++)for(let S=0;S<=r;S++){const T=S/r*s,M=A/n*Math.PI*2;v.x=(e+t*Math.cos(M))*Math.cos(T),v.y=(e+t*Math.cos(M))*Math.sin(T),v.z=t*Math.sin(M),u.push(v.x,v.y,v.z),g.x=e*Math.cos(T),g.y=e*Math.sin(T),y.subVectors(v,g).normalize(),f.push(y.x,y.y,y.z),p.push(S/r),p.push(A/n)}for(let A=1;A<=n;A++)for(let S=1;S<=r;S++){const T=(r+1)*A+S-1,M=(r+1)*(A-1)+S-1,E=(r+1)*(A-1)+S,R=(r+1)*A+S;o.push(T,M,R),o.push(M,E,R)}this.setIndex(o),this.setAttribute("position",new Jt(u,3)),this.setAttribute("normal",new Jt(f,3)),this.setAttribute("uv",new Jt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new z_(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class H_ extends pn{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const u=[],f=[],p=[],g=[],v=new Q,y=new Q,A=new Q,S=new Q,T=new Q,M=new Q,E=new Q;for(let I=0;I<=n;++I){const O=I/n*s*Math.PI*2;R(O,s,o,e,A),R(O+.01,s,o,e,S),M.subVectors(S,A),E.addVectors(S,A),T.crossVectors(M,E),E.crossVectors(T,M),T.normalize(),E.normalize();for(let F=0;F<=r;++F){const z=F/r*Math.PI*2,j=-t*Math.cos(z),W=t*Math.sin(z);v.x=A.x+(j*E.x+W*T.x),v.y=A.y+(j*E.y+W*T.y),v.z=A.z+(j*E.z+W*T.z),f.push(v.x,v.y,v.z),y.subVectors(v,A).normalize(),p.push(y.x,y.y,y.z),g.push(I/n),g.push(F/r)}}for(let I=1;I<=n;I++)for(let O=1;O<=r;O++){const F=(r+1)*(I-1)+(O-1),z=(r+1)*I+(O-1),j=(r+1)*I+O,W=(r+1)*(I-1)+O;u.push(F,z,W),u.push(z,j,W)}this.setIndex(u),this.setAttribute("position",new Jt(f,3)),this.setAttribute("normal",new Jt(p,3)),this.setAttribute("uv",new Jt(g,2));function R(I,O,F,z,j){const W=Math.cos(I),L=Math.sin(I),H=F/O*I,K=Math.cos(H);j.x=z*(2+K)*.5*W,j.y=z*(2+K)*L*.5,j.z=z*Math.sin(H)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new H_(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class G_ extends pn{constructor(e=new N_(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const u=new Q,f=new Q,p=new qe;let g=new Q;const v=[],y=[],A=[],S=[];T(),this.setIndex(S),this.setAttribute("position",new Jt(v,3)),this.setAttribute("normal",new Jt(y,3)),this.setAttribute("uv",new Jt(A,2));function T(){for(let I=0;I<t;I++)M(I);M(s===!1?t:0),R(),E()}function M(I){g=e.getPointAt(I/t,g);const O=o.normals[I],F=o.binormals[I];for(let z=0;z<=r;z++){const j=z/r*Math.PI*2,W=Math.sin(j),L=-Math.cos(j);f.x=L*O.x+W*F.x,f.y=L*O.y+W*F.y,f.z=L*O.z+W*F.z,f.normalize(),y.push(f.x,f.y,f.z),u.x=g.x+n*f.x,u.y=g.y+n*f.y,u.z=g.z+n*f.z,v.push(u.x,u.y,u.z)}}function E(){for(let I=1;I<=t;I++)for(let O=1;O<=r;O++){const F=(r+1)*(I-1)+(O-1),z=(r+1)*I+(O-1),j=(r+1)*I+O,W=(r+1)*(I-1)+O;S.push(F,z,W),S.push(z,j,W)}}function R(){for(let I=0;I<=t;I++)for(let O=0;O<=r;O++)p.x=I/t,p.y=O/r,A.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new G_(new jA[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class u4 extends pn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new Q,s=new Q;if(e.index!==null){const o=e.attributes.position,u=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:u.count,materialIndex:0}]);for(let p=0,g=f.length;p<g;++p){const v=f[p],y=v.start,A=v.count;for(let S=y,T=y+A;S<T;S+=3)for(let M=0;M<3;M++){const E=u.getX(S+M),R=u.getX(S+(M+1)%3);r.fromBufferAttribute(o,E),s.fromBufferAttribute(o,R),GC(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let u=0,f=o.count/3;u<f;u++)for(let p=0;p<3;p++){const g=3*u+p,v=3*u+(p+1)%3;r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,v),GC(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Jt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function GC(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var kC=Object.freeze({__proto__:null,BoxGeometry:Ed,CapsuleGeometry:R_,CircleGeometry:D_,ConeGeometry:Uv,CylinderGeometry:Pv,DodecahedronGeometry:I_,EdgesGeometry:n4,ExtrudeGeometry:O_,IcosahedronGeometry:Fv,LatheGeometry:L_,OctahedronGeometry:zv,PlaneGeometry:lc,PolyhedronGeometry:Md,RingGeometry:P_,ShapeGeometry:U_,SphereGeometry:Hv,TetrahedronGeometry:F_,TorusGeometry:z_,TorusKnotGeometry:H_,TubeGeometry:G_,WireframeGeometry:u4});class d4 extends mr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ft(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Gv extends ai{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class kv extends mr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ft(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ga,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class no extends kv{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return gn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ft(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ft(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ft(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class f4 extends mr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ft(16777215),this.specular=new Ft(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ga,this.combine=Rv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class h4 extends mr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ft(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class rT extends mr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class p4 extends mr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ga,this.combine=Rv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class k_ extends mr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Uo,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class sT extends mr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class m4 extends mr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ft(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class g4 extends Ms{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Hf(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function v4(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function PE(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const u=t[s]*e;for(let f=0;f!==e;++f)r[o++]=i[u+f]}return r}function aT(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push(...o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)}function c8(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let f=0;f<s.tracks.length;++f){const p=s.tracks[f],g=p.getValueSize(),v=[],y=[];for(let A=0;A<p.times.length;++A){const S=p.times[A]*r;if(!(S<t||S>=n)){v.push(p.times[A]);for(let T=0;T<g;++T)y.push(p.values[A*g+T])}}v.length!==0&&(p.times=Hf(v,p.times.constructor),p.values=Hf(y,p.values.constructor),o.push(p))}s.tracks=o;let u=1/0;for(let f=0;f<s.tracks.length;++f)u>s.tracks[f].times[0]&&(u=s.tracks[f].times[0]);for(let f=0;f<s.tracks.length;++f)s.tracks[f].shift(-1*u);return s.resetDuration(),s}function u8(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const u=t.tracks[o],f=u.ValueTypeName;if(f==="bool"||f==="string")continue;const p=i.tracks.find(function(E){return E.name===u.name&&E.ValueTypeName===f});if(p===void 0)continue;let g=0;const v=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);let y=0;const A=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=A/3);const S=u.times.length-1;let T;if(s<=u.times[0]){const E=g,R=v-g;T=u.values.slice(E,R)}else if(s>=u.times[S]){const E=S*v+g,R=E+v-g;T=u.values.slice(E,R)}else{const E=u.createInterpolant(),R=g,I=v-g;E.evaluate(s),T=E.resultBuffer.slice(R,I)}f==="quaternion"&&new es().fromArray(T).normalize().conjugate().toArray(T);const M=p.times.length;for(let E=0;E<M;++E){const R=E*A+y;if(f==="quaternion")es.multiplyQuaternionsFlat(p.values,R,T,0,p.values,R);else{const I=A-y*2;for(let O=0;O<I;++O)p.values[R+O]-=T[O]}}}return i.blendMode=zM,i}class d8{static convertArray(e,t){return Hf(e,t)}static isTypedArray(e){return V2(e)}static getKeyframeOrder(e){return v4(e)}static sortedArray(e,t,n){return PE(e,t,n)}static flattenJSON(e,t,n,r){aT(e,t,n,r)}static subclip(e,t,n,r,s=30){return c8(e,t,n,r,s)}static makeClipAdditive(e,t=0,n=e,r=30){return u8(e,t,n,r)}}class Om{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let u=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(!(e>=s)){const u=t[1];e<u&&(n=2,s=u);for(let f=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){const u=n+o>>>1;e<t[u]?o=u:n=u+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class x4 extends Om{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ff,endingEnd:Ff}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,u=r[s],f=r[o];if(u===void 0)switch(this.getSettings_().endingStart){case zf:s=e,u=2*t-n;break;case fv:s=r.length-2,u=t+r[s]-r[s+1];break;default:s=e,u=n}if(f===void 0)switch(this.getSettings_().endingEnd){case zf:o=e,f=2*n-t;break;case fv:o=1,f=n+r[1]-r[0];break;default:o=e-1,f=t}const p=(n-t)*.5,g=this.valueSize;this._weightPrev=p/(t-u),this._weightNext=p/(f-n),this._offsetPrev=s*g,this._offsetNext=o*g}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=e*u,p=f-u,g=this._offsetPrev,v=this._offsetNext,y=this._weightPrev,A=this._weightNext,S=(n-t)/(r-t),T=S*S,M=T*S,E=-y*M+2*y*T-y*S,R=(1+y)*M+(-1.5-2*y)*T+(-.5+y)*S+1,I=(-1-A)*M+(1.5+A)*T+.5*S,O=A*M-A*T;for(let F=0;F!==u;++F)s[F]=E*o[g+F]+R*o[p+F]+I*o[f+F]+O*o[v+F];return s}}class oT extends Om{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=e*u,p=f-u,g=(n-t)/(r-t),v=1-g;for(let y=0;y!==u;++y)s[y]=o[p+y]*v+o[f+y]*g;return s}}class y4 extends Om{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Fo{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Hf(t,this.TimeBufferType),this.values=Hf(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Hf(e.times,Array),values:Hf(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new y4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new oT(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new x4(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case mm:t=this.InterpolantFactoryMethodDiscrete;break;case gm:t=this.InterpolantFactoryMethodLinear;break;case Xy:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Ht("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return mm;case this.InterpolantFactoryMethodLinear:return gm;case this.InterpolantFactoryMethodSmooth:return Xy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const u=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*u,o*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(nn("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(nn("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let u=0;u!==s;u++){const f=n[u];if(typeof f=="number"&&isNaN(f)){nn("KeyframeTrack: Time is not a valid number.",this,u,f),e=!1;break}if(o!==null&&o>f){nn("KeyframeTrack: Out of order keys.",this,u,f,o),e=!1;break}o=f}if(r!==void 0&&V2(r))for(let u=0,f=r.length;u!==f;++u){const p=r[u];if(isNaN(p)){nn("KeyframeTrack: Value is not a valid number.",this,u,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Xy,s=e.length-1;let o=1;for(let u=1;u<s;++u){let f=!1;const p=e[u],g=e[u+1];if(p!==g&&(u!==1||p!==e[0]))if(r)f=!0;else{const v=u*n,y=v-n,A=v+n;for(let S=0;S!==n;++S){const T=t[v+S];if(T!==t[y+S]||T!==t[A+S]){f=!0;break}}}if(f){if(u!==o){e[o]=e[u];const v=u*n,y=o*n;for(let A=0;A!==n;++A)t[y+A]=t[v+A]}++o}}if(s>0){e[o]=e[s];for(let u=s*n,f=o*n,p=0;p!==n;++p)t[f+p]=t[u+p];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Fo.prototype.ValueTypeName="";Fo.prototype.TimeBufferType=Float32Array;Fo.prototype.ValueBufferType=Float32Array;Fo.prototype.DefaultInterpolation=gm;class uh extends Fo{constructor(e,t,n){super(e,t,n)}}uh.prototype.ValueTypeName="bool";uh.prototype.ValueBufferType=Array;uh.prototype.DefaultInterpolation=mm;uh.prototype.InterpolantFactoryMethodLinear=void 0;uh.prototype.InterpolantFactoryMethodSmooth=void 0;class lT extends Fo{constructor(e,t,n,r){super(e,t,n,r)}}lT.prototype.ValueTypeName="color";class nh extends Fo{constructor(e,t,n,r){super(e,t,n,r)}}nh.prototype.ValueTypeName="number";class A4 extends Om{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=(n-t)/(r-t);let p=e*u;for(let g=p+u;p!==g;p+=4)es.slerpFlat(s,0,o,p-u,o,p,f);return s}}class ih extends Fo{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new A4(this.times,this.values,this.getValueSize(),e)}}ih.prototype.ValueTypeName="quaternion";ih.prototype.InterpolantFactoryMethodSmooth=void 0;class dh extends Fo{constructor(e,t,n){super(e,t,n)}}dh.prototype.ValueTypeName="string";dh.prototype.ValueBufferType=Array;dh.prototype.DefaultInterpolation=mm;dh.prototype.InterpolantFactoryMethodLinear=void 0;dh.prototype.InterpolantFactoryMethodSmooth=void 0;class rh extends Fo{constructor(e,t,n,r){super(e,t,n,r)}}rh.prototype.ValueTypeName="vector";class Em{constructor(e="",t=-1,n=[],r=x_){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=$a(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,u=n.length;o!==u;++o)t.push(h8(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,o=n.length;s!==o;++s)t.push(Fo.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let u=0;u<s;u++){let f=[],p=[];f.push((u+s-1)%s,u,(u+1)%s),p.push(0,1,0);const g=v4(f);f=PE(f,1,g),p=PE(p,1,g),!r&&f[0]===0&&(f.push(s),p.push(p[0])),o.push(new nh(".morphTargetInfluences["+t[u].name+"]",f,p).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let u=0,f=e.length;u<f;u++){const p=e[u],g=p.name.match(s);if(g&&g.length>1){const v=g[1];let y=r[v];y||(r[v]=y=[]),y.push(p)}}const o=[];for(const u in r)o.push(this.CreateFromMorphTargetSequence(u,r[u],t,n));return o}static parseAnimation(e,t){if(Ht("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return nn("AnimationClip: No animation in JSONLoader data."),null;const n=function(v,y,A,S,T){if(A.length!==0){const M=[],E=[];aT(A,M,E,S),M.length!==0&&T.push(new v(y,M,E))}},r=[],s=e.name||"default",o=e.fps||30,u=e.blendMode;let f=e.length||-1;const p=e.hierarchy||[];for(let v=0;v<p.length;v++){const y=p[v].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const A={};let S;for(S=0;S<y.length;S++)if(y[S].morphTargets)for(let T=0;T<y[S].morphTargets.length;T++)A[y[S].morphTargets[T]]=-1;for(const T in A){const M=[],E=[];for(let R=0;R!==y[S].morphTargets.length;++R){const I=y[S];M.push(I.time),E.push(I.morphTarget===T?1:0)}r.push(new nh(".morphTargetInfluence["+T+"]",M,E))}f=A.length*o}else{const A=".bones["+t[v].name+"]";n(rh,A+".position",y,"pos",r),n(ih,A+".quaternion",y,"rot",r),n(rh,A+".scale",y,"scl",r)}}return r.length===0?null:new this(s,f,r,u)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function f8(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nh;case"vector":case"vector2":case"vector3":case"vector4":return rh;case"color":return lT;case"quaternion":return ih;case"bool":case"boolean":return uh;case"string":return dh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function h8(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=f8(i.type);if(i.times===void 0){const t=[],n=[];aT(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const ic={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Vv{constructor(e,t,n){const r=this;let s=!1,o=0,u=0,f;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(g){u++,s===!1&&r.onStart!==void 0&&r.onStart(g,o,u),s=!0},this.itemEnd=function(g){o++,r.onProgress!==void 0&&r.onProgress(g,o,u),o===u&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(g){r.onError!==void 0&&r.onError(g)},this.resolveURL=function(g){return f?f(g):g},this.setURLModifier=function(g){return f=g,this},this.addHandler=function(g,v){return p.push(g,v),this},this.removeHandler=function(g){const v=p.indexOf(g);return v!==-1&&p.splice(v,2),this},this.getHandler=function(g){for(let v=0,y=p.length;v<y;v+=2){const A=p[v],S=p[v+1];if(A.global&&(A.lastIndex=0),A.test(g))return S}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const _4=new Vv;class gr{constructor(e){this.manager=e!==void 0?e:_4,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}gr.DEFAULT_MATERIAL_NAME="__DEFAULT";const jc={};class p8 extends Error{constructor(e,t){super(e),this.response=t}}class ds extends gr{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ic.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(jc[e]!==void 0){jc[e].push({onLoad:t,onProgress:n,onError:r});return}jc[e]=[],jc[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),u=this.mimeType,f=this.responseType;fetch(o).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&Ht("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const g=jc[e],v=p.body.getReader(),y=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),A=y?parseInt(y):0,S=A!==0;let T=0;const M=new ReadableStream({start(E){R();function R(){v.read().then(({done:I,value:O})=>{if(I)E.close();else{T+=O.byteLength;const F=new ProgressEvent("progress",{lengthComputable:S,loaded:T,total:A});for(let z=0,j=g.length;z<j;z++){const W=g[z];W.onProgress&&W.onProgress(F)}E.enqueue(O),R()}},I=>{E.error(I)})}}});return new Response(M)}else throw new p8(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(f){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(g=>new DOMParser().parseFromString(g,u));case"json":return p.json();default:if(u==="")return p.text();{const v=/charset="?([^;"\s]*)"?/i.exec(u),y=v&&v[1]?v[1].toLowerCase():void 0,A=new TextDecoder(y);return p.arrayBuffer().then(S=>A.decode(S))}}}).then(p=>{ic.add(`file:${e}`,p);const g=jc[e];delete jc[e];for(let v=0,y=g.length;v<y;v++){const A=g[v];A.onLoad&&A.onLoad(p)}}).catch(p=>{const g=jc[e];if(g===void 0)throw this.manager.itemError(e),p;delete jc[e];for(let v=0,y=g.length;v<y;v++){const A=g[v];A.onError&&A.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class m8 extends gr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new ds(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){r?r(f):nn(f),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Em.parse(e[n]);t.push(r)}return t}}class g8 extends gr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],u=new C_,f=new ds(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(s.withCredentials);let p=0;function g(v){f.load(e[v],function(y){const A=s.parse(y,!0);o[v]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps},p+=1,p===6&&(A.mipmapCount===1&&(u.minFilter=on),u.image=o,u.format=A.format,u.needsUpdate=!0,t&&t(u))},n,r)}if(Array.isArray(e))for(let v=0,y=e.length;v<y;++v)g(v);else f.load(e,function(v){const y=s.parse(v,!0);if(y.isCubemap){const A=y.mipmaps.length/y.mipmapCount;for(let S=0;S<A;S++){o[S]={mipmaps:[]};for(let T=0;T<y.mipmapCount;T++)o[S].mipmaps.push(y.mipmaps[S*y.mipmapCount+T]),o[S].format=y.format,o[S].width=y.width,o[S].height=y.height}u.image=o}else u.image.width=y.width,u.image.height=y.height,u.mipmaps=y.mipmaps;y.mipmapCount===1&&(u.minFilter=on),u.format=y.format,u.needsUpdate=!0,t&&t(u)},n,r);return u}}const Pp=new WeakMap;class Av extends gr{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ic.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0);else{let v=Pp.get(o);v===void 0&&(v=[],Pp.set(o,v)),v.push({onLoad:t,onError:r})}return o}const u=mv("img");function f(){g(),t&&t(this);const v=Pp.get(this)||[];for(let y=0;y<v.length;y++){const A=v[y];A.onLoad&&A.onLoad(this)}Pp.delete(this),s.manager.itemEnd(e)}function p(v){g(),r&&r(v),ic.remove(`image:${e}`);const y=Pp.get(this)||[];for(let A=0;A<y.length;A++){const S=y[A];S.onError&&S.onError(v)}Pp.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function g(){u.removeEventListener("load",f,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",f,!1),u.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),ic.add(`image:${e}`,u),s.manager.itemStart(e),u.src=e,u}}class S4 extends gr{constructor(e){super(e)}load(e,t,n,r){const s=new Ov;s.colorSpace=Hn;const o=new Av(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let u=0;function f(p){o.load(e[p],function(g){s.images[p]=g,u++,u===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let p=0;p<e.length;++p)f(p);return s}}class V_ extends gr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new oa,u=new ds(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(s.withCredentials),u.load(e,function(f){let p;try{p=s.parse(f)}catch(g){if(r!==void 0)r(g);else{g(g);return}}p.image!==void 0?o.image=p.image:p.data!==void 0&&(o.image.width=p.width,o.image.height=p.height,o.image.data=p.data),o.wrapS=p.wrapS!==void 0?p.wrapS:Ni,o.wrapT=p.wrapT!==void 0?p.wrapT:Ni,o.magFilter=p.magFilter!==void 0?p.magFilter:on,o.minFilter=p.minFilter!==void 0?p.minFilter:on,o.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(o.colorSpace=p.colorSpace),p.flipY!==void 0&&(o.flipY=p.flipY),p.format!==void 0&&(o.format=p.format),p.type!==void 0&&(o.type=p.type),p.mipmaps!==void 0&&(o.mipmaps=p.mipmaps,o.minFilter=Ka),p.mipmapCount===1&&(o.minFilter=on),p.generateMipmaps!==void 0&&(o.generateMipmaps=p.generateMipmaps),o.needsUpdate=!0,t&&t(o,p)},n,r),o}}class jv extends gr{constructor(e){super(e)}load(e,t,n,r){const s=new Jn,o=new Av(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(u){s.image=u,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class Td extends ni{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ft(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class b4 extends Td{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ni.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ft(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const Nb=new jt,VC=new Q,jC=new Q;class cT{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new qe(512,512),this.mapType=_i,this.map=null,this.mapPass=null,this.matrix=new jt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Nm,this._frameExtents=new qe(1,1),this._viewportCount=1,this._viewports=[new Ti(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;VC.setFromMatrixPosition(e.matrixWorld),t.position.copy(VC),jC.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jC),t.updateMatrixWorld(),Nb.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Nb,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Nb)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class v8 extends cT{constructor(){super(new ki(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Am*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class uT extends Td{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ni.DEFAULT_UP),this.updateMatrix(),this.target=new ni,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new v8}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class x8 extends cT{constructor(){super(new ki(90,1,.5,500)),this.isPointLightShadow=!0}}class dT extends Td{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new x8}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}let Ha=class extends Bm{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,u=r+t,f=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=p*this.view.offsetX,o=s+p*this.view.width,u-=g*this.view.offsetY,f=u-g*this.view.height}this.projectionMatrix.makeOrthographic(s,o,u,f,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};class y8 extends cT{constructor(){super(new Ha(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class fT extends Td{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ni.DEFAULT_UP),this.updateMatrix(),this.target=new ni,this.shadow=new y8}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class E4 extends Td{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class M4 extends Td{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class hT{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Q)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class T4 extends Td{constructor(e=new hT,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class j_ extends gr{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new ds(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){r?r(f):nn(f),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&Ht("MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Ft().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new Ft().setHex(o.value);break;case"v2":r.uniforms[s].value=new qe().fromArray(o.value);break;case"v3":r.uniforms[s].value=new Q().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Ti().fromArray(o.value);break;case"m3":r.uniforms[s].value=new An().fromArray(o.value);break;case"m4":r.uniforms[s].value=new jt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new qe().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new qe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return j_.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:d4,SpriteMaterial:XM,RawShaderMaterial:Gv,ShaderMaterial:ai,PointsMaterial:w_,MeshPhysicalMaterial:no,MeshStandardMaterial:kv,MeshPhongMaterial:f4,MeshToonMaterial:h4,MeshNormalMaterial:rT,MeshLambertMaterial:p4,MeshDepthMaterial:k_,MeshDistanceMaterial:sT,MeshBasicMaterial:za,MeshMatcapMaterial:m4,LineDashedMaterial:g4,LineBasicMaterial:Ms,Material:mr};return new t[e]}}class md{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class w4 extends pn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class C4 extends gr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new ds(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){r?r(f):nn(f),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(A,S){if(t[S]!==void 0)return t[S];const M=A.interleavedBuffers[S],E=s(A,M.buffer),R=em(M.type,E),I=new $f(R,M.stride);return I.uuid=M.uuid,t[S]=I,I}function s(A,S){if(n[S]!==void 0)return n[S];const M=A.arrayBuffers[S],E=new Uint32Array(M).buffer;return n[S]=E,E}const o=e.isInstancedBufferGeometry?new w4:new pn,u=e.data.index;if(u!==void 0){const A=em(u.type,u.array);o.setIndex(new jn(A,1))}const f=e.data.attributes;for(const A in f){const S=f[A];let T;if(S.isInterleavedBufferAttribute){const M=r(e.data,S.data);T=new pl(M,S.itemSize,S.offset,S.normalized)}else{const M=em(S.type,S.array),E=S.isInstancedBufferAttribute?eh:jn;T=new E(M,S.itemSize,S.normalized)}S.name!==void 0&&(T.name=S.name),S.usage!==void 0&&T.setUsage(S.usage),o.setAttribute(A,T)}const p=e.data.morphAttributes;if(p)for(const A in p){const S=p[A],T=[];for(let M=0,E=S.length;M<E;M++){const R=S[M];let I;if(R.isInterleavedBufferAttribute){const O=r(e.data,R.data);I=new pl(O,R.itemSize,R.offset,R.normalized)}else{const O=em(R.type,R.array);I=new jn(O,R.itemSize,R.normalized)}R.name!==void 0&&(I.name=R.name),T.push(I)}o.morphAttributes[A]=T}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const v=e.data.groups||e.data.drawcalls||e.data.offsets;if(v!==void 0)for(let A=0,S=v.length;A!==S;++A){const T=v[A];o.addGroup(T.start,T.count,T.materialIndex)}const y=e.data.boundingSphere;return y!==void 0&&(o.boundingSphere=new Wr().fromJSON(y)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class A8 extends gr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=this.path===""?md.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const u=new ds(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(f){let p=null;try{p=JSON.parse(f)}catch(v){r!==void 0&&r(v),v("ObjectLoader: Can't parse "+e+".",v.message);return}const g=p.metadata;if(g===void 0||g.type===void 0||g.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),nn("ObjectLoader: Can't load "+e);return}s.parse(p,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?md.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new ds(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),u=JSON.parse(o),f=u.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(u)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(p)}),u=this.parseTextures(e.textures,o),f=this.parseMaterials(e.materials,u),p=this.parseObject(e.object,s,f,u,n),g=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,g),this.bindLightTargets(p),t!==void 0){let v=!1;for(const y in o)if(o[y].data instanceof HTMLImageElement){v=!0;break}v===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),u=this.parseMaterials(e.materials,o),f=this.parseObject(e.object,r,u,o,t),p=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,p),this.bindLightTargets(f),f}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new Xf().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const u=new Lv().fromJSON(e[s],r);n[u.uuid]=u}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new C4;for(let s=0,o=e.length;s<o;s++){let u;const f=e[s];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":u=r.parse(f);break;default:f.type in kC?u=kC[f.type].fromJSON(f,t):Ht(`ObjectLoader: Unsupported geometry type "${f.type}"`)}u.uuid=f.uuid,f.name!==void 0&&(u.name=f.name),f.userData!==void 0&&(u.userData=f.userData),n[f.uuid]=u}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new j_;s.setTextures(t);for(let o=0,u=e.length;o<u;o++){const f=e[o];n[f.uuid]===void 0&&(n[f.uuid]=s.parse(f)),r[f.uuid]=n[f.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=Em.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function o(f){return n.manager.itemStart(f),s.load(f,function(){n.manager.itemEnd(f)},void 0,function(){n.manager.itemError(f),n.manager.itemEnd(f)})}function u(f){if(typeof f=="string"){const p=f,g=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return o(g)}else return f.data?{data:em(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new Vv(t);s=new Av(f),s.setCrossOrigin(this.crossOrigin);for(let p=0,g=e.length;p<g;p++){const v=e[p],y=v.url;if(Array.isArray(y)){const A=[];for(let S=0,T=y.length;S<T;S++){const M=y[S],E=u(M);E!==null&&(E instanceof HTMLImageElement?A.push(E):A.push(new oa(E.data,E.width,E.height)))}r[v.uuid]=new fd(A)}else{const A=u(v.url);r[v.uuid]=new fd(A)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(o){if(typeof o=="string"){const u=o,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:t.resourcePath+u;return await r.loadAsync(f)}else return o.data?{data:em(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Av(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,u=e.length;o<u;o++){const f=e[o],p=f.url;if(Array.isArray(p)){const g=[];for(let v=0,y=p.length;v<y;v++){const A=p[v],S=await s(A);S!==null&&(S instanceof HTMLImageElement?g.push(S):g.push(new oa(S.data,S.width,S.height)))}n[f.uuid]=new fd(g)}else{const g=await s(f.url);n[f.uuid]=new fd(g)}}}return n}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(Ht("ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const u=e[s];u.image===void 0&&Ht('ObjectLoader: No "image" specified for',u.uuid),t[u.image]===void 0&&Ht("ObjectLoader: Undefined image",u.image);const f=t[u.image],p=f.data;let g;Array.isArray(p)?(g=new Ov,p.length===6&&(g.needsUpdate=!0)):(p&&p.data?g=new oa:g=new Jn,p&&(g.needsUpdate=!0)),g.source=f,g.uuid=u.uuid,u.name!==void 0&&(g.name=u.name),u.mapping!==void 0&&(g.mapping=n(u.mapping,_8)),u.channel!==void 0&&(g.channel=u.channel),u.offset!==void 0&&g.offset.fromArray(u.offset),u.repeat!==void 0&&g.repeat.fromArray(u.repeat),u.center!==void 0&&g.center.fromArray(u.center),u.rotation!==void 0&&(g.rotation=u.rotation),u.wrap!==void 0&&(g.wrapS=n(u.wrap[0],WC),g.wrapT=n(u.wrap[1],WC)),u.format!==void 0&&(g.format=u.format),u.internalFormat!==void 0&&(g.internalFormat=u.internalFormat),u.type!==void 0&&(g.type=u.type),u.colorSpace!==void 0&&(g.colorSpace=u.colorSpace),u.minFilter!==void 0&&(g.minFilter=n(u.minFilter,XC)),u.magFilter!==void 0&&(g.magFilter=n(u.magFilter,XC)),u.anisotropy!==void 0&&(g.anisotropy=u.anisotropy),u.flipY!==void 0&&(g.flipY=u.flipY),u.generateMipmaps!==void 0&&(g.generateMipmaps=u.generateMipmaps),u.premultiplyAlpha!==void 0&&(g.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(g.unpackAlignment=u.unpackAlignment),u.compareFunction!==void 0&&(g.compareFunction=u.compareFunction),u.userData!==void 0&&(g.userData=u.userData),r[u.uuid]=g}return r}parseObject(e,t,n,r,s){let o;function u(y){return t[y]===void 0&&Ht("ObjectLoader: Undefined geometry",y),t[y]}function f(y){if(y!==void 0){if(Array.isArray(y)){const A=[];for(let S=0,T=y.length;S<T;S++){const M=y[S];n[M]===void 0&&Ht("ObjectLoader: Undefined material",M),A.push(n[M])}return A}return n[y]===void 0&&Ht("ObjectLoader: Undefined material",y),n[y]}}function p(y){return r[y]===void 0&&Ht("ObjectLoader: Undefined texture",y),r[y]}let g,v;switch(e.type){case"Scene":o=new Ad,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ft(e.background):o.background=p(e.background)),e.environment!==void 0&&(o.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new E_(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new b_(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new ki(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ha(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new E4(e.color,e.intensity);break;case"DirectionalLight":o=new fT(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new dT(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new M4(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new uT(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new b4(e.color,e.groundColor,e.intensity);break;case"LightProbe":const y=new hT().fromArray(e.sh);o=new T4(y,e.intensity);break;case"SkinnedMesh":g=u(e.geometry),v=f(e.material),o=new YM(g,v),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":g=u(e.geometry),v=f(e.material),o=new Oi(g,v);break;case"InstancedMesh":g=u(e.geometry),v=f(e.material);const A=e.count,S=e.instanceMatrix,T=e.instanceColor;o=new QM(g,v,A),o.instanceMatrix=new eh(new Float32Array(S.array),16),T!==void 0&&(o.instanceColor=new eh(new Float32Array(T.array),T.itemSize));break;case"BatchedMesh":g=u(e.geometry),v=f(e.material),o=new $2(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,v),o.geometry=g,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(M=>{let E=null,R=null;return M.boundingBox!==void 0&&(E=new Es().fromJSON(M.boundingBox)),M.boundingSphere!==void 0&&(R=new Wr().fromJSON(M.boundingSphere)),{...M,boundingBox:E,boundingSphere:R}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=p(e.matricesTexture.uuid),o._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new Wr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new Es().fromJSON(e.boundingBox));break;case"LOD":o=new Z2;break;case"Line":o=new sc(u(e.geometry),f(e.material));break;case"LineLoop":o=new qM(u(e.geometry),f(e.material));break;case"LineSegments":o=new xl(u(e.geometry),f(e.material));break;case"PointCloud":case"Points":o=new JM(u(e.geometry),f(e.material));break;case"Sprite":o=new K2(f(e.material));break;case"Group":o=new nc;break;case"Bone":o=new M_;break;default:o=new ni}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let A=0;A<y.length;A++)o.add(this.parseObject(y[A],t,n,r,s))}if(e.animations!==void 0){const y=e.animations;for(let A=0;A<y.length;A++){const S=y[A];o.animations.push(s[S])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const y=e.levels;for(let A=0;A<y.length;A++){const S=y[A],T=o.getObjectByProperty("uuid",S.object);T!==void 0&&o.addLevel(T,S.distance,S.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?Ht("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new ni}})}}const _8={UVMapping:vd,CubeReflectionMapping:gl,CubeRefractionMapping:xd,EquirectangularReflectionMapping:hm,EquirectangularRefractionMapping:dv,CubeUVReflectionMapping:Dm},WC={RepeatWrapping:Lo,ClampToEdgeWrapping:Ni,MirroredRepeatWrapping:pm},XC={NearestFilter:di,NearestMipmapNearestFilter:h_,NearestMipmapLinearFilter:Uf,LinearFilter:on,LinearMipmapNearestFilter:om,LinearMipmapLinearFilter:Ka},Ob=new WeakMap;class R4 extends gr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Ht("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Ht("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ic.get(`image-bitmap:${e}`);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(p=>{if(Ob.has(o)===!0)r&&r(Ob.get(o)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(p),s.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,u.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const f=fetch(e,u).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(p){return ic.add(`image-bitmap:${e}`,p),t&&t(p),s.manager.itemEnd(e),p}).catch(function(p){r&&r(p),Ob.set(f,p),ic.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});ic.add(`image-bitmap:${e}`,f),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let gy;class pT{static getContext(){return gy===void 0&&(gy=new(window.AudioContext||window.webkitAudioContext)),gy}static setContext(e){gy=e}}class S8 extends gr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new ds(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(f){try{const p=f.slice(0);pT.getContext().decodeAudioData(p,function(v){t(v)}).catch(u)}catch(p){u(p)}},n,r);function u(f){r?r(f):nn(f),s.manager.itemError(e)}}}const YC=new jt,QC=new jt,Af=new jt;class b8{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ki,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ki,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Af.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Wf*t.fov*.5)/t.zoom;let u,f;QC.elements[12]=-r,YC.elements[12]=r,u=-o*t.aspect+s,f=o*t.aspect+s,Af.elements[0]=2*t.near/(f-u),Af.elements[8]=(f+u)/(f-u),this.cameraL.projectionMatrix.copy(Af),u=-o*t.aspect-s,f=o*t.aspect-s,Af.elements[0]=2*t.near/(f-u),Af.elements[8]=(f+u)/(f-u),this.cameraR.projectionMatrix.copy(Af)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(QC),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(YC)}}class D4 extends ki{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class mT{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const _f=new Q,Lb=new es,E8=new Q,Sf=new Q,bf=new Q;class M8 extends ni{constructor(){super(),this.type="AudioListener",this.context=pT.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new mT}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_f,Lb,E8),Sf.set(0,0,-1).applyQuaternion(Lb),bf.set(0,1,0).applyQuaternion(Lb),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(_f.x,n),t.positionY.linearRampToValueAtTime(_f.y,n),t.positionZ.linearRampToValueAtTime(_f.z,n),t.forwardX.linearRampToValueAtTime(Sf.x,n),t.forwardY.linearRampToValueAtTime(Sf.y,n),t.forwardZ.linearRampToValueAtTime(Sf.z,n),t.upX.linearRampToValueAtTime(bf.x,n),t.upY.linearRampToValueAtTime(bf.y,n),t.upZ.linearRampToValueAtTime(bf.z,n)}else t.setPosition(_f.x,_f.y,_f.z),t.setOrientation(Sf.x,Sf.y,Sf.z,bf.x,bf.y,bf.z)}}class I4 extends ni{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Ht("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Ht("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Ht("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Ef=new Q,qC=new es,T8=new Q,Mf=new Q;class w8 extends I4{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Ef,qC,T8),Mf.set(0,0,1).applyQuaternion(qC);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Ef.x,n),t.positionY.linearRampToValueAtTime(Ef.y,n),t.positionZ.linearRampToValueAtTime(Ef.z,n),t.orientationX.linearRampToValueAtTime(Mf.x,n),t.orientationY.linearRampToValueAtTime(Mf.y,n),t.orientationZ.linearRampToValueAtTime(Mf.z,n)}else t.setPosition(Ef.x,Ef.y,Ef.z),t.setOrientation(Mf.x,Mf.y,Mf.z)}}class C8{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class B4{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let u=0;u!==r;++u)n[s+u]=n[u];o=t}else{o+=t;const u=t/o;this._mixBufferRegion(n,s,0,u,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const f=t*this._origIndex;this._mixBufferRegion(n,r,f,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let f=t,p=t+t;f!==p;++f)if(n[f]!==n[f+t]){u.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){es.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;es.multiplyQuaternionsFlat(e,o,e,t,e,n),es.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let u=0;u!==s;++u){const f=t+u;e[f]=e[f]*o+e[n+u]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const u=t+o;e[u]=e[u]+e[n+o]*r}}}const gT="\\[\\]\\.:\\/",R8=new RegExp("["+gT+"]","g"),vT="[^"+gT+"]",D8="[^"+gT.replace("\\.","")+"]",I8=/((?:WC+[\/:])*)/.source.replace("WC",vT),B8=/(WCOD+)?/.source.replace("WCOD",D8),N8=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vT),O8=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vT),L8=new RegExp("^"+I8+B8+N8+O8+"$"),P8=["material","materials","bones","map"];class U8{constructor(e,t,n){const r=n||ri.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class ri{constructor(e,t,n){this.path=t,this.parsedPath=n||ri.parseTrackName(t),this.node=ri.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new ri.Composite(e,t,n):new ri(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(R8,"")}static parseTrackName(e){const t=L8.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);P8.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const u=s[o];if(u.name===t||u.uuid===t)return u;const f=n(u.children);if(f)return f}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=ri.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Ht("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){nn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){nn("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){nn("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let g=0;g<e.length;g++)if(e[g].name===p){p=g;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){nn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){nn("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){nn("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){nn("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const o=e[r];if(o===void 0){const p=t.nodeName;nn("PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?u=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){nn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){nn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}f=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(f=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ri.Composite=U8;ri.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ri.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ri.prototype.GetterByBindingType=[ri.prototype._getValue_direct,ri.prototype._getValue_array,ri.prototype._getValue_arrayElement,ri.prototype._getValue_toArray];ri.prototype.SetterByBindingTypeAndVersioning=[[ri.prototype._setValue_direct,ri.prototype._setValue_direct_setNeedsUpdate,ri.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ri.prototype._setValue_array,ri.prototype._setValue_array_setNeedsUpdate,ri.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ri.prototype._setValue_arrayElement,ri.prototype._setValue_arrayElement_setNeedsUpdate,ri.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ri.prototype._setValue_fromArray,ri.prototype._setValue_fromArray_setNeedsUpdate,ri.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class F8{constructor(){this.isAnimationObjectGroup=!0,this.uuid=$a(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let u,f=e.length,p=this.nCachedObjects_;for(let g=0,v=arguments.length;g!==v;++g){const y=arguments[g],A=y.uuid;let S=t[A];if(S===void 0){S=f++,t[A]=S,e.push(y);for(let T=0,M=o;T!==M;++T)s[T].push(new ri(y,n[T],r[T]))}else if(S<p){u=e[S];const T=--p,M=e[T];t[M.uuid]=S,e[S]=M,t[A]=T,e[T]=y;for(let E=0,R=o;E!==R;++E){const I=s[E],O=I[T];let F=I[S];I[S]=O,F===void 0&&(F=new ri(y,n[E],r[E])),I[T]=F}}else e[S]!==u&&nn("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,u=arguments.length;o!==u;++o){const f=arguments[o],p=f.uuid,g=t[p];if(g!==void 0&&g>=s){const v=s++,y=e[v];t[y.uuid]=g,e[g]=y,t[p]=v,e[v]=f;for(let A=0,S=r;A!==S;++A){const T=n[A],M=T[v],E=T[g];T[g]=M,T[v]=E}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let u=0,f=arguments.length;u!==f;++u){const p=arguments[u],g=p.uuid,v=t[g];if(v!==void 0)if(delete t[g],v<s){const y=--s,A=e[y],S=--o,T=e[S];t[A.uuid]=v,e[v]=A,t[T.uuid]=y,e[y]=T,e.pop();for(let M=0,E=r;M!==E;++M){const R=n[M],I=R[y],O=R[S];R[v]=I,R[y]=O,R.pop()}}else{const y=--o,A=e[y];y>0&&(t[A.uuid]=v),e[v]=A,e.pop();for(let S=0,T=r;S!==T;++S){const M=n[S];M[v]=M[y],M.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,u=this._parsedPaths,f=this._objects,p=f.length,g=this.nCachedObjects_,v=new Array(p);r=s.length,n[e]=r,o.push(e),u.push(t),s.push(v);for(let y=g,A=f.length;y!==A;++y){const S=f[y];v[y]=new ri(S,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,u=o.length-1,f=o[u],p=e[u];t[p]=n,o[n]=f,o.pop(),s[n]=s[u],s.pop(),r[n]=r[u],r.pop()}}}class N4{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,u=new Array(o),f={endingStart:Ff,endingEnd:Ff};for(let p=0;p!==o;++p){const g=s[p].createInterpolant(null);u[p]=g,g.settings=f}this._interpolantSettings=f,this._interpolants=u,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=B2,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,s=e._clip.duration,o=s/r,u=r/s;e.warp(1,o,t),this.warp(u,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=r._lendControlInterpolant(),this._timeScaleInterpolant=u);const f=u.parameterPositions,p=u.sampleValues;return f[0]=s,f[1]=s+n,p[0]=e/o,p[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const f=(e-s)*n;f<0||n===0?t=0:(this._startTime=null,t=n*f)}t*=this._updateTimeScale(e);const o=this._updateTime(t),u=this._updateWeight(e);if(u>0){const f=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case zM:for(let g=0,v=f.length;g!==v;++g)f[g].evaluate(o),p[g].accumulateAdditive(u);break;case x_:default:for(let g=0,v=f.length;g!==v;++g)f[g].evaluate(o),p[g].accumulate(r,u)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===N2;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(n===I2){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const u=Math.floor(r/t);r-=t*u,s+=Math.abs(u);const f=this.repetitions-s;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const p=e<0;this._setEndings(p,!p,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=zf,r.endingEnd=zf):(e?r.endingStart=this.zeroSlopeAtStart?zf:Ff:r.endingStart=fv,t?r.endingEnd=this.zeroSlopeAtEnd?zf:Ff:r.endingEnd=fv)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const u=o.parameterPositions,f=o.sampleValues;return u[0]=s,f[0]=t,u[1]=s+e,f[1]=n,this}}const z8=new Float32Array(1);class H8 extends eo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,u=e._interpolants,f=n.uuid,p=this._bindingsByRootAndName;let g=p[f];g===void 0&&(g={},p[f]=g);for(let v=0;v!==s;++v){const y=r[v],A=y.name;let S=g[A];if(S!==void 0)++S.referenceCount,o[v]=S;else{if(S=o[v],S!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,f,A));continue}const T=t&&t._propertyBindings[v].binding.parsedPath;S=new B4(ri.create(n,A,T),y.ValueTypeName,y.getValueSize()),++S.referenceCount,this._addInactiveBinding(S,f,A),o[v]=S}u[v].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const u=o.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,u=o[s],f=u.knownActions,p=f[f.length-1],g=e._byClipCacheIndex;p._byClipCacheIndex=g,f[g]=p,f.pop(),e._byClipCacheIndex=null;const v=u.actionByRoot,y=(e._localRoot||this._root).uuid;delete v[y],f.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,u=o[r],f=t[t.length-1],p=e._cacheIndex;f._cacheIndex=p,t[p]=f,t.pop(),delete u[s],Object.keys(u).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new oT(new Float32Array(2),new Float32Array(2),1,z8),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Em.findByName(r,e):e;const u=o!==null?o.uuid:e,f=this._actionsByClip[u];let p=null;if(n===void 0&&(o!==null?n=o.blendMode:n=x_),f!==void 0){const v=f.actionByRoot[s];if(v!==void 0&&v.blendMode===n)return v;p=f.knownActions[0],o===null&&(o=p._clip)}if(o===null)return null;const g=new N4(this,o,t,n);return this._bindAction(g,p),this._addInactiveAction(g,u,s),g}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?Em.findByName(n,e):e,o=s?s.uuid:e,u=this._actionsByClip[o];return u!==void 0&&u.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,s,o);const u=this._bindings,f=this._nActiveBindings;for(let p=0;p!==f;++p)u[p].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let u=0,f=o.length;u!==f;++u){const p=o[u];this._deactivateAction(p);const g=p._cacheIndex,v=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,v._cacheIndex=g,t[g]=v,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const u=n[o].actionByRoot,f=u[t];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const u=s[o];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class G8 extends kM{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new su(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Ne{constructor(e){this.value=e}clone(){return new Ne(this.value.clone===void 0?this.value:this.value.clone())}}let k8=0;class V8 extends eo{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:k8++}),this.name="",this.usage=pv,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class j8 extends $f{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class W8{constructor(e,t,n,r,s,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const JC=new jt;class xT{constructor(e,t,n=0,r=1/0){this.ray=new bd(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new _m,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):nn("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return JC.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(JC),this}intersectObject(e,t=!0,n=[]){return UE(e,this,n,t),n.sort(KC),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)UE(e[r],this,n,t);return n.sort(KC),n}}function KC(i,e){return i.distance-e.distance}function UE(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let o=0,u=s.length;o<u;o++)UE(s[o],e,t,!0)}}let X8=class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=Y8.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}};function Y8(){this._document.hidden===!1&&this.reset()}class FE{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=gn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(gn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Q8{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class yT{constructor(e,t,n,r){yT.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const ZC=new qe;class q8{constructor(e=new qe(1/0,1/0),t=new qe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=ZC.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ZC).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $C=new Q,vy=new Q,Up=new Q,Fp=new Q,Pb=new Q,J8=new Q,K8=new Q;class Z8{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){$C.subVectors(e,this.start),vy.subVectors(this.end,this.start);const n=vy.dot(vy);let s=vy.dot($C)/n;return t&&(s=gn(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=J8,n=K8){const r=10000000000000001e-32;let s,o;const u=this.start,f=e.start,p=this.end,g=e.end;Up.subVectors(p,u),Fp.subVectors(g,f),Pb.subVectors(u,f);const v=Up.dot(Up),y=Fp.dot(Fp),A=Fp.dot(Pb);if(v<=r&&y<=r)return t.copy(u),n.copy(f),t.sub(n),t.dot(t);if(v<=r)s=0,o=A/y,o=gn(o,0,1);else{const S=Up.dot(Pb);if(y<=r)o=0,s=gn(-S/v,0,1);else{const T=Up.dot(Fp),M=v*y-T*T;M!==0?s=gn((T*A-S*y)/M,0,1):s=0,o=(T*s+A)/y,o<0?(o=0,s=gn(-S/v,0,1)):o>1&&(o=1,s=gn((T-S)/v,0,1))}}return t.copy(u).add(Up.multiplyScalar(s)),n.copy(f).add(Fp.multiplyScalar(o)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const e3=new Q;class $8 extends ni{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new pn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,u=1,f=32;o<f;o++,u++){const p=o/f*Math.PI*2,g=u/f*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(g),Math.sin(g),1)}n.setAttribute("position",new Jt(r,3));const s=new Ms({fog:!1,toneMapped:!1});this.cone=new xl(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),e3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const sd=new Q,xy=new jt,Ub=new jt;class e6 extends xl{constructor(e){const t=O4(e),n=new pn,r=[],s=[];for(let p=0;p<t.length;p++){const g=t[p];g.parent&&g.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new Jt(r,3)),n.setAttribute("color",new Jt(s,3));const o=new Ms({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const u=new Ft(255),f=new Ft(65280);this.setColors(u,f)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Ub.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const u=t[s];u.parent&&u.parent.isBone&&(xy.multiplyMatrices(Ub,u.matrixWorld),sd.setFromMatrixPosition(xy),r.setXYZ(o,sd.x,sd.y,sd.z),xy.multiplyMatrices(Ub,u.parent.matrixWorld),sd.setFromMatrixPosition(xy),r.setXYZ(o+1,sd.x,sd.y,sd.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function O4(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...O4(i.children[t]));return e}class t6 extends Oi{constructor(e,t,n){const r=new Hv(t,4,2),s=new za({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const n6=new Q,t3=new Ft,n3=new Ft;class i6 extends ni{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new zv(t);r.rotateY(Math.PI*.5),this.material=new za({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new jn(o,3)),this.add(new Oi(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");t3.copy(this.light.color),n3.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?t3:n3;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(n6.setFromMatrixPosition(this.light.matrixWorld).negate())}}class r6 extends xl{constructor(e=10,t=10,n=4473924,r=8947848){n=new Ft(n),r=new Ft(r);const s=t/2,o=e/t,u=e/2,f=[],p=[];for(let y=0,A=0,S=-u;y<=t;y++,S+=o){f.push(-u,0,S,u,0,S),f.push(S,0,-u,S,0,u);const T=y===s?n:r;T.toArray(p,A),A+=3,T.toArray(p,A),A+=3,T.toArray(p,A),A+=3,T.toArray(p,A),A+=3}const g=new pn;g.setAttribute("position",new Jt(f,3)),g.setAttribute("color",new Jt(p,3));const v=new Ms({vertexColors:!0,toneMapped:!1});super(g,v),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class s6 extends xl{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new Ft(s),o=new Ft(o);const u=[],f=[];if(t>1)for(let v=0;v<t;v++){const y=v/t*(Math.PI*2),A=Math.sin(y)*e,S=Math.cos(y)*e;u.push(0,0,0),u.push(A,0,S);const T=v&1?s:o;f.push(T.r,T.g,T.b),f.push(T.r,T.g,T.b)}for(let v=0;v<n;v++){const y=v&1?s:o,A=e-e/n*v;for(let S=0;S<r;S++){let T=S/r*(Math.PI*2),M=Math.sin(T)*A,E=Math.cos(T)*A;u.push(M,0,E),f.push(y.r,y.g,y.b),T=(S+1)/r*(Math.PI*2),M=Math.sin(T)*A,E=Math.cos(T)*A,u.push(M,0,E),f.push(y.r,y.g,y.b)}}const p=new pn;p.setAttribute("position",new Jt(u,3)),p.setAttribute("color",new Jt(f,3));const g=new Ms({vertexColors:!0,toneMapped:!1});super(p,g),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const i3=new Q,yy=new Q,r3=new Q;class a6 extends ni{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new pn;r.setAttribute("position",new Jt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Ms({fog:!1,toneMapped:!1});this.lightPlane=new sc(r,s),this.add(this.lightPlane),r=new pn,r.setAttribute("position",new Jt([0,0,0,0,0,1],3)),this.targetLine=new sc(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),i3.setFromMatrixPosition(this.light.matrixWorld),yy.setFromMatrixPosition(this.light.target.matrixWorld),r3.subVectors(yy,i3),this.lightPlane.lookAt(yy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(yy),this.targetLine.scale.z=r3.length()}}const Ay=new Q,br=new Bm;class o6 extends xl{constructor(e){const t=new pn,n=new Ms({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4");function u(S,T){f(S),f(T)}function f(S){r.push(0,0,0),s.push(0,0,0),o[S]===void 0&&(o[S]=[]),o[S].push(r.length/3-1)}t.setAttribute("position",new Jt(r,3)),t.setAttribute("color",new Jt(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const p=new Ft(16755200),g=new Ft(16711680),v=new Ft(43775),y=new Ft(16777215),A=new Ft(3355443);this.setColors(p,g,v,y,A)}setColors(e,t,n,r,s){const u=this.geometry.getAttribute("color");return u.setXYZ(0,e.r,e.g,e.b),u.setXYZ(1,e.r,e.g,e.b),u.setXYZ(2,e.r,e.g,e.b),u.setXYZ(3,e.r,e.g,e.b),u.setXYZ(4,e.r,e.g,e.b),u.setXYZ(5,e.r,e.g,e.b),u.setXYZ(6,e.r,e.g,e.b),u.setXYZ(7,e.r,e.g,e.b),u.setXYZ(8,e.r,e.g,e.b),u.setXYZ(9,e.r,e.g,e.b),u.setXYZ(10,e.r,e.g,e.b),u.setXYZ(11,e.r,e.g,e.b),u.setXYZ(12,e.r,e.g,e.b),u.setXYZ(13,e.r,e.g,e.b),u.setXYZ(14,e.r,e.g,e.b),u.setXYZ(15,e.r,e.g,e.b),u.setXYZ(16,e.r,e.g,e.b),u.setXYZ(17,e.r,e.g,e.b),u.setXYZ(18,e.r,e.g,e.b),u.setXYZ(19,e.r,e.g,e.b),u.setXYZ(20,e.r,e.g,e.b),u.setXYZ(21,e.r,e.g,e.b),u.setXYZ(22,e.r,e.g,e.b),u.setXYZ(23,e.r,e.g,e.b),u.setXYZ(24,t.r,t.g,t.b),u.setXYZ(25,t.r,t.g,t.b),u.setXYZ(26,t.r,t.g,t.b),u.setXYZ(27,t.r,t.g,t.b),u.setXYZ(28,t.r,t.g,t.b),u.setXYZ(29,t.r,t.g,t.b),u.setXYZ(30,t.r,t.g,t.b),u.setXYZ(31,t.r,t.g,t.b),u.setXYZ(32,n.r,n.g,n.b),u.setXYZ(33,n.r,n.g,n.b),u.setXYZ(34,n.r,n.g,n.b),u.setXYZ(35,n.r,n.g,n.b),u.setXYZ(36,n.r,n.g,n.b),u.setXYZ(37,n.r,n.g,n.b),u.setXYZ(38,r.r,r.g,r.b),u.setXYZ(39,r.r,r.g,r.b),u.setXYZ(40,s.r,s.g,s.b),u.setXYZ(41,s.r,s.g,s.b),u.setXYZ(42,s.r,s.g,s.b),u.setXYZ(43,s.r,s.g,s.b),u.setXYZ(44,s.r,s.g,s.b),u.setXYZ(45,s.r,s.g,s.b),u.setXYZ(46,s.r,s.g,s.b),u.setXYZ(47,s.r,s.g,s.b),u.setXYZ(48,s.r,s.g,s.b),u.setXYZ(49,s.r,s.g,s.b),u.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let s,o;if(br.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,o=0;else if(this.camera.coordinateSystem===Za)s=-1,o=1;else if(this.camera.coordinateSystem===xm)s=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);Dr("c",t,e,br,0,0,s),Dr("t",t,e,br,0,0,o),Dr("n1",t,e,br,-n,-r,s),Dr("n2",t,e,br,n,-r,s),Dr("n3",t,e,br,-n,r,s),Dr("n4",t,e,br,n,r,s),Dr("f1",t,e,br,-n,-r,o),Dr("f2",t,e,br,n,-r,o),Dr("f3",t,e,br,-n,r,o),Dr("f4",t,e,br,n,r,o),Dr("u1",t,e,br,n*.7,r*1.1,s),Dr("u2",t,e,br,-n*.7,r*1.1,s),Dr("u3",t,e,br,0,r*2,s),Dr("cf1",t,e,br,-n,0,o),Dr("cf2",t,e,br,n,0,o),Dr("cf3",t,e,br,0,-r,o),Dr("cf4",t,e,br,0,r,o),Dr("cn1",t,e,br,-n,0,s),Dr("cn2",t,e,br,n,0,s),Dr("cn3",t,e,br,0,-r,s),Dr("cn4",t,e,br,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Dr(i,e,t,n,r,s,o){Ay.set(r,s,o).unproject(n);const u=e[i];if(u!==void 0){const f=t.getAttribute("position");for(let p=0,g=u.length;p<g;p++)f.setXYZ(u[p],Ay.x,Ay.y,Ay.z)}}const _y=new Es;class l6 extends xl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new pn;s.setIndex(new jn(n,1)),s.setAttribute("position",new jn(r,3)),super(s,new Ms({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&_y.setFromObject(this.object),_y.isEmpty())return;const e=_y.min,t=_y.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class c6 extends xl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new pn;s.setIndex(new jn(n,1)),s.setAttribute("position",new Jt(r,3)),super(s,new Ms({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class u6 extends sc{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new pn;o.setAttribute("position",new Jt(s,3)),o.computeBoundingSphere(),super(o,new Ms({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new pn;f.setAttribute("position",new Jt(u,3)),f.computeBoundingSphere(),this.add(new Oi(f,new za({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const s3=new Q;let Sy,Fb;class d6 extends ni{constructor(e=new Q(0,0,1),t=new Q(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",Sy===void 0&&(Sy=new pn,Sy.setAttribute("position",new Jt([0,0,0,0,1,0],3)),Fb=new Uv(.5,1,5,1),Fb.translate(0,-.5,0)),this.position.copy(t),this.line=new sc(Sy,new Ms({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Oi(Fb,new za({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{s3.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(s3,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class f6 extends xl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new pn;r.setAttribute("position",new Jt(t,3)),r.setAttribute("color",new Jt(n,3));const s=new Ms({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new Ft,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class h6{constructor(){this.type="ShapePath",this.color=new Ft,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new WA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(E){const R=[];for(let I=0,O=E.length;I<O;I++){const F=E[I],z=new Xf;z.curves=F.curves,R.push(z)}return R}function n(E,R){const I=R.length;let O=!1;for(let F=I-1,z=0;z<I;F=z++){let j=R[F],W=R[z],L=W.x-j.x,H=W.y-j.y;if(Math.abs(H)>Number.EPSILON){if(H<0&&(j=R[z],L=-L,W=R[F],H=-H),E.y<j.y||E.y>W.y)continue;if(E.y===j.y){if(E.x===j.x)return!0}else{const K=H*(E.x-j.x)-L*(E.y-j.y);if(K===0)return!0;if(K<0)continue;O=!O}}else{if(E.y!==j.y)continue;if(W.x<=E.x&&E.x<=j.x||j.x<=E.x&&E.x<=W.x)return!0}}return O}const r=fl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,u,f;const p=[];if(s.length===1)return u=s[0],f=new Xf,f.curves=u.curves,p.push(f),p;let g=!r(s[0].getPoints());g=e?!g:g;const v=[],y=[];let A=[],S=0,T;y[S]=void 0,A[S]=[];for(let E=0,R=s.length;E<R;E++)u=s[E],T=u.getPoints(),o=r(T),o=e?!o:o,o?(!g&&y[S]&&S++,y[S]={s:new Xf,p:T},y[S].s.curves=u.curves,g&&S++,A[S]=[]):A[S].push({h:u,p:T[0]});if(!y[0])return t(s);if(y.length>1){let E=!1,R=0;for(let I=0,O=y.length;I<O;I++)v[I]=[];for(let I=0,O=y.length;I<O;I++){const F=A[I];for(let z=0;z<F.length;z++){const j=F[z];let W=!0;for(let L=0;L<y.length;L++)n(j.p,y[L].p)&&(I!==L&&R++,W?(W=!1,v[L].push(j)):E=!0);W&&v[I].push(j)}}R>0&&E===!1&&(A=v)}let M;for(let E=0,R=y.length;E<R;E++){f=y[E].s,p.push(f),M=A[E];for(let I=0,O=M.length;I<O;I++)f.holes.push(M[I].h)}return p}}class p6 extends eo{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Ht("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function m6(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function g6(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function v6(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function zE(i,e,t,n){const r=x6(n);switch(t){case UM:return i*e;case tc:return i*e/r.components*r.byteLength;case Nv:return i*e/r.components*r.byteLength;case Bo:return i*e*2/r.components*r.byteLength;case g_:return i*e*2/r.components*r.byteLength;case FM:return i*e*3/r.components*r.byteLength;case Ai:return i*e*4/r.components*r.byteLength;case v_:return i*e*4/r.components*r.byteLength;case qg:case Jg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Kg:case Zg:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case cA:case dA:return Math.max(i,16)*Math.max(e,8)/4;case lA:case uA:return Math.max(i,8)*Math.max(e,8)/2;case fA:case hA:case mA:case gA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case pA:case vA:case xA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case yA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case AA:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case _A:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case SA:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case bA:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case EA:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case MA:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case TA:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case wA:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case CA:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case RA:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case DA:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case IA:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case BA:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case NA:case OA:case LA:return Math.ceil(i/4)*Math.ceil(e/4)*16;case PA:case UA:return Math.ceil(i/4)*Math.ceil(e/4)*8;case FA:case zA:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function x6(i){switch(i){case _i:case Iv:return{byteLength:1,components:1};case Kf:case Bv:case On:return{byteLength:2,components:1};case p_:case m_:return{byteLength:2,components:4};case ca:case Im:case si:return{byteLength:4,components:1};case LM:case PM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class y6{static contain(e,t){return m6(e,t)}static cover(e,t){return g6(e,t)}static fill(e){return v6(e)}static getByteLength(e,t,n,r){return zE(e,t,n,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:lu}}));typeof window<"u"&&(window.__THREE__?Ht("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=lu);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function L4(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function A6(i){const e=new WeakMap;function t(u,f){const p=u.array,g=u.usage,v=p.byteLength,y=i.createBuffer();i.bindBuffer(f,y),i.bufferData(f,p,g),u.onUploadCallback();let A;if(p instanceof Float32Array)A=i.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)A=i.HALF_FLOAT;else if(p instanceof Uint16Array)u.isFloat16BufferAttribute?A=i.HALF_FLOAT:A=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)A=i.SHORT;else if(p instanceof Uint32Array)A=i.UNSIGNED_INT;else if(p instanceof Int32Array)A=i.INT;else if(p instanceof Int8Array)A=i.BYTE;else if(p instanceof Uint8Array)A=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)A=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:y,type:A,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:v}}function n(u,f,p){const g=f.array,v=f.updateRanges;if(i.bindBuffer(p,u),v.length===0)i.bufferSubData(p,0,g);else{v.sort((A,S)=>A.start-S.start);let y=0;for(let A=1;A<v.length;A++){const S=v[y],T=v[A];T.start<=S.start+S.count+1?S.count=Math.max(S.count,T.start+T.count-S.start):(++y,v[y]=T)}v.length=y+1;for(let A=0,S=v.length;A<S;A++){const T=v[A];i.bufferSubData(p,T.start*g.BYTES_PER_ELEMENT,g,T.start,T.count)}f.clearUpdateRanges()}f.onUploadCallback()}function r(u){return u.isInterleavedBufferAttribute&&(u=u.data),e.get(u)}function s(u){u.isInterleavedBufferAttribute&&(u=u.data);const f=e.get(u);f&&(i.deleteBuffer(f.buffer),e.delete(u))}function o(u,f){if(u.isInterleavedBufferAttribute&&(u=u.data),u.isGLBufferAttribute){const g=e.get(u);(!g||g.version<u.version)&&e.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}const p=e.get(u);if(p===void 0)e.set(u,t(u,f));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,u,f),p.version=u.version}}return{get:r,remove:s,update:o}}var _6=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,S6=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,b6=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,E6=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,M6=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,T6=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,w6=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,C6=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,R6=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,D6=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,I6=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,B6=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,N6=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,O6=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,L6=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,P6=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,U6=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,F6=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,z6=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,H6=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,G6=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,k6=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,V6=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,j6=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,W6=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,X6=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Y6=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Q6=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,q6=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,J6=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,K6="gl_FragColor = linearToOutputTexel( gl_FragColor );",Z6=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,$6=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,eO=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,tO=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,nO=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,iO=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,rO=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,sO=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,aO=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,oO=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,lO=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,cO=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,uO=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,dO=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,fO=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,hO=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,pO=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,mO=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,gO=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,vO=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,xO=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,yO=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,AO=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,_O=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,SO=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,bO=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,EO=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,MO=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,TO=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,wO=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,CO=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,RO=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,DO=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,IO=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,BO=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,NO=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,OO=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,LO=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,PO=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,UO=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,FO=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,zO=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,HO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,GO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kO=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,VO=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,jO=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,WO=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,XO=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,YO=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,QO=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qO=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,JO=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,KO=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ZO=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,$O=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,eL=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,tL=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,nL=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,iL=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,rL=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,sL=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,aL=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,oL=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,lL=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,cL=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,uL=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,dL=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,fL=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,hL=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,pL=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,mL=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,gL=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vL=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,xL=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,yL=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const AL=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,_L=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,SL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,bL=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,EL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ML=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TL=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,wL=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,CL=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,RL=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,DL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,IL=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,BL=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NL=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,OL=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,LL=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PL=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,UL=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FL=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,zL=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HL=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,GL=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,kL=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VL=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jL=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,WL=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XL=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YL=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QL=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,qL=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,JL=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KL=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ZL=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$L=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pn={alphahash_fragment:_6,alphahash_pars_fragment:S6,alphamap_fragment:b6,alphamap_pars_fragment:E6,alphatest_fragment:M6,alphatest_pars_fragment:T6,aomap_fragment:w6,aomap_pars_fragment:C6,batching_pars_vertex:R6,batching_vertex:D6,begin_vertex:I6,beginnormal_vertex:B6,bsdfs:N6,iridescence_fragment:O6,bumpmap_pars_fragment:L6,clipping_planes_fragment:P6,clipping_planes_pars_fragment:U6,clipping_planes_pars_vertex:F6,clipping_planes_vertex:z6,color_fragment:H6,color_pars_fragment:G6,color_pars_vertex:k6,color_vertex:V6,common:j6,cube_uv_reflection_fragment:W6,defaultnormal_vertex:X6,displacementmap_pars_vertex:Y6,displacementmap_vertex:Q6,emissivemap_fragment:q6,emissivemap_pars_fragment:J6,colorspace_fragment:K6,colorspace_pars_fragment:Z6,envmap_fragment:$6,envmap_common_pars_fragment:eO,envmap_pars_fragment:tO,envmap_pars_vertex:nO,envmap_physical_pars_fragment:hO,envmap_vertex:iO,fog_vertex:rO,fog_pars_vertex:sO,fog_fragment:aO,fog_pars_fragment:oO,gradientmap_pars_fragment:lO,lightmap_pars_fragment:cO,lights_lambert_fragment:uO,lights_lambert_pars_fragment:dO,lights_pars_begin:fO,lights_toon_fragment:pO,lights_toon_pars_fragment:mO,lights_phong_fragment:gO,lights_phong_pars_fragment:vO,lights_physical_fragment:xO,lights_physical_pars_fragment:yO,lights_fragment_begin:AO,lights_fragment_maps:_O,lights_fragment_end:SO,logdepthbuf_fragment:bO,logdepthbuf_pars_fragment:EO,logdepthbuf_pars_vertex:MO,logdepthbuf_vertex:TO,map_fragment:wO,map_pars_fragment:CO,map_particle_fragment:RO,map_particle_pars_fragment:DO,metalnessmap_fragment:IO,metalnessmap_pars_fragment:BO,morphinstance_vertex:NO,morphcolor_vertex:OO,morphnormal_vertex:LO,morphtarget_pars_vertex:PO,morphtarget_vertex:UO,normal_fragment_begin:FO,normal_fragment_maps:zO,normal_pars_fragment:HO,normal_pars_vertex:GO,normal_vertex:kO,normalmap_pars_fragment:VO,clearcoat_normal_fragment_begin:jO,clearcoat_normal_fragment_maps:WO,clearcoat_pars_fragment:XO,iridescence_pars_fragment:YO,opaque_fragment:QO,packing:qO,premultiplied_alpha_fragment:JO,project_vertex:KO,dithering_fragment:ZO,dithering_pars_fragment:$O,roughnessmap_fragment:eL,roughnessmap_pars_fragment:tL,shadowmap_pars_fragment:nL,shadowmap_pars_vertex:iL,shadowmap_vertex:rL,shadowmask_pars_fragment:sL,skinbase_vertex:aL,skinning_pars_vertex:oL,skinning_vertex:lL,skinnormal_vertex:cL,specularmap_fragment:uL,specularmap_pars_fragment:dL,tonemapping_fragment:fL,tonemapping_pars_fragment:hL,transmission_fragment:pL,transmission_pars_fragment:mL,uv_pars_fragment:gL,uv_pars_vertex:vL,uv_vertex:xL,worldpos_vertex:yL,background_vert:AL,background_frag:_L,backgroundCube_vert:SL,backgroundCube_frag:bL,cube_vert:EL,cube_frag:ML,depth_vert:TL,depth_frag:wL,distance_vert:CL,distance_frag:RL,equirect_vert:DL,equirect_frag:IL,linedashed_vert:BL,linedashed_frag:NL,meshbasic_vert:OL,meshbasic_frag:LL,meshlambert_vert:PL,meshlambert_frag:UL,meshmatcap_vert:FL,meshmatcap_frag:zL,meshnormal_vert:HL,meshnormal_frag:GL,meshphong_vert:kL,meshphong_frag:VL,meshphysical_vert:jL,meshphysical_frag:WL,meshtoon_vert:XL,meshtoon_frag:YL,points_vert:QL,points_frag:qL,shadow_vert:JL,shadow_frag:KL,sprite_vert:ZL,sprite_frag:$L},kt={common:{diffuse:{value:new Ft(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new An},alphaMap:{value:null},alphaMapTransform:{value:new An},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new An}},envmap:{envMap:{value:null},envMapRotation:{value:new An},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new An}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new An}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new An},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new An},normalScale:{value:new qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new An},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new An}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new An}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new An}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new An},alphaTest:{value:0},uvTransform:{value:new An}},sprite:{diffuse:{value:new Ft(16777215)},opacity:{value:1},center:{value:new qe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new An},alphaMap:{value:null},alphaMapTransform:{value:new An},alphaTest:{value:0}}},dl={basic:{uniforms:ia([kt.common,kt.specularmap,kt.envmap,kt.aomap,kt.lightmap,kt.fog]),vertexShader:Pn.meshbasic_vert,fragmentShader:Pn.meshbasic_frag},lambert:{uniforms:ia([kt.common,kt.specularmap,kt.envmap,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.fog,kt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:Pn.meshlambert_vert,fragmentShader:Pn.meshlambert_frag},phong:{uniforms:ia([kt.common,kt.specularmap,kt.envmap,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.fog,kt.lights,{emissive:{value:new Ft(0)},specular:{value:new Ft(1118481)},shininess:{value:30}}]),vertexShader:Pn.meshphong_vert,fragmentShader:Pn.meshphong_frag},standard:{uniforms:ia([kt.common,kt.envmap,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.roughnessmap,kt.metalnessmap,kt.fog,kt.lights,{emissive:{value:new Ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag},toon:{uniforms:ia([kt.common,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.gradientmap,kt.fog,kt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:Pn.meshtoon_vert,fragmentShader:Pn.meshtoon_frag},matcap:{uniforms:ia([kt.common,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.fog,{matcap:{value:null}}]),vertexShader:Pn.meshmatcap_vert,fragmentShader:Pn.meshmatcap_frag},points:{uniforms:ia([kt.points,kt.fog]),vertexShader:Pn.points_vert,fragmentShader:Pn.points_frag},dashed:{uniforms:ia([kt.common,kt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pn.linedashed_vert,fragmentShader:Pn.linedashed_frag},depth:{uniforms:ia([kt.common,kt.displacementmap]),vertexShader:Pn.depth_vert,fragmentShader:Pn.depth_frag},normal:{uniforms:ia([kt.common,kt.bumpmap,kt.normalmap,kt.displacementmap,{opacity:{value:1}}]),vertexShader:Pn.meshnormal_vert,fragmentShader:Pn.meshnormal_frag},sprite:{uniforms:ia([kt.sprite,kt.fog]),vertexShader:Pn.sprite_vert,fragmentShader:Pn.sprite_frag},background:{uniforms:{uvTransform:{value:new An},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pn.background_vert,fragmentShader:Pn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new An}},vertexShader:Pn.backgroundCube_vert,fragmentShader:Pn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pn.cube_vert,fragmentShader:Pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pn.equirect_vert,fragmentShader:Pn.equirect_frag},distance:{uniforms:ia([kt.common,kt.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pn.distance_vert,fragmentShader:Pn.distance_frag},shadow:{uniforms:ia([kt.lights,kt.fog,{color:{value:new Ft(0)},opacity:{value:1}}]),vertexShader:Pn.shadow_vert,fragmentShader:Pn.shadow_frag}};dl.physical={uniforms:ia([dl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new An},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new An},clearcoatNormalScale:{value:new qe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new An},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new An},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new An},sheen:{value:0},sheenColor:{value:new Ft(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new An},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new An},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new An},transmissionSamplerSize:{value:new qe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new An},attenuationDistance:{value:0},attenuationColor:{value:new Ft(0)},specularColor:{value:new Ft(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new An},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new An},anisotropyVector:{value:new qe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new An}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag};const by={r:0,b:0,g:0},Tf=new Ga,eP=new jt;function tP(i,e,t,n,r,s,o){const u=new Ft(0);let f=s===!0?0:1,p,g,v=null,y=0,A=null;function S(I){let O=I.isScene===!0?I.background:null;return O&&O.isTexture&&(O=(I.backgroundBlurriness>0?t:e).get(O)),O}function T(I){let O=!1;const F=S(I);F===null?E(u,f):F&&F.isColor&&(E(F,1),O=!0);const z=i.xr.getEnvironmentBlendMode();z==="additive"?n.buffers.color.setClear(0,0,0,1,o):z==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||O)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function M(I,O){const F=S(O);F&&(F.isCubeTexture||F.mapping===Dm)?(g===void 0&&(g=new Oi(new Ed(1,1,1),new ai({name:"BackgroundCubeMaterial",uniforms:Sm(dl.backgroundCube.uniforms),vertexShader:dl.backgroundCube.vertexShader,fragmentShader:dl.backgroundCube.fragmentShader,side:jr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(z,j,W){this.matrixWorld.copyPosition(W.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(g)),Tf.copy(O.backgroundRotation),Tf.x*=-1,Tf.y*=-1,Tf.z*=-1,F.isCubeTexture&&F.isRenderTargetTexture===!1&&(Tf.y*=-1,Tf.z*=-1),g.material.uniforms.envMap.value=F,g.material.uniforms.flipEnvMap.value=F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,g.material.uniforms.backgroundBlurriness.value=O.backgroundBlurriness,g.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,g.material.uniforms.backgroundRotation.value.setFromMatrix4(eP.makeRotationFromEuler(Tf)),g.material.toneMapped=$n.getTransfer(F.colorSpace)!==yi,(v!==F||y!==F.version||A!==i.toneMapping)&&(g.material.needsUpdate=!0,v=F,y=F.version,A=i.toneMapping),g.layers.enableAll(),I.unshift(g,g.geometry,g.material,0,0,null)):F&&F.isTexture&&(p===void 0&&(p=new Oi(new lc(2,2),new ai({name:"BackgroundMaterial",uniforms:Sm(dl.background.uniforms),vertexShader:dl.background.vertexShader,fragmentShader:dl.background.fragmentShader,side:ml,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=F,p.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,p.material.toneMapped=$n.getTransfer(F.colorSpace)!==yi,F.matrixAutoUpdate===!0&&F.updateMatrix(),p.material.uniforms.uvTransform.value.copy(F.matrix),(v!==F||y!==F.version||A!==i.toneMapping)&&(p.material.needsUpdate=!0,v=F,y=F.version,A=i.toneMapping),p.layers.enableAll(),I.unshift(p,p.geometry,p.material,0,0,null))}function E(I,O){I.getRGB(by,Q2(i)),n.buffers.color.setClear(by.r,by.g,by.b,O,o)}function R(){g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return u},setClearColor:function(I,O=1){u.set(I),f=O,E(u,f)},getClearAlpha:function(){return f},setClearAlpha:function(I){f=I,E(u,f)},render:T,addToRenderList:M,dispose:R}}function nP(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=y(null);let s=r,o=!1;function u(H,K,de,ce,ne){let fe=!1;const X=v(ce,de,K);s!==X&&(s=X,p(s.object)),fe=A(H,ce,de,ne),fe&&S(H,ce,de,ne),ne!==null&&e.update(ne,i.ELEMENT_ARRAY_BUFFER),(fe||o)&&(o=!1,O(H,K,de,ce),ne!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(ne).buffer))}function f(){return i.createVertexArray()}function p(H){return i.bindVertexArray(H)}function g(H){return i.deleteVertexArray(H)}function v(H,K,de){const ce=de.wireframe===!0;let ne=n[H.id];ne===void 0&&(ne={},n[H.id]=ne);let fe=ne[K.id];fe===void 0&&(fe={},ne[K.id]=fe);let X=fe[ce];return X===void 0&&(X=y(f()),fe[ce]=X),X}function y(H){const K=[],de=[],ce=[];for(let ne=0;ne<t;ne++)K[ne]=0,de[ne]=0,ce[ne]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:K,enabledAttributes:de,attributeDivisors:ce,object:H,attributes:{},index:null}}function A(H,K,de,ce){const ne=s.attributes,fe=K.attributes;let X=0;const re=de.getAttributes();for(const ge in re)if(re[ge].location>=0){const Se=ne[ge];let Y=fe[ge];if(Y===void 0&&(ge==="instanceMatrix"&&H.instanceMatrix&&(Y=H.instanceMatrix),ge==="instanceColor"&&H.instanceColor&&(Y=H.instanceColor)),Se===void 0||Se.attribute!==Y||Y&&Se.data!==Y.data)return!0;X++}return s.attributesNum!==X||s.index!==ce}function S(H,K,de,ce){const ne={},fe=K.attributes;let X=0;const re=de.getAttributes();for(const ge in re)if(re[ge].location>=0){let Se=fe[ge];Se===void 0&&(ge==="instanceMatrix"&&H.instanceMatrix&&(Se=H.instanceMatrix),ge==="instanceColor"&&H.instanceColor&&(Se=H.instanceColor));const Y={};Y.attribute=Se,Se&&Se.data&&(Y.data=Se.data),ne[ge]=Y,X++}s.attributes=ne,s.attributesNum=X,s.index=ce}function T(){const H=s.newAttributes;for(let K=0,de=H.length;K<de;K++)H[K]=0}function M(H){E(H,0)}function E(H,K){const de=s.newAttributes,ce=s.enabledAttributes,ne=s.attributeDivisors;de[H]=1,ce[H]===0&&(i.enableVertexAttribArray(H),ce[H]=1),ne[H]!==K&&(i.vertexAttribDivisor(H,K),ne[H]=K)}function R(){const H=s.newAttributes,K=s.enabledAttributes;for(let de=0,ce=K.length;de<ce;de++)K[de]!==H[de]&&(i.disableVertexAttribArray(de),K[de]=0)}function I(H,K,de,ce,ne,fe,X){X===!0?i.vertexAttribIPointer(H,K,de,ne,fe):i.vertexAttribPointer(H,K,de,ce,ne,fe)}function O(H,K,de,ce){T();const ne=ce.attributes,fe=de.getAttributes(),X=K.defaultAttributeValues;for(const re in fe){const ge=fe[re];if(ge.location>=0){let Te=ne[re];if(Te===void 0&&(re==="instanceMatrix"&&H.instanceMatrix&&(Te=H.instanceMatrix),re==="instanceColor"&&H.instanceColor&&(Te=H.instanceColor)),Te!==void 0){const Se=Te.normalized,Y=Te.itemSize,me=e.get(Te);if(me===void 0)continue;const Ce=me.buffer,Ze=me.type,xt=me.bytesPerElement,ve=Ze===i.INT||Ze===i.UNSIGNED_INT||Te.gpuType===Im;if(Te.isInterleavedBufferAttribute){const ze=Te.data,dt=ze.stride,Ee=Te.offset;if(ze.isInstancedInterleavedBuffer){for(let yt=0;yt<ge.locationSize;yt++)E(ge.location+yt,ze.meshPerAttribute);H.isInstancedMesh!==!0&&ce._maxInstanceCount===void 0&&(ce._maxInstanceCount=ze.meshPerAttribute*ze.count)}else for(let yt=0;yt<ge.locationSize;yt++)M(ge.location+yt);i.bindBuffer(i.ARRAY_BUFFER,Ce);for(let yt=0;yt<ge.locationSize;yt++)I(ge.location+yt,Y/ge.locationSize,Ze,Se,dt*xt,(Ee+Y/ge.locationSize*yt)*xt,ve)}else{if(Te.isInstancedBufferAttribute){for(let ze=0;ze<ge.locationSize;ze++)E(ge.location+ze,Te.meshPerAttribute);H.isInstancedMesh!==!0&&ce._maxInstanceCount===void 0&&(ce._maxInstanceCount=Te.meshPerAttribute*Te.count)}else for(let ze=0;ze<ge.locationSize;ze++)M(ge.location+ze);i.bindBuffer(i.ARRAY_BUFFER,Ce);for(let ze=0;ze<ge.locationSize;ze++)I(ge.location+ze,Y/ge.locationSize,Ze,Se,Y*xt,Y/ge.locationSize*ze*xt,ve)}}else if(X!==void 0){const Se=X[re];if(Se!==void 0)switch(Se.length){case 2:i.vertexAttrib2fv(ge.location,Se);break;case 3:i.vertexAttrib3fv(ge.location,Se);break;case 4:i.vertexAttrib4fv(ge.location,Se);break;default:i.vertexAttrib1fv(ge.location,Se)}}}}R()}function F(){W();for(const H in n){const K=n[H];for(const de in K){const ce=K[de];for(const ne in ce)g(ce[ne].object),delete ce[ne];delete K[de]}delete n[H]}}function z(H){if(n[H.id]===void 0)return;const K=n[H.id];for(const de in K){const ce=K[de];for(const ne in ce)g(ce[ne].object),delete ce[ne];delete K[de]}delete n[H.id]}function j(H){for(const K in n){const de=n[K];if(de[H.id]===void 0)continue;const ce=de[H.id];for(const ne in ce)g(ce[ne].object),delete ce[ne];delete de[H.id]}}function W(){L(),o=!0,s!==r&&(s=r,p(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:u,reset:W,resetDefaultState:L,dispose:F,releaseStatesOfGeometry:z,releaseStatesOfProgram:j,initAttributes:T,enableAttribute:M,disableUnusedAttributes:R}}function iP(i,e,t){let n;function r(p){n=p}function s(p,g){i.drawArrays(n,p,g),t.update(g,n,1)}function o(p,g,v){v!==0&&(i.drawArraysInstanced(n,p,g,v),t.update(g,n,v))}function u(p,g,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,g,0,v);let A=0;for(let S=0;S<v;S++)A+=g[S];t.update(A,n,1)}function f(p,g,v,y){if(v===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let S=0;S<p.length;S++)o(p[S],g[S],y[S]);else{A.multiDrawArraysInstancedWEBGL(n,p,0,g,0,y,0,v);let S=0;for(let T=0;T<v;T++)S+=g[T]*y[T];t.update(S,n,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=u,this.renderMultiDrawInstances=f}function rP(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const j=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(j.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(j){return!(j!==Ai&&n.convert(j)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function u(j){const W=j===On&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(j!==_i&&n.convert(j)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&j!==si&&!W)}function f(j){if(j==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";j="mediump"}return j==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const g=f(p);g!==p&&(Ht("WebGLRenderer:",p,"not supported, using",g,"instead."),p=g);const v=t.logarithmicDepthBuffer===!0,y=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),A=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),S=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),T=i.getParameter(i.MAX_TEXTURE_SIZE),M=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),E=i.getParameter(i.MAX_VERTEX_ATTRIBS),R=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),I=i.getParameter(i.MAX_VARYING_VECTORS),O=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),F=i.getParameter(i.MAX_SAMPLES),z=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:f,textureFormatReadable:o,textureTypeReadable:u,precision:p,logarithmicDepthBuffer:v,reversedDepthBuffer:y,maxTextures:A,maxVertexTextures:S,maxTextureSize:T,maxCubemapSize:M,maxAttributes:E,maxVertexUniforms:R,maxVaryings:I,maxFragmentUniforms:O,maxSamples:F,samples:z}}function sP(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Kc,u=new An,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(v,y){const A=v.length!==0||y||n!==0||r;return r=y,n=v.length,A},this.beginShadows=function(){s=!0,g(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(v,y){t=g(v,y,0)},this.setState=function(v,y,A){const S=v.clippingPlanes,T=v.clipIntersection,M=v.clipShadows,E=i.get(v);if(!r||S===null||S.length===0||s&&!M)s?g(null):p();else{const R=s?0:n,I=R*4;let O=E.clippingState||null;f.value=O,O=g(S,y,I,A);for(let F=0;F!==I;++F)O[F]=t[F];E.clippingState=O,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=R}};function p(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function g(v,y,A,S){const T=v!==null?v.length:0;let M=null;if(T!==0){if(M=f.value,S!==!0||M===null){const E=A+T*4,R=y.matrixWorldInverse;u.getNormalMatrix(R),(M===null||M.length<E)&&(M=new Float32Array(E));for(let I=0,O=A;I!==T;++I,O+=4)o.copy(v[I]).applyMatrix4(R,u),o.normal.toArray(M,O),M[O+3]=o.constant}f.value=M,f.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,M}}function aP(i){let e=new WeakMap;function t(o,u){return u===hm?o.mapping=gl:u===dv&&(o.mapping=xd),o}function n(o){if(o&&o.isTexture){const u=o.mapping;if(u===hm||u===dv)if(e.has(o)){const f=e.get(o).texture;return t(f,o.mapping)}else{const f=o.image;if(f&&f.height>0){const p=new S_(f.height);return p.fromEquirectangularTexture(i,o),e.set(o,p),o.addEventListener("dispose",r),t(p.texture,o.mapping)}else return null}}return o}function r(o){const u=o.target;u.removeEventListener("dispose",r);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const hd=4,a3=[.125,.215,.35,.446,.526,.582],Lf=20,oP=256,wg=new Ha,o3=new Ft;let zb=null,Hb=0,Gb=0,kb=!1;const lP=new Q;class HE{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:o=256,position:u=lP}=s;zb=this._renderer.getRenderTarget(),Hb=this._renderer.getActiveCubeFace(),Gb=this._renderer.getActiveMipmapLevel(),kb=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(e,n,r,f,u),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=u3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=c3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(zb,Hb,Gb),this._renderer.xr.enabled=kb,e.scissorTest=!1,zp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===gl||e.mapping===xd?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),zb=this._renderer.getRenderTarget(),Hb=this._renderer.getActiveCubeFace(),Gb=this._renderer.getActiveMipmapLevel(),kb=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:on,minFilter:on,generateMipmaps:!1,type:On,format:Ai,colorSpace:kr,depthBuffer:!1},r=l3(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=l3(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=cP(s)),this._blurMaterial=dP(s,e,t),this._ggxMaterial=uP(s,e,t)}return r}_compileMaterial(e){const t=new Oi(new pn,e);this._renderer.compile(t,wg)}_sceneToCubeUV(e,t,n,r,s){const f=new ki(90,1,t,n),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,A=v.toneMapping;v.getClearColor(o3),v.toneMapping=aa,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(r),v.clearDepth(),v.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Oi(new Ed,new za({name:"PMREM.Background",side:jr,depthWrite:!1,depthTest:!1})));const T=this._backgroundBox,M=T.material;let E=!1;const R=e.background;R?R.isColor&&(M.color.copy(R),e.background=null,E=!0):(M.color.copy(o3),E=!0);for(let I=0;I<6;I++){const O=I%3;O===0?(f.up.set(0,p[I],0),f.position.set(s.x,s.y,s.z),f.lookAt(s.x+g[I],s.y,s.z)):O===1?(f.up.set(0,0,p[I]),f.position.set(s.x,s.y,s.z),f.lookAt(s.x,s.y+g[I],s.z)):(f.up.set(0,p[I],0),f.position.set(s.x,s.y,s.z),f.lookAt(s.x,s.y,s.z+g[I]));const F=this._cubeSize;zp(r,O*F,I>2?F:0,F,F),v.setRenderTarget(r),E&&v.render(T,f),v.render(e,f)}v.toneMapping=A,v.autoClear=y,e.background=R}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===gl||e.mapping===xd;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=u3()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=c3());const s=r?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=s;const u=s.uniforms;u.envMap.value=e;const f=this._cubeSize;zp(t,0,0,3*f,2*f),n.setRenderTarget(t),n.render(o,wg)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,o=this._ggxMaterial,u=this._lodMeshes[n];u.material=o;const f=o.uniforms,p=n/(this._lodMeshes.length-1),g=t/(this._lodMeshes.length-1),v=Math.sqrt(p*p-g*g),y=0+p*1.25,A=v*y,{_lodMax:S}=this,T=this._sizeLods[n],M=3*T*(n>S-hd?n-S+hd:0),E=4*(this._cubeSize-T);f.envMap.value=e.texture,f.roughness.value=A,f.mipInt.value=S-t,zp(s,M,E,3*T,2*T),r.setRenderTarget(s),r.render(u,wg),f.envMap.value=s.texture,f.roughness.value=0,f.mipInt.value=S-n,zp(e,M,E,3*T,2*T),r.setRenderTarget(e),r.render(u,wg)}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,u){const f=this._renderer,p=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&nn("blur direction must be either latitudinal or longitudinal!");const g=3,v=this._lodMeshes[r];v.material=p;const y=p.uniforms,A=this._sizeLods[n]-1,S=isFinite(s)?Math.PI/(2*A):2*Math.PI/(2*Lf-1),T=s/S,M=isFinite(s)?1+Math.floor(g*T):Lf;M>Lf&&Ht(`sigmaRadians, ${s}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${Lf}`);const E=[];let R=0;for(let j=0;j<Lf;++j){const W=j/T,L=Math.exp(-W*W/2);E.push(L),j===0?R+=L:j<M&&(R+=2*L)}for(let j=0;j<E.length;j++)E[j]=E[j]/R;y.envMap.value=e.texture,y.samples.value=M,y.weights.value=E,y.latitudinal.value=o==="latitudinal",u&&(y.poleAxis.value=u);const{_lodMax:I}=this;y.dTheta.value=S,y.mipInt.value=I-n;const O=this._sizeLods[r],F=3*O*(r>I-hd?r-I+hd:0),z=4*(this._cubeSize-O);zp(t,F,z,3*O,2*O),f.setRenderTarget(t),f.render(v,wg)}}function cP(i){const e=[],t=[],n=[];let r=i;const s=i-hd+1+a3.length;for(let o=0;o<s;o++){const u=Math.pow(2,r);e.push(u);let f=1/u;o>i-hd?f=a3[o-i+hd-1]:o===0&&(f=0),t.push(f);const p=1/(u-2),g=-p,v=1+p,y=[g,g,v,g,v,v,g,g,v,v,g,v],A=6,S=6,T=3,M=2,E=1,R=new Float32Array(T*S*A),I=new Float32Array(M*S*A),O=new Float32Array(E*S*A);for(let z=0;z<A;z++){const j=z%3*2/3-1,W=z>2?0:-1,L=[j,W,0,j+2/3,W,0,j+2/3,W+1,0,j,W,0,j+2/3,W+1,0,j,W+1,0];R.set(L,T*S*z),I.set(y,M*S*z);const H=[z,z,z,z,z,z];O.set(H,E*S*z)}const F=new pn;F.setAttribute("position",new jn(R,T)),F.setAttribute("uv",new jn(I,M)),F.setAttribute("faceIndex",new jn(O,E)),n.push(new Oi(F,null)),r>hd&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function l3(i,e,t){const n=new ti(i,e,t);return n.texture.mapping=Dm,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function zp(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function uP(i,e,t){return new ai({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:oP,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:W_(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Pi,depthTest:!1,depthWrite:!1})}function dP(i,e,t){const n=new Float32Array(Lf),r=new Q(0,1,0);return new ai({name:"SphericalGaussianBlur",defines:{n:Lf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:W_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Pi,depthTest:!1,depthWrite:!1})}function c3(){return new ai({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:W_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Pi,depthTest:!1,depthWrite:!1})}function u3(){return new ai({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:W_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Pi,depthTest:!1,depthWrite:!1})}function W_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function fP(i){let e=new WeakMap,t=null;function n(u){if(u&&u.isTexture){const f=u.mapping,p=f===hm||f===dv,g=f===gl||f===xd;if(p||g){let v=e.get(u);const y=v!==void 0?v.texture.pmremVersion:0;if(u.isRenderTargetTexture&&u.pmremVersion!==y)return t===null&&(t=new HE(i)),v=p?t.fromEquirectangular(u,v):t.fromCubemap(u,v),v.texture.pmremVersion=u.pmremVersion,e.set(u,v),v.texture;if(v!==void 0)return v.texture;{const A=u.image;return p&&A&&A.height>0||g&&A&&r(A)?(t===null&&(t=new HE(i)),v=p?t.fromEquirectangular(u):t.fromCubemap(u),v.texture.pmremVersion=u.pmremVersion,e.set(u,v),u.addEventListener("dispose",s),v.texture):null}}}return u}function r(u){let f=0;const p=6;for(let g=0;g<p;g++)u[g]!==void 0&&f++;return f===p}function s(u){const f=u.target;f.removeEventListener("dispose",s);const p=e.get(f);p!==void 0&&(e.delete(f),p.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function hP(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&ym("WebGLRenderer: "+n+" extension not supported."),r}}}function pP(i,e,t,n){const r={},s=new WeakMap;function o(v){const y=v.target;y.index!==null&&e.remove(y.index);for(const S in y.attributes)e.remove(y.attributes[S]);y.removeEventListener("dispose",o),delete r[y.id];const A=s.get(y);A&&(e.remove(A),s.delete(y)),n.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function u(v,y){return r[y.id]===!0||(y.addEventListener("dispose",o),r[y.id]=!0,t.memory.geometries++),y}function f(v){const y=v.attributes;for(const A in y)e.update(y[A],i.ARRAY_BUFFER)}function p(v){const y=[],A=v.index,S=v.attributes.position;let T=0;if(A!==null){const R=A.array;T=A.version;for(let I=0,O=R.length;I<O;I+=3){const F=R[I+0],z=R[I+1],j=R[I+2];y.push(F,z,z,j,j,F)}}else if(S!==void 0){const R=S.array;T=S.version;for(let I=0,O=R.length/3-1;I<O;I+=3){const F=I+0,z=I+1,j=I+2;y.push(F,z,z,j,j,F)}}else return;const M=new(k2(y)?jM:VM)(y,1);M.version=T;const E=s.get(v);E&&e.remove(E),s.set(v,M)}function g(v){const y=s.get(v);if(y){const A=v.index;A!==null&&y.version<A.version&&p(v)}else p(v);return s.get(v)}return{get:u,update:f,getWireframeAttribute:g}}function mP(i,e,t){let n;function r(y){n=y}let s,o;function u(y){s=y.type,o=y.bytesPerElement}function f(y,A){i.drawElements(n,A,s,y*o),t.update(A,n,1)}function p(y,A,S){S!==0&&(i.drawElementsInstanced(n,A,s,y*o,S),t.update(A,n,S))}function g(y,A,S){if(S===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,A,0,s,y,0,S);let M=0;for(let E=0;E<S;E++)M+=A[E];t.update(M,n,1)}function v(y,A,S,T){if(S===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let E=0;E<y.length;E++)p(y[E]/o,A[E],T[E]);else{M.multiDrawElementsInstancedWEBGL(n,A,0,s,y,0,T,0,S);let E=0;for(let R=0;R<S;R++)E+=A[R]*T[R];t.update(E,n,1)}}this.setMode=r,this.setIndex=u,this.render=f,this.renderInstances=p,this.renderMultiDraw=g,this.renderMultiDrawInstances=v}function gP(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,u){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=u*(s/3);break;case i.LINES:t.lines+=u*(s/2);break;case i.LINE_STRIP:t.lines+=u*(s-1);break;case i.LINE_LOOP:t.lines+=u*s;break;case i.POINTS:t.points+=u*s;break;default:nn("WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function vP(i,e,t){const n=new WeakMap,r=new Ti;function s(o,u,f){const p=o.morphTargetInfluences,g=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=g!==void 0?g.length:0;let y=n.get(u);if(y===void 0||y.count!==v){let H=function(){W.dispose(),n.delete(u),u.removeEventListener("dispose",H)};var A=H;y!==void 0&&y.texture.dispose();const S=u.morphAttributes.position!==void 0,T=u.morphAttributes.normal!==void 0,M=u.morphAttributes.color!==void 0,E=u.morphAttributes.position||[],R=u.morphAttributes.normal||[],I=u.morphAttributes.color||[];let O=0;S===!0&&(O=1),T===!0&&(O=2),M===!0&&(O=3);let F=u.attributes.position.count*O,z=1;F>e.maxTextureSize&&(z=Math.ceil(F/e.maxTextureSize),F=e.maxTextureSize);const j=new Float32Array(F*z*4*v),W=new __(j,F,z,v);W.type=si,W.needsUpdate=!0;const L=O*4;for(let K=0;K<v;K++){const de=E[K],ce=R[K],ne=I[K],fe=F*z*4*K;for(let X=0;X<de.count;X++){const re=X*L;S===!0&&(r.fromBufferAttribute(de,X),j[fe+re+0]=r.x,j[fe+re+1]=r.y,j[fe+re+2]=r.z,j[fe+re+3]=0),T===!0&&(r.fromBufferAttribute(ce,X),j[fe+re+4]=r.x,j[fe+re+5]=r.y,j[fe+re+6]=r.z,j[fe+re+7]=0),M===!0&&(r.fromBufferAttribute(ne,X),j[fe+re+8]=r.x,j[fe+re+9]=r.y,j[fe+re+10]=r.z,j[fe+re+11]=ne.itemSize===4?r.w:1)}}y={count:v,texture:W,size:new qe(F,z)},n.set(u,y),u.addEventListener("dispose",H)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)f.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let S=0;for(let M=0;M<p.length;M++)S+=p[M];const T=u.morphTargetsRelative?1:1-S;f.getUniforms().setValue(i,"morphTargetBaseInfluence",T),f.getUniforms().setValue(i,"morphTargetInfluences",p)}f.getUniforms().setValue(i,"morphTargetsTexture",y.texture,t),f.getUniforms().setValue(i,"morphTargetsTextureSize",y.size)}return{update:s}}function xP(i,e,t,n){let r=new WeakMap;function s(f){const p=n.render.frame,g=f.geometry,v=e.get(f,g);if(r.get(v)!==p&&(e.update(v),r.set(v,p)),f.isInstancedMesh&&(f.hasEventListener("dispose",u)===!1&&f.addEventListener("dispose",u),r.get(f)!==p&&(t.update(f.instanceMatrix,i.ARRAY_BUFFER),f.instanceColor!==null&&t.update(f.instanceColor,i.ARRAY_BUFFER),r.set(f,p))),f.isSkinnedMesh){const y=f.skeleton;r.get(y)!==p&&(y.update(),r.set(y,p))}return v}function o(){r=new WeakMap}function u(f){const p=f.target;p.removeEventListener("dispose",u),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:s,dispose:o}}const yP={[RM]:"LINEAR_TONE_MAPPING",[DM]:"REINHARD_TONE_MAPPING",[IM]:"CINEON_TONE_MAPPING",[Dv]:"ACES_FILMIC_TONE_MAPPING",[NM]:"AGX_TONE_MAPPING",[OM]:"NEUTRAL_TONE_MAPPING",[BM]:"CUSTOM_TONE_MAPPING"};function AP(i,e,t,n,r){const s=new ti(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),o=new ti(e,t,{type:On,depthBuffer:!1,stencilBuffer:!1}),u=new pn;u.setAttribute("position",new Jt([-1,3,0,-1,-1,0,3,-1,0],3)),u.setAttribute("uv",new Jt([0,2,0,0,2,0],2));const f=new Gv({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new Oi(u,f),g=new Ha(-1,1,1,-1,0,1);let v=null,y=null,A=!1,S,T=null,M=[],E=!1;this.setSize=function(R,I){s.setSize(R,I),o.setSize(R,I);for(let O=0;O<M.length;O++){const F=M[O];F.setSize&&F.setSize(R,I)}},this.setEffects=function(R){M=R,E=M.length>0&&M[0].isRenderPass===!0;const I=s.width,O=s.height;for(let F=0;F<M.length;F++){const z=M[F];z.setSize&&z.setSize(I,O)}},this.begin=function(R,I){if(A||R.toneMapping===aa&&M.length===0)return!1;if(T=I,I!==null){const O=I.width,F=I.height;(s.width!==O||s.height!==F)&&this.setSize(O,F)}return E===!1&&R.setRenderTarget(s),S=R.toneMapping,R.toneMapping=aa,!0},this.hasRenderPass=function(){return E},this.end=function(R,I){R.toneMapping=S,A=!0;let O=s,F=o;for(let z=0;z<M.length;z++){const j=M[z];if(j.enabled!==!1&&(j.render(R,F,O,I),j.needsSwap!==!1)){const W=O;O=F,F=W}}if(v!==R.outputColorSpace||y!==R.toneMapping){v=R.outputColorSpace,y=R.toneMapping,f.defines={},$n.getTransfer(v)===yi&&(f.defines.SRGB_TRANSFER="");const z=yP[y];z&&(f.defines[z]=""),f.needsUpdate=!0}f.uniforms.tDiffuse.value=O.texture,R.setRenderTarget(T),R.render(p,g),T=null,A=!1},this.isCompositing=function(){return A},this.dispose=function(){s.dispose(),o.dispose(),u.dispose(),f.dispose()}}const P4=new Jn,GE=new _d(1,1),U4=new __,F4=new su,z4=new Ov,d3=[],f3=[],h3=new Float32Array(16),p3=new Float32Array(9),m3=new Float32Array(4);function Lm(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=d3[r];if(s===void 0&&(s=new Float32Array(r),d3[r]=s),e!==0){n.toArray(s,0);for(let o=1,u=0;o!==e;++o)u+=t,i[o].toArray(s,u)}return s}function ts(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function ns(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function X_(i,e){let t=f3[e];t===void 0&&(t=new Int32Array(e),f3[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function _P(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function SP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;i.uniform2fv(this.addr,e),ns(t,e)}}function bP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ts(t,e))return;i.uniform3fv(this.addr,e),ns(t,e)}}function EP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;i.uniform4fv(this.addr,e),ns(t,e)}}function MP(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(ts(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ns(t,e)}else{if(ts(t,n))return;m3.set(n),i.uniformMatrix2fv(this.addr,!1,m3),ns(t,n)}}function TP(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(ts(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ns(t,e)}else{if(ts(t,n))return;p3.set(n),i.uniformMatrix3fv(this.addr,!1,p3),ns(t,n)}}function wP(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(ts(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ns(t,e)}else{if(ts(t,n))return;h3.set(n),i.uniformMatrix4fv(this.addr,!1,h3),ns(t,n)}}function CP(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function RP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;i.uniform2iv(this.addr,e),ns(t,e)}}function DP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ts(t,e))return;i.uniform3iv(this.addr,e),ns(t,e)}}function IP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;i.uniform4iv(this.addr,e),ns(t,e)}}function BP(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function NP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;i.uniform2uiv(this.addr,e),ns(t,e)}}function OP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ts(t,e))return;i.uniform3uiv(this.addr,e),ns(t,e)}}function LP(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;i.uniform4uiv(this.addr,e),ns(t,e)}}function PP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(GE.compareFunction=t.isReversedDepthBuffer()?A_:y_,s=GE):s=P4,t.setTexture2D(e||s,r)}function UP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||F4,r)}function FP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||z4,r)}function zP(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||U4,r)}function HP(i){switch(i){case 5126:return _P;case 35664:return SP;case 35665:return bP;case 35666:return EP;case 35674:return MP;case 35675:return TP;case 35676:return wP;case 5124:case 35670:return CP;case 35667:case 35671:return RP;case 35668:case 35672:return DP;case 35669:case 35673:return IP;case 5125:return BP;case 36294:return NP;case 36295:return OP;case 36296:return LP;case 35678:case 36198:case 36298:case 36306:case 35682:return PP;case 35679:case 36299:case 36307:return UP;case 35680:case 36300:case 36308:case 36293:return FP;case 36289:case 36303:case 36311:case 36292:return zP}}function GP(i,e){i.uniform1fv(this.addr,e)}function kP(i,e){const t=Lm(e,this.size,2);i.uniform2fv(this.addr,t)}function VP(i,e){const t=Lm(e,this.size,3);i.uniform3fv(this.addr,t)}function jP(i,e){const t=Lm(e,this.size,4);i.uniform4fv(this.addr,t)}function WP(i,e){const t=Lm(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function XP(i,e){const t=Lm(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function YP(i,e){const t=Lm(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function QP(i,e){i.uniform1iv(this.addr,e)}function qP(i,e){i.uniform2iv(this.addr,e)}function JP(i,e){i.uniform3iv(this.addr,e)}function KP(i,e){i.uniform4iv(this.addr,e)}function ZP(i,e){i.uniform1uiv(this.addr,e)}function $P(i,e){i.uniform2uiv(this.addr,e)}function eU(i,e){i.uniform3uiv(this.addr,e)}function tU(i,e){i.uniform4uiv(this.addr,e)}function nU(i,e,t){const n=this.cache,r=e.length,s=X_(t,r);ts(n,s)||(i.uniform1iv(this.addr,s),ns(n,s));let o;this.type===i.SAMPLER_2D_SHADOW?o=GE:o=P4;for(let u=0;u!==r;++u)t.setTexture2D(e[u]||o,s[u])}function iU(i,e,t){const n=this.cache,r=e.length,s=X_(t,r);ts(n,s)||(i.uniform1iv(this.addr,s),ns(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||F4,s[o])}function rU(i,e,t){const n=this.cache,r=e.length,s=X_(t,r);ts(n,s)||(i.uniform1iv(this.addr,s),ns(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||z4,s[o])}function sU(i,e,t){const n=this.cache,r=e.length,s=X_(t,r);ts(n,s)||(i.uniform1iv(this.addr,s),ns(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||U4,s[o])}function aU(i){switch(i){case 5126:return GP;case 35664:return kP;case 35665:return VP;case 35666:return jP;case 35674:return WP;case 35675:return XP;case 35676:return YP;case 5124:case 35670:return QP;case 35667:case 35671:return qP;case 35668:case 35672:return JP;case 35669:case 35673:return KP;case 5125:return ZP;case 36294:return $P;case 36295:return eU;case 36296:return tU;case 35678:case 36198:case 36298:case 36306:case 35682:return nU;case 35679:case 36299:case 36307:return iU;case 35680:case 36300:case 36308:case 36293:return rU;case 36289:case 36303:case 36311:case 36292:return sU}}class oU{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=HP(t.type)}}class lU{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=aU(t.type)}}class cU{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const u=r[s];u.setValue(e,t[u.id],n)}}}const Vb=/(\w+)(\])?(\[|\.)?/g;function g3(i,e){i.seq.push(e),i.map[e.id]=e}function uU(i,e,t){const n=i.name,r=n.length;for(Vb.lastIndex=0;;){const s=Vb.exec(n),o=Vb.lastIndex;let u=s[1];const f=s[2]==="]",p=s[3];if(f&&(u=u|0),p===void 0||p==="["&&o+2===r){g3(t,p===void 0?new oU(u,i,e):new lU(u,i,e));break}else{let v=t.map[u];v===void 0&&(v=new cU(u),g3(t,v)),t=v}}}class Qy{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<n;++o){const u=e.getActiveUniform(t,o),f=e.getUniformLocation(t,u.name);uU(u,f,this)}const r=[],s=[];for(const o of this.seq)o.type===e.SAMPLER_2D_SHADOW||o.type===e.SAMPLER_CUBE_SHADOW||o.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(o):s.push(o);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const u=t[s],f=n[u.id];f.needsUpdate!==!1&&u.setValue(e,f.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function v3(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const dU=37297;let fU=0;function hU(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const u=o+1;n.push(`${u===e?">":" "} ${u}: ${t[o]}`)}return n.join(`
`)}const x3=new An;function pU(i){$n._getMatrix(x3,$n.workingColorSpace,i);const e=`mat3( ${x3.elements.map(t=>t.toFixed(4))} )`;switch($n.getTransfer(i)){case hv:return[e,"LinearTransferOETF"];case yi:return[e,"sRGBTransferOETF"];default:return Ht("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function y3(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const u=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+hU(i.getShaderSource(e),u)}else return s}function mU(i,e){const t=pU(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const gU={[RM]:"Linear",[DM]:"Reinhard",[IM]:"Cineon",[Dv]:"ACESFilmic",[NM]:"AgX",[OM]:"Neutral",[BM]:"Custom"};function vU(i,e){const t=gU[e];return t===void 0?(Ht("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Ey=new Q;function xU(){$n.getLuminanceCoefficients(Ey);const i=Ey.x.toFixed(4),e=Ey.y.toFixed(4),t=Ey.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function yU(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Vg).join(`
`)}function AU(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function _U(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let u=1;s.type===i.FLOAT_MAT2&&(u=2),s.type===i.FLOAT_MAT3&&(u=3),s.type===i.FLOAT_MAT4&&(u=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:u}}return t}function Vg(i){return i!==""}function A3(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function _3(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const SU=/^[ \t]*#include +<([\w\d./]+)>/gm;function kE(i){return i.replace(SU,EU)}const bU=new Map;function EU(i,e){let t=Pn[e];if(t===void 0){const n=bU.get(e);if(n!==void 0)t=Pn[n],Ht('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return kE(t)}const MU=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function S3(i){return i.replace(MU,TU)}function TU(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function b3(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const wU={[am]:"SHADOWMAP_TYPE_PCF",[Pf]:"SHADOWMAP_TYPE_VSM"};function CU(i){return wU[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const RU={[gl]:"ENVMAP_TYPE_CUBE",[xd]:"ENVMAP_TYPE_CUBE",[Dm]:"ENVMAP_TYPE_CUBE_UV"};function DU(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":RU[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const IU={[xd]:"ENVMAP_MODE_REFRACTION"};function BU(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":IU[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const NU={[Rv]:"ENVMAP_BLENDING_MULTIPLY",[C2]:"ENVMAP_BLENDING_MIX",[R2]:"ENVMAP_BLENDING_ADD"};function OU(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":NU[i.combine]||"ENVMAP_BLENDING_NONE"}function LU(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function PU(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,u=t.fragmentShader;const f=CU(t),p=DU(t),g=BU(t),v=OU(t),y=LU(t),A=yU(t),S=AU(s),T=r.createProgram();let M,E,R=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(Vg).join(`
`),M.length>0&&(M+=`
`),E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(Vg).join(`
`),E.length>0&&(E+=`
`)):(M=[b3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Vg).join(`
`),E=[b3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==aa?"#define TONE_MAPPING":"",t.toneMapping!==aa?Pn.tonemapping_pars_fragment:"",t.toneMapping!==aa?vU("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pn.colorspace_pars_fragment,mU("linearToOutputTexel",t.outputColorSpace),xU(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Vg).join(`
`)),o=kE(o),o=A3(o,t),o=_3(o,t),u=kE(u),u=A3(u,t),u=_3(u,t),o=S3(o),u=S3(u),t.isRawShaderMaterial!==!0&&(R=`#version 300 es
`,M=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,E=["#define varying in",t.glslVersion===vm?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===vm?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const I=R+M+o,O=R+E+u,F=v3(r,r.VERTEX_SHADER,I),z=v3(r,r.FRAGMENT_SHADER,O);r.attachShader(T,F),r.attachShader(T,z),t.index0AttributeName!==void 0?r.bindAttribLocation(T,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(T,0,"position"),r.linkProgram(T);function j(K){if(i.debug.checkShaderErrors){const de=r.getProgramInfoLog(T)||"",ce=r.getShaderInfoLog(F)||"",ne=r.getShaderInfoLog(z)||"",fe=de.trim(),X=ce.trim(),re=ne.trim();let ge=!0,Te=!0;if(r.getProgramParameter(T,r.LINK_STATUS)===!1)if(ge=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,T,F,z);else{const Se=y3(r,F,"vertex"),Y=y3(r,z,"fragment");nn("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(T,r.VALIDATE_STATUS)+`

Material Name: `+K.name+`
Material Type: `+K.type+`

Program Info Log: `+fe+`
`+Se+`
`+Y)}else fe!==""?Ht("WebGLProgram: Program Info Log:",fe):(X===""||re==="")&&(Te=!1);Te&&(K.diagnostics={runnable:ge,programLog:fe,vertexShader:{log:X,prefix:M},fragmentShader:{log:re,prefix:E}})}r.deleteShader(F),r.deleteShader(z),W=new Qy(r,T),L=_U(r,T)}let W;this.getUniforms=function(){return W===void 0&&j(this),W};let L;this.getAttributes=function(){return L===void 0&&j(this),L};let H=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return H===!1&&(H=r.getProgramParameter(T,dU)),H},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(T),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=fU++,this.cacheKey=e,this.usedTimes=1,this.program=T,this.vertexShader=F,this.fragmentShader=z,this}let UU=0;class FU{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new zU(e),t.set(e,n)),n}}class zU{constructor(e){this.id=UU++,this.code=e,this.usedTimes=0}}function HU(i,e,t,n,r,s,o){const u=new _m,f=new FU,p=new Set,g=[],v=new Map,y=r.logarithmicDepthBuffer;let A=r.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function T(L){return p.add(L),L===0?"uv":`uv${L}`}function M(L,H,K,de,ce){const ne=de.fog,fe=ce.geometry,X=L.isMeshStandardMaterial?de.environment:null,re=(L.isMeshStandardMaterial?t:e).get(L.envMap||X),ge=re&&re.mapping===Dm?re.image.height:null,Te=S[L.type];L.precision!==null&&(A=r.getMaxPrecision(L.precision),A!==L.precision&&Ht("WebGLProgram.getParameters:",L.precision,"not supported, using",A,"instead."));const Se=fe.morphAttributes.position||fe.morphAttributes.normal||fe.morphAttributes.color,Y=Se!==void 0?Se.length:0;let me=0;fe.morphAttributes.position!==void 0&&(me=1),fe.morphAttributes.normal!==void 0&&(me=2),fe.morphAttributes.color!==void 0&&(me=3);let Ce,Ze,xt,ve;if(Te){const _n=dl[Te];Ce=_n.vertexShader,Ze=_n.fragmentShader}else Ce=L.vertexShader,Ze=L.fragmentShader,f.update(L),xt=f.getVertexShaderID(L),ve=f.getFragmentShaderID(L);const ze=i.getRenderTarget(),dt=i.state.buffers.depth.getReversed(),Ee=ce.isInstancedMesh===!0,yt=ce.isBatchedMesh===!0,Pt=!!L.map,Ot=!!L.matcap,Mt=!!re,je=!!L.aoMap,st=!!L.lightMap,et=!!L.bumpMap,At=!!L.normalMap,oe=!!L.displacementMap,Gt=!!L.emissiveMap,Dt=!!L.metalnessMap,qt=!!L.roughnessMap,Tt=L.anisotropy>0,te=L.clearcoat>0,G=L.dispersion>0,be=L.iridescence>0,Ye=L.sheen>0,ot=L.transmission>0,Qe=Tt&&!!L.anisotropyMap,Ut=te&&!!L.clearcoatMap,Rt=te&&!!L.clearcoatNormalMap,Vt=te&&!!L.clearcoatRoughnessMap,$t=be&&!!L.iridescenceMap,vt=be&&!!L.iridescenceThicknessMap,ct=Ye&&!!L.sheenColorMap,Bt=Ye&&!!L.sheenRoughnessMap,he=!!L.specularMap,Be=!!L.specularColorMap,ft=!!L.specularIntensityMap,pe=ot&&!!L.transmissionMap,Fe=ot&&!!L.thicknessMap,Oe=!!L.gradientMap,It=!!L.alphaMap,_t=L.alphaTest>0,ut=!!L.alphaHash,wt=!!L.extensions;let Zt=aa;L.toneMapped&&(ze===null||ze.isXRRenderTarget===!0)&&(Zt=i.toneMapping);const yn={shaderID:Te,shaderType:L.type,shaderName:L.name,vertexShader:Ce,fragmentShader:Ze,defines:L.defines,customVertexShaderID:xt,customFragmentShaderID:ve,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:A,batching:yt,batchingColor:yt&&ce._colorsTexture!==null,instancing:Ee,instancingColor:Ee&&ce.instanceColor!==null,instancingMorph:Ee&&ce.morphTexture!==null,outputColorSpace:ze===null?i.outputColorSpace:ze.isXRRenderTarget===!0?ze.texture.colorSpace:kr,alphaToCoverage:!!L.alphaToCoverage,map:Pt,matcap:Ot,envMap:Mt,envMapMode:Mt&&re.mapping,envMapCubeUVHeight:ge,aoMap:je,lightMap:st,bumpMap:et,normalMap:At,displacementMap:oe,emissiveMap:Gt,normalMapObjectSpace:At&&L.normalMapType===L2,normalMapTangentSpace:At&&L.normalMapType===Sd,metalnessMap:Dt,roughnessMap:qt,anisotropy:Tt,anisotropyMap:Qe,clearcoat:te,clearcoatMap:Ut,clearcoatNormalMap:Rt,clearcoatRoughnessMap:Vt,dispersion:G,iridescence:be,iridescenceMap:$t,iridescenceThicknessMap:vt,sheen:Ye,sheenColorMap:ct,sheenRoughnessMap:Bt,specularMap:he,specularColorMap:Be,specularIntensityMap:ft,transmission:ot,transmissionMap:pe,thicknessMap:Fe,gradientMap:Oe,opaque:L.transparent===!1&&L.blending===jf&&L.alphaToCoverage===!1,alphaMap:It,alphaTest:_t,alphaHash:ut,combine:L.combine,mapUv:Pt&&T(L.map.channel),aoMapUv:je&&T(L.aoMap.channel),lightMapUv:st&&T(L.lightMap.channel),bumpMapUv:et&&T(L.bumpMap.channel),normalMapUv:At&&T(L.normalMap.channel),displacementMapUv:oe&&T(L.displacementMap.channel),emissiveMapUv:Gt&&T(L.emissiveMap.channel),metalnessMapUv:Dt&&T(L.metalnessMap.channel),roughnessMapUv:qt&&T(L.roughnessMap.channel),anisotropyMapUv:Qe&&T(L.anisotropyMap.channel),clearcoatMapUv:Ut&&T(L.clearcoatMap.channel),clearcoatNormalMapUv:Rt&&T(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Vt&&T(L.clearcoatRoughnessMap.channel),iridescenceMapUv:$t&&T(L.iridescenceMap.channel),iridescenceThicknessMapUv:vt&&T(L.iridescenceThicknessMap.channel),sheenColorMapUv:ct&&T(L.sheenColorMap.channel),sheenRoughnessMapUv:Bt&&T(L.sheenRoughnessMap.channel),specularMapUv:he&&T(L.specularMap.channel),specularColorMapUv:Be&&T(L.specularColorMap.channel),specularIntensityMapUv:ft&&T(L.specularIntensityMap.channel),transmissionMapUv:pe&&T(L.transmissionMap.channel),thicknessMapUv:Fe&&T(L.thicknessMap.channel),alphaMapUv:It&&T(L.alphaMap.channel),vertexTangents:!!fe.attributes.tangent&&(At||Tt),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!fe.attributes.color&&fe.attributes.color.itemSize===4,pointsUvs:ce.isPoints===!0&&!!fe.attributes.uv&&(Pt||It),fog:!!ne,useFog:L.fog===!0,fogExp2:!!ne&&ne.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:y,reversedDepthBuffer:dt,skinning:ce.isSkinnedMesh===!0,morphTargets:fe.morphAttributes.position!==void 0,morphNormals:fe.morphAttributes.normal!==void 0,morphColors:fe.morphAttributes.color!==void 0,morphTargetsCount:Y,morphTextureStride:me,numDirLights:H.directional.length,numPointLights:H.point.length,numSpotLights:H.spot.length,numSpotLightMaps:H.spotLightMap.length,numRectAreaLights:H.rectArea.length,numHemiLights:H.hemi.length,numDirLightShadows:H.directionalShadowMap.length,numPointLightShadows:H.pointShadowMap.length,numSpotLightShadows:H.spotShadowMap.length,numSpotLightShadowsWithMaps:H.numSpotLightShadowsWithMaps,numLightProbes:H.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:L.dithering,shadowMapEnabled:i.shadowMap.enabled&&K.length>0,shadowMapType:i.shadowMap.type,toneMapping:Zt,decodeVideoTexture:Pt&&L.map.isVideoTexture===!0&&$n.getTransfer(L.map.colorSpace)===yi,decodeVideoTextureEmissive:Gt&&L.emissiveMap.isVideoTexture===!0&&$n.getTransfer(L.emissiveMap.colorSpace)===yi,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===Vr,flipSided:L.side===jr,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:wt&&L.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(wt&&L.extensions.multiDraw===!0||yt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return yn.vertexUv1s=p.has(1),yn.vertexUv2s=p.has(2),yn.vertexUv3s=p.has(3),p.clear(),yn}function E(L){const H=[];if(L.shaderID?H.push(L.shaderID):(H.push(L.customVertexShaderID),H.push(L.customFragmentShaderID)),L.defines!==void 0)for(const K in L.defines)H.push(K),H.push(L.defines[K]);return L.isRawShaderMaterial===!1&&(R(H,L),I(H,L),H.push(i.outputColorSpace)),H.push(L.customProgramCacheKey),H.join()}function R(L,H){L.push(H.precision),L.push(H.outputColorSpace),L.push(H.envMapMode),L.push(H.envMapCubeUVHeight),L.push(H.mapUv),L.push(H.alphaMapUv),L.push(H.lightMapUv),L.push(H.aoMapUv),L.push(H.bumpMapUv),L.push(H.normalMapUv),L.push(H.displacementMapUv),L.push(H.emissiveMapUv),L.push(H.metalnessMapUv),L.push(H.roughnessMapUv),L.push(H.anisotropyMapUv),L.push(H.clearcoatMapUv),L.push(H.clearcoatNormalMapUv),L.push(H.clearcoatRoughnessMapUv),L.push(H.iridescenceMapUv),L.push(H.iridescenceThicknessMapUv),L.push(H.sheenColorMapUv),L.push(H.sheenRoughnessMapUv),L.push(H.specularMapUv),L.push(H.specularColorMapUv),L.push(H.specularIntensityMapUv),L.push(H.transmissionMapUv),L.push(H.thicknessMapUv),L.push(H.combine),L.push(H.fogExp2),L.push(H.sizeAttenuation),L.push(H.morphTargetsCount),L.push(H.morphAttributeCount),L.push(H.numDirLights),L.push(H.numPointLights),L.push(H.numSpotLights),L.push(H.numSpotLightMaps),L.push(H.numHemiLights),L.push(H.numRectAreaLights),L.push(H.numDirLightShadows),L.push(H.numPointLightShadows),L.push(H.numSpotLightShadows),L.push(H.numSpotLightShadowsWithMaps),L.push(H.numLightProbes),L.push(H.shadowMapType),L.push(H.toneMapping),L.push(H.numClippingPlanes),L.push(H.numClipIntersection),L.push(H.depthPacking)}function I(L,H){u.disableAll(),H.instancing&&u.enable(0),H.instancingColor&&u.enable(1),H.instancingMorph&&u.enable(2),H.matcap&&u.enable(3),H.envMap&&u.enable(4),H.normalMapObjectSpace&&u.enable(5),H.normalMapTangentSpace&&u.enable(6),H.clearcoat&&u.enable(7),H.iridescence&&u.enable(8),H.alphaTest&&u.enable(9),H.vertexColors&&u.enable(10),H.vertexAlphas&&u.enable(11),H.vertexUv1s&&u.enable(12),H.vertexUv2s&&u.enable(13),H.vertexUv3s&&u.enable(14),H.vertexTangents&&u.enable(15),H.anisotropy&&u.enable(16),H.alphaHash&&u.enable(17),H.batching&&u.enable(18),H.dispersion&&u.enable(19),H.batchingColor&&u.enable(20),H.gradientMap&&u.enable(21),L.push(u.mask),u.disableAll(),H.fog&&u.enable(0),H.useFog&&u.enable(1),H.flatShading&&u.enable(2),H.logarithmicDepthBuffer&&u.enable(3),H.reversedDepthBuffer&&u.enable(4),H.skinning&&u.enable(5),H.morphTargets&&u.enable(6),H.morphNormals&&u.enable(7),H.morphColors&&u.enable(8),H.premultipliedAlpha&&u.enable(9),H.shadowMapEnabled&&u.enable(10),H.doubleSided&&u.enable(11),H.flipSided&&u.enable(12),H.useDepthPacking&&u.enable(13),H.dithering&&u.enable(14),H.transmission&&u.enable(15),H.sheen&&u.enable(16),H.opaque&&u.enable(17),H.pointsUvs&&u.enable(18),H.decodeVideoTexture&&u.enable(19),H.decodeVideoTextureEmissive&&u.enable(20),H.alphaToCoverage&&u.enable(21),L.push(u.mask)}function O(L){const H=S[L.type];let K;if(H){const de=dl[H];K=WM.clone(de.uniforms)}else K=L.uniforms;return K}function F(L,H){let K=v.get(H);return K!==void 0?++K.usedTimes:(K=new PU(i,H,L,s),g.push(K),v.set(H,K)),K}function z(L){if(--L.usedTimes===0){const H=g.indexOf(L);g[H]=g[g.length-1],g.pop(),v.delete(L.cacheKey),L.destroy()}}function j(L){f.remove(L)}function W(){f.dispose()}return{getParameters:M,getProgramCacheKey:E,getUniforms:O,acquireProgram:F,releaseProgram:z,releaseShaderCache:j,programs:g,dispose:W}}function GU(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let u=i.get(o);return u===void 0&&(u={},i.set(o,u)),u}function n(o){i.delete(o)}function r(o,u,f){i.get(o)[u]=f}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function kU(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function E3(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function M3(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(v,y,A,S,T,M){let E=i[e];return E===void 0?(E={id:v.id,object:v,geometry:y,material:A,groupOrder:S,renderOrder:v.renderOrder,z:T,group:M},i[e]=E):(E.id=v.id,E.object=v,E.geometry=y,E.material=A,E.groupOrder=S,E.renderOrder=v.renderOrder,E.z=T,E.group=M),e++,E}function u(v,y,A,S,T,M){const E=o(v,y,A,S,T,M);A.transmission>0?n.push(E):A.transparent===!0?r.push(E):t.push(E)}function f(v,y,A,S,T,M){const E=o(v,y,A,S,T,M);A.transmission>0?n.unshift(E):A.transparent===!0?r.unshift(E):t.unshift(E)}function p(v,y){t.length>1&&t.sort(v||kU),n.length>1&&n.sort(y||E3),r.length>1&&r.sort(y||E3)}function g(){for(let v=e,y=i.length;v<y;v++){const A=i[v];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:u,unshift:f,finish:g,sort:p}}function VU(){let i=new WeakMap;function e(n,r){const s=i.get(n);let o;return s===void 0?(o=new M3,i.set(n,[o])):r>=s.length?(o=new M3,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function jU(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new Ft};break;case"SpotLight":t={position:new Q,direction:new Q,color:new Ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new Ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new Ft,groundColor:new Ft};break;case"RectAreaLight":t={color:new Ft,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return i[e.id]=t,t}}}function WU(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let XU=0;function YU(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function QU(i){const e=new jU,t=WU(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new Q);const r=new Q,s=new jt,o=new jt;function u(p){let g=0,v=0,y=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let A=0,S=0,T=0,M=0,E=0,R=0,I=0,O=0,F=0,z=0,j=0;p.sort(YU);for(let L=0,H=p.length;L<H;L++){const K=p[L],de=K.color,ce=K.intensity,ne=K.distance;let fe=null;if(K.shadow&&K.shadow.map&&(K.shadow.map.texture.format===Bo?fe=K.shadow.map.texture:fe=K.shadow.map.depthTexture||K.shadow.map.texture),K.isAmbientLight)g+=de.r*ce,v+=de.g*ce,y+=de.b*ce;else if(K.isLightProbe){for(let X=0;X<9;X++)n.probe[X].addScaledVector(K.sh.coefficients[X],ce);j++}else if(K.isDirectionalLight){const X=e.get(K);if(X.color.copy(K.color).multiplyScalar(K.intensity),K.castShadow){const re=K.shadow,ge=t.get(K);ge.shadowIntensity=re.intensity,ge.shadowBias=re.bias,ge.shadowNormalBias=re.normalBias,ge.shadowRadius=re.radius,ge.shadowMapSize=re.mapSize,n.directionalShadow[A]=ge,n.directionalShadowMap[A]=fe,n.directionalShadowMatrix[A]=K.shadow.matrix,R++}n.directional[A]=X,A++}else if(K.isSpotLight){const X=e.get(K);X.position.setFromMatrixPosition(K.matrixWorld),X.color.copy(de).multiplyScalar(ce),X.distance=ne,X.coneCos=Math.cos(K.angle),X.penumbraCos=Math.cos(K.angle*(1-K.penumbra)),X.decay=K.decay,n.spot[T]=X;const re=K.shadow;if(K.map&&(n.spotLightMap[F]=K.map,F++,re.updateMatrices(K),K.castShadow&&z++),n.spotLightMatrix[T]=re.matrix,K.castShadow){const ge=t.get(K);ge.shadowIntensity=re.intensity,ge.shadowBias=re.bias,ge.shadowNormalBias=re.normalBias,ge.shadowRadius=re.radius,ge.shadowMapSize=re.mapSize,n.spotShadow[T]=ge,n.spotShadowMap[T]=fe,O++}T++}else if(K.isRectAreaLight){const X=e.get(K);X.color.copy(de).multiplyScalar(ce),X.halfWidth.set(K.width*.5,0,0),X.halfHeight.set(0,K.height*.5,0),n.rectArea[M]=X,M++}else if(K.isPointLight){const X=e.get(K);if(X.color.copy(K.color).multiplyScalar(K.intensity),X.distance=K.distance,X.decay=K.decay,K.castShadow){const re=K.shadow,ge=t.get(K);ge.shadowIntensity=re.intensity,ge.shadowBias=re.bias,ge.shadowNormalBias=re.normalBias,ge.shadowRadius=re.radius,ge.shadowMapSize=re.mapSize,ge.shadowCameraNear=re.camera.near,ge.shadowCameraFar=re.camera.far,n.pointShadow[S]=ge,n.pointShadowMap[S]=fe,n.pointShadowMatrix[S]=K.shadow.matrix,I++}n.point[S]=X,S++}else if(K.isHemisphereLight){const X=e.get(K);X.skyColor.copy(K.color).multiplyScalar(ce),X.groundColor.copy(K.groundColor).multiplyScalar(ce),n.hemi[E]=X,E++}}M>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=kt.LTC_FLOAT_1,n.rectAreaLTC2=kt.LTC_FLOAT_2):(n.rectAreaLTC1=kt.LTC_HALF_1,n.rectAreaLTC2=kt.LTC_HALF_2)),n.ambient[0]=g,n.ambient[1]=v,n.ambient[2]=y;const W=n.hash;(W.directionalLength!==A||W.pointLength!==S||W.spotLength!==T||W.rectAreaLength!==M||W.hemiLength!==E||W.numDirectionalShadows!==R||W.numPointShadows!==I||W.numSpotShadows!==O||W.numSpotMaps!==F||W.numLightProbes!==j)&&(n.directional.length=A,n.spot.length=T,n.rectArea.length=M,n.point.length=S,n.hemi.length=E,n.directionalShadow.length=R,n.directionalShadowMap.length=R,n.pointShadow.length=I,n.pointShadowMap.length=I,n.spotShadow.length=O,n.spotShadowMap.length=O,n.directionalShadowMatrix.length=R,n.pointShadowMatrix.length=I,n.spotLightMatrix.length=O+F-z,n.spotLightMap.length=F,n.numSpotLightShadowsWithMaps=z,n.numLightProbes=j,W.directionalLength=A,W.pointLength=S,W.spotLength=T,W.rectAreaLength=M,W.hemiLength=E,W.numDirectionalShadows=R,W.numPointShadows=I,W.numSpotShadows=O,W.numSpotMaps=F,W.numLightProbes=j,n.version=XU++)}function f(p,g){let v=0,y=0,A=0,S=0,T=0;const M=g.matrixWorldInverse;for(let E=0,R=p.length;E<R;E++){const I=p[E];if(I.isDirectionalLight){const O=n.directional[v];O.direction.setFromMatrixPosition(I.matrixWorld),r.setFromMatrixPosition(I.target.matrixWorld),O.direction.sub(r),O.direction.transformDirection(M),v++}else if(I.isSpotLight){const O=n.spot[A];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(M),O.direction.setFromMatrixPosition(I.matrixWorld),r.setFromMatrixPosition(I.target.matrixWorld),O.direction.sub(r),O.direction.transformDirection(M),A++}else if(I.isRectAreaLight){const O=n.rectArea[S];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(M),o.identity(),s.copy(I.matrixWorld),s.premultiply(M),o.extractRotation(s),O.halfWidth.set(I.width*.5,0,0),O.halfHeight.set(0,I.height*.5,0),O.halfWidth.applyMatrix4(o),O.halfHeight.applyMatrix4(o),S++}else if(I.isPointLight){const O=n.point[y];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(M),y++}else if(I.isHemisphereLight){const O=n.hemi[T];O.direction.setFromMatrixPosition(I.matrixWorld),O.direction.transformDirection(M),T++}}}return{setup:u,setupView:f,state:n}}function T3(i){const e=new QU(i),t=[],n=[];function r(g){p.camera=g,t.length=0,n.length=0}function s(g){t.push(g)}function o(g){n.push(g)}function u(){e.setup(t)}function f(g){e.setupView(t,g)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:u,setupLightsView:f,pushLight:s,pushShadow:o}}function qU(i){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let u;return o===void 0?(u=new T3(i),e.set(r,[u])):s>=o.length?(u=new T3(i),o.push(u)):u=o[s],u}function n(){e=new WeakMap}return{get:t,dispose:n}}const JU=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,KU=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,ZU=[new Q(1,0,0),new Q(-1,0,0),new Q(0,1,0),new Q(0,-1,0),new Q(0,0,1),new Q(0,0,-1)],$U=[new Q(0,-1,0),new Q(0,-1,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,-1,0),new Q(0,-1,0)],w3=new jt,Cg=new Q,jb=new Q;function e9(i,e,t){let n=new Nm;const r=new qe,s=new qe,o=new Ti,u=new k_,f=new sT,p={},g=t.maxTextureSize,v={[ml]:jr,[jr]:ml,[Vr]:Vr},y=new ai({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new qe},radius:{value:4}},vertexShader:JU,fragmentShader:KU}),A=y.clone();A.defines.HORIZONTAL_PASS=1;const S=new pn;S.setAttribute("position",new jn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new Oi(S,y),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=am;let E=this.type;this.render=function(z,j,W){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||z.length===0)return;z.type===Qg&&(Ht("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),z.type=am);const L=i.getRenderTarget(),H=i.getActiveCubeFace(),K=i.getActiveMipmapLevel(),de=i.state;de.setBlending(Pi),de.buffers.depth.getReversed()===!0?de.buffers.color.setClear(0,0,0,0):de.buffers.color.setClear(1,1,1,1),de.buffers.depth.setTest(!0),de.setScissorTest(!1);const ce=E!==this.type;ce&&j.traverse(function(ne){ne.material&&(Array.isArray(ne.material)?ne.material.forEach(fe=>fe.needsUpdate=!0):ne.material.needsUpdate=!0)});for(let ne=0,fe=z.length;ne<fe;ne++){const X=z[ne],re=X.shadow;if(re===void 0){Ht("WebGLShadowMap:",X,"has no shadow.");continue}if(re.autoUpdate===!1&&re.needsUpdate===!1)continue;r.copy(re.mapSize);const ge=re.getFrameExtents();if(r.multiply(ge),s.copy(re.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(s.x=Math.floor(g/ge.x),r.x=s.x*ge.x,re.mapSize.x=s.x),r.y>g&&(s.y=Math.floor(g/ge.y),r.y=s.y*ge.y,re.mapSize.y=s.y)),re.map===null||ce===!0){if(re.map!==null&&(re.map.depthTexture!==null&&(re.map.depthTexture.dispose(),re.map.depthTexture=null),re.map.dispose()),this.type===Pf){if(X.isPointLight){Ht("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}re.map=new ti(r.x,r.y,{format:Bo,type:On,minFilter:on,magFilter:on,generateMipmaps:!1}),re.map.texture.name=X.name+".shadowMap",re.map.depthTexture=new _d(r.x,r.y,si),re.map.depthTexture.name=X.name+".shadowMapDepth",re.map.depthTexture.format=rc,re.map.depthTexture.compareFunction=null,re.map.depthTexture.minFilter=di,re.map.depthTexture.magFilter=di}else{X.isPointLight?(re.map=new S_(r.x),re.map.depthTexture=new t4(r.x,ca)):(re.map=new ti(r.x,r.y),re.map.depthTexture=new _d(r.x,r.y,ca)),re.map.depthTexture.name=X.name+".shadowMap",re.map.depthTexture.format=rc;const Se=i.state.buffers.depth.getReversed();this.type===am?(re.map.depthTexture.compareFunction=Se?A_:y_,re.map.depthTexture.minFilter=on,re.map.depthTexture.magFilter=on):(re.map.depthTexture.compareFunction=null,re.map.depthTexture.minFilter=di,re.map.depthTexture.magFilter=di)}re.camera.updateProjectionMatrix()}const Te=re.map.isWebGLCubeRenderTarget?6:1;for(let Se=0;Se<Te;Se++){if(re.map.isWebGLCubeRenderTarget)i.setRenderTarget(re.map,Se),i.clear();else{Se===0&&(i.setRenderTarget(re.map),i.clear());const Y=re.getViewport(Se);o.set(s.x*Y.x,s.y*Y.y,s.x*Y.z,s.y*Y.w),de.viewport(o)}if(X.isPointLight){const Y=re.camera,me=re.matrix,Ce=X.distance||Y.far;Ce!==Y.far&&(Y.far=Ce,Y.updateProjectionMatrix()),Cg.setFromMatrixPosition(X.matrixWorld),Y.position.copy(Cg),jb.copy(Y.position),jb.add(ZU[Se]),Y.up.copy($U[Se]),Y.lookAt(jb),Y.updateMatrixWorld(),me.makeTranslation(-Cg.x,-Cg.y,-Cg.z),w3.multiplyMatrices(Y.projectionMatrix,Y.matrixWorldInverse),re._frustum.setFromProjectionMatrix(w3,Y.coordinateSystem,Y.reversedDepth)}else re.updateMatrices(X);n=re.getFrustum(),O(j,W,re.camera,X,this.type)}re.isPointLightShadow!==!0&&this.type===Pf&&R(re,W),re.needsUpdate=!1}E=this.type,M.needsUpdate=!1,i.setRenderTarget(L,H,K)};function R(z,j){const W=e.update(T);y.defines.VSM_SAMPLES!==z.blurSamples&&(y.defines.VSM_SAMPLES=z.blurSamples,A.defines.VSM_SAMPLES=z.blurSamples,y.needsUpdate=!0,A.needsUpdate=!0),z.mapPass===null&&(z.mapPass=new ti(r.x,r.y,{format:Bo,type:On})),y.uniforms.shadow_pass.value=z.map.depthTexture,y.uniforms.resolution.value=z.mapSize,y.uniforms.radius.value=z.radius,i.setRenderTarget(z.mapPass),i.clear(),i.renderBufferDirect(j,null,W,y,T,null),A.uniforms.shadow_pass.value=z.mapPass.texture,A.uniforms.resolution.value=z.mapSize,A.uniforms.radius.value=z.radius,i.setRenderTarget(z.map),i.clear(),i.renderBufferDirect(j,null,W,A,T,null)}function I(z,j,W,L){let H=null;const K=W.isPointLight===!0?z.customDistanceMaterial:z.customDepthMaterial;if(K!==void 0)H=K;else if(H=W.isPointLight===!0?f:u,i.localClippingEnabled&&j.clipShadows===!0&&Array.isArray(j.clippingPlanes)&&j.clippingPlanes.length!==0||j.displacementMap&&j.displacementScale!==0||j.alphaMap&&j.alphaTest>0||j.map&&j.alphaTest>0||j.alphaToCoverage===!0){const de=H.uuid,ce=j.uuid;let ne=p[de];ne===void 0&&(ne={},p[de]=ne);let fe=ne[ce];fe===void 0&&(fe=H.clone(),ne[ce]=fe,j.addEventListener("dispose",F)),H=fe}if(H.visible=j.visible,H.wireframe=j.wireframe,L===Pf?H.side=j.shadowSide!==null?j.shadowSide:j.side:H.side=j.shadowSide!==null?j.shadowSide:v[j.side],H.alphaMap=j.alphaMap,H.alphaTest=j.alphaToCoverage===!0?.5:j.alphaTest,H.map=j.map,H.clipShadows=j.clipShadows,H.clippingPlanes=j.clippingPlanes,H.clipIntersection=j.clipIntersection,H.displacementMap=j.displacementMap,H.displacementScale=j.displacementScale,H.displacementBias=j.displacementBias,H.wireframeLinewidth=j.wireframeLinewidth,H.linewidth=j.linewidth,W.isPointLight===!0&&H.isMeshDistanceMaterial===!0){const de=i.properties.get(H);de.light=W}return H}function O(z,j,W,L,H){if(z.visible===!1)return;if(z.layers.test(j.layers)&&(z.isMesh||z.isLine||z.isPoints)&&(z.castShadow||z.receiveShadow&&H===Pf)&&(!z.frustumCulled||n.intersectsObject(z))){z.modelViewMatrix.multiplyMatrices(W.matrixWorldInverse,z.matrixWorld);const ce=e.update(z),ne=z.material;if(Array.isArray(ne)){const fe=ce.groups;for(let X=0,re=fe.length;X<re;X++){const ge=fe[X],Te=ne[ge.materialIndex];if(Te&&Te.visible){const Se=I(z,Te,L,H);z.onBeforeShadow(i,z,j,W,ce,Se,ge),i.renderBufferDirect(W,null,ce,Se,z,ge),z.onAfterShadow(i,z,j,W,ce,Se,ge)}}}else if(ne.visible){const fe=I(z,ne,L,H);z.onBeforeShadow(i,z,j,W,ce,fe,null),i.renderBufferDirect(W,null,ce,fe,z,null),z.onAfterShadow(i,z,j,W,ce,fe,null)}}const de=z.children;for(let ce=0,ne=de.length;ce<ne;ce++)O(de[ce],j,W,L,H)}function F(z){z.target.removeEventListener("dispose",F);for(const W in p){const L=p[W],H=z.target.uuid;H in L&&(L[H].dispose(),delete L[H])}}}const t9={[nA]:uv,[iA]:aA,[rA]:oA,[Jf]:sA,[uv]:nA,[aA]:iA,[oA]:rA,[sA]:Jf};function n9(i,e){function t(){let pe=!1;const Fe=new Ti;let Oe=null;const It=new Ti(0,0,0,0);return{setMask:function(_t){Oe!==_t&&!pe&&(i.colorMask(_t,_t,_t,_t),Oe=_t)},setLocked:function(_t){pe=_t},setClear:function(_t,ut,wt,Zt,yn){yn===!0&&(_t*=Zt,ut*=Zt,wt*=Zt),Fe.set(_t,ut,wt,Zt),It.equals(Fe)===!1&&(i.clearColor(_t,ut,wt,Zt),It.copy(Fe))},reset:function(){pe=!1,Oe=null,It.set(-1,0,0,0)}}}function n(){let pe=!1,Fe=!1,Oe=null,It=null,_t=null;return{setReversed:function(ut){if(Fe!==ut){const wt=e.get("EXT_clip_control");ut?wt.clipControlEXT(wt.LOWER_LEFT_EXT,wt.ZERO_TO_ONE_EXT):wt.clipControlEXT(wt.LOWER_LEFT_EXT,wt.NEGATIVE_ONE_TO_ONE_EXT),Fe=ut;const Zt=_t;_t=null,this.setClear(Zt)}},getReversed:function(){return Fe},setTest:function(ut){ut?ze(i.DEPTH_TEST):dt(i.DEPTH_TEST)},setMask:function(ut){Oe!==ut&&!pe&&(i.depthMask(ut),Oe=ut)},setFunc:function(ut){if(Fe&&(ut=t9[ut]),It!==ut){switch(ut){case nA:i.depthFunc(i.NEVER);break;case uv:i.depthFunc(i.ALWAYS);break;case iA:i.depthFunc(i.LESS);break;case Jf:i.depthFunc(i.LEQUAL);break;case rA:i.depthFunc(i.EQUAL);break;case sA:i.depthFunc(i.GEQUAL);break;case aA:i.depthFunc(i.GREATER);break;case oA:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}It=ut}},setLocked:function(ut){pe=ut},setClear:function(ut){_t!==ut&&(Fe&&(ut=1-ut),i.clearDepth(ut),_t=ut)},reset:function(){pe=!1,Oe=null,It=null,_t=null,Fe=!1}}}function r(){let pe=!1,Fe=null,Oe=null,It=null,_t=null,ut=null,wt=null,Zt=null,yn=null;return{setTest:function(_n){pe||(_n?ze(i.STENCIL_TEST):dt(i.STENCIL_TEST))},setMask:function(_n){Fe!==_n&&!pe&&(i.stencilMask(_n),Fe=_n)},setFunc:function(_n,Si,ji){(Oe!==_n||It!==Si||_t!==ji)&&(i.stencilFunc(_n,Si,ji),Oe=_n,It=Si,_t=ji)},setOp:function(_n,Si,ji){(ut!==_n||wt!==Si||Zt!==ji)&&(i.stencilOp(_n,Si,ji),ut=_n,wt=Si,Zt=ji)},setLocked:function(_n){pe=_n},setClear:function(_n){yn!==_n&&(i.clearStencil(_n),yn=_n)},reset:function(){pe=!1,Fe=null,Oe=null,It=null,_t=null,ut=null,wt=null,Zt=null,yn=null}}}const s=new t,o=new n,u=new r,f=new WeakMap,p=new WeakMap;let g={},v={},y=new WeakMap,A=[],S=null,T=!1,M=null,E=null,R=null,I=null,O=null,F=null,z=null,j=new Ft(0,0,0),W=0,L=!1,H=null,K=null,de=null,ce=null,ne=null;const fe=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let X=!1,re=0;const ge=i.getParameter(i.VERSION);ge.indexOf("WebGL")!==-1?(re=parseFloat(/^WebGL (\d)/.exec(ge)[1]),X=re>=1):ge.indexOf("OpenGL ES")!==-1&&(re=parseFloat(/^OpenGL ES (\d)/.exec(ge)[1]),X=re>=2);let Te=null,Se={};const Y=i.getParameter(i.SCISSOR_BOX),me=i.getParameter(i.VIEWPORT),Ce=new Ti().fromArray(Y),Ze=new Ti().fromArray(me);function xt(pe,Fe,Oe,It){const _t=new Uint8Array(4),ut=i.createTexture();i.bindTexture(pe,ut),i.texParameteri(pe,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(pe,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let wt=0;wt<Oe;wt++)pe===i.TEXTURE_3D||pe===i.TEXTURE_2D_ARRAY?i.texImage3D(Fe,0,i.RGBA,1,1,It,0,i.RGBA,i.UNSIGNED_BYTE,_t):i.texImage2D(Fe+wt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,_t);return ut}const ve={};ve[i.TEXTURE_2D]=xt(i.TEXTURE_2D,i.TEXTURE_2D,1),ve[i.TEXTURE_CUBE_MAP]=xt(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),ve[i.TEXTURE_2D_ARRAY]=xt(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),ve[i.TEXTURE_3D]=xt(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),u.setClear(0),ze(i.DEPTH_TEST),o.setFunc(Jf),et(!1),At(TE),ze(i.CULL_FACE),je(Pi);function ze(pe){g[pe]!==!0&&(i.enable(pe),g[pe]=!0)}function dt(pe){g[pe]!==!1&&(i.disable(pe),g[pe]=!1)}function Ee(pe,Fe){return v[pe]!==Fe?(i.bindFramebuffer(pe,Fe),v[pe]=Fe,pe===i.DRAW_FRAMEBUFFER&&(v[i.FRAMEBUFFER]=Fe),pe===i.FRAMEBUFFER&&(v[i.DRAW_FRAMEBUFFER]=Fe),!0):!1}function yt(pe,Fe){let Oe=A,It=!1;if(pe){Oe=y.get(Fe),Oe===void 0&&(Oe=[],y.set(Fe,Oe));const _t=pe.textures;if(Oe.length!==_t.length||Oe[0]!==i.COLOR_ATTACHMENT0){for(let ut=0,wt=_t.length;ut<wt;ut++)Oe[ut]=i.COLOR_ATTACHMENT0+ut;Oe.length=_t.length,It=!0}}else Oe[0]!==i.BACK&&(Oe[0]=i.BACK,It=!0);It&&i.drawBuffers(Oe)}function Pt(pe){return S!==pe?(i.useProgram(pe),S=pe,!0):!1}const Ot={[$l]:i.FUNC_ADD,[f2]:i.FUNC_SUBTRACT,[h2]:i.FUNC_REVERSE_SUBTRACT};Ot[p2]=i.MIN,Ot[m2]=i.MAX;const Mt={[g2]:i.ZERO,[$p]:i.ONE,[v2]:i.SRC_COLOR,[eA]:i.SRC_ALPHA,[b2]:i.SRC_ALPHA_SATURATE,[_2]:i.DST_COLOR,[y2]:i.DST_ALPHA,[x2]:i.ONE_MINUS_SRC_COLOR,[tA]:i.ONE_MINUS_SRC_ALPHA,[S2]:i.ONE_MINUS_DST_COLOR,[A2]:i.ONE_MINUS_DST_ALPHA,[E2]:i.CONSTANT_COLOR,[M2]:i.ONE_MINUS_CONSTANT_COLOR,[T2]:i.CONSTANT_ALPHA,[w2]:i.ONE_MINUS_CONSTANT_ALPHA};function je(pe,Fe,Oe,It,_t,ut,wt,Zt,yn,_n){if(pe===Pi){T===!0&&(dt(i.BLEND),T=!1);return}if(T===!1&&(ze(i.BLEND),T=!0),pe!==CM){if(pe!==M||_n!==L){if((E!==$l||O!==$l)&&(i.blendEquation(i.FUNC_ADD),E=$l,O=$l),_n)switch(pe){case jf:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case wE:i.blendFunc(i.ONE,i.ONE);break;case CE:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case RE:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:nn("WebGLState: Invalid blending: ",pe);break}else switch(pe){case jf:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case wE:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case CE:nn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case RE:nn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:nn("WebGLState: Invalid blending: ",pe);break}R=null,I=null,F=null,z=null,j.set(0,0,0),W=0,M=pe,L=_n}return}_t=_t||Fe,ut=ut||Oe,wt=wt||It,(Fe!==E||_t!==O)&&(i.blendEquationSeparate(Ot[Fe],Ot[_t]),E=Fe,O=_t),(Oe!==R||It!==I||ut!==F||wt!==z)&&(i.blendFuncSeparate(Mt[Oe],Mt[It],Mt[ut],Mt[wt]),R=Oe,I=It,F=ut,z=wt),(Zt.equals(j)===!1||yn!==W)&&(i.blendColor(Zt.r,Zt.g,Zt.b,yn),j.copy(Zt),W=yn),M=pe,L=!1}function st(pe,Fe){pe.side===Vr?dt(i.CULL_FACE):ze(i.CULL_FACE);let Oe=pe.side===jr;Fe&&(Oe=!Oe),et(Oe),pe.blending===jf&&pe.transparent===!1?je(Pi):je(pe.blending,pe.blendEquation,pe.blendSrc,pe.blendDst,pe.blendEquationAlpha,pe.blendSrcAlpha,pe.blendDstAlpha,pe.blendColor,pe.blendAlpha,pe.premultipliedAlpha),o.setFunc(pe.depthFunc),o.setTest(pe.depthTest),o.setMask(pe.depthWrite),s.setMask(pe.colorWrite);const It=pe.stencilWrite;u.setTest(It),It&&(u.setMask(pe.stencilWriteMask),u.setFunc(pe.stencilFunc,pe.stencilRef,pe.stencilFuncMask),u.setOp(pe.stencilFail,pe.stencilZFail,pe.stencilZPass)),Gt(pe.polygonOffset,pe.polygonOffsetFactor,pe.polygonOffsetUnits),pe.alphaToCoverage===!0?ze(i.SAMPLE_ALPHA_TO_COVERAGE):dt(i.SAMPLE_ALPHA_TO_COVERAGE)}function et(pe){H!==pe&&(pe?i.frontFace(i.CW):i.frontFace(i.CCW),H=pe)}function At(pe){pe!==c2?(ze(i.CULL_FACE),pe!==K&&(pe===TE?i.cullFace(i.BACK):pe===u2?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):dt(i.CULL_FACE),K=pe}function oe(pe){pe!==de&&(X&&i.lineWidth(pe),de=pe)}function Gt(pe,Fe,Oe){pe?(ze(i.POLYGON_OFFSET_FILL),(ce!==Fe||ne!==Oe)&&(i.polygonOffset(Fe,Oe),ce=Fe,ne=Oe)):dt(i.POLYGON_OFFSET_FILL)}function Dt(pe){pe?ze(i.SCISSOR_TEST):dt(i.SCISSOR_TEST)}function qt(pe){pe===void 0&&(pe=i.TEXTURE0+fe-1),Te!==pe&&(i.activeTexture(pe),Te=pe)}function Tt(pe,Fe,Oe){Oe===void 0&&(Te===null?Oe=i.TEXTURE0+fe-1:Oe=Te);let It=Se[Oe];It===void 0&&(It={type:void 0,texture:void 0},Se[Oe]=It),(It.type!==pe||It.texture!==Fe)&&(Te!==Oe&&(i.activeTexture(Oe),Te=Oe),i.bindTexture(pe,Fe||ve[pe]),It.type=pe,It.texture=Fe)}function te(){const pe=Se[Te];pe!==void 0&&pe.type!==void 0&&(i.bindTexture(pe.type,null),pe.type=void 0,pe.texture=void 0)}function G(){try{i.compressedTexImage2D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function be(){try{i.compressedTexImage3D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function Ye(){try{i.texSubImage2D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function ot(){try{i.texSubImage3D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function Qe(){try{i.compressedTexSubImage2D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function Ut(){try{i.compressedTexSubImage3D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function Rt(){try{i.texStorage2D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function Vt(){try{i.texStorage3D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function $t(){try{i.texImage2D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function vt(){try{i.texImage3D(...arguments)}catch(pe){nn("WebGLState:",pe)}}function ct(pe){Ce.equals(pe)===!1&&(i.scissor(pe.x,pe.y,pe.z,pe.w),Ce.copy(pe))}function Bt(pe){Ze.equals(pe)===!1&&(i.viewport(pe.x,pe.y,pe.z,pe.w),Ze.copy(pe))}function he(pe,Fe){let Oe=p.get(Fe);Oe===void 0&&(Oe=new WeakMap,p.set(Fe,Oe));let It=Oe.get(pe);It===void 0&&(It=i.getUniformBlockIndex(Fe,pe.name),Oe.set(pe,It))}function Be(pe,Fe){const It=p.get(Fe).get(pe);f.get(Fe)!==It&&(i.uniformBlockBinding(Fe,It,pe.__bindingPointIndex),f.set(Fe,It))}function ft(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),g={},Te=null,Se={},v={},y=new WeakMap,A=[],S=null,T=!1,M=null,E=null,R=null,I=null,O=null,F=null,z=null,j=new Ft(0,0,0),W=0,L=!1,H=null,K=null,de=null,ce=null,ne=null,Ce.set(0,0,i.canvas.width,i.canvas.height),Ze.set(0,0,i.canvas.width,i.canvas.height),s.reset(),o.reset(),u.reset()}return{buffers:{color:s,depth:o,stencil:u},enable:ze,disable:dt,bindFramebuffer:Ee,drawBuffers:yt,useProgram:Pt,setBlending:je,setMaterial:st,setFlipSided:et,setCullFace:At,setLineWidth:oe,setPolygonOffset:Gt,setScissorTest:Dt,activeTexture:qt,bindTexture:Tt,unbindTexture:te,compressedTexImage2D:G,compressedTexImage3D:be,texImage2D:$t,texImage3D:vt,updateUBOMapping:he,uniformBlockBinding:Be,texStorage2D:Rt,texStorage3D:Vt,texSubImage2D:Ye,texSubImage3D:ot,compressedTexSubImage2D:Qe,compressedTexSubImage3D:Ut,scissor:ct,viewport:Bt,reset:ft}}function i9(i,e,t,n,r,s,o){const u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new qe,g=new WeakMap;let v;const y=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S(te,G){return A?new OffscreenCanvas(te,G):mv("canvas")}function T(te,G,be){let Ye=1;const ot=Tt(te);if((ot.width>be||ot.height>be)&&(Ye=be/Math.max(ot.width,ot.height)),Ye<1)if(typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&te instanceof ImageBitmap||typeof VideoFrame<"u"&&te instanceof VideoFrame){const Qe=Math.floor(Ye*ot.width),Ut=Math.floor(Ye*ot.height);v===void 0&&(v=S(Qe,Ut));const Rt=G?S(Qe,Ut):v;return Rt.width=Qe,Rt.height=Ut,Rt.getContext("2d").drawImage(te,0,0,Qe,Ut),Ht("WebGLRenderer: Texture has been resized from ("+ot.width+"x"+ot.height+") to ("+Qe+"x"+Ut+")."),Rt}else return"data"in te&&Ht("WebGLRenderer: Image in DataTexture is too big ("+ot.width+"x"+ot.height+")."),te;return te}function M(te){return te.generateMipmaps}function E(te){i.generateMipmap(te)}function R(te){return te.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:te.isWebGL3DRenderTarget?i.TEXTURE_3D:te.isWebGLArrayRenderTarget||te.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function I(te,G,be,Ye,ot=!1){if(te!==null){if(i[te]!==void 0)return i[te];Ht("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let Qe=G;if(G===i.RED&&(be===i.FLOAT&&(Qe=i.R32F),be===i.HALF_FLOAT&&(Qe=i.R16F),be===i.UNSIGNED_BYTE&&(Qe=i.R8)),G===i.RED_INTEGER&&(be===i.UNSIGNED_BYTE&&(Qe=i.R8UI),be===i.UNSIGNED_SHORT&&(Qe=i.R16UI),be===i.UNSIGNED_INT&&(Qe=i.R32UI),be===i.BYTE&&(Qe=i.R8I),be===i.SHORT&&(Qe=i.R16I),be===i.INT&&(Qe=i.R32I)),G===i.RG&&(be===i.FLOAT&&(Qe=i.RG32F),be===i.HALF_FLOAT&&(Qe=i.RG16F),be===i.UNSIGNED_BYTE&&(Qe=i.RG8)),G===i.RG_INTEGER&&(be===i.UNSIGNED_BYTE&&(Qe=i.RG8UI),be===i.UNSIGNED_SHORT&&(Qe=i.RG16UI),be===i.UNSIGNED_INT&&(Qe=i.RG32UI),be===i.BYTE&&(Qe=i.RG8I),be===i.SHORT&&(Qe=i.RG16I),be===i.INT&&(Qe=i.RG32I)),G===i.RGB_INTEGER&&(be===i.UNSIGNED_BYTE&&(Qe=i.RGB8UI),be===i.UNSIGNED_SHORT&&(Qe=i.RGB16UI),be===i.UNSIGNED_INT&&(Qe=i.RGB32UI),be===i.BYTE&&(Qe=i.RGB8I),be===i.SHORT&&(Qe=i.RGB16I),be===i.INT&&(Qe=i.RGB32I)),G===i.RGBA_INTEGER&&(be===i.UNSIGNED_BYTE&&(Qe=i.RGBA8UI),be===i.UNSIGNED_SHORT&&(Qe=i.RGBA16UI),be===i.UNSIGNED_INT&&(Qe=i.RGBA32UI),be===i.BYTE&&(Qe=i.RGBA8I),be===i.SHORT&&(Qe=i.RGBA16I),be===i.INT&&(Qe=i.RGBA32I)),G===i.RGB&&(be===i.UNSIGNED_INT_5_9_9_9_REV&&(Qe=i.RGB9_E5),be===i.UNSIGNED_INT_10F_11F_11F_REV&&(Qe=i.R11F_G11F_B10F)),G===i.RGBA){const Ut=ot?hv:$n.getTransfer(Ye);be===i.FLOAT&&(Qe=i.RGBA32F),be===i.HALF_FLOAT&&(Qe=i.RGBA16F),be===i.UNSIGNED_BYTE&&(Qe=Ut===yi?i.SRGB8_ALPHA8:i.RGBA8),be===i.UNSIGNED_SHORT_4_4_4_4&&(Qe=i.RGBA4),be===i.UNSIGNED_SHORT_5_5_5_1&&(Qe=i.RGB5_A1)}return(Qe===i.R16F||Qe===i.R32F||Qe===i.RG16F||Qe===i.RG32F||Qe===i.RGBA16F||Qe===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Qe}function O(te,G){let be;return te?G===null||G===ca||G===Zf?be=i.DEPTH24_STENCIL8:G===si?be=i.DEPTH32F_STENCIL8:G===Kf&&(be=i.DEPTH24_STENCIL8,Ht("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):G===null||G===ca||G===Zf?be=i.DEPTH_COMPONENT24:G===si?be=i.DEPTH_COMPONENT32F:G===Kf&&(be=i.DEPTH_COMPONENT16),be}function F(te,G){return M(te)===!0||te.isFramebufferTexture&&te.minFilter!==di&&te.minFilter!==on?Math.log2(Math.max(G.width,G.height))+1:te.mipmaps!==void 0&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?G.mipmaps.length:1}function z(te){const G=te.target;G.removeEventListener("dispose",z),W(G),G.isVideoTexture&&g.delete(G)}function j(te){const G=te.target;G.removeEventListener("dispose",j),H(G)}function W(te){const G=n.get(te);if(G.__webglInit===void 0)return;const be=te.source,Ye=y.get(be);if(Ye){const ot=Ye[G.__cacheKey];ot.usedTimes--,ot.usedTimes===0&&L(te),Object.keys(Ye).length===0&&y.delete(be)}n.remove(te)}function L(te){const G=n.get(te);i.deleteTexture(G.__webglTexture);const be=te.source,Ye=y.get(be);delete Ye[G.__cacheKey],o.memory.textures--}function H(te){const G=n.get(te);if(te.depthTexture&&(te.depthTexture.dispose(),n.remove(te.depthTexture)),te.isWebGLCubeRenderTarget)for(let Ye=0;Ye<6;Ye++){if(Array.isArray(G.__webglFramebuffer[Ye]))for(let ot=0;ot<G.__webglFramebuffer[Ye].length;ot++)i.deleteFramebuffer(G.__webglFramebuffer[Ye][ot]);else i.deleteFramebuffer(G.__webglFramebuffer[Ye]);G.__webglDepthbuffer&&i.deleteRenderbuffer(G.__webglDepthbuffer[Ye])}else{if(Array.isArray(G.__webglFramebuffer))for(let Ye=0;Ye<G.__webglFramebuffer.length;Ye++)i.deleteFramebuffer(G.__webglFramebuffer[Ye]);else i.deleteFramebuffer(G.__webglFramebuffer);if(G.__webglDepthbuffer&&i.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&i.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let Ye=0;Ye<G.__webglColorRenderbuffer.length;Ye++)G.__webglColorRenderbuffer[Ye]&&i.deleteRenderbuffer(G.__webglColorRenderbuffer[Ye]);G.__webglDepthRenderbuffer&&i.deleteRenderbuffer(G.__webglDepthRenderbuffer)}const be=te.textures;for(let Ye=0,ot=be.length;Ye<ot;Ye++){const Qe=n.get(be[Ye]);Qe.__webglTexture&&(i.deleteTexture(Qe.__webglTexture),o.memory.textures--),n.remove(be[Ye])}n.remove(te)}let K=0;function de(){K=0}function ce(){const te=K;return te>=r.maxTextures&&Ht("WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+r.maxTextures),K+=1,te}function ne(te){const G=[];return G.push(te.wrapS),G.push(te.wrapT),G.push(te.wrapR||0),G.push(te.magFilter),G.push(te.minFilter),G.push(te.anisotropy),G.push(te.internalFormat),G.push(te.format),G.push(te.type),G.push(te.generateMipmaps),G.push(te.premultiplyAlpha),G.push(te.flipY),G.push(te.unpackAlignment),G.push(te.colorSpace),G.join()}function fe(te,G){const be=n.get(te);if(te.isVideoTexture&&Dt(te),te.isRenderTargetTexture===!1&&te.isExternalTexture!==!0&&te.version>0&&be.__version!==te.version){const Ye=te.image;if(Ye===null)Ht("WebGLRenderer: Texture marked for update but no image data found.");else if(Ye.complete===!1)Ht("WebGLRenderer: Texture marked for update but image is incomplete");else{ve(be,te,G);return}}else te.isExternalTexture&&(be.__webglTexture=te.sourceTexture?te.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,be.__webglTexture,i.TEXTURE0+G)}function X(te,G){const be=n.get(te);if(te.isRenderTargetTexture===!1&&te.version>0&&be.__version!==te.version){ve(be,te,G);return}else te.isExternalTexture&&(be.__webglTexture=te.sourceTexture?te.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,be.__webglTexture,i.TEXTURE0+G)}function re(te,G){const be=n.get(te);if(te.isRenderTargetTexture===!1&&te.version>0&&be.__version!==te.version){ve(be,te,G);return}t.bindTexture(i.TEXTURE_3D,be.__webglTexture,i.TEXTURE0+G)}function ge(te,G){const be=n.get(te);if(te.isCubeDepthTexture!==!0&&te.version>0&&be.__version!==te.version){ze(be,te,G);return}t.bindTexture(i.TEXTURE_CUBE_MAP,be.__webglTexture,i.TEXTURE0+G)}const Te={[Lo]:i.REPEAT,[Ni]:i.CLAMP_TO_EDGE,[pm]:i.MIRRORED_REPEAT},Se={[di]:i.NEAREST,[h_]:i.NEAREST_MIPMAP_NEAREST,[Uf]:i.NEAREST_MIPMAP_LINEAR,[on]:i.LINEAR,[om]:i.LINEAR_MIPMAP_NEAREST,[Ka]:i.LINEAR_MIPMAP_LINEAR},Y={[P2]:i.NEVER,[G2]:i.ALWAYS,[U2]:i.LESS,[y_]:i.LEQUAL,[F2]:i.EQUAL,[A_]:i.GEQUAL,[z2]:i.GREATER,[H2]:i.NOTEQUAL};function me(te,G){if(G.type===si&&e.has("OES_texture_float_linear")===!1&&(G.magFilter===on||G.magFilter===om||G.magFilter===Uf||G.magFilter===Ka||G.minFilter===on||G.minFilter===om||G.minFilter===Uf||G.minFilter===Ka)&&Ht("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(te,i.TEXTURE_WRAP_S,Te[G.wrapS]),i.texParameteri(te,i.TEXTURE_WRAP_T,Te[G.wrapT]),(te===i.TEXTURE_3D||te===i.TEXTURE_2D_ARRAY)&&i.texParameteri(te,i.TEXTURE_WRAP_R,Te[G.wrapR]),i.texParameteri(te,i.TEXTURE_MAG_FILTER,Se[G.magFilter]),i.texParameteri(te,i.TEXTURE_MIN_FILTER,Se[G.minFilter]),G.compareFunction&&(i.texParameteri(te,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(te,i.TEXTURE_COMPARE_FUNC,Y[G.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(G.magFilter===di||G.minFilter!==Uf&&G.minFilter!==Ka||G.type===si&&e.has("OES_texture_float_linear")===!1)return;if(G.anisotropy>1||n.get(G).__currentAnisotropy){const be=e.get("EXT_texture_filter_anisotropic");i.texParameterf(te,be.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(G.anisotropy,r.getMaxAnisotropy())),n.get(G).__currentAnisotropy=G.anisotropy}}}function Ce(te,G){let be=!1;te.__webglInit===void 0&&(te.__webglInit=!0,G.addEventListener("dispose",z));const Ye=G.source;let ot=y.get(Ye);ot===void 0&&(ot={},y.set(Ye,ot));const Qe=ne(G);if(Qe!==te.__cacheKey){ot[Qe]===void 0&&(ot[Qe]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,be=!0),ot[Qe].usedTimes++;const Ut=ot[te.__cacheKey];Ut!==void 0&&(ot[te.__cacheKey].usedTimes--,Ut.usedTimes===0&&L(G)),te.__cacheKey=Qe,te.__webglTexture=ot[Qe].texture}return be}function Ze(te,G,be){return Math.floor(Math.floor(te/be)/G)}function xt(te,G,be,Ye){const Qe=te.updateRanges;if(Qe.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,G.width,G.height,be,Ye,G.data);else{Qe.sort((vt,ct)=>vt.start-ct.start);let Ut=0;for(let vt=1;vt<Qe.length;vt++){const ct=Qe[Ut],Bt=Qe[vt],he=ct.start+ct.count,Be=Ze(Bt.start,G.width,4),ft=Ze(ct.start,G.width,4);Bt.start<=he+1&&Be===ft&&Ze(Bt.start+Bt.count-1,G.width,4)===Be?ct.count=Math.max(ct.count,Bt.start+Bt.count-ct.start):(++Ut,Qe[Ut]=Bt)}Qe.length=Ut+1;const Rt=i.getParameter(i.UNPACK_ROW_LENGTH),Vt=i.getParameter(i.UNPACK_SKIP_PIXELS),$t=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,G.width);for(let vt=0,ct=Qe.length;vt<ct;vt++){const Bt=Qe[vt],he=Math.floor(Bt.start/4),Be=Math.ceil(Bt.count/4),ft=he%G.width,pe=Math.floor(he/G.width),Fe=Be,Oe=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,ft),i.pixelStorei(i.UNPACK_SKIP_ROWS,pe),t.texSubImage2D(i.TEXTURE_2D,0,ft,pe,Fe,Oe,be,Ye,G.data)}te.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,Rt),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Vt),i.pixelStorei(i.UNPACK_SKIP_ROWS,$t)}}function ve(te,G,be){let Ye=i.TEXTURE_2D;(G.isDataArrayTexture||G.isCompressedArrayTexture)&&(Ye=i.TEXTURE_2D_ARRAY),G.isData3DTexture&&(Ye=i.TEXTURE_3D);const ot=Ce(te,G),Qe=G.source;t.bindTexture(Ye,te.__webglTexture,i.TEXTURE0+be);const Ut=n.get(Qe);if(Qe.version!==Ut.__version||ot===!0){t.activeTexture(i.TEXTURE0+be);const Rt=$n.getPrimaries($n.workingColorSpace),Vt=G.colorSpace===Ja?null:$n.getPrimaries(G.colorSpace),$t=G.colorSpace===Ja||Rt===Vt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,G.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,G.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);let vt=T(G.image,!1,r.maxTextureSize);vt=qt(G,vt);const ct=s.convert(G.format,G.colorSpace),Bt=s.convert(G.type);let he=I(G.internalFormat,ct,Bt,G.colorSpace,G.isVideoTexture);me(Ye,G);let Be;const ft=G.mipmaps,pe=G.isVideoTexture!==!0,Fe=Ut.__version===void 0||ot===!0,Oe=Qe.dataReady,It=F(G,vt);if(G.isDepthTexture)he=O(G.format===nu,G.type),Fe&&(pe?t.texStorage2D(i.TEXTURE_2D,1,he,vt.width,vt.height):t.texImage2D(i.TEXTURE_2D,0,he,vt.width,vt.height,0,ct,Bt,null));else if(G.isDataTexture)if(ft.length>0){pe&&Fe&&t.texStorage2D(i.TEXTURE_2D,It,he,ft[0].width,ft[0].height);for(let _t=0,ut=ft.length;_t<ut;_t++)Be=ft[_t],pe?Oe&&t.texSubImage2D(i.TEXTURE_2D,_t,0,0,Be.width,Be.height,ct,Bt,Be.data):t.texImage2D(i.TEXTURE_2D,_t,he,Be.width,Be.height,0,ct,Bt,Be.data);G.generateMipmaps=!1}else pe?(Fe&&t.texStorage2D(i.TEXTURE_2D,It,he,vt.width,vt.height),Oe&&xt(G,vt,ct,Bt)):t.texImage2D(i.TEXTURE_2D,0,he,vt.width,vt.height,0,ct,Bt,vt.data);else if(G.isCompressedTexture)if(G.isCompressedArrayTexture){pe&&Fe&&t.texStorage3D(i.TEXTURE_2D_ARRAY,It,he,ft[0].width,ft[0].height,vt.depth);for(let _t=0,ut=ft.length;_t<ut;_t++)if(Be=ft[_t],G.format!==Ai)if(ct!==null)if(pe){if(Oe)if(G.layerUpdates.size>0){const wt=zE(Be.width,Be.height,G.format,G.type);for(const Zt of G.layerUpdates){const yn=Be.data.subarray(Zt*wt/Be.data.BYTES_PER_ELEMENT,(Zt+1)*wt/Be.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,_t,0,0,Zt,Be.width,Be.height,1,ct,yn)}G.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,_t,0,0,0,Be.width,Be.height,vt.depth,ct,Be.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,_t,he,Be.width,Be.height,vt.depth,0,Be.data,0,0);else Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else pe?Oe&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,_t,0,0,0,Be.width,Be.height,vt.depth,ct,Bt,Be.data):t.texImage3D(i.TEXTURE_2D_ARRAY,_t,he,Be.width,Be.height,vt.depth,0,ct,Bt,Be.data)}else{pe&&Fe&&t.texStorage2D(i.TEXTURE_2D,It,he,ft[0].width,ft[0].height);for(let _t=0,ut=ft.length;_t<ut;_t++)Be=ft[_t],G.format!==Ai?ct!==null?pe?Oe&&t.compressedTexSubImage2D(i.TEXTURE_2D,_t,0,0,Be.width,Be.height,ct,Be.data):t.compressedTexImage2D(i.TEXTURE_2D,_t,he,Be.width,Be.height,0,Be.data):Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pe?Oe&&t.texSubImage2D(i.TEXTURE_2D,_t,0,0,Be.width,Be.height,ct,Bt,Be.data):t.texImage2D(i.TEXTURE_2D,_t,he,Be.width,Be.height,0,ct,Bt,Be.data)}else if(G.isDataArrayTexture)if(pe){if(Fe&&t.texStorage3D(i.TEXTURE_2D_ARRAY,It,he,vt.width,vt.height,vt.depth),Oe)if(G.layerUpdates.size>0){const _t=zE(vt.width,vt.height,G.format,G.type);for(const ut of G.layerUpdates){const wt=vt.data.subarray(ut*_t/vt.data.BYTES_PER_ELEMENT,(ut+1)*_t/vt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,ut,vt.width,vt.height,1,ct,Bt,wt)}G.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,vt.width,vt.height,vt.depth,ct,Bt,vt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,he,vt.width,vt.height,vt.depth,0,ct,Bt,vt.data);else if(G.isData3DTexture)pe?(Fe&&t.texStorage3D(i.TEXTURE_3D,It,he,vt.width,vt.height,vt.depth),Oe&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,vt.width,vt.height,vt.depth,ct,Bt,vt.data)):t.texImage3D(i.TEXTURE_3D,0,he,vt.width,vt.height,vt.depth,0,ct,Bt,vt.data);else if(G.isFramebufferTexture){if(Fe)if(pe)t.texStorage2D(i.TEXTURE_2D,It,he,vt.width,vt.height);else{let _t=vt.width,ut=vt.height;for(let wt=0;wt<It;wt++)t.texImage2D(i.TEXTURE_2D,wt,he,_t,ut,0,ct,Bt,null),_t>>=1,ut>>=1}}else if(ft.length>0){if(pe&&Fe){const _t=Tt(ft[0]);t.texStorage2D(i.TEXTURE_2D,It,he,_t.width,_t.height)}for(let _t=0,ut=ft.length;_t<ut;_t++)Be=ft[_t],pe?Oe&&t.texSubImage2D(i.TEXTURE_2D,_t,0,0,ct,Bt,Be):t.texImage2D(i.TEXTURE_2D,_t,he,ct,Bt,Be);G.generateMipmaps=!1}else if(pe){if(Fe){const _t=Tt(vt);t.texStorage2D(i.TEXTURE_2D,It,he,_t.width,_t.height)}Oe&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,ct,Bt,vt)}else t.texImage2D(i.TEXTURE_2D,0,he,ct,Bt,vt);M(G)&&E(Ye),Ut.__version=Qe.version,G.onUpdate&&G.onUpdate(G)}te.__version=G.version}function ze(te,G,be){if(G.image.length!==6)return;const Ye=Ce(te,G),ot=G.source;t.bindTexture(i.TEXTURE_CUBE_MAP,te.__webglTexture,i.TEXTURE0+be);const Qe=n.get(ot);if(ot.version!==Qe.__version||Ye===!0){t.activeTexture(i.TEXTURE0+be);const Ut=$n.getPrimaries($n.workingColorSpace),Rt=G.colorSpace===Ja?null:$n.getPrimaries(G.colorSpace),Vt=G.colorSpace===Ja||Ut===Rt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,G.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,G.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Vt);const $t=G.isCompressedTexture||G.image[0].isCompressedTexture,vt=G.image[0]&&G.image[0].isDataTexture,ct=[];for(let ut=0;ut<6;ut++)!$t&&!vt?ct[ut]=T(G.image[ut],!0,r.maxCubemapSize):ct[ut]=vt?G.image[ut].image:G.image[ut],ct[ut]=qt(G,ct[ut]);const Bt=ct[0],he=s.convert(G.format,G.colorSpace),Be=s.convert(G.type),ft=I(G.internalFormat,he,Be,G.colorSpace),pe=G.isVideoTexture!==!0,Fe=Qe.__version===void 0||Ye===!0,Oe=ot.dataReady;let It=F(G,Bt);me(i.TEXTURE_CUBE_MAP,G);let _t;if($t){pe&&Fe&&t.texStorage2D(i.TEXTURE_CUBE_MAP,It,ft,Bt.width,Bt.height);for(let ut=0;ut<6;ut++){_t=ct[ut].mipmaps;for(let wt=0;wt<_t.length;wt++){const Zt=_t[wt];G.format!==Ai?he!==null?pe?Oe&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt,0,0,Zt.width,Zt.height,he,Zt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt,ft,Zt.width,Zt.height,0,Zt.data):Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pe?Oe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt,0,0,Zt.width,Zt.height,he,Be,Zt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt,ft,Zt.width,Zt.height,0,he,Be,Zt.data)}}}else{if(_t=G.mipmaps,pe&&Fe){_t.length>0&&It++;const ut=Tt(ct[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,It,ft,ut.width,ut.height)}for(let ut=0;ut<6;ut++)if(vt){pe?Oe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,0,0,ct[ut].width,ct[ut].height,he,Be,ct[ut].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,ft,ct[ut].width,ct[ut].height,0,he,Be,ct[ut].data);for(let wt=0;wt<_t.length;wt++){const yn=_t[wt].image[ut].image;pe?Oe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt+1,0,0,yn.width,yn.height,he,Be,yn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt+1,ft,yn.width,yn.height,0,he,Be,yn.data)}}else{pe?Oe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,0,0,he,Be,ct[ut]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0,ft,he,Be,ct[ut]);for(let wt=0;wt<_t.length;wt++){const Zt=_t[wt];pe?Oe&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt+1,0,0,he,Be,Zt.image[ut]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+ut,wt+1,ft,he,Be,Zt.image[ut])}}}M(G)&&E(i.TEXTURE_CUBE_MAP),Qe.__version=ot.version,G.onUpdate&&G.onUpdate(G)}te.__version=G.version}function dt(te,G,be,Ye,ot,Qe){const Ut=s.convert(be.format,be.colorSpace),Rt=s.convert(be.type),Vt=I(be.internalFormat,Ut,Rt,be.colorSpace),$t=n.get(G),vt=n.get(be);if(vt.__renderTarget=G,!$t.__hasExternalTextures){const ct=Math.max(1,G.width>>Qe),Bt=Math.max(1,G.height>>Qe);ot===i.TEXTURE_3D||ot===i.TEXTURE_2D_ARRAY?t.texImage3D(ot,Qe,Vt,ct,Bt,G.depth,0,Ut,Rt,null):t.texImage2D(ot,Qe,Vt,ct,Bt,0,Ut,Rt,null)}t.bindFramebuffer(i.FRAMEBUFFER,te),Gt(G)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ye,ot,vt.__webglTexture,0,oe(G)):(ot===i.TEXTURE_2D||ot>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ot<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Ye,ot,vt.__webglTexture,Qe),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ee(te,G,be){if(i.bindRenderbuffer(i.RENDERBUFFER,te),G.depthBuffer){const Ye=G.depthTexture,ot=Ye&&Ye.isDepthTexture?Ye.type:null,Qe=O(G.stencilBuffer,ot),Ut=G.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;Gt(G)?u.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,oe(G),Qe,G.width,G.height):be?i.renderbufferStorageMultisample(i.RENDERBUFFER,oe(G),Qe,G.width,G.height):i.renderbufferStorage(i.RENDERBUFFER,Qe,G.width,G.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ut,i.RENDERBUFFER,te)}else{const Ye=G.textures;for(let ot=0;ot<Ye.length;ot++){const Qe=Ye[ot],Ut=s.convert(Qe.format,Qe.colorSpace),Rt=s.convert(Qe.type),Vt=I(Qe.internalFormat,Ut,Rt,Qe.colorSpace);Gt(G)?u.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,oe(G),Vt,G.width,G.height):be?i.renderbufferStorageMultisample(i.RENDERBUFFER,oe(G),Vt,G.width,G.height):i.renderbufferStorage(i.RENDERBUFFER,Vt,G.width,G.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function yt(te,G,be){const Ye=G.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,te),!(G.depthTexture&&G.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ot=n.get(G.depthTexture);if(ot.__renderTarget=G,(!ot.__webglTexture||G.depthTexture.image.width!==G.width||G.depthTexture.image.height!==G.height)&&(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),Ye){if(ot.__webglInit===void 0&&(ot.__webglInit=!0,G.depthTexture.addEventListener("dispose",z)),ot.__webglTexture===void 0){ot.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,ot.__webglTexture),me(i.TEXTURE_CUBE_MAP,G.depthTexture);const $t=s.convert(G.depthTexture.format),vt=s.convert(G.depthTexture.type);let ct;G.depthTexture.format===rc?ct=i.DEPTH_COMPONENT24:G.depthTexture.format===nu&&(ct=i.DEPTH24_STENCIL8);for(let Bt=0;Bt<6;Bt++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Bt,0,ct,G.width,G.height,0,$t,vt,null)}}else fe(G.depthTexture,0);const Qe=ot.__webglTexture,Ut=oe(G),Rt=Ye?i.TEXTURE_CUBE_MAP_POSITIVE_X+be:i.TEXTURE_2D,Vt=G.depthTexture.format===nu?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(G.depthTexture.format===rc)Gt(G)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Vt,Rt,Qe,0,Ut):i.framebufferTexture2D(i.FRAMEBUFFER,Vt,Rt,Qe,0);else if(G.depthTexture.format===nu)Gt(G)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Vt,Rt,Qe,0,Ut):i.framebufferTexture2D(i.FRAMEBUFFER,Vt,Rt,Qe,0);else throw new Error("Unknown depthTexture format")}function Pt(te){const G=n.get(te),be=te.isWebGLCubeRenderTarget===!0;if(G.__boundDepthTexture!==te.depthTexture){const Ye=te.depthTexture;if(G.__depthDisposeCallback&&G.__depthDisposeCallback(),Ye){const ot=()=>{delete G.__boundDepthTexture,delete G.__depthDisposeCallback,Ye.removeEventListener("dispose",ot)};Ye.addEventListener("dispose",ot),G.__depthDisposeCallback=ot}G.__boundDepthTexture=Ye}if(te.depthTexture&&!G.__autoAllocateDepthBuffer)if(be)for(let Ye=0;Ye<6;Ye++)yt(G.__webglFramebuffer[Ye],te,Ye);else{const Ye=te.texture.mipmaps;Ye&&Ye.length>0?yt(G.__webglFramebuffer[0],te,0):yt(G.__webglFramebuffer,te,0)}else if(be){G.__webglDepthbuffer=[];for(let Ye=0;Ye<6;Ye++)if(t.bindFramebuffer(i.FRAMEBUFFER,G.__webglFramebuffer[Ye]),G.__webglDepthbuffer[Ye]===void 0)G.__webglDepthbuffer[Ye]=i.createRenderbuffer(),Ee(G.__webglDepthbuffer[Ye],te,!1);else{const ot=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Qe=G.__webglDepthbuffer[Ye];i.bindRenderbuffer(i.RENDERBUFFER,Qe),i.framebufferRenderbuffer(i.FRAMEBUFFER,ot,i.RENDERBUFFER,Qe)}}else{const Ye=te.texture.mipmaps;if(Ye&&Ye.length>0?t.bindFramebuffer(i.FRAMEBUFFER,G.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,G.__webglFramebuffer),G.__webglDepthbuffer===void 0)G.__webglDepthbuffer=i.createRenderbuffer(),Ee(G.__webglDepthbuffer,te,!1);else{const ot=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Qe=G.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Qe),i.framebufferRenderbuffer(i.FRAMEBUFFER,ot,i.RENDERBUFFER,Qe)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ot(te,G,be){const Ye=n.get(te);G!==void 0&&dt(Ye.__webglFramebuffer,te,te.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),be!==void 0&&Pt(te)}function Mt(te){const G=te.texture,be=n.get(te),Ye=n.get(G);te.addEventListener("dispose",j);const ot=te.textures,Qe=te.isWebGLCubeRenderTarget===!0,Ut=ot.length>1;if(Ut||(Ye.__webglTexture===void 0&&(Ye.__webglTexture=i.createTexture()),Ye.__version=G.version,o.memory.textures++),Qe){be.__webglFramebuffer=[];for(let Rt=0;Rt<6;Rt++)if(G.mipmaps&&G.mipmaps.length>0){be.__webglFramebuffer[Rt]=[];for(let Vt=0;Vt<G.mipmaps.length;Vt++)be.__webglFramebuffer[Rt][Vt]=i.createFramebuffer()}else be.__webglFramebuffer[Rt]=i.createFramebuffer()}else{if(G.mipmaps&&G.mipmaps.length>0){be.__webglFramebuffer=[];for(let Rt=0;Rt<G.mipmaps.length;Rt++)be.__webglFramebuffer[Rt]=i.createFramebuffer()}else be.__webglFramebuffer=i.createFramebuffer();if(Ut)for(let Rt=0,Vt=ot.length;Rt<Vt;Rt++){const $t=n.get(ot[Rt]);$t.__webglTexture===void 0&&($t.__webglTexture=i.createTexture(),o.memory.textures++)}if(te.samples>0&&Gt(te)===!1){be.__webglMultisampledFramebuffer=i.createFramebuffer(),be.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,be.__webglMultisampledFramebuffer);for(let Rt=0;Rt<ot.length;Rt++){const Vt=ot[Rt];be.__webglColorRenderbuffer[Rt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,be.__webglColorRenderbuffer[Rt]);const $t=s.convert(Vt.format,Vt.colorSpace),vt=s.convert(Vt.type),ct=I(Vt.internalFormat,$t,vt,Vt.colorSpace,te.isXRRenderTarget===!0),Bt=oe(te);i.renderbufferStorageMultisample(i.RENDERBUFFER,Bt,ct,te.width,te.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Rt,i.RENDERBUFFER,be.__webglColorRenderbuffer[Rt])}i.bindRenderbuffer(i.RENDERBUFFER,null),te.depthBuffer&&(be.__webglDepthRenderbuffer=i.createRenderbuffer(),Ee(be.__webglDepthRenderbuffer,te,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Qe){t.bindTexture(i.TEXTURE_CUBE_MAP,Ye.__webglTexture),me(i.TEXTURE_CUBE_MAP,G);for(let Rt=0;Rt<6;Rt++)if(G.mipmaps&&G.mipmaps.length>0)for(let Vt=0;Vt<G.mipmaps.length;Vt++)dt(be.__webglFramebuffer[Rt][Vt],te,G,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Rt,Vt);else dt(be.__webglFramebuffer[Rt],te,G,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Rt,0);M(G)&&E(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ut){for(let Rt=0,Vt=ot.length;Rt<Vt;Rt++){const $t=ot[Rt],vt=n.get($t);let ct=i.TEXTURE_2D;(te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(ct=te.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(ct,vt.__webglTexture),me(ct,$t),dt(be.__webglFramebuffer,te,$t,i.COLOR_ATTACHMENT0+Rt,ct,0),M($t)&&E(ct)}t.unbindTexture()}else{let Rt=i.TEXTURE_2D;if((te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(Rt=te.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Rt,Ye.__webglTexture),me(Rt,G),G.mipmaps&&G.mipmaps.length>0)for(let Vt=0;Vt<G.mipmaps.length;Vt++)dt(be.__webglFramebuffer[Vt],te,G,i.COLOR_ATTACHMENT0,Rt,Vt);else dt(be.__webglFramebuffer,te,G,i.COLOR_ATTACHMENT0,Rt,0);M(G)&&E(Rt),t.unbindTexture()}te.depthBuffer&&Pt(te)}function je(te){const G=te.textures;for(let be=0,Ye=G.length;be<Ye;be++){const ot=G[be];if(M(ot)){const Qe=R(te),Ut=n.get(ot).__webglTexture;t.bindTexture(Qe,Ut),E(Qe),t.unbindTexture()}}}const st=[],et=[];function At(te){if(te.samples>0){if(Gt(te)===!1){const G=te.textures,be=te.width,Ye=te.height;let ot=i.COLOR_BUFFER_BIT;const Qe=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ut=n.get(te),Rt=G.length>1;if(Rt)for(let $t=0;$t<G.length;$t++)t.bindFramebuffer(i.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ut.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer);const Vt=te.texture.mipmaps;Vt&&Vt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ut.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ut.__webglFramebuffer);for(let $t=0;$t<G.length;$t++){if(te.resolveDepthBuffer&&(te.depthBuffer&&(ot|=i.DEPTH_BUFFER_BIT),te.stencilBuffer&&te.resolveStencilBuffer&&(ot|=i.STENCIL_BUFFER_BIT)),Rt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ut.__webglColorRenderbuffer[$t]);const vt=n.get(G[$t]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,vt,0)}i.blitFramebuffer(0,0,be,Ye,0,0,be,Ye,ot,i.NEAREST),f===!0&&(st.length=0,et.length=0,st.push(i.COLOR_ATTACHMENT0+$t),te.depthBuffer&&te.resolveDepthBuffer===!1&&(st.push(Qe),et.push(Qe),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,et)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,st))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Rt)for(let $t=0;$t<G.length;$t++){t.bindFramebuffer(i.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.RENDERBUFFER,Ut.__webglColorRenderbuffer[$t]);const vt=n.get(G[$t]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ut.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.TEXTURE_2D,vt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer)}else if(te.depthBuffer&&te.resolveDepthBuffer===!1&&f){const G=te.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[G])}}}function oe(te){return Math.min(r.maxSamples,te.samples)}function Gt(te){const G=n.get(te);return te.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&G.__useRenderToTexture!==!1}function Dt(te){const G=o.render.frame;g.get(te)!==G&&(g.set(te,G),te.update())}function qt(te,G){const be=te.colorSpace,Ye=te.format,ot=te.type;return te.isCompressedTexture===!0||te.isVideoTexture===!0||be!==kr&&be!==Ja&&($n.getTransfer(be)===yi?(Ye!==Ai||ot!==_i)&&Ht("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):nn("WebGLTextures: Unsupported texture color space:",be)),G}function Tt(te){return typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement?(p.width=te.naturalWidth||te.width,p.height=te.naturalHeight||te.height):typeof VideoFrame<"u"&&te instanceof VideoFrame?(p.width=te.displayWidth,p.height=te.displayHeight):(p.width=te.width,p.height=te.height),p}this.allocateTextureUnit=ce,this.resetTextureUnits=de,this.setTexture2D=fe,this.setTexture2DArray=X,this.setTexture3D=re,this.setTextureCube=ge,this.rebindTextures=Ot,this.setupRenderTarget=Mt,this.updateRenderTargetMipmap=je,this.updateMultisampleRenderTarget=At,this.setupDepthRenderbuffer=Pt,this.setupFrameBufferTexture=dt,this.useMultisampledRTT=Gt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function H4(i,e){function t(n,r=Ja){let s;const o=$n.getTransfer(r);if(n===_i)return i.UNSIGNED_BYTE;if(n===p_)return i.UNSIGNED_SHORT_4_4_4_4;if(n===m_)return i.UNSIGNED_SHORT_5_5_5_1;if(n===LM)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===PM)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===Iv)return i.BYTE;if(n===Bv)return i.SHORT;if(n===Kf)return i.UNSIGNED_SHORT;if(n===Im)return i.INT;if(n===ca)return i.UNSIGNED_INT;if(n===si)return i.FLOAT;if(n===On)return i.HALF_FLOAT;if(n===UM)return i.ALPHA;if(n===FM)return i.RGB;if(n===Ai)return i.RGBA;if(n===rc)return i.DEPTH_COMPONENT;if(n===nu)return i.DEPTH_STENCIL;if(n===tc)return i.RED;if(n===Nv)return i.RED_INTEGER;if(n===Bo)return i.RG;if(n===g_)return i.RG_INTEGER;if(n===v_)return i.RGBA_INTEGER;if(n===qg||n===Jg||n===Kg||n===Zg)if(o===yi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===qg)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Jg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Kg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Zg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===qg)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Jg)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Kg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Zg)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===lA||n===cA||n===uA||n===dA)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===lA)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===cA)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===uA)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===dA)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===fA||n===hA||n===pA||n===mA||n===gA||n===vA||n===xA)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===fA||n===hA)return o===yi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===pA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===mA)return s.COMPRESSED_R11_EAC;if(n===gA)return s.COMPRESSED_SIGNED_R11_EAC;if(n===vA)return s.COMPRESSED_RG11_EAC;if(n===xA)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===yA||n===AA||n===_A||n===SA||n===bA||n===EA||n===MA||n===TA||n===wA||n===CA||n===RA||n===DA||n===IA||n===BA)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===yA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===AA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===_A)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===SA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===bA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===EA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===MA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===TA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===wA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===CA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===RA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===DA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===IA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===BA)return o===yi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===NA||n===OA||n===LA)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===NA)return o===yi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===OA)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===LA)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===PA||n===UA||n===FA||n===zA)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===PA)return s.COMPRESSED_RED_RGTC1_EXT;if(n===UA)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===FA)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===zA)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Zf?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const r9=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,s9=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class a9{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new KM(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new ai({vertexShader:r9,fragmentShader:s9,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Oi(new lc(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class o9 extends eo{constructor(e,t){super();const n=this;let r=null,s=1,o=null,u="local-floor",f=1,p=null,g=null,v=null,y=null,A=null,S=null;const T=typeof XRWebGLBinding<"u",M=new a9,E={},R=t.getContextAttributes();let I=null,O=null;const F=[],z=[],j=new qe;let W=null;const L=new ki;L.viewport=new Ti;const H=new ki;H.viewport=new Ti;const K=[L,H],de=new D4;let ce=null,ne=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ve){let ze=F[ve];return ze===void 0&&(ze=new Yy,F[ve]=ze),ze.getTargetRaySpace()},this.getControllerGrip=function(ve){let ze=F[ve];return ze===void 0&&(ze=new Yy,F[ve]=ze),ze.getGripSpace()},this.getHand=function(ve){let ze=F[ve];return ze===void 0&&(ze=new Yy,F[ve]=ze),ze.getHandSpace()};function fe(ve){const ze=z.indexOf(ve.inputSource);if(ze===-1)return;const dt=F[ze];dt!==void 0&&(dt.update(ve.inputSource,ve.frame,p||o),dt.dispatchEvent({type:ve.type,data:ve.inputSource}))}function X(){r.removeEventListener("select",fe),r.removeEventListener("selectstart",fe),r.removeEventListener("selectend",fe),r.removeEventListener("squeeze",fe),r.removeEventListener("squeezestart",fe),r.removeEventListener("squeezeend",fe),r.removeEventListener("end",X),r.removeEventListener("inputsourceschange",re);for(let ve=0;ve<F.length;ve++){const ze=z[ve];ze!==null&&(z[ve]=null,F[ve].disconnect(ze))}ce=null,ne=null,M.reset();for(const ve in E)delete E[ve];e.setRenderTarget(I),A=null,y=null,v=null,r=null,O=null,xt.stop(),n.isPresenting=!1,e.setPixelRatio(W),e.setSize(j.width,j.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ve){s=ve,n.isPresenting===!0&&Ht("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ve){u=ve,n.isPresenting===!0&&Ht("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||o},this.setReferenceSpace=function(ve){p=ve},this.getBaseLayer=function(){return y!==null?y:A},this.getBinding=function(){return v===null&&T&&(v=new XRWebGLBinding(r,t)),v},this.getFrame=function(){return S},this.getSession=function(){return r},this.setSession=async function(ve){if(r=ve,r!==null){if(I=e.getRenderTarget(),r.addEventListener("select",fe),r.addEventListener("selectstart",fe),r.addEventListener("selectend",fe),r.addEventListener("squeeze",fe),r.addEventListener("squeezestart",fe),r.addEventListener("squeezeend",fe),r.addEventListener("end",X),r.addEventListener("inputsourceschange",re),R.xrCompatible!==!0&&await t.makeXRCompatible(),W=e.getPixelRatio(),e.getSize(j),T&&"createProjectionLayer"in XRWebGLBinding.prototype){let dt=null,Ee=null,yt=null;R.depth&&(yt=R.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,dt=R.stencil?nu:rc,Ee=R.stencil?Zf:ca);const Pt={colorFormat:t.RGBA8,depthFormat:yt,scaleFactor:s};v=this.getBinding(),y=v.createProjectionLayer(Pt),r.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),O=new ti(y.textureWidth,y.textureHeight,{format:Ai,type:_i,depthTexture:new _d(y.textureWidth,y.textureHeight,Ee,void 0,void 0,void 0,void 0,void 0,void 0,dt),stencilBuffer:R.stencil,colorSpace:e.outputColorSpace,samples:R.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}else{const dt={antialias:R.antialias,alpha:!0,depth:R.depth,stencil:R.stencil,framebufferScaleFactor:s};A=new XRWebGLLayer(r,t,dt),r.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),O=new ti(A.framebufferWidth,A.framebufferHeight,{format:Ai,type:_i,colorSpace:e.outputColorSpace,stencilBuffer:R.stencil,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}O.isXRRenderTarget=!0,this.setFoveation(f),p=null,o=await r.requestReferenceSpace(u),xt.setContext(r),xt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return M.getDepthTexture()};function re(ve){for(let ze=0;ze<ve.removed.length;ze++){const dt=ve.removed[ze],Ee=z.indexOf(dt);Ee>=0&&(z[Ee]=null,F[Ee].disconnect(dt))}for(let ze=0;ze<ve.added.length;ze++){const dt=ve.added[ze];let Ee=z.indexOf(dt);if(Ee===-1){for(let Pt=0;Pt<F.length;Pt++)if(Pt>=z.length){z.push(dt),Ee=Pt;break}else if(z[Pt]===null){z[Pt]=dt,Ee=Pt;break}if(Ee===-1)break}const yt=F[Ee];yt&&yt.connect(dt)}}const ge=new Q,Te=new Q;function Se(ve,ze,dt){ge.setFromMatrixPosition(ze.matrixWorld),Te.setFromMatrixPosition(dt.matrixWorld);const Ee=ge.distanceTo(Te),yt=ze.projectionMatrix.elements,Pt=dt.projectionMatrix.elements,Ot=yt[14]/(yt[10]-1),Mt=yt[14]/(yt[10]+1),je=(yt[9]+1)/yt[5],st=(yt[9]-1)/yt[5],et=(yt[8]-1)/yt[0],At=(Pt[8]+1)/Pt[0],oe=Ot*et,Gt=Ot*At,Dt=Ee/(-et+At),qt=Dt*-et;if(ze.matrixWorld.decompose(ve.position,ve.quaternion,ve.scale),ve.translateX(qt),ve.translateZ(Dt),ve.matrixWorld.compose(ve.position,ve.quaternion,ve.scale),ve.matrixWorldInverse.copy(ve.matrixWorld).invert(),yt[10]===-1)ve.projectionMatrix.copy(ze.projectionMatrix),ve.projectionMatrixInverse.copy(ze.projectionMatrixInverse);else{const Tt=Ot+Dt,te=Mt+Dt,G=oe-qt,be=Gt+(Ee-qt),Ye=je*Mt/te*Tt,ot=st*Mt/te*Tt;ve.projectionMatrix.makePerspective(G,be,Ye,ot,Tt,te),ve.projectionMatrixInverse.copy(ve.projectionMatrix).invert()}}function Y(ve,ze){ze===null?ve.matrixWorld.copy(ve.matrix):ve.matrixWorld.multiplyMatrices(ze.matrixWorld,ve.matrix),ve.matrixWorldInverse.copy(ve.matrixWorld).invert()}this.updateCamera=function(ve){if(r===null)return;let ze=ve.near,dt=ve.far;M.texture!==null&&(M.depthNear>0&&(ze=M.depthNear),M.depthFar>0&&(dt=M.depthFar)),de.near=H.near=L.near=ze,de.far=H.far=L.far=dt,(ce!==de.near||ne!==de.far)&&(r.updateRenderState({depthNear:de.near,depthFar:de.far}),ce=de.near,ne=de.far),de.layers.mask=ve.layers.mask|6,L.layers.mask=de.layers.mask&3,H.layers.mask=de.layers.mask&5;const Ee=ve.parent,yt=de.cameras;Y(de,Ee);for(let Pt=0;Pt<yt.length;Pt++)Y(yt[Pt],Ee);yt.length===2?Se(de,L,H):de.projectionMatrix.copy(L.projectionMatrix),me(ve,de,Ee)};function me(ve,ze,dt){dt===null?ve.matrix.copy(ze.matrixWorld):(ve.matrix.copy(dt.matrixWorld),ve.matrix.invert(),ve.matrix.multiply(ze.matrixWorld)),ve.matrix.decompose(ve.position,ve.quaternion,ve.scale),ve.updateMatrixWorld(!0),ve.projectionMatrix.copy(ze.projectionMatrix),ve.projectionMatrixInverse.copy(ze.projectionMatrixInverse),ve.isPerspectiveCamera&&(ve.fov=Am*2*Math.atan(1/ve.projectionMatrix.elements[5]),ve.zoom=1)}this.getCamera=function(){return de},this.getFoveation=function(){if(!(y===null&&A===null))return f},this.setFoveation=function(ve){f=ve,y!==null&&(y.fixedFoveation=ve),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=ve)},this.hasDepthSensing=function(){return M.texture!==null},this.getDepthSensingMesh=function(){return M.getMesh(de)},this.getCameraTexture=function(ve){return E[ve]};let Ce=null;function Ze(ve,ze){if(g=ze.getViewerPose(p||o),S=ze,g!==null){const dt=g.views;A!==null&&(e.setRenderTargetFramebuffer(O,A.framebuffer),e.setRenderTarget(O));let Ee=!1;dt.length!==de.cameras.length&&(de.cameras.length=0,Ee=!0);for(let Mt=0;Mt<dt.length;Mt++){const je=dt[Mt];let st=null;if(A!==null)st=A.getViewport(je);else{const At=v.getViewSubImage(y,je);st=At.viewport,Mt===0&&(e.setRenderTargetTextures(O,At.colorTexture,At.depthStencilTexture),e.setRenderTarget(O))}let et=K[Mt];et===void 0&&(et=new ki,et.layers.enable(Mt),et.viewport=new Ti,K[Mt]=et),et.matrix.fromArray(je.transform.matrix),et.matrix.decompose(et.position,et.quaternion,et.scale),et.projectionMatrix.fromArray(je.projectionMatrix),et.projectionMatrixInverse.copy(et.projectionMatrix).invert(),et.viewport.set(st.x,st.y,st.width,st.height),Mt===0&&(de.matrix.copy(et.matrix),de.matrix.decompose(de.position,de.quaternion,de.scale)),Ee===!0&&de.cameras.push(et)}const yt=r.enabledFeatures;if(yt&&yt.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&T){v=n.getBinding();const Mt=v.getDepthInformation(dt[0]);Mt&&Mt.isValid&&Mt.texture&&M.init(Mt,r.renderState)}if(yt&&yt.includes("camera-access")&&T){e.state.unbindTexture(),v=n.getBinding();for(let Mt=0;Mt<dt.length;Mt++){const je=dt[Mt].camera;if(je){let st=E[je];st||(st=new KM,E[je]=st);const et=v.getCameraImage(je);st.sourceTexture=et}}}}for(let dt=0;dt<F.length;dt++){const Ee=z[dt],yt=F[dt];Ee!==null&&yt!==void 0&&yt.update(Ee,ze,p||o)}Ce&&Ce(ve,ze),ze.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:ze}),S=null}const xt=new L4;xt.setAnimationLoop(Ze),this.setAnimationLoop=function(ve){Ce=ve},this.dispose=function(){}}}const wf=new Ga,l9=new jt;function c9(i,e){function t(M,E){M.matrixAutoUpdate===!0&&M.updateMatrix(),E.value.copy(M.matrix)}function n(M,E){E.color.getRGB(M.fogColor.value,Q2(i)),E.isFog?(M.fogNear.value=E.near,M.fogFar.value=E.far):E.isFogExp2&&(M.fogDensity.value=E.density)}function r(M,E,R,I,O){E.isMeshBasicMaterial||E.isMeshLambertMaterial?s(M,E):E.isMeshToonMaterial?(s(M,E),v(M,E)):E.isMeshPhongMaterial?(s(M,E),g(M,E)):E.isMeshStandardMaterial?(s(M,E),y(M,E),E.isMeshPhysicalMaterial&&A(M,E,O)):E.isMeshMatcapMaterial?(s(M,E),S(M,E)):E.isMeshDepthMaterial?s(M,E):E.isMeshDistanceMaterial?(s(M,E),T(M,E)):E.isMeshNormalMaterial?s(M,E):E.isLineBasicMaterial?(o(M,E),E.isLineDashedMaterial&&u(M,E)):E.isPointsMaterial?f(M,E,R,I):E.isSpriteMaterial?p(M,E):E.isShadowMaterial?(M.color.value.copy(E.color),M.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function s(M,E){M.opacity.value=E.opacity,E.color&&M.diffuse.value.copy(E.color),E.emissive&&M.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(M.map.value=E.map,t(E.map,M.mapTransform)),E.alphaMap&&(M.alphaMap.value=E.alphaMap,t(E.alphaMap,M.alphaMapTransform)),E.bumpMap&&(M.bumpMap.value=E.bumpMap,t(E.bumpMap,M.bumpMapTransform),M.bumpScale.value=E.bumpScale,E.side===jr&&(M.bumpScale.value*=-1)),E.normalMap&&(M.normalMap.value=E.normalMap,t(E.normalMap,M.normalMapTransform),M.normalScale.value.copy(E.normalScale),E.side===jr&&M.normalScale.value.negate()),E.displacementMap&&(M.displacementMap.value=E.displacementMap,t(E.displacementMap,M.displacementMapTransform),M.displacementScale.value=E.displacementScale,M.displacementBias.value=E.displacementBias),E.emissiveMap&&(M.emissiveMap.value=E.emissiveMap,t(E.emissiveMap,M.emissiveMapTransform)),E.specularMap&&(M.specularMap.value=E.specularMap,t(E.specularMap,M.specularMapTransform)),E.alphaTest>0&&(M.alphaTest.value=E.alphaTest);const R=e.get(E),I=R.envMap,O=R.envMapRotation;I&&(M.envMap.value=I,wf.copy(O),wf.x*=-1,wf.y*=-1,wf.z*=-1,I.isCubeTexture&&I.isRenderTargetTexture===!1&&(wf.y*=-1,wf.z*=-1),M.envMapRotation.value.setFromMatrix4(l9.makeRotationFromEuler(wf)),M.flipEnvMap.value=I.isCubeTexture&&I.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=E.reflectivity,M.ior.value=E.ior,M.refractionRatio.value=E.refractionRatio),E.lightMap&&(M.lightMap.value=E.lightMap,M.lightMapIntensity.value=E.lightMapIntensity,t(E.lightMap,M.lightMapTransform)),E.aoMap&&(M.aoMap.value=E.aoMap,M.aoMapIntensity.value=E.aoMapIntensity,t(E.aoMap,M.aoMapTransform))}function o(M,E){M.diffuse.value.copy(E.color),M.opacity.value=E.opacity,E.map&&(M.map.value=E.map,t(E.map,M.mapTransform))}function u(M,E){M.dashSize.value=E.dashSize,M.totalSize.value=E.dashSize+E.gapSize,M.scale.value=E.scale}function f(M,E,R,I){M.diffuse.value.copy(E.color),M.opacity.value=E.opacity,M.size.value=E.size*R,M.scale.value=I*.5,E.map&&(M.map.value=E.map,t(E.map,M.uvTransform)),E.alphaMap&&(M.alphaMap.value=E.alphaMap,t(E.alphaMap,M.alphaMapTransform)),E.alphaTest>0&&(M.alphaTest.value=E.alphaTest)}function p(M,E){M.diffuse.value.copy(E.color),M.opacity.value=E.opacity,M.rotation.value=E.rotation,E.map&&(M.map.value=E.map,t(E.map,M.mapTransform)),E.alphaMap&&(M.alphaMap.value=E.alphaMap,t(E.alphaMap,M.alphaMapTransform)),E.alphaTest>0&&(M.alphaTest.value=E.alphaTest)}function g(M,E){M.specular.value.copy(E.specular),M.shininess.value=Math.max(E.shininess,1e-4)}function v(M,E){E.gradientMap&&(M.gradientMap.value=E.gradientMap)}function y(M,E){M.metalness.value=E.metalness,E.metalnessMap&&(M.metalnessMap.value=E.metalnessMap,t(E.metalnessMap,M.metalnessMapTransform)),M.roughness.value=E.roughness,E.roughnessMap&&(M.roughnessMap.value=E.roughnessMap,t(E.roughnessMap,M.roughnessMapTransform)),E.envMap&&(M.envMapIntensity.value=E.envMapIntensity)}function A(M,E,R){M.ior.value=E.ior,E.sheen>0&&(M.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),M.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(M.sheenColorMap.value=E.sheenColorMap,t(E.sheenColorMap,M.sheenColorMapTransform)),E.sheenRoughnessMap&&(M.sheenRoughnessMap.value=E.sheenRoughnessMap,t(E.sheenRoughnessMap,M.sheenRoughnessMapTransform))),E.clearcoat>0&&(M.clearcoat.value=E.clearcoat,M.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(M.clearcoatMap.value=E.clearcoatMap,t(E.clearcoatMap,M.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,t(E.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(M.clearcoatNormalMap.value=E.clearcoatNormalMap,t(E.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===jr&&M.clearcoatNormalScale.value.negate())),E.dispersion>0&&(M.dispersion.value=E.dispersion),E.iridescence>0&&(M.iridescence.value=E.iridescence,M.iridescenceIOR.value=E.iridescenceIOR,M.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(M.iridescenceMap.value=E.iridescenceMap,t(E.iridescenceMap,M.iridescenceMapTransform)),E.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=E.iridescenceThicknessMap,t(E.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),E.transmission>0&&(M.transmission.value=E.transmission,M.transmissionSamplerMap.value=R.texture,M.transmissionSamplerSize.value.set(R.width,R.height),E.transmissionMap&&(M.transmissionMap.value=E.transmissionMap,t(E.transmissionMap,M.transmissionMapTransform)),M.thickness.value=E.thickness,E.thicknessMap&&(M.thicknessMap.value=E.thicknessMap,t(E.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=E.attenuationDistance,M.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(M.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(M.anisotropyMap.value=E.anisotropyMap,t(E.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=E.specularIntensity,M.specularColor.value.copy(E.specularColor),E.specularColorMap&&(M.specularColorMap.value=E.specularColorMap,t(E.specularColorMap,M.specularColorMapTransform)),E.specularIntensityMap&&(M.specularIntensityMap.value=E.specularIntensityMap,t(E.specularIntensityMap,M.specularIntensityMapTransform))}function S(M,E){E.matcap&&(M.matcap.value=E.matcap)}function T(M,E){const R=e.get(E).light;M.referencePosition.value.setFromMatrixPosition(R.matrixWorld),M.nearDistance.value=R.shadow.camera.near,M.farDistance.value=R.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function u9(i,e,t,n){let r={},s={},o=[];const u=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function f(R,I){const O=I.program;n.uniformBlockBinding(R,O)}function p(R,I){let O=r[R.id];O===void 0&&(S(R),O=g(R),r[R.id]=O,R.addEventListener("dispose",M));const F=I.program;n.updateUBOMapping(R,F);const z=e.render.frame;s[R.id]!==z&&(y(R),s[R.id]=z)}function g(R){const I=v();R.__bindingPointIndex=I;const O=i.createBuffer(),F=R.__size,z=R.usage;return i.bindBuffer(i.UNIFORM_BUFFER,O),i.bufferData(i.UNIFORM_BUFFER,F,z),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,I,O),O}function v(){for(let R=0;R<u;R++)if(o.indexOf(R)===-1)return o.push(R),R;return nn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(R){const I=r[R.id],O=R.uniforms,F=R.__cache;i.bindBuffer(i.UNIFORM_BUFFER,I);for(let z=0,j=O.length;z<j;z++){const W=Array.isArray(O[z])?O[z]:[O[z]];for(let L=0,H=W.length;L<H;L++){const K=W[L];if(A(K,z,L,F)===!0){const de=K.__offset,ce=Array.isArray(K.value)?K.value:[K.value];let ne=0;for(let fe=0;fe<ce.length;fe++){const X=ce[fe],re=T(X);typeof X=="number"||typeof X=="boolean"?(K.__data[0]=X,i.bufferSubData(i.UNIFORM_BUFFER,de+ne,K.__data)):X.isMatrix3?(K.__data[0]=X.elements[0],K.__data[1]=X.elements[1],K.__data[2]=X.elements[2],K.__data[3]=0,K.__data[4]=X.elements[3],K.__data[5]=X.elements[4],K.__data[6]=X.elements[5],K.__data[7]=0,K.__data[8]=X.elements[6],K.__data[9]=X.elements[7],K.__data[10]=X.elements[8],K.__data[11]=0):(X.toArray(K.__data,ne),ne+=re.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,de,K.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function A(R,I,O,F){const z=R.value,j=I+"_"+O;if(F[j]===void 0)return typeof z=="number"||typeof z=="boolean"?F[j]=z:F[j]=z.clone(),!0;{const W=F[j];if(typeof z=="number"||typeof z=="boolean"){if(W!==z)return F[j]=z,!0}else if(W.equals(z)===!1)return W.copy(z),!0}return!1}function S(R){const I=R.uniforms;let O=0;const F=16;for(let j=0,W=I.length;j<W;j++){const L=Array.isArray(I[j])?I[j]:[I[j]];for(let H=0,K=L.length;H<K;H++){const de=L[H],ce=Array.isArray(de.value)?de.value:[de.value];for(let ne=0,fe=ce.length;ne<fe;ne++){const X=ce[ne],re=T(X),ge=O%F,Te=ge%re.boundary,Se=ge+Te;O+=Te,Se!==0&&F-Se<re.storage&&(O+=F-Se),de.__data=new Float32Array(re.storage/Float32Array.BYTES_PER_ELEMENT),de.__offset=O,O+=re.storage}}}const z=O%F;return z>0&&(O+=F-z),R.__size=O,R.__cache={},this}function T(R){const I={boundary:0,storage:0};return typeof R=="number"||typeof R=="boolean"?(I.boundary=4,I.storage=4):R.isVector2?(I.boundary=8,I.storage=8):R.isVector3||R.isColor?(I.boundary=16,I.storage=12):R.isVector4?(I.boundary=16,I.storage=16):R.isMatrix3?(I.boundary=48,I.storage=48):R.isMatrix4?(I.boundary=64,I.storage=64):R.isTexture?Ht("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Ht("WebGLRenderer: Unsupported uniform value type.",R),I}function M(R){const I=R.target;I.removeEventListener("dispose",M);const O=o.indexOf(I.__bindingPointIndex);o.splice(O,1),i.deleteBuffer(r[I.id]),delete r[I.id],delete s[I.id]}function E(){for(const R in r)i.deleteBuffer(r[R]);o=[],r={},s={}}return{bind:f,update:p,dispose:E}}const d9=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Jl=null;function f9(){return Jl===null&&(Jl=new oa(d9,16,16,Bo,On),Jl.name="DFG_LUT",Jl.minFilter=on,Jl.magFilter=on,Jl.wrapS=Ni,Jl.wrapT=Ni,Jl.generateMipmaps=!1,Jl.needsUpdate=!0),Jl}class Y_{constructor(e={}){const{canvas:t=j2(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:u=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:p=!1,powerPreference:g="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:y=!1,outputBufferType:A=_i}=e;this.isWebGLRenderer=!0;let S;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");S=n.getContextAttributes().alpha}else S=o;const T=A,M=new Set([v_,g_,Nv]),E=new Set([_i,ca,Kf,Zf,p_,m_]),R=new Uint32Array(4),I=new Int32Array(4);let O=null,F=null;const z=[],j=[];let W=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=aa,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let H=!1;this._outputColorSpace=Hn;let K=0,de=0,ce=null,ne=-1,fe=null;const X=new Ti,re=new Ti;let ge=null;const Te=new Ft(0);let Se=0,Y=t.width,me=t.height,Ce=1,Ze=null,xt=null;const ve=new Ti(0,0,Y,me),ze=new Ti(0,0,Y,me);let dt=!1;const Ee=new Nm;let yt=!1,Pt=!1;const Ot=new jt,Mt=new Q,je=new Ti,st={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let et=!1;function At(){return ce===null?Ce:1}let oe=n;function Gt(P,Z){return t.getContext(P,Z)}try{const P={alpha:!0,depth:r,stencil:s,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:p,powerPreference:g,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${lu}`),t.addEventListener("webglcontextlost",Zt,!1),t.addEventListener("webglcontextrestored",yn,!1),t.addEventListener("webglcontextcreationerror",_n,!1),oe===null){const Z="webgl2";if(oe=Gt(Z,P),oe===null)throw Gt(Z)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(P){throw nn("WebGLRenderer: "+P.message),P}let Dt,qt,Tt,te,G,be,Ye,ot,Qe,Ut,Rt,Vt,$t,vt,ct,Bt,he,Be,ft,pe,Fe,Oe,It,_t;function ut(){Dt=new hP(oe),Dt.init(),Oe=new H4(oe,Dt),qt=new rP(oe,Dt,e,Oe),Tt=new n9(oe,Dt),qt.reversedDepthBuffer&&y&&Tt.buffers.depth.setReversed(!0),te=new gP(oe),G=new GU,be=new i9(oe,Dt,Tt,G,qt,Oe,te),Ye=new aP(L),ot=new fP(L),Qe=new A6(oe),It=new nP(oe,Qe),Ut=new pP(oe,Qe,te,It),Rt=new xP(oe,Ut,Qe,te),ft=new vP(oe,qt,be),Bt=new sP(G),Vt=new HU(L,Ye,ot,Dt,qt,It,Bt),$t=new c9(L,G),vt=new VU,ct=new qU(Dt),Be=new tP(L,Ye,ot,Tt,Rt,S,f),he=new e9(L,Rt,qt),_t=new u9(oe,te,qt,Tt),pe=new iP(oe,Dt,te),Fe=new mP(oe,Dt,te),te.programs=Vt.programs,L.capabilities=qt,L.extensions=Dt,L.properties=G,L.renderLists=vt,L.shadowMap=he,L.state=Tt,L.info=te}ut(),T!==_i&&(W=new AP(T,t.width,t.height,r,s));const wt=new o9(L,oe);this.xr=wt,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const P=Dt.get("WEBGL_lose_context");P&&P.loseContext()},this.forceContextRestore=function(){const P=Dt.get("WEBGL_lose_context");P&&P.restoreContext()},this.getPixelRatio=function(){return Ce},this.setPixelRatio=function(P){P!==void 0&&(Ce=P,this.setSize(Y,me,!1))},this.getSize=function(P){return P.set(Y,me)},this.setSize=function(P,Z,se=!0){if(wt.isPresenting){Ht("WebGLRenderer: Can't change size while VR device is presenting.");return}Y=P,me=Z,t.width=Math.floor(P*Ce),t.height=Math.floor(Z*Ce),se===!0&&(t.style.width=P+"px",t.style.height=Z+"px"),W!==null&&W.setSize(t.width,t.height),this.setViewport(0,0,P,Z)},this.getDrawingBufferSize=function(P){return P.set(Y*Ce,me*Ce).floor()},this.setDrawingBufferSize=function(P,Z,se){Y=P,me=Z,Ce=se,t.width=Math.floor(P*se),t.height=Math.floor(Z*se),this.setViewport(0,0,P,Z)},this.setEffects=function(P){if(T===_i){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(P){for(let Z=0;Z<P.length;Z++)if(P[Z].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}W.setEffects(P||[])},this.getCurrentViewport=function(P){return P.copy(X)},this.getViewport=function(P){return P.copy(ve)},this.setViewport=function(P,Z,se,ae){P.isVector4?ve.set(P.x,P.y,P.z,P.w):ve.set(P,Z,se,ae),Tt.viewport(X.copy(ve).multiplyScalar(Ce).round())},this.getScissor=function(P){return P.copy(ze)},this.setScissor=function(P,Z,se,ae){P.isVector4?ze.set(P.x,P.y,P.z,P.w):ze.set(P,Z,se,ae),Tt.scissor(re.copy(ze).multiplyScalar(Ce).round())},this.getScissorTest=function(){return dt},this.setScissorTest=function(P){Tt.setScissorTest(dt=P)},this.setOpaqueSort=function(P){Ze=P},this.setTransparentSort=function(P){xt=P},this.getClearColor=function(P){return P.copy(Be.getClearColor())},this.setClearColor=function(){Be.setClearColor(...arguments)},this.getClearAlpha=function(){return Be.getClearAlpha()},this.setClearAlpha=function(){Be.setClearAlpha(...arguments)},this.clear=function(P=!0,Z=!0,se=!0){let ae=0;if(P){let ie=!1;if(ce!==null){const we=ce.texture.format;ie=M.has(we)}if(ie){const we=ce.texture.type,Ie=E.has(we),Re=Be.getClearColor(),tt=Be.getClearAlpha(),He=Re.r,at=Re.g,nt=Re.b;Ie?(R[0]=He,R[1]=at,R[2]=nt,R[3]=tt,oe.clearBufferuiv(oe.COLOR,0,R)):(I[0]=He,I[1]=at,I[2]=nt,I[3]=tt,oe.clearBufferiv(oe.COLOR,0,I))}else ae|=oe.COLOR_BUFFER_BIT}Z&&(ae|=oe.DEPTH_BUFFER_BIT),se&&(ae|=oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),oe.clear(ae)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Zt,!1),t.removeEventListener("webglcontextrestored",yn,!1),t.removeEventListener("webglcontextcreationerror",_n,!1),Be.dispose(),vt.dispose(),ct.dispose(),G.dispose(),Ye.dispose(),ot.dispose(),Rt.dispose(),It.dispose(),_t.dispose(),Vt.dispose(),wt.dispose(),wt.removeEventListener("sessionstart",Xr),wt.removeEventListener("sessionend",is),rn.stop()};function Zt(P){P.preventDefault(),gv("WebGLRenderer: Context Lost."),H=!0}function yn(){gv("WebGLRenderer: Context Restored."),H=!1;const P=te.autoReset,Z=he.enabled,se=he.autoUpdate,ae=he.needsUpdate,ie=he.type;ut(),te.autoReset=P,he.enabled=Z,he.autoUpdate=se,he.needsUpdate=ae,he.type=ie}function _n(P){nn("WebGLRenderer: A WebGL context could not be created. Reason: ",P.statusMessage)}function Si(P){const Z=P.target;Z.removeEventListener("dispose",Si),ji(Z)}function ji(P){ha(P),G.remove(P)}function ha(P){const Z=G.get(P).programs;Z!==void 0&&(Z.forEach(function(se){Vt.releaseProgram(se)}),P.isShaderMaterial&&Vt.releaseShaderCache(P))}this.renderBufferDirect=function(P,Z,se,ae,ie,we){Z===null&&(Z=st);const Ie=ie.isMesh&&ie.matrixWorld.determinant()<0,Re=N(P,Z,se,ae,ie);Tt.setMaterial(ae,Ie);let tt=se.index,He=1;if(ae.wireframe===!0){if(tt=Ut.getWireframeAttribute(se),tt===void 0)return;He=2}const at=se.drawRange,nt=se.attributes.position;let Et=at.start*He,Wt=(at.start+at.count)*He;we!==null&&(Et=Math.max(Et,we.start*He),Wt=Math.min(Wt,(we.start+we.count)*He)),tt!==null?(Et=Math.max(Et,0),Wt=Math.min(Wt,tt.count)):nt!=null&&(Et=Math.max(Et,0),Wt=Math.min(Wt,nt.count));const ln=Wt-Et;if(ln<0||ln===1/0)return;It.setup(ie,ae,Re,se,tt);let Yt,mt=pe;if(tt!==null&&(Yt=Qe.get(tt),mt=Fe,mt.setIndex(Yt)),ie.isMesh)ae.wireframe===!0?(Tt.setLineWidth(ae.wireframeLinewidth*At()),mt.setMode(oe.LINES)):mt.setMode(oe.TRIANGLES);else if(ie.isLine){let ht=ae.linewidth;ht===void 0&&(ht=1),Tt.setLineWidth(ht*At()),ie.isLineSegments?mt.setMode(oe.LINES):ie.isLineLoop?mt.setMode(oe.LINE_LOOP):mt.setMode(oe.LINE_STRIP)}else ie.isPoints?mt.setMode(oe.POINTS):ie.isSprite&&mt.setMode(oe.TRIANGLES);if(ie.isBatchedMesh)if(ie._multiDrawInstances!==null)ym("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),mt.renderMultiDrawInstances(ie._multiDrawStarts,ie._multiDrawCounts,ie._multiDrawCount,ie._multiDrawInstances);else if(Dt.get("WEBGL_multi_draw"))mt.renderMultiDraw(ie._multiDrawStarts,ie._multiDrawCounts,ie._multiDrawCount);else{const ht=ie._multiDrawStarts,zt=ie._multiDrawCounts,St=ie._multiDrawCount,Qt=tt?Qe.get(tt).bytesPerElement:1,vn=G.get(ae).currentProgram.getUniforms();for(let fn=0;fn<St;fn++)vn.setValue(oe,"_gl_DrawID",fn),mt.render(ht[fn]/Qt,zt[fn])}else if(ie.isInstancedMesh)mt.renderInstances(Et,ln,ie.count);else if(se.isInstancedBufferGeometry){const ht=se._maxInstanceCount!==void 0?se._maxInstanceCount:1/0,zt=Math.min(se.instanceCount,ht);mt.renderInstances(Et,ln,zt)}else mt.render(Et,ln)};function pa(P,Z,se){P.transparent===!0&&P.side===Vr&&P.forceSinglePass===!1?(P.side=jr,P.needsUpdate=!0,Ge(P,Z,se),P.side=ml,P.needsUpdate=!0,Ge(P,Z,se),P.side=Vr):Ge(P,Z,se)}this.compile=function(P,Z,se=null){se===null&&(se=P),F=ct.get(se),F.init(Z),j.push(F),se.traverseVisible(function(ie){ie.isLight&&ie.layers.test(Z.layers)&&(F.pushLight(ie),ie.castShadow&&F.pushShadow(ie))}),P!==se&&P.traverseVisible(function(ie){ie.isLight&&ie.layers.test(Z.layers)&&(F.pushLight(ie),ie.castShadow&&F.pushShadow(ie))}),F.setupLights();const ae=new Set;return P.traverse(function(ie){if(!(ie.isMesh||ie.isPoints||ie.isLine||ie.isSprite))return;const we=ie.material;if(we)if(Array.isArray(we))for(let Ie=0;Ie<we.length;Ie++){const Re=we[Ie];pa(Re,se,ie),ae.add(Re)}else pa(we,se,ie),ae.add(we)}),F=j.pop(),ae},this.compileAsync=function(P,Z,se=null){const ae=this.compile(P,Z,se);return new Promise(ie=>{function we(){if(ae.forEach(function(Ie){G.get(Ie).currentProgram.isReady()&&ae.delete(Ie)}),ae.size===0){ie(P);return}setTimeout(we,10)}Dt.get("KHR_parallel_shader_compile")!==null?we():setTimeout(we,10)})};let Ts=null;function ma(P){Ts&&Ts(P)}function Xr(){rn.stop()}function is(){rn.start()}const rn=new L4;rn.setAnimationLoop(ma),typeof self<"u"&&rn.setContext(self),this.setAnimationLoop=function(P){Ts=P,wt.setAnimationLoop(P),P===null?rn.stop():rn.start()},wt.addEventListener("sessionstart",Xr),wt.addEventListener("sessionend",is),this.render=function(P,Z){if(Z!==void 0&&Z.isCamera!==!0){nn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;const se=wt.enabled===!0&&wt.isPresenting===!0,ae=W!==null&&(ce===null||se)&&W.begin(L,ce);if(P.matrixWorldAutoUpdate===!0&&P.updateMatrixWorld(),Z.parent===null&&Z.matrixWorldAutoUpdate===!0&&Z.updateMatrixWorld(),wt.enabled===!0&&wt.isPresenting===!0&&(W===null||W.isCompositing()===!1)&&(wt.cameraAutoUpdate===!0&&wt.updateCamera(Z),Z=wt.getCamera()),P.isScene===!0&&P.onBeforeRender(L,P,Z,ce),F=ct.get(P,j.length),F.init(Z),j.push(F),Ot.multiplyMatrices(Z.projectionMatrix,Z.matrixWorldInverse),Ee.setFromProjectionMatrix(Ot,Za,Z.reversedDepth),Pt=this.localClippingEnabled,yt=Bt.init(this.clippingPlanes,Pt),O=vt.get(P,z.length),O.init(),z.push(O),wt.enabled===!0&&wt.isPresenting===!0){const Ie=L.xr.getDepthSensingMesh();Ie!==null&&Br(Ie,Z,-1/0,L.sortObjects)}Br(P,Z,0,L.sortObjects),O.finish(),L.sortObjects===!0&&O.sort(Ze,xt),et=wt.enabled===!1||wt.isPresenting===!1||wt.hasDepthSensing()===!1,et&&Be.addToRenderList(O,P),this.info.render.frame++,yt===!0&&Bt.beginShadows();const ie=F.state.shadowsArray;if(he.render(ie,P,Z),yt===!0&&Bt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ae&&W.hasRenderPass())===!1){const Ie=O.opaque,Re=O.transmissive;if(F.setupLights(),Z.isArrayCamera){const tt=Z.cameras;if(Re.length>0)for(let He=0,at=tt.length;He<at;He++){const nt=tt[He];V(Ie,Re,P,nt)}et&&Be.render(P);for(let He=0,at=tt.length;He<at;He++){const nt=tt[He];bi(O,P,nt,nt.viewport)}}else Re.length>0&&V(Ie,Re,P,Z),et&&Be.render(P),bi(O,P,Z)}ce!==null&&de===0&&(be.updateMultisampleRenderTarget(ce),be.updateRenderTargetMipmap(ce)),ae&&W.end(L),P.isScene===!0&&P.onAfterRender(L,P,Z),It.resetDefaultState(),ne=-1,fe=null,j.pop(),j.length>0?(F=j[j.length-1],yt===!0&&Bt.setGlobalState(L.clippingPlanes,F.state.camera)):F=null,z.pop(),z.length>0?O=z[z.length-1]:O=null};function Br(P,Z,se,ae){if(P.visible===!1)return;if(P.layers.test(Z.layers)){if(P.isGroup)se=P.renderOrder;else if(P.isLOD)P.autoUpdate===!0&&P.update(Z);else if(P.isLight)F.pushLight(P),P.castShadow&&F.pushShadow(P);else if(P.isSprite){if(!P.frustumCulled||Ee.intersectsSprite(P)){ae&&je.setFromMatrixPosition(P.matrixWorld).applyMatrix4(Ot);const Ie=Rt.update(P),Re=P.material;Re.visible&&O.push(P,Ie,Re,se,je.z,null)}}else if((P.isMesh||P.isLine||P.isPoints)&&(!P.frustumCulled||Ee.intersectsObject(P))){const Ie=Rt.update(P),Re=P.material;if(ae&&(P.boundingSphere!==void 0?(P.boundingSphere===null&&P.computeBoundingSphere(),je.copy(P.boundingSphere.center)):(Ie.boundingSphere===null&&Ie.computeBoundingSphere(),je.copy(Ie.boundingSphere.center)),je.applyMatrix4(P.matrixWorld).applyMatrix4(Ot)),Array.isArray(Re)){const tt=Ie.groups;for(let He=0,at=tt.length;He<at;He++){const nt=tt[He],Et=Re[nt.materialIndex];Et&&Et.visible&&O.push(P,Ie,Et,se,je.z,nt)}}else Re.visible&&O.push(P,Ie,Re,se,je.z,null)}}const we=P.children;for(let Ie=0,Re=we.length;Ie<Re;Ie++)Br(we[Ie],Z,se,ae)}function bi(P,Z,se,ae){const{opaque:ie,transmissive:we,transparent:Ie}=P;F.setupLightsView(se),yt===!0&&Bt.setGlobalState(L.clippingPlanes,se),ae&&Tt.viewport(X.copy(ae)),ie.length>0&&ee(ie,Z,se),we.length>0&&ee(we,Z,se),Ie.length>0&&ee(Ie,Z,se),Tt.buffers.depth.setTest(!0),Tt.buffers.depth.setMask(!0),Tt.buffers.color.setMask(!0),Tt.setPolygonOffset(!1)}function V(P,Z,se,ae){if((se.isScene===!0?se.overrideMaterial:null)!==null)return;if(F.state.transmissionRenderTarget[ae.id]===void 0){const Et=Dt.has("EXT_color_buffer_half_float")||Dt.has("EXT_color_buffer_float");F.state.transmissionRenderTarget[ae.id]=new ti(1,1,{generateMipmaps:!0,type:Et?On:_i,minFilter:Ka,samples:qt.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:$n.workingColorSpace})}const we=F.state.transmissionRenderTarget[ae.id],Ie=ae.viewport||X;we.setSize(Ie.z*L.transmissionResolutionScale,Ie.w*L.transmissionResolutionScale);const Re=L.getRenderTarget(),tt=L.getActiveCubeFace(),He=L.getActiveMipmapLevel();L.setRenderTarget(we),L.getClearColor(Te),Se=L.getClearAlpha(),Se<1&&L.setClearColor(16777215,.5),L.clear(),et&&Be.render(se);const at=L.toneMapping;L.toneMapping=aa;const nt=ae.viewport;if(ae.viewport!==void 0&&(ae.viewport=void 0),F.setupLightsView(ae),yt===!0&&Bt.setGlobalState(L.clippingPlanes,ae),ee(P,se,ae),be.updateMultisampleRenderTarget(we),be.updateRenderTargetMipmap(we),Dt.has("WEBGL_multisampled_render_to_texture")===!1){let Et=!1;for(let Wt=0,ln=Z.length;Wt<ln;Wt++){const Yt=Z[Wt],{object:mt,geometry:ht,material:zt,group:St}=Yt;if(zt.side===Vr&&mt.layers.test(ae.layers)){const Qt=zt.side;zt.side=jr,zt.needsUpdate=!0,xe(mt,se,ae,ht,zt,St),zt.side=Qt,zt.needsUpdate=!0,Et=!0}}Et===!0&&(be.updateMultisampleRenderTarget(we),be.updateRenderTargetMipmap(we))}L.setRenderTarget(Re,tt,He),L.setClearColor(Te,Se),nt!==void 0&&(ae.viewport=nt),L.toneMapping=at}function ee(P,Z,se){const ae=Z.isScene===!0?Z.overrideMaterial:null;for(let ie=0,we=P.length;ie<we;ie++){const Ie=P[ie],{object:Re,geometry:tt,group:He}=Ie;let at=Ie.material;at.allowOverride===!0&&ae!==null&&(at=ae),Re.layers.test(se.layers)&&xe(Re,Z,se,tt,at,He)}}function xe(P,Z,se,ae,ie,we){P.onBeforeRender(L,Z,se,ae,ie,we),P.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,P.matrixWorld),P.normalMatrix.getNormalMatrix(P.modelViewMatrix),ie.onBeforeRender(L,Z,se,ae,P,we),ie.transparent===!0&&ie.side===Vr&&ie.forceSinglePass===!1?(ie.side=jr,ie.needsUpdate=!0,L.renderBufferDirect(se,Z,ae,ie,P,we),ie.side=ml,ie.needsUpdate=!0,L.renderBufferDirect(se,Z,ae,ie,P,we),ie.side=Vr):L.renderBufferDirect(se,Z,ae,ie,P,we),P.onAfterRender(L,Z,se,ae,ie,we)}function Ge(P,Z,se){Z.isScene!==!0&&(Z=st);const ae=G.get(P),ie=F.state.lights,we=F.state.shadowsArray,Ie=ie.state.version,Re=Vt.getParameters(P,ie.state,we,Z,se),tt=Vt.getProgramCacheKey(Re);let He=ae.programs;ae.environment=P.isMeshStandardMaterial?Z.environment:null,ae.fog=Z.fog,ae.envMap=(P.isMeshStandardMaterial?ot:Ye).get(P.envMap||ae.environment),ae.envMapRotation=ae.environment!==null&&P.envMap===null?Z.environmentRotation:P.envMapRotation,He===void 0&&(P.addEventListener("dispose",Si),He=new Map,ae.programs=He);let at=He.get(tt);if(at!==void 0){if(ae.currentProgram===at&&ae.lightsStateVersion===Ie)return Ke(P,Re),at}else Re.uniforms=Vt.getUniforms(P),P.onBeforeCompile(Re,L),at=Vt.acquireProgram(Re,tt),He.set(tt,at),ae.uniforms=Re.uniforms;const nt=ae.uniforms;return(!P.isShaderMaterial&&!P.isRawShaderMaterial||P.clipping===!0)&&(nt.clippingPlanes=Bt.uniform),Ke(P,Re),ae.needsLights=$(P),ae.lightsStateVersion=Ie,ae.needsLights&&(nt.ambientLightColor.value=ie.state.ambient,nt.lightProbe.value=ie.state.probe,nt.directionalLights.value=ie.state.directional,nt.directionalLightShadows.value=ie.state.directionalShadow,nt.spotLights.value=ie.state.spot,nt.spotLightShadows.value=ie.state.spotShadow,nt.rectAreaLights.value=ie.state.rectArea,nt.ltc_1.value=ie.state.rectAreaLTC1,nt.ltc_2.value=ie.state.rectAreaLTC2,nt.pointLights.value=ie.state.point,nt.pointLightShadows.value=ie.state.pointShadow,nt.hemisphereLights.value=ie.state.hemi,nt.directionalShadowMap.value=ie.state.directionalShadowMap,nt.directionalShadowMatrix.value=ie.state.directionalShadowMatrix,nt.spotShadowMap.value=ie.state.spotShadowMap,nt.spotLightMatrix.value=ie.state.spotLightMatrix,nt.spotLightMap.value=ie.state.spotLightMap,nt.pointShadowMap.value=ie.state.pointShadowMap,nt.pointShadowMatrix.value=ie.state.pointShadowMatrix),ae.currentProgram=at,ae.uniformsList=null,at}function Je(P){if(P.uniformsList===null){const Z=P.currentProgram.getUniforms();P.uniformsList=Qy.seqWithValue(Z.seq,P.uniforms)}return P.uniformsList}function Ke(P,Z){const se=G.get(P);se.outputColorSpace=Z.outputColorSpace,se.batching=Z.batching,se.batchingColor=Z.batchingColor,se.instancing=Z.instancing,se.instancingColor=Z.instancingColor,se.instancingMorph=Z.instancingMorph,se.skinning=Z.skinning,se.morphTargets=Z.morphTargets,se.morphNormals=Z.morphNormals,se.morphColors=Z.morphColors,se.morphTargetsCount=Z.morphTargetsCount,se.numClippingPlanes=Z.numClippingPlanes,se.numIntersection=Z.numClipIntersection,se.vertexAlphas=Z.vertexAlphas,se.vertexTangents=Z.vertexTangents,se.toneMapping=Z.toneMapping}function N(P,Z,se,ae,ie){Z.isScene!==!0&&(Z=st),be.resetTextureUnits();const we=Z.fog,Ie=ae.isMeshStandardMaterial?Z.environment:null,Re=ce===null?L.outputColorSpace:ce.isXRRenderTarget===!0?ce.texture.colorSpace:kr,tt=(ae.isMeshStandardMaterial?ot:Ye).get(ae.envMap||Ie),He=ae.vertexColors===!0&&!!se.attributes.color&&se.attributes.color.itemSize===4,at=!!se.attributes.tangent&&(!!ae.normalMap||ae.anisotropy>0),nt=!!se.morphAttributes.position,Et=!!se.morphAttributes.normal,Wt=!!se.morphAttributes.color;let ln=aa;ae.toneMapped&&(ce===null||ce.isXRRenderTarget===!0)&&(ln=L.toneMapping);const Yt=se.morphAttributes.position||se.morphAttributes.normal||se.morphAttributes.color,mt=Yt!==void 0?Yt.length:0,ht=G.get(ae),zt=F.state.lights;if(yt===!0&&(Pt===!0||P!==fe)){const Nr=P===fe&&ae.id===ne;Bt.setState(ae,P,Nr)}let St=!1;ae.version===ht.__version?(ht.needsLights&&ht.lightsStateVersion!==zt.state.version||ht.outputColorSpace!==Re||ie.isBatchedMesh&&ht.batching===!1||!ie.isBatchedMesh&&ht.batching===!0||ie.isBatchedMesh&&ht.batchingColor===!0&&ie.colorTexture===null||ie.isBatchedMesh&&ht.batchingColor===!1&&ie.colorTexture!==null||ie.isInstancedMesh&&ht.instancing===!1||!ie.isInstancedMesh&&ht.instancing===!0||ie.isSkinnedMesh&&ht.skinning===!1||!ie.isSkinnedMesh&&ht.skinning===!0||ie.isInstancedMesh&&ht.instancingColor===!0&&ie.instanceColor===null||ie.isInstancedMesh&&ht.instancingColor===!1&&ie.instanceColor!==null||ie.isInstancedMesh&&ht.instancingMorph===!0&&ie.morphTexture===null||ie.isInstancedMesh&&ht.instancingMorph===!1&&ie.morphTexture!==null||ht.envMap!==tt||ae.fog===!0&&ht.fog!==we||ht.numClippingPlanes!==void 0&&(ht.numClippingPlanes!==Bt.numPlanes||ht.numIntersection!==Bt.numIntersection)||ht.vertexAlphas!==He||ht.vertexTangents!==at||ht.morphTargets!==nt||ht.morphNormals!==Et||ht.morphColors!==Wt||ht.toneMapping!==ln||ht.morphTargetsCount!==mt)&&(St=!0):(St=!0,ht.__version=ae.version);let Qt=ht.currentProgram;St===!0&&(Qt=Ge(ae,Z,ie));let vn=!1,fn=!1,oi=!1;const En=Qt.getUniforms(),Ui=ht.uniforms;if(Tt.useProgram(Qt.program)&&(vn=!0,fn=!0,oi=!0),ae.id!==ne&&(ne=ae.id,fn=!0),vn||fe!==P){Tt.buffers.depth.getReversed()&&P.reversedDepth!==!0&&(P._reversedDepth=!0,P.updateProjectionMatrix()),En.setValue(oe,"projectionMatrix",P.projectionMatrix),En.setValue(oe,"viewMatrix",P.matrixWorldInverse);const Or=En.map.cameraPosition;Or!==void 0&&Or.setValue(oe,Mt.setFromMatrixPosition(P.matrixWorld)),qt.logarithmicDepthBuffer&&En.setValue(oe,"logDepthBufFC",2/(Math.log(P.far+1)/Math.LN2)),(ae.isMeshPhongMaterial||ae.isMeshToonMaterial||ae.isMeshLambertMaterial||ae.isMeshBasicMaterial||ae.isMeshStandardMaterial||ae.isShaderMaterial)&&En.setValue(oe,"isOrthographic",P.isOrthographicCamera===!0),fe!==P&&(fe=P,fn=!0,oi=!0)}if(ht.needsLights&&(zt.state.directionalShadowMap.length>0&&En.setValue(oe,"directionalShadowMap",zt.state.directionalShadowMap,be),zt.state.spotShadowMap.length>0&&En.setValue(oe,"spotShadowMap",zt.state.spotShadowMap,be),zt.state.pointShadowMap.length>0&&En.setValue(oe,"pointShadowMap",zt.state.pointShadowMap,be)),ie.isSkinnedMesh){En.setOptional(oe,ie,"bindMatrix"),En.setOptional(oe,ie,"bindMatrixInverse");const Nr=ie.skeleton;Nr&&(Nr.boneTexture===null&&Nr.computeBoneTexture(),En.setValue(oe,"boneTexture",Nr.boneTexture,be))}ie.isBatchedMesh&&(En.setOptional(oe,ie,"batchingTexture"),En.setValue(oe,"batchingTexture",ie._matricesTexture,be),En.setOptional(oe,ie,"batchingIdTexture"),En.setValue(oe,"batchingIdTexture",ie._indirectTexture,be),En.setOptional(oe,ie,"batchingColorTexture"),ie._colorsTexture!==null&&En.setValue(oe,"batchingColorTexture",ie._colorsTexture,be));const vr=se.morphAttributes;if((vr.position!==void 0||vr.normal!==void 0||vr.color!==void 0)&&ft.update(ie,se,Qt),(fn||ht.receiveShadow!==ie.receiveShadow)&&(ht.receiveShadow=ie.receiveShadow,En.setValue(oe,"receiveShadow",ie.receiveShadow)),ae.isMeshGouraudMaterial&&ae.envMap!==null&&(Ui.envMap.value=tt,Ui.flipEnvMap.value=tt.isCubeTexture&&tt.isRenderTargetTexture===!1?-1:1),ae.isMeshStandardMaterial&&ae.envMap===null&&Z.environment!==null&&(Ui.envMapIntensity.value=Z.environmentIntensity),Ui.dfgLUT!==void 0&&(Ui.dfgLUT.value=f9()),fn&&(En.setValue(oe,"toneMappingExposure",L.toneMappingExposure),ht.needsLights&&k(Ui,oi),we&&ae.fog===!0&&$t.refreshFogUniforms(Ui,we),$t.refreshMaterialUniforms(Ui,ae,Ce,me,F.state.transmissionRenderTarget[P.id]),Qy.upload(oe,Je(ht),Ui,be)),ae.isShaderMaterial&&ae.uniformsNeedUpdate===!0&&(Qy.upload(oe,Je(ht),Ui,be),ae.uniformsNeedUpdate=!1),ae.isSpriteMaterial&&En.setValue(oe,"center",ie.center),En.setValue(oe,"modelViewMatrix",ie.modelViewMatrix),En.setValue(oe,"normalMatrix",ie.normalMatrix),En.setValue(oe,"modelMatrix",ie.matrixWorld),ae.isShaderMaterial||ae.isRawShaderMaterial){const Nr=ae.uniformsGroups;for(let Or=0,cc=Nr.length;Or<cc;Or++){const ga=Nr[Or];_t.update(ga,Qt),_t.bind(ga,Qt)}}return Qt}function k(P,Z){P.ambientLightColor.needsUpdate=Z,P.lightProbe.needsUpdate=Z,P.directionalLights.needsUpdate=Z,P.directionalLightShadows.needsUpdate=Z,P.pointLights.needsUpdate=Z,P.pointLightShadows.needsUpdate=Z,P.spotLights.needsUpdate=Z,P.spotLightShadows.needsUpdate=Z,P.rectAreaLights.needsUpdate=Z,P.hemisphereLights.needsUpdate=Z}function $(P){return P.isMeshLambertMaterial||P.isMeshToonMaterial||P.isMeshPhongMaterial||P.isMeshStandardMaterial||P.isShadowMaterial||P.isShaderMaterial&&P.lights===!0}this.getActiveCubeFace=function(){return K},this.getActiveMipmapLevel=function(){return de},this.getRenderTarget=function(){return ce},this.setRenderTargetTextures=function(P,Z,se){const ae=G.get(P);ae.__autoAllocateDepthBuffer=P.resolveDepthBuffer===!1,ae.__autoAllocateDepthBuffer===!1&&(ae.__useRenderToTexture=!1),G.get(P.texture).__webglTexture=Z,G.get(P.depthTexture).__webglTexture=ae.__autoAllocateDepthBuffer?void 0:se,ae.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(P,Z){const se=G.get(P);se.__webglFramebuffer=Z,se.__useDefaultFramebuffer=Z===void 0};const ue=oe.createFramebuffer();this.setRenderTarget=function(P,Z=0,se=0){ce=P,K=Z,de=se;let ae=null,ie=!1,we=!1;if(P){const Re=G.get(P);if(Re.__useDefaultFramebuffer!==void 0){Tt.bindFramebuffer(oe.FRAMEBUFFER,Re.__webglFramebuffer),X.copy(P.viewport),re.copy(P.scissor),ge=P.scissorTest,Tt.viewport(X),Tt.scissor(re),Tt.setScissorTest(ge),ne=-1;return}else if(Re.__webglFramebuffer===void 0)be.setupRenderTarget(P);else if(Re.__hasExternalTextures)be.rebindTextures(P,G.get(P.texture).__webglTexture,G.get(P.depthTexture).__webglTexture);else if(P.depthBuffer){const at=P.depthTexture;if(Re.__boundDepthTexture!==at){if(at!==null&&G.has(at)&&(P.width!==at.image.width||P.height!==at.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");be.setupDepthRenderbuffer(P)}}const tt=P.texture;(tt.isData3DTexture||tt.isDataArrayTexture||tt.isCompressedArrayTexture)&&(we=!0);const He=G.get(P).__webglFramebuffer;P.isWebGLCubeRenderTarget?(Array.isArray(He[Z])?ae=He[Z][se]:ae=He[Z],ie=!0):P.samples>0&&be.useMultisampledRTT(P)===!1?ae=G.get(P).__webglMultisampledFramebuffer:Array.isArray(He)?ae=He[se]:ae=He,X.copy(P.viewport),re.copy(P.scissor),ge=P.scissorTest}else X.copy(ve).multiplyScalar(Ce).floor(),re.copy(ze).multiplyScalar(Ce).floor(),ge=dt;if(se!==0&&(ae=ue),Tt.bindFramebuffer(oe.FRAMEBUFFER,ae)&&Tt.drawBuffers(P,ae),Tt.viewport(X),Tt.scissor(re),Tt.setScissorTest(ge),ie){const Re=G.get(P.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+Z,Re.__webglTexture,se)}else if(we){const Re=Z;for(let tt=0;tt<P.textures.length;tt++){const He=G.get(P.textures[tt]);oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0+tt,He.__webglTexture,se,Re)}}else if(P!==null&&se!==0){const Re=G.get(P.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,Re.__webglTexture,se)}ne=-1},this.readRenderTargetPixels=function(P,Z,se,ae,ie,we,Ie,Re=0){if(!(P&&P.isWebGLRenderTarget)){nn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let tt=G.get(P).__webglFramebuffer;if(P.isWebGLCubeRenderTarget&&Ie!==void 0&&(tt=tt[Ie]),tt){Tt.bindFramebuffer(oe.FRAMEBUFFER,tt);try{const He=P.textures[Re],at=He.format,nt=He.type;if(!qt.textureFormatReadable(at)){nn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!qt.textureTypeReadable(nt)){nn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Z>=0&&Z<=P.width-ae&&se>=0&&se<=P.height-ie&&(P.textures.length>1&&oe.readBuffer(oe.COLOR_ATTACHMENT0+Re),oe.readPixels(Z,se,ae,ie,Oe.convert(at),Oe.convert(nt),we))}finally{const He=ce!==null?G.get(ce).__webglFramebuffer:null;Tt.bindFramebuffer(oe.FRAMEBUFFER,He)}}},this.readRenderTargetPixelsAsync=async function(P,Z,se,ae,ie,we,Ie,Re=0){if(!(P&&P.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let tt=G.get(P).__webglFramebuffer;if(P.isWebGLCubeRenderTarget&&Ie!==void 0&&(tt=tt[Ie]),tt)if(Z>=0&&Z<=P.width-ae&&se>=0&&se<=P.height-ie){Tt.bindFramebuffer(oe.FRAMEBUFFER,tt);const He=P.textures[Re],at=He.format,nt=He.type;if(!qt.textureFormatReadable(at))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!qt.textureTypeReadable(nt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Et=oe.createBuffer();oe.bindBuffer(oe.PIXEL_PACK_BUFFER,Et),oe.bufferData(oe.PIXEL_PACK_BUFFER,we.byteLength,oe.STREAM_READ),P.textures.length>1&&oe.readBuffer(oe.COLOR_ATTACHMENT0+Re),oe.readPixels(Z,se,ae,ie,Oe.convert(at),Oe.convert(nt),0);const Wt=ce!==null?G.get(ce).__webglFramebuffer:null;Tt.bindFramebuffer(oe.FRAMEBUFFER,Wt);const ln=oe.fenceSync(oe.SYNC_GPU_COMMANDS_COMPLETE,0);return oe.flush(),await CN(oe,ln,4),oe.bindBuffer(oe.PIXEL_PACK_BUFFER,Et),oe.getBufferSubData(oe.PIXEL_PACK_BUFFER,0,we),oe.deleteBuffer(Et),oe.deleteSync(ln),we}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(P,Z=null,se=0){const ae=Math.pow(2,-se),ie=Math.floor(P.image.width*ae),we=Math.floor(P.image.height*ae),Ie=Z!==null?Z.x:0,Re=Z!==null?Z.y:0;be.setTexture2D(P,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,se,0,0,Ie,Re,ie,we),Tt.unbindTexture()};const _e=oe.createFramebuffer(),De=oe.createFramebuffer();this.copyTextureToTexture=function(P,Z,se=null,ae=null,ie=0,we=null){we===null&&(ie!==0?(ym("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),we=ie,ie=0):we=0);let Ie,Re,tt,He,at,nt,Et,Wt,ln;const Yt=P.isCompressedTexture?P.mipmaps[we]:P.image;if(se!==null)Ie=se.max.x-se.min.x,Re=se.max.y-se.min.y,tt=se.isBox3?se.max.z-se.min.z:1,He=se.min.x,at=se.min.y,nt=se.isBox3?se.min.z:0;else{const vr=Math.pow(2,-ie);Ie=Math.floor(Yt.width*vr),Re=Math.floor(Yt.height*vr),P.isDataArrayTexture?tt=Yt.depth:P.isData3DTexture?tt=Math.floor(Yt.depth*vr):tt=1,He=0,at=0,nt=0}ae!==null?(Et=ae.x,Wt=ae.y,ln=ae.z):(Et=0,Wt=0,ln=0);const mt=Oe.convert(Z.format),ht=Oe.convert(Z.type);let zt;Z.isData3DTexture?(be.setTexture3D(Z,0),zt=oe.TEXTURE_3D):Z.isDataArrayTexture||Z.isCompressedArrayTexture?(be.setTexture2DArray(Z,0),zt=oe.TEXTURE_2D_ARRAY):(be.setTexture2D(Z,0),zt=oe.TEXTURE_2D),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,Z.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,Z.unpackAlignment);const St=oe.getParameter(oe.UNPACK_ROW_LENGTH),Qt=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),vn=oe.getParameter(oe.UNPACK_SKIP_PIXELS),fn=oe.getParameter(oe.UNPACK_SKIP_ROWS),oi=oe.getParameter(oe.UNPACK_SKIP_IMAGES);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Yt.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Yt.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,He),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,at),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,nt);const En=P.isDataArrayTexture||P.isData3DTexture,Ui=Z.isDataArrayTexture||Z.isData3DTexture;if(P.isDepthTexture){const vr=G.get(P),Nr=G.get(Z),Or=G.get(vr.__renderTarget),cc=G.get(Nr.__renderTarget);Tt.bindFramebuffer(oe.READ_FRAMEBUFFER,Or.__webglFramebuffer),Tt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,cc.__webglFramebuffer);for(let ga=0;ga<tt;ga++)En&&(oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,G.get(P).__webglTexture,ie,nt+ga),oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,G.get(Z).__webglTexture,we,ln+ga)),oe.blitFramebuffer(He,at,Ie,Re,Et,Wt,Ie,Re,oe.DEPTH_BUFFER_BIT,oe.NEAREST);Tt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),Tt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else if(ie!==0||P.isRenderTargetTexture||G.has(P)){const vr=G.get(P),Nr=G.get(Z);Tt.bindFramebuffer(oe.READ_FRAMEBUFFER,_e),Tt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,De);for(let Or=0;Or<tt;Or++)En?oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,vr.__webglTexture,ie,nt+Or):oe.framebufferTexture2D(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,vr.__webglTexture,ie),Ui?oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Nr.__webglTexture,we,ln+Or):oe.framebufferTexture2D(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,Nr.__webglTexture,we),ie!==0?oe.blitFramebuffer(He,at,Ie,Re,Et,Wt,Ie,Re,oe.COLOR_BUFFER_BIT,oe.NEAREST):Ui?oe.copyTexSubImage3D(zt,we,Et,Wt,ln+Or,He,at,Ie,Re):oe.copyTexSubImage2D(zt,we,Et,Wt,He,at,Ie,Re);Tt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),Tt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else Ui?P.isDataTexture||P.isData3DTexture?oe.texSubImage3D(zt,we,Et,Wt,ln,Ie,Re,tt,mt,ht,Yt.data):Z.isCompressedArrayTexture?oe.compressedTexSubImage3D(zt,we,Et,Wt,ln,Ie,Re,tt,mt,Yt.data):oe.texSubImage3D(zt,we,Et,Wt,ln,Ie,Re,tt,mt,ht,Yt):P.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,we,Et,Wt,Ie,Re,mt,ht,Yt.data):P.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,we,Et,Wt,Yt.width,Yt.height,mt,Yt.data):oe.texSubImage2D(oe.TEXTURE_2D,we,Et,Wt,Ie,Re,mt,ht,Yt);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,St),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Qt),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,vn),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,fn),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,oi),we===0&&Z.generateMipmaps&&oe.generateMipmap(zt),Tt.unbindTexture()},this.initRenderTarget=function(P){G.get(P).__webglFramebuffer===void 0&&be.setupRenderTarget(P)},this.initTexture=function(P){P.isCubeTexture?be.setTextureCube(P,0):P.isData3DTexture?be.setTexture3D(P,0):P.isDataArrayTexture||P.isCompressedArrayTexture?be.setTexture2DArray(P,0):be.setTexture2D(P,0),Tt.unbindTexture()},this.resetState=function(){K=0,de=0,ce=null,Tt.reset(),It.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Za}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=$n._getDrawingBufferColorSpace(e),t.unpackColorSpace=$n._getUnpackColorSpace()}}const h9=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Dv,AddEquation:$l,AddOperation:R2,AdditiveAnimationBlendMode:zM,AdditiveBlending:wE,AgXToneMapping:NM,AlphaFormat:UM,AlwaysCompare:G2,AlwaysDepth:uv,AlwaysStencilFunc:BE,AmbientLight:E4,AnimationAction:N4,AnimationClip:Em,AnimationLoader:m8,AnimationMixer:H8,AnimationObjectGroup:F8,AnimationUtils:d8,ArcCurve:i4,ArrayCamera:D4,ArrowHelper:d6,AttachedBindMode:DE,Audio:I4,AudioAnalyser:C8,AudioContext:pT,AudioListener:M8,AudioLoader:S8,AxesHelper:f6,BackSide:jr,BasicDepthPacking:Uo,BasicShadowMap:d2,BatchedMesh:$2,Bone:M_,BooleanKeyframeTrack:uh,Box2:q8,Box3:Es,Box3Helper:c6,BoxGeometry:Ed,BoxHelper:l6,BufferAttribute:jn,BufferGeometry:pn,BufferGeometryLoader:C4,ByteType:Iv,Cache:ic,Camera:Bm,CameraHelper:o6,CanvasTexture:O5,CapsuleGeometry:R_,CatmullRomCurve3:r4,CineonToneMapping:IM,CircleGeometry:D_,ClampToEdgeWrapping:Ni,Clock:mT,Color:Ft,ColorKeyframeTrack:lT,ColorManagement:$n,CompressedArrayTexture:B5,CompressedCubeTexture:N5,CompressedTexture:C_,CompressedTextureLoader:g8,ConeGeometry:Uv,ConstantAlphaFactor:T2,ConstantColorFactor:E2,Controls:p6,CubeCamera:q2,CubeDepthTexture:t4,CubeReflectionMapping:gl,CubeRefractionMapping:xd,CubeTexture:Ov,CubeTextureLoader:S4,CubeUVReflectionMapping:Dm,CubicBezierCurve:$M,CubicBezierCurve3:s4,CubicInterpolant:x4,CullFaceBack:TE,CullFaceFront:u2,CullFaceFrontBack:kB,CullFaceNone:c2,Curve:yl,CurvePath:iT,CustomBlending:CM,CustomToneMapping:BM,CylinderGeometry:Pv,Cylindrical:Q8,Data3DTexture:su,DataArrayTexture:__,DataTexture:oa,DataTextureLoader:V_,DataUtils:iu,DecrementStencilOp:nN,DecrementWrapStencilOp:rN,DefaultLoadingManager:_4,DepthFormat:rc,DepthStencilFormat:nu,DepthTexture:_d,DetachedBindMode:D2,DirectionalLight:fT,DirectionalLightHelper:a6,DiscreteInterpolant:y4,DodecahedronGeometry:I_,DoubleSide:Vr,DstAlphaFactor:y2,DstColorFactor:_2,DynamicCopyUsage:yN,DynamicDrawUsage:hN,DynamicReadUsage:gN,EdgesGeometry:n4,EllipseCurve:B_,EqualCompare:F2,EqualDepth:rA,EqualStencilFunc:lN,EquirectangularReflectionMapping:hm,EquirectangularRefractionMapping:dv,Euler:Ga,EventDispatcher:eo,ExternalTexture:KM,ExtrudeGeometry:O_,FileLoader:ds,Float16BufferAttribute:u5,Float32BufferAttribute:Jt,FloatType:si,Fog:E_,FogExp2:b_,FramebufferTexture:I5,FrontSide:ml,Frustum:Nm,FrustumArray:T_,GLBufferAttribute:W8,GLSL1:_N,GLSL3:vm,GreaterCompare:z2,GreaterDepth:aA,GreaterEqualCompare:A_,GreaterEqualDepth:sA,GreaterEqualStencilFunc:fN,GreaterStencilFunc:uN,GridHelper:r6,Group:nc,HalfFloatType:On,HemisphereLight:b4,HemisphereLightHelper:i6,IcosahedronGeometry:Fv,ImageBitmapLoader:R4,ImageLoader:Av,ImageUtils:W2,IncrementStencilOp:tN,IncrementWrapStencilOp:iN,InstancedBufferAttribute:eh,InstancedBufferGeometry:w4,InstancedInterleavedBuffer:j8,InstancedMesh:QM,Int16BufferAttribute:l5,Int32BufferAttribute:c5,Int8BufferAttribute:s5,IntType:Im,InterleavedBuffer:$f,InterleavedBufferAttribute:pl,Interpolant:Om,InterpolateDiscrete:mm,InterpolateLinear:gm,InterpolateSmooth:Xy,InterpolationSamplingMode:EN,InterpolationSamplingType:bN,InvertStencilOp:sN,KeepStencilOp:Nf,KeyframeTrack:Fo,LOD:Z2,LatheGeometry:L_,Layers:_m,LessCompare:U2,LessDepth:iA,LessEqualCompare:y_,LessEqualDepth:Jf,LessEqualStencilFunc:cN,LessStencilFunc:oN,Light:Td,LightProbe:T4,Line:sc,Line3:Z8,LineBasicMaterial:Ms,LineCurve:eT,LineCurve3:VA,LineDashedMaterial:g4,LineLoop:qM,LineSegments:xl,LinearFilter:on,LinearInterpolant:oT,LinearMipMapLinearFilter:IE,LinearMipMapNearestFilter:WB,LinearMipmapLinearFilter:Ka,LinearMipmapNearestFilter:om,LinearSRGBColorSpace:kr,LinearToneMapping:RM,LinearTransfer:hv,Loader:gr,LoaderUtils:md,LoadingManager:Vv,LoopOnce:I2,LoopPingPong:N2,LoopRepeat:B2,MOUSE:If,Material:mr,MaterialLoader:j_,MathUtils:to,Matrix2:yT,Matrix3:An,Matrix4:jt,MaxEquation:m2,Mesh:Oi,MeshBasicMaterial:za,MeshDepthMaterial:k_,MeshDistanceMaterial:sT,MeshLambertMaterial:p4,MeshMatcapMaterial:m4,MeshNormalMaterial:rT,MeshPhongMaterial:f4,MeshPhysicalMaterial:no,MeshStandardMaterial:kv,MeshToonMaterial:h4,MinEquation:p2,MirroredRepeatWrapping:pm,MixOperation:C2,MultiplyBlending:RE,MultiplyOperation:Rv,NearestFilter:di,NearestMipMapLinearFilter:jB,NearestMipMapNearestFilter:VB,NearestMipmapLinearFilter:Uf,NearestMipmapNearestFilter:h_,NeutralToneMapping:OM,NeverCompare:P2,NeverDepth:nA,NeverStencilFunc:aN,NoBlending:Pi,NoColorSpace:Ja,NoNormalPacking:JB,NoToneMapping:aa,NormalAnimationBlendMode:x_,NormalBlending:jf,NormalGAPacking:ZB,NormalRGPacking:KB,NotEqualCompare:H2,NotEqualDepth:oA,NotEqualStencilFunc:dN,NumberKeyframeTrack:nh,Object3D:ni,ObjectLoader:A8,ObjectSpaceNormalMap:L2,OctahedronGeometry:zv,OneFactor:$p,OneMinusConstantAlphaFactor:w2,OneMinusConstantColorFactor:M2,OneMinusDstAlphaFactor:A2,OneMinusDstColorFactor:S2,OneMinusSrcAlphaFactor:tA,OneMinusSrcColorFactor:x2,OrthographicCamera:Ha,PCFShadowMap:am,PCFSoftShadowMap:Qg,PMREMGenerator:HE,Path:WA,PerspectiveCamera:ki,Plane:Kc,PlaneGeometry:lc,PlaneHelper:u6,PointLight:dT,PointLightHelper:t6,Points:JM,PointsMaterial:w_,PolarGridHelper:s6,PolyhedronGeometry:Md,PositionalAudio:w8,PropertyBinding:ri,PropertyMixer:B4,QuadraticBezierCurve:tT,QuadraticBezierCurve3:N_,Quaternion:es,QuaternionKeyframeTrack:ih,QuaternionLinearInterpolant:A4,R11_EAC_Format:mA,RED_GREEN_RGTC2_Format:FA,RED_RGTC1_Format:PA,REVISION:lu,RG11_EAC_Format:vA,RGBADepthPacking:YB,RGBAFormat:Ai,RGBAIntegerFormat:v_,RGBA_ASTC_10x10_Format:DA,RGBA_ASTC_10x5_Format:wA,RGBA_ASTC_10x6_Format:CA,RGBA_ASTC_10x8_Format:RA,RGBA_ASTC_12x10_Format:IA,RGBA_ASTC_12x12_Format:BA,RGBA_ASTC_4x4_Format:yA,RGBA_ASTC_5x4_Format:AA,RGBA_ASTC_5x5_Format:_A,RGBA_ASTC_6x5_Format:SA,RGBA_ASTC_6x6_Format:bA,RGBA_ASTC_8x5_Format:EA,RGBA_ASTC_8x6_Format:MA,RGBA_ASTC_8x8_Format:TA,RGBA_BPTC_Format:NA,RGBA_ETC2_EAC_Format:pA,RGBA_PVRTC_2BPPV1_Format:dA,RGBA_PVRTC_4BPPV1_Format:uA,RGBA_S3TC_DXT1_Format:Jg,RGBA_S3TC_DXT3_Format:Kg,RGBA_S3TC_DXT5_Format:Zg,RGBDepthPacking:QB,RGBFormat:FM,RGBIntegerFormat:XB,RGB_BPTC_SIGNED_Format:OA,RGB_BPTC_UNSIGNED_Format:LA,RGB_ETC1_Format:fA,RGB_ETC2_Format:hA,RGB_PVRTC_2BPPV1_Format:cA,RGB_PVRTC_4BPPV1_Format:lA,RGB_S3TC_DXT1_Format:qg,RGDepthPacking:qB,RGFormat:Bo,RGIntegerFormat:g_,RawShaderMaterial:Gv,Ray:bd,Raycaster:xT,RectAreaLight:M4,RedFormat:tc,RedIntegerFormat:Nv,ReinhardToneMapping:DM,RenderTarget:kM,RenderTarget3D:G8,RepeatWrapping:Lo,ReplaceStencilOp:eN,ReverseSubtractEquation:h2,RingGeometry:P_,SIGNED_R11_EAC_Format:gA,SIGNED_RED_GREEN_RGTC2_Format:zA,SIGNED_RED_RGTC1_Format:UA,SIGNED_RG11_EAC_Format:xA,SRGBColorSpace:Hn,SRGBTransfer:yi,Scene:Ad,ShaderChunk:Pn,ShaderLib:dl,ShaderMaterial:ai,ShadowMaterial:d4,Shape:Xf,ShapeGeometry:U_,ShapePath:h6,ShapeUtils:fl,ShortType:Bv,Skeleton:Lv,SkeletonHelper:e6,SkinnedMesh:YM,Source:fd,Sphere:Wr,SphereGeometry:Hv,Spherical:FE,SphericalHarmonics3:hT,SplineCurve:nT,SpotLight:uT,SpotLightHelper:$8,Sprite:K2,SpriteMaterial:XM,SrcAlphaFactor:eA,SrcAlphaSaturateFactor:b2,SrcColorFactor:v2,StaticCopyUsage:xN,StaticDrawUsage:pv,StaticReadUsage:mN,StereoCamera:b8,StreamCopyUsage:AN,StreamDrawUsage:pN,StreamReadUsage:vN,StringKeyframeTrack:dh,SubtractEquation:f2,SubtractiveBlending:CE,TOUCH:Bf,TangentSpaceNormalMap:Sd,TetrahedronGeometry:F_,Texture:Jn,TextureLoader:jv,TextureUtils:y6,Timer:X8,TimestampQuery:SN,TorusGeometry:z_,TorusKnotGeometry:H_,Triangle:Fa,TriangleFanDrawMode:HA,TriangleStripDrawMode:HM,TrianglesDrawMode:O2,TubeGeometry:G_,UVMapping:vd,Uint16BufferAttribute:VM,Uint32BufferAttribute:jM,Uint8BufferAttribute:a5,Uint8ClampedBufferAttribute:o5,Uniform:Ne,UniformsGroup:V8,UniformsLib:kt,UniformsUtils:WM,UnsignedByteType:_i,UnsignedInt101111Type:PM,UnsignedInt248Type:Zf,UnsignedInt5999Type:LM,UnsignedIntType:ca,UnsignedShort4444Type:p_,UnsignedShort5551Type:m_,UnsignedShortType:Kf,VSMShadowMap:Pf,Vector2:qe,Vector3:Q,Vector4:Ti,VectorKeyframeTrack:rh,VideoFrameTexture:D5,VideoTexture:e4,WebGL3DRenderTarget:X2,WebGLArrayRenderTarget:QN,WebGLCoordinateSystem:Za,WebGLCubeRenderTarget:S_,WebGLRenderTarget:ti,WebGLRenderer:Y_,WebGLUtils:H4,WebGPUCoordinateSystem:xm,WebXRController:Yy,WireframeGeometry:u4,WrapAroundEnding:fv,ZeroCurvatureEnding:Ff,ZeroFactor:g2,ZeroSlopeEnding:zf,ZeroStencilOp:$B,createCanvasElement:j2,error:nn,getConsoleFunction:wN,log:gv,setConsoleFunction:TN,warn:Ht,warnOnce:ym},Symbol.toStringTag,{value:"Module"}));var Wb={exports:{}},Xb={},Yb={exports:{}},Qb={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C3;function p9(){if(C3)return Qb;C3=1;var i=wv();function e(v,y){return v===y&&(v!==0||1/v===1/y)||v!==v&&y!==y}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,r=i.useEffect,s=i.useLayoutEffect,o=i.useDebugValue;function u(v,y){var A=y(),S=n({inst:{value:A,getSnapshot:y}}),T=S[0].inst,M=S[1];return s(function(){T.value=A,T.getSnapshot=y,f(T)&&M({inst:T})},[v,A,y]),r(function(){return f(T)&&M({inst:T}),v(function(){f(T)&&M({inst:T})})},[v]),o(A),A}function f(v){var y=v.getSnapshot;v=v.value;try{var A=y();return!t(v,A)}catch{return!0}}function p(v,y){return y()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:u;return Qb.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:g,Qb}var R3;function m9(){return R3||(R3=1,Yb.exports=p9()),Yb.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D3;function g9(){if(D3)return Xb;D3=1;var i=wv(),e=m9();function t(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=i.useRef,o=i.useEffect,u=i.useMemo,f=i.useDebugValue;return Xb.useSyncExternalStoreWithSelector=function(p,g,v,y,A){var S=s(null);if(S.current===null){var T={hasValue:!1,value:null};S.current=T}else T=S.current;S=u(function(){function E(z){if(!R){if(R=!0,I=z,z=y(z),A!==void 0&&T.hasValue){var j=T.value;if(A(j,z))return O=j}return O=z}if(j=O,n(I,z))return j;var W=y(z);return A!==void 0&&A(j,W)?(I=z,j):(I=z,O=W)}var R=!1,I,O,F=v===void 0?null:v;return[function(){return E(g())},F===null?void 0:function(){return E(F())}]},[g,v,y,A]);var M=r(p,S[0],S[1]);return o(function(){T.hasValue=!0,T.value=M},[M]),f(M),M},Xb}var I3;function v9(){return I3||(I3=1,Wb.exports=g9()),Wb.exports}var x9=v9();const G4=Tv(x9),B3=i=>{let e;const t=new Set,n=(p,g)=>{const v=typeof p=="function"?p(e):p;if(!Object.is(v,e)){const y=e;e=g??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(A=>A(e,y))}},r=()=>e,u={setState:n,getState:r,getInitialState:()=>f,subscribe:p=>(t.add(p),()=>t.delete(p))},f=e=i(n,r,u);return u},y9=(i=>i?B3(i):B3),{useSyncExternalStoreWithSelector:A9}=G4,_9=i=>i;function S9(i,e=_9,t){const n=A9(i.subscribe,i.getState,i.getInitialState,e,t);return Cv.useDebugValue(n),n}const N3=(i,e)=>{const t=y9(i),n=(r,s=e)=>S9(t,r,s);return Object.assign(n,t),n},k4=((i,e)=>i?N3(i,e):N3),b9=i=>typeof i=="object"&&typeof i.then=="function",Gf=[];function V4(i,e,t=(n,r)=>n===r){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!t(i[r],e[r]))return!1;return!0}function j4(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const s of Gf)if(V4(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=Gf.indexOf(r);s!==-1&&Gf.splice(s,1)},promise:(b9(i)?i:i(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(Gf.push(r),!t)throw r.promise}const E9=(i,e,t)=>j4(i,e,!1,t),M9=(i,e,t)=>void j4(i,e,!0,t),T9=i=>{if(i===void 0||i.length===0)Gf.splice(0,Gf.length);else{const e=Gf.find(t=>V4(i,t.keys,t.equal));e&&e.remove()}};var VE=o2();const w9=Tv(VE);function AT(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const r=AT(n,e,t);if(r)return r;n=e?null:n.sibling}}function W4(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const _T=W4(le.createContext(null));let X4=class extends le.Component{render(){return le.createElement(_T.Provider,{value:this._reactInternals},this.props.children)}};function Y4(){const i=le.useContext(_T);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=le.useId();return le.useMemo(()=>{for(const t of[i,i==null?void 0:i.alternate]){if(!t)continue;const n=AT(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[i,e])}const C9=Symbol.for("react.context"),R9=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===C9;function D9(){const i=Y4(),[e]=le.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;R9(n)&&n!==_T&&!e.has(n)&&e.set(n,le.use(W4(n))),t=t.return}return e}function I9(){const i=D9();return le.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>le.createElement(e,null,le.createElement(t.Provider,{...n,value:i.get(t)})),e=>le.createElement(X4,{...e})),[i])}function Q4(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const q4=i=>i&&i.isOrthographicCamera,B9=i=>i&&i.hasOwnProperty("current"),N9=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),Wv=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?le.useLayoutEffect:le.useEffect;function ST(i){const e=le.useRef(i);return Wv(()=>void(e.current=i),[i]),e}function O9(){const i=Y4(),e=I9();return le.useMemo(()=>({children:t})=>{const r=!!AT(i,!0,s=>s.type===le.StrictMode)?le.StrictMode:le.Fragment;return D.jsx(r,{children:D.jsx(e,{children:t})})},[i,e])}function L9({set:i}){return Wv(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const P9=(i=>(i=class extends le.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function J4(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Hp(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const ar={obj:i=>i===Object(i)&&!ar.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(ar.str(i)||ar.num(i)||ar.boo(i))return i===e;const s=ar.obj(i);if(s&&n==="reference")return i===e;const o=ar.arr(i);if(o&&t==="reference")return i===e;if((o||s)&&i===e)return!0;let u;for(u in i)if(!(u in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(u in r?e:i)if(!ar.equ(i[u],e[u],{strict:r,objects:"reference"}))return!1}else for(u in r?e:i)if(i[u]!==e[u])return!1;if(ar.und(u)){if(o&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function U9(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function F9(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const K4=["children","key","ref"];function z9(i){const e={};for(const t in i)K4.includes(t)||(e[t]=i[t]);return e}function XA(i,e,t,n){const r=i;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:z9(n),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function _v(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const r of n){if(typeof t!="object"||t===null){if(t!==void 0){const s=n.slice(n.indexOf(r)).join("-");return{root:t,key:s,target:void 0}}return{root:i,key:e,target:void 0}}e=r,i=t,t=t[e]}return{root:i,key:e,target:t}}const O3=/-\d+$/;function YA(i,e){if(ar.str(e.props.attach)){if(O3.test(e.props.attach)){const r=e.props.attach.replace(O3,""),{root:s,key:o}=_v(i.object,r);Array.isArray(s[o])||(s[o]=[])}const{root:t,key:n}=_v(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else ar.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function QA(i,e){if(ar.str(e.props.attach)){const{root:t,key:n}=_v(i.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[n]:t[n]=r}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const jE=[...K4,"args","dispose","attach","object","onUpdate","dispose"],L3=new Map;function H9(i){let e=L3.get(i.constructor);try{e||(e=new i.constructor,L3.set(i.constructor,e))}catch{}return e}function G9(i,e){const t={};for(const n in e)if(!jE.includes(n)&&!ar.equ(e[n],i.props[n])){t[n]=e[n];for(const r in e)r.startsWith(`${n}-`)&&(t[r]=e[r])}for(const n in i.props){if(jE.includes(n)||e.hasOwnProperty(n))continue;const{root:r,key:s}=_v(i.object,n);if(r.constructor&&r.constructor.length===0){const o=H9(r);ar.und(o)||(t[s]=o[s])}else t[s]=0}return t}const k9=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],V9=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function ec(i,e){var t;const n=i.__r3f,r=n&&Q4(n).getState(),s=n==null?void 0:n.eventCount;for(const u in e){let f=e[u];if(jE.includes(u))continue;if(n&&V9.test(u)){typeof f=="function"?n.handlers[u]=f:delete n.handlers[u],n.eventCount=Object.keys(n.handlers).length;continue}if(f===void 0)continue;let{root:p,key:g,target:v}=_v(i,u);if(v===void 0&&(typeof p!="object"||p===null))throw Error(`R3F: Cannot set "${u}". Ensure it is an object before setting "${g}".`);if(v instanceof _m&&f instanceof _m)v.mask=f.mask;else if(v instanceof Ft&&N9(f))v.set(f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof v.copy=="function"&&f!=null&&f.constructor&&v.constructor===f.constructor)v.copy(f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&Array.isArray(f))typeof v.fromArray=="function"?v.fromArray(f):v.set(...f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof f=="number")typeof v.setScalar=="function"?v.setScalar(f):v.set(f);else{var o;p[g]=f,r&&!r.linear&&k9.includes(g)&&(o=p[g])!=null&&o.isTexture&&p[g].format===Ai&&p[g].type===_i&&(p[g].colorSpace=Hn)}}if(n!=null&&n.parent&&r!=null&&r.internal&&(t=n.object)!=null&&t.isObject3D&&s!==n.eventCount){const u=n.object,f=r.internal.interaction.indexOf(u);f>-1&&r.internal.interaction.splice(f,1),n.eventCount&&u.raycast!==null&&r.internal.interaction.push(u)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Pm(n),i}function Pm(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function Z4(i,e){i.manual||(q4(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const ra=i=>i==null?void 0:i.isObject3D;function My(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function $4(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function j9(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{$4(t.capturedMap,e,n,r)})}function W9(i){function e(f){const{internal:p}=i.getState(),g=f.offsetX-p.initialClick[0],v=f.offsetY-p.initialClick[1];return Math.round(Math.sqrt(g*g+v*v))}function t(f){return f.filter(p=>["Move","Over","Enter","Out","Leave"].some(g=>{var v;return(v=p.__r3f)==null?void 0:v.handlers["onPointer"+g]}))}function n(f,p){const g=i.getState(),v=new Set,y=[],A=p?p(g.internal.interaction):g.internal.interaction;for(let E=0;E<A.length;E++){const R=Hp(A[E]);R&&(R.raycaster.camera=void 0)}g.previousRoot||g.events.compute==null||g.events.compute(f,g);function S(E){const R=Hp(E);if(!R||!R.events.enabled||R.raycaster.camera===null)return[];if(R.raycaster.camera===void 0){var I;R.events.compute==null||R.events.compute(f,R,(I=R.previousRoot)==null?void 0:I.getState()),R.raycaster.camera===void 0&&(R.raycaster.camera=null)}return R.raycaster.camera?R.raycaster.intersectObject(E,!0):[]}let T=A.flatMap(S).sort((E,R)=>{const I=Hp(E.object),O=Hp(R.object);return!I||!O?E.distance-R.distance:O.events.priority-I.events.priority||E.distance-R.distance}).filter(E=>{const R=My(E);return v.has(R)?!1:(v.add(R),!0)});g.events.filter&&(T=g.events.filter(T,g));for(const E of T){let R=E.object;for(;R;){var M;(M=R.__r3f)!=null&&M.eventCount&&y.push({...E,eventObject:R}),R=R.parent}}if("pointerId"in f&&g.internal.capturedMap.has(f.pointerId))for(let E of g.internal.capturedMap.get(f.pointerId).values())v.has(My(E.intersection))||y.push(E.intersection);return y}function r(f,p,g,v){if(f.length){const y={stopped:!1};for(const A of f){let S=Hp(A.object);if(S||A.object.traverseAncestors(T=>{const M=Hp(T);if(M)return S=M,!1}),S){const{raycaster:T,pointer:M,camera:E,internal:R}=S,I=new Q(M.x,M.y,0).unproject(E),O=L=>{var H,K;return(H=(K=R.capturedMap.get(L))==null?void 0:K.has(A.eventObject))!=null?H:!1},F=L=>{const H={intersection:A,target:p.target};R.capturedMap.has(L)?R.capturedMap.get(L).set(A.eventObject,H):R.capturedMap.set(L,new Map([[A.eventObject,H]])),p.target.setPointerCapture(L)},z=L=>{const H=R.capturedMap.get(L);H&&$4(R.capturedMap,A.eventObject,H,L)};let j={};for(let L in p){let H=p[L];typeof H!="function"&&(j[L]=H)}let W={...A,...j,pointer:M,intersections:f,stopped:y.stopped,delta:g,unprojectedPoint:I,ray:T.ray,camera:E,stopPropagation(){const L="pointerId"in p&&R.capturedMap.get(p.pointerId);if((!L||L.has(A.eventObject))&&(W.stopped=y.stopped=!0,R.hovered.size&&Array.from(R.hovered.values()).find(H=>H.eventObject===A.eventObject))){const H=f.slice(0,f.indexOf(A));s([...H,A])}},target:{hasPointerCapture:O,setPointerCapture:F,releasePointerCapture:z},currentTarget:{hasPointerCapture:O,setPointerCapture:F,releasePointerCapture:z},nativeEvent:p};if(v(W),y.stopped===!0)break}}}return f}function s(f){const{internal:p}=i.getState();for(const g of p.hovered.values())if(!f.length||!f.find(v=>v.object===g.object&&v.index===g.index&&v.instanceId===g.instanceId)){const y=g.eventObject.__r3f;if(p.hovered.delete(My(g)),y!=null&&y.eventCount){const A=y.handlers,S={...g,intersections:f};A.onPointerOut==null||A.onPointerOut(S),A.onPointerLeave==null||A.onPointerLeave(S)}}}function o(f,p){for(let g=0;g<p.length;g++){const v=p[g].__r3f;v==null||v.handlers.onPointerMissed==null||v.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return p=>{const{internal:g}=i.getState();"pointerId"in p&&g.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{g.capturedMap.has(p.pointerId)&&(g.capturedMap.delete(p.pointerId),s([]))})}}return function(g){const{onPointerMissed:v,internal:y}=i.getState();y.lastEvent.current=g;const A=f==="onPointerMove",S=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",M=n(g,A?t:void 0),E=S?e(g):0;f==="onPointerDown"&&(y.initialClick=[g.offsetX,g.offsetY],y.initialHits=M.map(I=>I.eventObject)),S&&!M.length&&E<=2&&(o(g,y.interaction),v&&v(g)),A&&s(M);function R(I){const O=I.eventObject,F=O.__r3f;if(!(F!=null&&F.eventCount))return;const z=F.handlers;if(A){if(z.onPointerOver||z.onPointerEnter||z.onPointerOut||z.onPointerLeave){const j=My(I),W=y.hovered.get(j);W?W.stopped&&I.stopPropagation():(y.hovered.set(j,I),z.onPointerOver==null||z.onPointerOver(I),z.onPointerEnter==null||z.onPointerEnter(I))}z.onPointerMove==null||z.onPointerMove(I)}else{const j=z[f];j?(!S||y.initialHits.includes(O))&&(o(g,y.interaction.filter(W=>!y.initialHits.includes(W))),j(I)):S&&y.initialHits.includes(O)&&o(g,y.interaction.filter(W=>!y.initialHits.includes(W)))}}r(M,g,E,R)}}return{handlePointer:u}}const P3=i=>!!(i!=null&&i.render),bT=le.createContext(null),X9=(i,e)=>{const t=k4((u,f)=>{const p=new Q,g=new Q,v=new Q;function y(E=f().camera,R=g,I=f().size){const{width:O,height:F,top:z,left:j}=I,W=O/F;R.isVector3?v.copy(R):v.set(...R);const L=E.getWorldPosition(p).distanceTo(v);if(q4(E))return{width:O/E.zoom,height:F/E.zoom,top:z,left:j,factor:1,distance:L,aspect:W};{const H=E.fov*Math.PI/180,K=2*Math.tan(H/2)*L,de=K*(O/F);return{width:de,height:K,top:z,left:j,factor:O/de,distance:L,aspect:W}}}let A;const S=E=>u(R=>({performance:{...R.performance,current:E}})),T=new qe;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(E=1)=>i(f(),E),advance:(E,R)=>e(E,R,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new mT,pointer:T,mouse:T,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const E=f();A&&clearTimeout(A),E.performance.current!==E.performance.min&&S(E.performance.min),A=setTimeout(()=>S(f().performance.max),E.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:E=>u(R=>({...R,events:{...R.events,...E}})),setSize:(E,R,I=0,O=0)=>{const F=f().camera,z={width:E,height:R,top:I,left:O};u(j=>({size:z,viewport:{...j.viewport,...y(F,g,z)}}))},setDpr:E=>u(R=>{const I=J4(E);return{viewport:{...R.viewport,dpr:I,initialDpr:R.viewport.initialDpr||I}}}),setFrameloop:(E="always")=>{const R=f().clock;R.stop(),R.elapsedTime=0,E!=="never"&&(R.start(),R.elapsedTime=0),u(()=>({frameloop:E}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:le.createRef(),active:!1,frames:0,priority:0,subscribe:(E,R,I)=>{const O=f().internal;return O.priority=O.priority+(R>0?1:0),O.subscribers.push({ref:E,priority:R,store:I}),O.subscribers=O.subscribers.sort((F,z)=>F.priority-z.priority),()=>{const F=f().internal;F!=null&&F.subscribers&&(F.priority=F.priority-(R>0?1:0),F.subscribers=F.subscribers.filter(z=>z.ref!==E))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:u,size:f,viewport:p,gl:g,set:v}=t.getState();if(f.width!==r.width||f.height!==r.height||p.dpr!==s){r=f,s=p.dpr,Z4(u,f),p.dpr>0&&g.setPixelRatio(p.dpr);const y=typeof HTMLCanvasElement<"u"&&g.domElement instanceof HTMLCanvasElement;g.setSize(f.width,f.height,y)}u!==o&&(o=u,v(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(u)}})))}),t.subscribe(u=>i(u)),t};function ET(){const i=le.useContext(bT);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function Nn(i=t=>t,e){return ET()(i,e)}function da(i,e=0){const t=ET(),n=t.getState().internal.subscribe,r=ST(i);return Wv(()=>n(r,e,t),[e,n,t]),null}const U3=new WeakMap,Y9=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function eD(i,e){return function(t,...n){let r;return Y9(t)?(r=U3.get(t),r||(r=new t,U3.set(t,r))):r=t,i&&i(r),Promise.all(n.map(s=>new Promise((o,u)=>r.load(s,f=>{ra(f==null?void 0:f.scene)&&Object.assign(f,U9(f.scene)),o(f)},e,f=>u(new Error(`Could not load ${s}: ${f==null?void 0:f.message}`))))))}}function Po(i,e,t,n){const r=Array.isArray(e)?e:[e],s=E9(eD(t,n),[i,...r],{equal:ar.equ});return Array.isArray(e)?s:s[0]}Po.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return M9(eD(t),[i,...n])};Po.clear=function(i,e){const t=Array.isArray(e)?e:[e];return T9([i,...t])};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */const Q9=1,q9=8,J9=32,K9=2;var Z9={version:"9.5.0"};function $9(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var F3={exports:{}},z3={exports:{}},H3;function eF(){return H3||(H3=1,(function(i){i.exports=function(e){function t(c,d,x,_){return new p0(c,d,x,_)}function n(){}function r(c){var d="https://react.dev/errors/"+c;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(c){var d=c,x=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(x=d.return),c=d.return;while(c)}return d.tag===3?x:null}function o(c){if(s(c)!==c)throw Error(r(188))}function u(c){var d=c.alternate;if(!d){if(d=s(c),d===null)throw Error(r(188));return d!==c?null:c}for(var x=c,_=d;;){var C=x.return;if(C===null)break;var B=C.alternate;if(B===null){if(_=C.return,_!==null){x=_;continue}break}if(C.child===B.child){for(B=C.child;B;){if(B===x)return o(C),c;if(B===_)return o(C),d;B=B.sibling}throw Error(r(188))}if(x.return!==_.return)x=C,_=B;else{for(var q=!1,Ae=C.child;Ae;){if(Ae===x){q=!0,x=C,_=B;break}if(Ae===_){q=!0,_=C,x=B;break}Ae=Ae.sibling}if(!q){for(Ae=B.child;Ae;){if(Ae===x){q=!0,x=B,_=C;break}if(Ae===_){q=!0,_=B,x=C;break}Ae=Ae.sibling}if(!q)throw Error(r(189))}}if(x.alternate!==_)throw Error(r(190))}if(x.tag!==3)throw Error(r(188));return x.stateNode.current===x?c:d}function f(c){var d=c.tag;if(d===5||d===26||d===27||d===6)return c;for(c=c.child;c!==null;){if(d=f(c),d!==null)return d;c=c.sibling}return null}function p(c){var d=c.tag;if(d===5||d===26||d===27||d===6)return c;for(c=c.child;c!==null;){if(c.tag!==4&&(d=p(c),d!==null))return d;c=c.sibling}return null}function g(c){return c===null||typeof c!="object"?null:(c=Yo&&c[Yo]||c["@@iterator"],typeof c=="function"?c:null)}function v(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===Bl?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case _c:return"Fragment";case bc:return"Profiler";case Sc:return"StrictMode";case Gh:return"Suspense";case Xo:return"SuspenseList";case Qd:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case Ac:return"Portal";case ba:return c.displayName||"Context";case Yd:return(c._context.displayName||"Context")+".Consumer";case Du:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case kh:return d=c.displayName||null,d!==null?d:v(c.type)||"Memo";case vs:d=c._payload,c=c._init;try{return v(c(d))}catch{}}return null}function y(c){return{current:c}}function A(c){0>Cc||(c.current=tp[Cc],tp[Cc]=null,Cc--)}function S(c,d){Cc++,tp[Cc]=c.current,c.current=d}function T(c){return c>>>=0,c===0?32:31-(np(c)/px|0)|0}function M(c){var d=c&42;if(d!==0)return d;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return c&261888;case 262144:case 524288:case 1048576:case 2097152:return c&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function E(c,d,x){var _=c.pendingLanes;if(_===0)return 0;var C=0,B=c.suspendedLanes,q=c.pingedLanes;c=c.warmLanes;var Ae=_&134217727;return Ae!==0?(_=Ae&~B,_!==0?C=M(_):(q&=Ae,q!==0?C=M(q):x||(x=Ae&~c,x!==0&&(C=M(x))))):(Ae=_&~B,Ae!==0?C=M(Ae):q!==0?C=M(q):x||(x=_&~c,x!==0&&(C=M(x)))),C===0?0:d!==0&&d!==C&&(d&B)===0&&(B=C&-C,x=d&-d,B>=x||B===32&&(x&4194048)!==0)?d:C}function R(c,d){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&d)===0}function I(c,d){switch(c){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function O(){var c=Uu;return Uu<<=1,(Uu&62914560)===0&&(Uu=4194304),c}function F(c){for(var d=[],x=0;31>x;x++)d.push(c);return d}function z(c,d){c.pendingLanes|=d,d!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function j(c,d,x,_,C,B){var q=c.pendingLanes;c.pendingLanes=x,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=x,c.entangledLanes&=x,c.errorRecoveryDisabledLanes&=x,c.shellSuspendCounter=0;var Ae=c.entanglements,it=c.expirationTimes,bt=c.hiddenUpdates;for(x=q&~x;0<x;){var Lt=31-Bs(x),Ct=1<<Lt;Ae[Lt]=0,it[Lt]=-1;var Xt=bt[Lt];if(Xt!==null)for(bt[Lt]=null,Lt=0;Lt<Xt.length;Lt++){var Sn=Xt[Lt];Sn!==null&&(Sn.lane&=-536870913)}x&=~Ct}_!==0&&W(c,_,0),B!==0&&C===0&&c.tag!==0&&(c.suspendedLanes|=B&~(q&~d))}function W(c,d,x){c.pendingLanes|=d,c.suspendedLanes&=~d;var _=31-Bs(d);c.entangledLanes|=d,c.entanglements[_]=c.entanglements[_]|1073741824|x&261930}function L(c,d){var x=c.entangledLanes|=d;for(c=c.entanglements;x;){var _=31-Bs(x),C=1<<_;C&d|c[_]&d&&(c[_]|=d),x&=~C}}function H(c,d){var x=d&-d;return x=(x&42)!==0?1:K(x),(x&(c.suspendedLanes|d))!==0?0:x}function K(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function de(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function ce(c){if(typeof $0=="function"&&vx(c),Ns&&typeof Ns.setStrictMode=="function")try{Ns.setStrictMode(Dc,c)}catch{}}function ne(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}function fe(c){if(lp===void 0)try{throw Error()}catch(x){var d=x.stack.trim().match(/\n( *(at )?)/);lp=d&&d[1]||"",xo=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lp+c+xo}function X(c,d){if(!c||rf)return"";rf=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(d){var Ct=function(){throw Error()};if(Object.defineProperty(Ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ct,[])}catch(Sn){var Xt=Sn}Reflect.construct(c,[],Ct)}else{try{Ct.call()}catch(Sn){Xt=Sn}c.call(Ct.prototype)}}else{try{throw Error()}catch(Sn){Xt=Sn}(Ct=c())&&typeof Ct.catch=="function"&&Ct.catch(function(){})}}catch(Sn){if(Sn&&Xt&&typeof Sn.stack=="string")return[Sn.stack,Xt.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=_.DetermineComponentFrameRoot(),q=B[0],Ae=B[1];if(q&&Ae){var it=q.split(`
`),bt=Ae.split(`
`);for(C=_=0;_<it.length&&!it[_].includes("DetermineComponentFrameRoot");)_++;for(;C<bt.length&&!bt[C].includes("DetermineComponentFrameRoot");)C++;if(_===it.length||C===bt.length)for(_=it.length-1,C=bt.length-1;1<=_&&0<=C&&it[_]!==bt[C];)C--;for(;1<=_&&0<=C;_--,C--)if(it[_]!==bt[C]){if(_!==1||C!==1)do if(_--,C--,0>C||it[_]!==bt[C]){var Lt=`
`+it[_].replace(" at new "," at ");return c.displayName&&Lt.includes("<anonymous>")&&(Lt=Lt.replace("<anonymous>",c.displayName)),Lt}while(1<=_&&0<=C);break}}}finally{rf=!1,Error.prepareStackTrace=x}return(x=c?c.displayName||c.name:"")?fe(x):""}function re(c,d){switch(c.tag){case 26:case 27:case 5:return fe(c.type);case 16:return fe("Lazy");case 13:return c.child!==d&&d!==null?fe("Suspense Fallback"):fe("Suspense");case 19:return fe("SuspenseList");case 0:case 15:return X(c.type,!1);case 11:return X(c.type.render,!1);case 1:return X(c.type,!0);case 31:return fe("Activity");default:return""}}function ge(c){try{var d="",x=null;do d+=re(c,x),x=c,c=c.return;while(c);return d}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function Te(c,d){if(typeof c=="object"&&c!==null){var x=eg.get(c);return x!==void 0?x:(d={value:c,source:d,stack:ge(d)},eg.set(c,d),d)}return{value:c,source:d,stack:ge(d)}}function Se(c,d){Jo[yo++]=sf,Jo[yo++]=gi,gi=c,sf=d}function Y(c,d,x){Ta[Js++]=Qr,Ta[Js++]=Va,Ta[Js++]=wa,wa=c;var _=Qr;c=Va;var C=32-Bs(_)-1;_&=~(1<<C),x+=1;var B=32-Bs(d)+C;if(30<B){var q=C-C%5;B=(_&(1<<q)-1).toString(32),_>>=q,C-=q,Qr=1<<32-Bs(d)+C|x<<C|_,Va=B+c}else Qr=1<<B|x<<C|_,Va=c}function me(c){c.return!==null&&(Se(c,1),Y(c,1,0))}function Ce(c){for(;c===gi;)gi=Jo[--yo],Jo[yo]=null,sf=Jo[--yo],Jo[yo]=null;for(;c===wa;)wa=Ta[--Js],Ta[Js]=null,Va=Ta[--Js],Ta[Js]=null,Qr=Ta[--Js],Ta[Js]=null}function Ze(c,d){Ta[Js++]=Qr,Ta[Js++]=Va,Ta[Js++]=wa,Qr=d.id,Va=d.overflow,wa=c}function xt(c,d){S(qr,d),S(Ko,c),S(Fr,null),c=D1(d),A(Fr),S(Fr,c)}function ve(){A(Fr),A(Ko),A(qr)}function ze(c){c.memoizedState!==null&&S(af,c);var d=Fr.current,x=Nu(d,c.type);d!==x&&(S(Ko,c),S(Fr,x))}function dt(c){Ko.current===c&&(A(Fr),A(Ko)),af.current===c&&(A(af),lr?Tc._currentValue=Mc:Tc._currentValue2=Mc)}function Ee(c){var d=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw st(Te(d,c)),cp}function yt(c,d){if(!zi)throw Error(r(175));nx(c.stateNode,c.type,c.memoizedProps,d,c)||Ee(c,!0)}function Pt(c){for(wr=c.return;wr;)switch(wr.tag){case 5:case 31:case 13:ys=!1;return;case 27:case 3:ys=!0;return;default:wr=wr.return}}function Ot(c){if(!zi||c!==wr)return!1;if(!kn)return Pt(c),kn=!0,!1;var d=c.tag;if(Tr?d!==3&&d!==27&&(d!==5||Pu(c.type)&&!xs(c.type,c.memoizedProps))&&Hi&&Ee(c):d!==3&&(d!==5||Pu(c.type)&&!xs(c.type,c.memoizedProps))&&Hi&&Ee(c),Pt(c),d===13){if(!zi)throw Error(r(316));if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));Hi=k0(c)}else if(d===31){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));Hi=rx(c)}else Hi=Tr&&d===27?Q1(c.type,Hi):wr?Y1(c.stateNode):null;return!0}function Mt(){zi&&(Hi=wr=null,kn=!1)}function je(){var c=Ao;return c!==null&&(Ps===null?Ps=c:Ps.push.apply(Ps,c),Ao=null),c}function st(c){Ao===null?Ao=[c]:Ao.push(c)}function et(c,d,x){lr?(S(Ca,d._currentValue),d._currentValue=x):(S(Ca,d._currentValue2),d._currentValue2=x)}function At(c){var d=Ca.current;lr?c._currentValue=d:c._currentValue2=d,A(Ca)}function oe(c,d,x){for(;c!==null;){var _=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,_!==null&&(_.childLanes|=d)):_!==null&&(_.childLanes&d)!==d&&(_.childLanes|=d),c===x)break;c=c.return}}function Gt(c,d,x,_){var C=c.child;for(C!==null&&(C.return=c);C!==null;){var B=C.dependencies;if(B!==null){var q=C.child;B=B.firstContext;e:for(;B!==null;){var Ae=B;B=C;for(var it=0;it<d.length;it++)if(Ae.context===d[it]){B.lanes|=x,Ae=B.alternate,Ae!==null&&(Ae.lanes|=x),oe(B.return,x,c),_||(q=null);break e}B=Ae.next}}else if(C.tag===18){if(q=C.return,q===null)throw Error(r(341));q.lanes|=x,B=q.alternate,B!==null&&(B.lanes|=x),oe(q,x,c),q=null}else q=C.child;if(q!==null)q.return=C;else for(q=C;q!==null;){if(q===c){q=null;break}if(C=q.sibling,C!==null){C.return=q.return,q=C;break}q=q.return}C=q}}function Dt(c,d,x,_){c=null;for(var C=d,B=!1;C!==null;){if(!B){if((C.flags&524288)!==0)B=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var q=C.alternate;if(q===null)throw Error(r(387));if(q=q.memoizedProps,q!==null){var Ae=C.type;ur(C.pendingProps.value,q.value)||(c!==null?c.push(Ae):c=[Ae])}}else if(C===af.current){if(q=C.alternate,q===null)throw Error(r(387));q.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(c!==null?c.push(Tc):c=[Tc])}C=C.return}c!==null&&Gt(d,c,x,_),d.flags|=262144}function qt(c){for(c=c.firstContext;c!==null;){var d=c.context;if(!ur(lr?d._currentValue:d._currentValue2,c.memoizedValue))return!0;c=c.next}return!1}function Tt(c){Ri=c,ja=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function te(c){return be(Ri,c)}function G(c,d){return Ri===null&&Tt(c),be(c,d)}function be(c,d){var x=lr?d._currentValue:d._currentValue2;if(d={context:d,memoizedValue:x,next:null},ja===null){if(c===null)throw Error(r(308));ja=d,c.dependencies={lanes:0,firstContext:d},c.flags|=524288}else ja=ja.next=d;return x}function Ye(){return{controller:new xx,data:new Map,refCount:0}}function ot(c){c.refCount--,c.refCount===0&&zr(wS,function(){c.controller.abort()})}function Qe(){}function Ut(c){c!==fi&&c.next===null&&(fi===null?of=fi=c:fi=fi.next=c),Ra=!0,as||(as=!0,he())}function Rt(c,d){if(!up&&Ra){up=!0;do for(var x=!1,_=of;_!==null;){if(c!==0){var C=_.pendingLanes;if(C===0)var B=0;else{var q=_.suspendedLanes,Ae=_.pingedLanes;B=(1<<31-Bs(42|c)+1)-1,B&=C&~(q&~Ae),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(x=!0,Bt(_,B))}else B=Vn,B=E(_,_===In?B:0,_.cancelPendingCommit!==null||_.timeoutHandle!==Is),(B&3)===0||R(_,B)||(x=!0,Bt(_,B));_=_.next}while(x);up=!1}}function Vt(){$t()}function $t(){Ra=as=!1;var c=0;Ul!==0&&Ec()&&(c=Ul);for(var d=ss(),x=null,_=of;_!==null;){var C=_.next,B=vt(_,d);B===0?(_.next=null,x===null?of=C:x.next=C,C===null&&(fi=x)):(x=_,(c!==0||(B&3)!==0)&&(Ra=!0)),_=C}_r!==0&&_r!==5||Rt(c),Ul!==0&&(Ul=0)}function vt(c,d){for(var x=c.suspendedLanes,_=c.pingedLanes,C=c.expirationTimes,B=c.pendingLanes&-62914561;0<B;){var q=31-Bs(B),Ae=1<<q,it=C[q];it===-1?((Ae&x)===0||(Ae&_)!==0)&&(C[q]=I(Ae,d)):it<=d&&(c.expiredLanes|=Ae),B&=~Ae}if(d=In,x=Vn,x=E(c,c===d?x:0,c.cancelPendingCommit!==null||c.timeoutHandle!==Is),_=c.callbackNode,x===0||c===d&&(pi===2||pi===9)||c.cancelPendingCommit!==null)return _!==null&&_!==null&&rp(_),c.callbackNode=null,c.callbackPriority=0;if((x&3)===0||R(c,x)){if(d=x&-x,d===c.callbackPriority)return d;switch(_!==null&&rp(_),de(x)){case 2:case 8:x=gx;break;case 32:x=nf;break;case 268435456:x=ap;break;default:x=nf}return _=ct.bind(null,c),x=tf(x,_),c.callbackPriority=d,c.callbackNode=x,d}return _!==null&&_!==null&&rp(_),c.callbackPriority=2,c.callbackNode=null,2}function ct(c,d){if(_r!==0&&_r!==5)return c.callbackNode=null,c.callbackPriority=0,null;var x=c.callbackNode;if(mo()&&c.callbackNode!==x)return null;var _=Vn;return _=E(c,c===In?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==Is),_===0?null:(ka(c,_,d),vt(c,ss()),c.callbackNode!=null&&c.callbackNode===x?ct.bind(null,c):null)}function Bt(c,d){if(mo())return null;ka(c,d,!0)}function he(){T0?w0(function(){(Un&6)!==0?tf(sp,Vt):$t()}):tf(sp,Vt)}function Be(){if(Ul===0){var c=Zo;c===0&&(c=ip,ip<<=1,(ip&261888)===0&&(ip=256)),Ul=c}return Ul}function ft(c,d){if(Fu===null){var x=Fu=[];tg=0,Zo=Be(),Cr={status:"pending",value:void 0,then:function(_){x.push(_)}}}return tg++,d.then(pe,pe),d}function pe(){if(--tg===0&&Fu!==null){Cr!==null&&(Cr.status="fulfilled");var c=Fu;Fu=null,Zo=0,Cr=null;for(var d=0;d<c.length;d++)(0,c[d])()}}function Fe(c,d){var x=[],_={status:"pending",value:null,reason:null,then:function(C){x.push(C)}};return c.then(function(){_.status="fulfilled",_.value=d;for(var C=0;C<x.length;C++)(0,x[C])(d)},function(C){for(_.status="rejected",_.reason=C,C=0;C<x.length;C++)(0,x[C])(void 0)}),_}function Oe(){var c=Fl.current;return c!==null?c:In.pooledCache}function It(c,d){d===null?S(Fl,Fl.current):S(Fl,d.pool)}function _t(){var c=Oe();return c===null?null:{parent:lr?Gi._currentValue:Gi._currentValue2,pool:c}}function ut(c,d){if(ur(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var x=Object.keys(c),_=Object.keys(d);if(x.length!==_.length)return!1;for(_=0;_<x.length;_++){var C=x[_];if(!TS.call(d,C)||!ur(c[C],d[C]))return!1}return!0}function wt(c){return c=c.status,c==="fulfilled"||c==="rejected"}function Zt(c,d,x){switch(x=c[x],x===void 0?c.push(d):x!==d&&(d.then(Qe,Qe),d=x),d.status){case"fulfilled":return d.value;case"rejected":throw c=d.reason,Si(c),c;default:if(typeof d.status=="string")d.then(Qe,Qe);else{if(c=In,c!==null&&100<c.shellSuspendCounter)throw Error(r(482));c=d,c.status="pending",c.then(function(_){if(d.status==="pending"){var C=d;C.status="fulfilled",C.value=_}},function(_){if(d.status==="pending"){var C=d;C.status="rejected",C.reason=_}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw c=d.reason,Si(c),c}throw As=d,Rr}}function yn(c){try{var d=c._init;return d(c._payload)}catch(x){throw x!==null&&typeof x=="object"&&typeof x.then=="function"?(As=x,Rr):x}}function _n(){if(As===null)throw Error(r(459));var c=As;return As=null,c}function Si(c){if(c===Rr||c===Ia)throw Error(r(483))}function ji(c){var d=Ic;return Ic+=1,zl===null&&(zl=[]),Zt(zl,c,d)}function ha(c,d){d=d.props.ref,c.ref=d!==void 0?d:null}function pa(c,d){throw d.$$typeof===yc?Error(r(525)):(c=Object.prototype.toString.call(d),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c)))}function Ts(c){function d(We,Pe){if(c){var $e=We.deletions;$e===null?(We.deletions=[Pe],We.flags|=16):$e.push(Pe)}}function x(We,Pe){if(!c)return null;for(;Pe!==null;)d(We,Pe),Pe=Pe.sibling;return null}function _(We){for(var Pe=new Map;We!==null;)We.key!==null?Pe.set(We.key,We):Pe.set(We.index,We),We=We.sibling;return Pe}function C(We,Pe){return We=Qs(We,Pe),We.index=0,We.sibling=null,We}function B(We,Pe,$e){return We.index=$e,c?($e=We.alternate,$e!==null?($e=$e.index,$e<Pe?(We.flags|=67108866,Pe):$e):(We.flags|=67108866,Pe)):(We.flags|=1048576,Pe)}function q(We){return c&&We.alternate===null&&(We.flags|=67108866),We}function Ae(We,Pe,$e,Nt){return Pe===null||Pe.tag!==6?(Pe=m0($e,We.mode,Nt),Pe.return=We,Pe):(Pe=C(Pe,$e),Pe.return=We,Pe)}function it(We,Pe,$e,Nt){var cn=$e.type;return cn===_c?Lt(We,Pe,$e.props.children,Nt,$e.key):Pe!==null&&(Pe.elementType===cn||typeof cn=="object"&&cn!==null&&cn.$$typeof===vs&&yn(cn)===Pe.type)?(Pe=C(Pe,$e.props),ha(Pe,$e),Pe.return=We,Pe):(Pe=Wo($e.type,$e.key,$e.props,null,We.mode,Nt),ha(Pe,$e),Pe.return=We,Pe)}function bt(We,Pe,$e,Nt){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==$e.containerInfo||Pe.stateNode.implementation!==$e.implementation?(Pe=v0($e,We.mode,Nt),Pe.return=We,Pe):(Pe=C(Pe,$e.children||[]),Pe.return=We,Pe)}function Lt(We,Pe,$e,Nt,cn){return Pe===null||Pe.tag!==7?(Pe=Sa($e,We.mode,Nt,cn),Pe.return=We,Pe):(Pe=C(Pe,$e),Pe.return=We,Pe)}function Ct(We,Pe,$e){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return Pe=m0(""+Pe,We.mode,$e),Pe.return=We,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case go:return $e=Wo(Pe.type,Pe.key,Pe.props,null,We.mode,$e),ha($e,Pe),$e.return=We,$e;case Ac:return Pe=v0(Pe,We.mode,$e),Pe.return=We,Pe;case vs:return Pe=yn(Pe),Ct(We,Pe,$e)}if(Nl(Pe)||g(Pe))return Pe=Sa(Pe,We.mode,$e,null),Pe.return=We,Pe;if(typeof Pe.then=="function")return Ct(We,ji(Pe),$e);if(Pe.$$typeof===ba)return Ct(We,G(We,Pe),$e);pa(We,Pe)}return null}function Xt(We,Pe,$e,Nt){var cn=Pe!==null?Pe.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return cn!==null?null:Ae(We,Pe,""+$e,Nt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case go:return $e.key===cn?it(We,Pe,$e,Nt):null;case Ac:return $e.key===cn?bt(We,Pe,$e,Nt):null;case vs:return $e=yn($e),Xt(We,Pe,$e,Nt)}if(Nl($e)||g($e))return cn!==null?null:Lt(We,Pe,$e,Nt,null);if(typeof $e.then=="function")return Xt(We,Pe,ji($e),Nt);if($e.$$typeof===ba)return Xt(We,Pe,G(We,$e),Nt);pa(We,$e)}return null}function Sn(We,Pe,$e,Nt,cn){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return We=We.get($e)||null,Ae(Pe,We,""+Nt,cn);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case go:return We=We.get(Nt.key===null?$e:Nt.key)||null,it(Pe,We,Nt,cn);case Ac:return We=We.get(Nt.key===null?$e:Nt.key)||null,bt(Pe,We,Nt,cn);case vs:return Nt=yn(Nt),Sn(We,Pe,$e,Nt,cn)}if(Nl(Nt)||g(Nt))return We=We.get($e)||null,Lt(Pe,We,Nt,cn,null);if(typeof Nt.then=="function")return Sn(We,Pe,$e,ji(Nt),cn);if(Nt.$$typeof===ba)return Sn(We,Pe,$e,G(Pe,Nt),cn);pa(Pe,Nt)}return null}function hr(We,Pe,$e,Nt){for(var cn=null,Ki=null,un=Pe,Kn=Pe=0,Hr=null;un!==null&&Kn<$e.length;Kn++){un.index>Kn?(Hr=un,un=null):Hr=un.sibling;var ii=Xt(We,un,$e[Kn],Nt);if(ii===null){un===null&&(un=Hr);break}c&&un&&ii.alternate===null&&d(We,un),Pe=B(ii,Pe,Kn),Ki===null?cn=ii:Ki.sibling=ii,Ki=ii,un=Hr}if(Kn===$e.length)return x(We,un),kn&&Se(We,Kn),cn;if(un===null){for(;Kn<$e.length;Kn++)un=Ct(We,$e[Kn],Nt),un!==null&&(Pe=B(un,Pe,Kn),Ki===null?cn=un:Ki.sibling=un,Ki=un);return kn&&Se(We,Kn),cn}for(un=_(un);Kn<$e.length;Kn++)Hr=Sn(un,We,Kn,$e[Kn],Nt),Hr!==null&&(c&&Hr.alternate!==null&&un.delete(Hr.key===null?Kn:Hr.key),Pe=B(Hr,Pe,Kn),Ki===null?cn=Hr:Ki.sibling=Hr,Ki=Hr);return c&&un.forEach(function(Oa){return d(We,Oa)}),kn&&Se(We,Kn),cn}function Xu(We,Pe,$e,Nt){if($e==null)throw Error(r(151));for(var cn=null,Ki=null,un=Pe,Kn=Pe=0,Hr=null,ii=$e.next();un!==null&&!ii.done;Kn++,ii=$e.next()){un.index>Kn?(Hr=un,un=null):Hr=un.sibling;var Oa=Xt(We,un,ii.value,Nt);if(Oa===null){un===null&&(un=Hr);break}c&&un&&Oa.alternate===null&&d(We,un),Pe=B(Oa,Pe,Kn),Ki===null?cn=Oa:Ki.sibling=Oa,Ki=Oa,un=Hr}if(ii.done)return x(We,un),kn&&Se(We,Kn),cn;if(un===null){for(;!ii.done;Kn++,ii=$e.next())ii=Ct(We,ii.value,Nt),ii!==null&&(Pe=B(ii,Pe,Kn),Ki===null?cn=ii:Ki.sibling=ii,Ki=ii);return kn&&Se(We,Kn),cn}for(un=_(un);!ii.done;Kn++,ii=$e.next())ii=Sn(un,We,Kn,ii.value,Nt),ii!==null&&(c&&ii.alternate!==null&&un.delete(ii.key===null?Kn:ii.key),Pe=B(ii,Pe,Kn),Ki===null?cn=ii:Ki.sibling=ii,Ki=ii);return c&&un.forEach(function(CS){return d(We,CS)}),kn&&Se(We,Kn),cn}function Yl(We,Pe,$e,Nt){if(typeof $e=="object"&&$e!==null&&$e.type===_c&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case go:e:{for(var cn=$e.key;Pe!==null;){if(Pe.key===cn){if(cn=$e.type,cn===_c){if(Pe.tag===7){x(We,Pe.sibling),Nt=C(Pe,$e.props.children),Nt.return=We,We=Nt;break e}}else if(Pe.elementType===cn||typeof cn=="object"&&cn!==null&&cn.$$typeof===vs&&yn(cn)===Pe.type){x(We,Pe.sibling),Nt=C(Pe,$e.props),ha(Nt,$e),Nt.return=We,We=Nt;break e}x(We,Pe);break}else d(We,Pe);Pe=Pe.sibling}$e.type===_c?(Nt=Sa($e.props.children,We.mode,Nt,$e.key),Nt.return=We,We=Nt):(Nt=Wo($e.type,$e.key,$e.props,null,We.mode,Nt),ha(Nt,$e),Nt.return=We,We=Nt)}return q(We);case Ac:e:{for(cn=$e.key;Pe!==null;){if(Pe.key===cn)if(Pe.tag===4&&Pe.stateNode.containerInfo===$e.containerInfo&&Pe.stateNode.implementation===$e.implementation){x(We,Pe.sibling),Nt=C(Pe,$e.children||[]),Nt.return=We,We=Nt;break e}else{x(We,Pe);break}else d(We,Pe);Pe=Pe.sibling}Nt=v0($e,We.mode,Nt),Nt.return=We,We=Nt}return q(We);case vs:return $e=yn($e),Yl(We,Pe,$e,Nt)}if(Nl($e))return hr(We,Pe,$e,Nt);if(g($e)){if(cn=g($e),typeof cn!="function")throw Error(r(150));return $e=cn.call($e),Xu(We,Pe,$e,Nt)}if(typeof $e.then=="function")return Yl(We,Pe,ji($e),Nt);if($e.$$typeof===ba)return Yl(We,Pe,G(We,$e),Nt);pa(We,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint"?($e=""+$e,Pe!==null&&Pe.tag===6?(x(We,Pe.sibling),Nt=C(Pe,$e),Nt.return=We,We=Nt):(x(We,Pe),Nt=m0($e,We.mode,Nt),Nt.return=We,We=Nt),q(We)):x(We,Pe)}return function(We,Pe,$e,Nt){try{Ic=0;var cn=Yl(We,Pe,$e,Nt);return zl=null,cn}catch(un){if(un===Rr||un===Ia)throw un;var Ki=t(29,un,null,We.mode);return Ki.lanes=Nt,Ki.return=We,Ki}finally{}}}function ma(){for(var c=So,d=Bc=So=0;d<c;){var x=Kr[d];Kr[d++]=null;var _=Kr[d];Kr[d++]=null;var C=Kr[d];Kr[d++]=null;var B=Kr[d];if(Kr[d++]=null,_!==null&&C!==null){var q=_.pending;q===null?C.next=C:(C.next=q.next,q.next=C),_.pending=C}B!==0&&Br(x,C,B)}}function Xr(c,d,x,_){Kr[So++]=c,Kr[So++]=d,Kr[So++]=x,Kr[So++]=_,Bc|=_,c.lanes|=_,c=c.alternate,c!==null&&(c.lanes|=_)}function is(c,d,x,_){return Xr(c,d,x,_),bi(c)}function rn(c,d){return Xr(c,null,null,d),bi(c)}function Br(c,d,x){c.lanes|=x;var _=c.alternate;_!==null&&(_.lanes|=x);for(var C=!1,B=c.return;B!==null;)B.childLanes|=x,_=B.alternate,_!==null&&(_.childLanes|=x),B.tag===22&&(c=B.stateNode,c===null||c._visibility&1||(C=!0)),c=B,B=B.return;return c.tag===3?(B=c.stateNode,C&&d!==null&&(C=31-Bs(x),c=B.hiddenUpdates,_=c[C],_===null?c[C]=[d]:_.push(d),d.lane=x|536870912),B):null}function bi(c){if(50<ei)throw ei=0,hf=null,Error(r(185));for(var d=c.return;d!==null;)c=d,d=c.return;return c.tag===3?c.stateNode:null}function V(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ee(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function xe(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Ge(c,d,x){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,(Un&2)!==0){var C=_.pending;return C===null?d.next=d:(d.next=C.next,C.next=d),_.pending=d,d=bi(c),Br(c,null,x),d}return Xr(c,_,d,x),bi(c)}function Je(c,d,x){if(d=d.updateQueue,d!==null&&(d=d.shared,(x&4194048)!==0)){var _=d.lanes;_&=c.pendingLanes,x|=_,d.lanes=x,L(c,x)}}function Ke(c,d){var x=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,x===_)){var C=null,B=null;if(x=x.firstBaseUpdate,x!==null){do{var q={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};B===null?C=B=q:B=B.next=q,x=x.next}while(x!==null);B===null?C=B=d:B=B.next=d}else C=B=d;x={baseState:_.baseState,firstBaseUpdate:C,lastBaseUpdate:B,shared:_.shared,callbacks:_.callbacks},c.updateQueue=x;return}c=x.lastBaseUpdate,c===null?x.firstBaseUpdate=d:c.next=d,x.lastBaseUpdate=d}function N(){if(fp){var c=Cr;if(c!==null)throw c}}function k(c,d,x,_){fp=!1;var C=c.updateQueue;Ks=!1;var B=C.firstBaseUpdate,q=C.lastBaseUpdate,Ae=C.shared.pending;if(Ae!==null){C.shared.pending=null;var it=Ae,bt=it.next;it.next=null,q===null?B=bt:q.next=bt,q=it;var Lt=c.alternate;Lt!==null&&(Lt=Lt.updateQueue,Ae=Lt.lastBaseUpdate,Ae!==q&&(Ae===null?Lt.firstBaseUpdate=bt:Ae.next=bt,Lt.lastBaseUpdate=it))}if(B!==null){var Ct=C.baseState;q=0,Lt=bt=it=null,Ae=B;do{var Xt=Ae.lane&-536870913,Sn=Xt!==Ae.lane;if(Sn?(Vn&Xt)===Xt:(_&Xt)===Xt){Xt!==0&&Xt===Zo&&(fp=!0),Lt!==null&&(Lt=Lt.next={lane:0,tag:Ae.tag,payload:Ae.payload,callback:null,next:null});e:{var hr=c,Xu=Ae;Xt=d;var Yl=x;switch(Xu.tag){case 1:if(hr=Xu.payload,typeof hr=="function"){Ct=hr.call(Yl,Ct,Xt);break e}Ct=hr;break e;case 3:hr.flags=hr.flags&-65537|128;case 0:if(hr=Xu.payload,Xt=typeof hr=="function"?hr.call(Yl,Ct,Xt):hr,Xt==null)break e;Ct=Hh({},Ct,Xt);break e;case 2:Ks=!0}}Xt=Ae.callback,Xt!==null&&(c.flags|=64,Sn&&(c.flags|=8192),Sn=C.callbacks,Sn===null?C.callbacks=[Xt]:Sn.push(Xt))}else Sn={lane:Xt,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},Lt===null?(bt=Lt=Sn,it=Ct):Lt=Lt.next=Sn,q|=Xt;if(Ae=Ae.next,Ae===null){if(Ae=C.shared.pending,Ae===null)break;Sn=Ae,Ae=Sn.next,Sn.next=null,C.lastBaseUpdate=Sn,C.shared.pending=null}}while(!0);Lt===null&&(it=Ct),C.baseState=it,C.firstBaseUpdate=bt,C.lastBaseUpdate=Lt,B===null&&(C.shared.lanes=0),el|=q,c.lanes=q,c.memoizedState=Ct}}function $(c,d){if(typeof c!="function")throw Error(r(191,c));c.call(d)}function ue(c,d){var x=c.callbacks;if(x!==null)for(c.callbacks=null,c=0;c<x.length;c++)$(x[c],d)}function _e(c,d){c=Eo,S(Hl,c),S(Nc,d),Eo=c|d.baseLanes}function De(){S(Hl,Eo),S(Nc,Nc.current)}function P(){Eo=Hl.current,A(Nc),A(Hl)}function Z(c){var d=c.alternate;S(nr,nr.current&1),S(Os,c),Ls===null&&(d===null||Nc.current!==null||d.memoizedState!==null)&&(Ls=c)}function se(c){S(nr,nr.current),S(Os,c),Ls===null&&(Ls=c)}function ae(c){c.tag===22?(S(nr,nr.current),S(Os,c),Ls===null&&(Ls=c)):ie()}function ie(){S(nr,nr.current),S(Os,Os.current)}function we(c){A(Os),Ls===c&&(Ls=null),A(nr)}function Ie(c){for(var d=c;d!==null;){if(d.tag===13){var x=d.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||Ll(x)||Qh(x)))return d}else if(d.tag===19&&(d.memoizedProps.revealOrder==="forwards"||d.memoizedProps.revealOrder==="backwards"||d.memoizedProps.revealOrder==="unstable_legacy-backwards"||d.memoizedProps.revealOrder==="together")){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function Re(){throw Error(r(321))}function tt(c,d){if(d===null)return!1;for(var x=0;x<d.length&&x<c.length;x++)if(!ur(c[x],d[x]))return!1;return!0}function He(c,d,x,_,C,B){return $o=B,Tn=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,sn.H=c===null||c.memoizedState===null?Qi:bo,Yn=!1,B=x(_,C),Yn=!1,Cn&&(B=nt(d,x,_,C)),at(c),B}function at(c){sn.H=Zs;var d=tn!==null&&tn.next!==null;if($o=0,xn=tn=Tn=null,Dn=!1,Ba=0,Wa=null,d)throw Error(r(300));c===null||Li||(c=c.dependencies,c!==null&&qt(c)&&(Li=!0))}function nt(c,d,x,_){Tn=c;var C=0;do{if(Cn&&(Wa=null),Ba=0,Cn=!1,25<=C)throw Error(r(301));if(C+=1,xn=tn=null,c.updateQueue!=null){var B=c.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}sn.H=Gl,B=d(x,_)}while(Cn);return B}function Et(){var c=sn.H,d=c.useState()[0];return d=typeof d.then=="function"?St(d):d,c=c.useState()[0],(tn!==null?tn.memoizedState:null)!==c&&(Tn.flags|=1024),d}function Wt(){var c=os!==0;return os=0,c}function ln(c,d,x){d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~x}function Yt(c){if(Dn){for(c=c.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}Dn=!1}$o=0,xn=tn=Tn=null,Cn=!1,Ba=os=0,Wa=null}function mt(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?Tn.memoizedState=xn=c:xn=xn.next=c,xn}function ht(){if(tn===null){var c=Tn.alternate;c=c!==null?c.memoizedState:null}else c=tn.next;var d=xn===null?Tn.memoizedState:xn.next;if(d!==null)xn=d,tn=c;else{if(c===null)throw Tn.alternate===null?Error(r(467)):Error(r(310));tn=c,c={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},xn===null?Tn.memoizedState=xn=c:xn=xn.next=c}return xn}function zt(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function St(c){var d=Ba;return Ba+=1,Wa===null&&(Wa=[]),c=Zt(Wa,c,d),d=Tn,(xn===null?d.memoizedState:xn.next)===null&&(d=d.alternate,sn.H=d===null||d.memoizedState===null?Qi:bo),c}function Qt(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return St(c);if(c.$$typeof===ba)return te(c)}throw Error(r(438,String(c)))}function vn(c){var d=null,x=Tn.updateQueue;if(x!==null&&(d=x.memoCache),d==null){var _=Tn.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(d={data:_.data.map(function(C){return C.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),x===null&&(x=zt(),Tn.updateQueue=x),x.memoCache=d,x=d.data[d.index],x===void 0)for(x=d.data[d.index]=Array(c),_=0;_<c;_++)x[_]=y0;return d.index++,x}function fn(c,d){return typeof d=="function"?d(c):d}function oi(c){var d=ht();return En(d,tn,c)}function En(c,d,x){var _=c.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=x;var C=c.baseQueue,B=_.pending;if(B!==null){if(C!==null){var q=C.next;C.next=B.next,B.next=q}d.baseQueue=C=B,_.pending=null}if(B=c.baseState,C===null)c.memoizedState=B;else{d=C.next;var Ae=q=null,it=null,bt=d,Lt=!1;do{var Ct=bt.lane&-536870913;if(Ct!==bt.lane?(Vn&Ct)===Ct:($o&Ct)===Ct){var Xt=bt.revertLane;if(Xt===0)it!==null&&(it=it.next={lane:0,revertLane:0,gesture:null,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null}),Ct===Zo&&(Lt=!0);else if(($o&Xt)===Xt){bt=bt.next,Xt===Zo&&(Lt=!0);continue}else Ct={lane:0,revertLane:bt.revertLane,gesture:null,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null},it===null?(Ae=it=Ct,q=B):it=it.next=Ct,Tn.lanes|=Xt,el|=Xt;Ct=bt.action,Yn&&x(B,Ct),B=bt.hasEagerState?bt.eagerState:x(B,Ct)}else Xt={lane:Ct,revertLane:bt.revertLane,gesture:bt.gesture,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null},it===null?(Ae=it=Xt,q=B):it=it.next=Xt,Tn.lanes|=Ct,el|=Ct;bt=bt.next}while(bt!==null&&bt!==d);if(it===null?q=B:it.next=Ae,!ur(B,c.memoizedState)&&(Li=!0,Lt&&(x=Cr,x!==null)))throw x;c.memoizedState=B,c.baseState=q,c.baseQueue=it,_.lastRenderedState=B}return C===null&&(_.lanes=0),[c.memoizedState,_.dispatch]}function Ui(c){var d=ht(),x=d.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=c;var _=x.dispatch,C=x.pending,B=d.memoizedState;if(C!==null){x.pending=null;var q=C=C.next;do B=c(B,q.action),q=q.next;while(q!==C);ur(B,d.memoizedState)||(Li=!0),d.memoizedState=B,d.baseQueue===null&&(d.baseState=B),x.lastRenderedState=B}return[B,_]}function vr(c,d,x){var _=Tn,C=ht(),B=kn;if(B){if(x===void 0)throw Error(r(407));x=x()}else x=d();var q=!ur((tn||C).memoizedState,x);if(q&&(C.memoizedState=x,Li=!0),C=C.queue,fu(cc.bind(null,_,C,c),[c]),C.getSnapshot!==d||q||xn!==null&&xn.memoizedState.tag&1){if(_.flags|=2048,Ws(9,{destroy:void 0},Or.bind(null,_,C,x,d),null),In===null)throw Error(r(349));B||($o&127)!==0||Nr(_,d,x)}return x}function Nr(c,d,x){c.flags|=16384,c={getSnapshot:d,value:x},d=Tn.updateQueue,d===null?(d=zt(),Tn.updateQueue=d,d.stores=[c]):(x=d.stores,x===null?d.stores=[c]:x.push(c))}function Or(c,d,x,_){d.value=x,d.getSnapshot=_,ga(d)&&Zv(c)}function cc(c,d,x){return x(function(){ga(d)&&Zv(c)})}function ga(c){var d=c.getSnapshot;c=c.value;try{var x=d();return!ur(c,x)}catch{return!0}}function Zv(c){var d=rn(c,2);d!==null&&Xi(d,c,2)}function jm(c){var d=mt();if(typeof c=="function"){var x=c;if(c=x(),Yn){ce(!0);try{x()}finally{ce(!1)}}}return d.memoizedState=d.baseState=c,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fn,lastRenderedState:c},d}function Cd(c,d,x,_){return c.baseState=x,En(c,tn,typeof _=="function"?_:fn)}function zo(c,d,x,_,C){if(Ah(c))throw Error(r(485));if(c=d.action,c!==null){var B={payload:C,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){B.listeners.push(q)}};sn.T!==null?x(!0):B.isTransition=!1,_(B),x=d.pending,x===null?(B.next=d.pending=B,hh(d,B)):(B.next=x.next,d.pending=x.next=B)}}function hh(c,d){var x=d.action,_=d.payload,C=c.state;if(d.isTransition){var B=sn.T,q={};sn.T=q;try{var Ae=x(C,_),it=sn.S;it!==null&&it(q,Ae),ph(c,d,Ae)}catch(bt){Al(c,d,bt)}finally{B!==null&&q.types!==null&&(B.types=q.types),sn.T=B}}else try{B=x(C,_),ph(c,d,B)}catch(bt){Al(c,d,bt)}}function ph(c,d,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(_){uc(c,d,_)},function(_){return Al(c,d,_)}):uc(c,d,x)}function uc(c,d,x){d.status="fulfilled",d.value=x,Wm(d),c.state=x,d=c.pending,d!==null&&(x=d.next,x===d?c.pending=null:(x=x.next,d.next=x,hh(c,x)))}function Al(c,d,x){var _=c.pending;if(c.pending=null,_!==null){_=_.next;do d.status="rejected",d.reason=x,Wm(d),d=d.next;while(d!==_)}c.action=null}function Wm(c){c=c.listeners;for(var d=0;d<c.length;d++)(0,c[d])()}function mh(c,d){return d}function Xm(c,d){if(kn){var x=In.formState;if(x!==null){e:{var _=Tn;if(kn){if(Hi){var C=X1(Hi,ys);if(C){Hi=Y1(C),_=F0(C);break e}}Ee(_)}_=!1}_&&(d=x[0])}}x=mt(),x.memoizedState=x.baseState=d,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:d},x.queue=_,x=r1.bind(null,Tn,_),_.dispatch=x,_=jm(!1);var B=yh.bind(null,Tn,!1,_.queue);return _=mt(),C={state:d,dispatch:null,action:c,pending:null},_.queue=C,x=zo.bind(null,Tn,C,B,x),C.dispatch=x,_.memoizedState=c,[d,x,!1]}function uu(c){var d=ht();return io(d,tn,c)}function io(c,d,x){if(d=En(c,d,mh)[0],c=oi(fn)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var _=St(d)}catch(q){throw q===Rr?Ia:q}else _=d;d=ht();var C=d.queue,B=C.dispatch;return x!==d.memoizedState&&(Tn.flags|=2048,Ws(9,{destroy:void 0},Ym.bind(null,C,x),null)),[_,B,c]}function Ym(c,d){c.action=d}function du(c){var d=ht(),x=tn;if(x!==null)return io(d,x,c);ht(),d=d.memoizedState,x=ht();var _=x.queue.dispatch;return x.memoizedState=c,[d,_,!1]}function Ws(c,d,x,_){return c={tag:c,create:x,deps:_,inst:d,next:null},d=Tn.updateQueue,d===null&&(d=zt(),Tn.updateQueue=d),x=d.lastEffect,x===null?d.lastEffect=c.next=c:(_=x.next,x.next=c,c.next=_,d.lastEffect=c),c}function gh(){return ht().memoizedState}function dc(c,d,x,_){var C=mt();Tn.flags|=c,C.memoizedState=Ws(1|d,{destroy:void 0},x,_===void 0?null:_)}function Rd(c,d,x,_){var C=ht();_=_===void 0?null:_;var B=C.memoizedState.inst;tn!==null&&_!==null&&tt(_,tn.memoizedState.deps)?C.memoizedState=Ws(d,B,x,_):(Tn.flags|=c,C.memoizedState=Ws(1|d,B,x,_))}function Dd(c,d){dc(8390656,8,c,d)}function fu(c,d){Rd(2048,8,c,d)}function $v(c){Tn.flags|=4;var d=Tn.updateQueue;if(d===null)d=zt(),Tn.updateQueue=d,d.events=[c];else{var x=d.events;x===null?d.events=[c]:x.push(c)}}function ps(c){var d=ht().memoizedState;return $v({ref:d,nextImpl:c}),function(){if((Un&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}function _l(c,d){return Rd(4,2,c,d)}function Id(c,d){return Rd(4,4,c,d)}function hu(c,d){if(typeof d=="function"){c=c();var x=d(c);return function(){typeof x=="function"?x():d(null)}}if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function e1(c,d,x){x=x!=null?x.concat([c]):null,Rd(4,4,hu.bind(null,d,c),x)}function Bd(){}function vh(c,d){var x=ht();d=d===void 0?null:d;var _=x.memoizedState;return d!==null&&tt(d,_[1])?_[0]:(x.memoizedState=[c,d],c)}function pu(c,d){var x=ht();d=d===void 0?null:d;var _=x.memoizedState;if(d!==null&&tt(d,_[1]))return _[0];if(_=c(),Yn){ce(!0);try{c()}finally{ce(!1)}}return x.memoizedState=[_,d],_}function mu(c,d,x){return x===void 0||($o&1073741824)!==0&&(Vn&261930)===0?c.memoizedState=d:(c.memoizedState=x,c=ko(),Tn.lanes|=c,el|=c,x)}function Qm(c,d,x,_){return ur(x,d)?x:Nc.current!==null?(c=mu(c,x,_),ur(c,d)||(Li=!0),c):($o&42)===0||($o&1073741824)!==0&&(Vn&261930)===0?(Li=!0,c.memoizedState=x):(c=ko(),Tn.lanes|=c,el|=c,d)}function t1(c,d,x,_,C){var B=Ea();Gn(B!==0&&8>B?B:8);var q=sn.T,Ae={};sn.T=Ae,yh(c,!1,d,x);try{var it=C(),bt=sn.S;if(bt!==null&&bt(Ae,it),it!==null&&typeof it=="object"&&typeof it.then=="function"){var Lt=Fe(it,_);Nd(c,d,Lt,Fi(c))}else Nd(c,d,_,Fi(c))}catch(Ct){Nd(c,d,{then:function(){},status:"rejected",reason:Ct},Fi())}finally{Gn(B),q!==null&&Ae.types!==null&&(q.types=Ae.types),sn.T=q}}function n1(c){var d=c.memoizedState;if(d!==null)return d;d={memoizedState:Mc,baseState:Mc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fn,lastRenderedState:Mc},next:null};var x={};return d.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fn,lastRenderedState:x},next:null},c.memoizedState=d,c=c.alternate,c!==null&&(c.memoizedState=d),d}function qm(){return te(Tc)}function xh(){return ht().memoizedState}function i1(){return ht().memoizedState}function gS(c){for(var d=c.return;d!==null;){switch(d.tag){case 24:case 3:var x=Fi();c=xe(x);var _=Ge(d,c,x);_!==null&&(Xi(_,d,x),Je(_,d,x)),d={cache:Ye()},c.payload=d;return}d=d.return}}function vS(c,d,x){var _=Fi();x={lane:_,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Ah(c)?s1(d,x):(x=is(c,d,x,_),x!==null&&(Xi(x,c,_),a1(x,d,_)))}function r1(c,d,x){var _=Fi();Nd(c,d,x,_)}function Nd(c,d,x,_){var C={lane:_,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null};if(Ah(c))s1(d,C);else{var B=c.alternate;if(c.lanes===0&&(B===null||B.lanes===0)&&(B=d.lastRenderedReducer,B!==null))try{var q=d.lastRenderedState,Ae=B(q,x);if(C.hasEagerState=!0,C.eagerState=Ae,ur(Ae,q))return Xr(c,d,C,0),In===null&&ma(),!1}catch{}finally{}if(x=is(c,d,C,_),x!==null)return Xi(x,c,_),a1(x,d,_),!0}return!1}function yh(c,d,x,_){if(_={lane:2,revertLane:Be(),gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},Ah(c)){if(d)throw Error(r(479))}else d=is(c,x,_,2),d!==null&&Xi(d,c,2)}function Ah(c){var d=c.alternate;return c===Tn||d!==null&&d===Tn}function s1(c,d){Cn=Dn=!0;var x=c.pending;x===null?d.next=d:(d.next=x.next,x.next=d),c.pending=d}function a1(c,d,x){if((x&4194048)!==0){var _=d.lanes;_&=c.pendingLanes,x|=_,d.lanes=x,L(c,x)}}function Jm(c,d,x,_){d=c.memoizedState,x=x(_,d),x=x==null?d:Hh({},d,x),c.memoizedState=x,c.lanes===0&&(c.updateQueue.baseState=x)}function _h(c,d,x,_,C,B,q){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,B,q):d.prototype&&d.prototype.isPureReactComponent?!ut(x,_)||!ut(C,B):!0}function o1(c,d,x,_){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(x,_),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(x,_),d.state!==c&&lf.enqueueReplaceState(d,d.state,null)}function fc(c,d){var x=d;if("ref"in d){x={};for(var _ in d)_!=="ref"&&(x[_]=d[_])}if(c=c.defaultProps){x===d&&(x=Hh({},x));for(var C in c)x[C]===void 0&&(x[C]=c[C])}return x}function Sh(c,d){try{var x=c.onUncaughtError;x(d.value,{componentStack:d.stack})}catch(_){setTimeout(function(){throw _})}}function Km(c,d,x){try{var _=c.onCaughtError;_(x.value,{componentStack:x.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Zm(c,d,x){return x=xe(x),x.tag=3,x.payload={element:null},x.callback=function(){Sh(c,d)},x}function l1(c){return c=xe(c),c.tag=3,c}function c1(c,d,x,_){var C=x.type.getDerivedStateFromError;if(typeof C=="function"){var B=_.value;c.payload=function(){return C(B)},c.callback=function(){Km(d,x,_)}}var q=x.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(c.callback=function(){Km(d,x,_),typeof C!="function"&&(tl===null?tl=new Set([this]):tl.add(this));var Ae=_.stack;this.componentDidCatch(_.value,{componentStack:Ae!==null?Ae:""})})}function xS(c,d,x,_,C){if(x.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(d=x.alternate,d!==null&&Dt(d,x,C,!0),x=Os.current,x!==null){switch(x.tag){case 31:case 13:return Ls===null?Tu():x.alternate===null&&Ji===0&&(Ji=3),x.flags&=-257,x.flags|=65536,x.lanes=C,_===_o?x.flags|=16384:(d=x.updateQueue,d===null?x.updateQueue=new Set([_]):d.add(_),Ru(c,_,C)),!1;case 22:return x.flags|=65536,_===_o?x.flags|=16384:(d=x.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([_])},x.updateQueue=d):(x=d.retryQueue,x===null?d.retryQueue=new Set([_]):x.add(_)),Ru(c,_,C)),!1}throw Error(r(435,x.tag))}return Ru(c,_,C),Tu(),!1}if(kn)return d=Os.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=C,_!==cp&&(c=Error(r(422),{cause:_}),st(Te(c,x)))):(_!==cp&&(d=Error(r(423),{cause:_}),st(Te(d,x))),c=c.current.alternate,c.flags|=65536,C&=-C,c.lanes|=C,_=Te(_,x),C=Zm(c.stateNode,_,C),Ke(c,C),Ji!==4&&(Ji=2)),!1;var B=Error(r(520),{cause:_});if(B=Te(B,x),uf===null?uf=[B]:uf.push(B),Ji!==4&&(Ji=2),d===null)return!0;_=Te(_,x),x=d;do{switch(x.tag){case 3:return x.flags|=65536,c=C&-C,x.lanes|=c,c=Zm(x.stateNode,_,c),Ke(x,c),!1;case 1:if(d=x.type,B=x.stateNode,(x.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(tl===null||!tl.has(B))))return x.flags|=65536,C&=-C,x.lanes|=C,C=l1(C),c1(C,c,x,_),Ke(x,C),!1}x=x.return}while(x!==null);return!1}function Yr(c,d,x,_){d.child=c===null?ng(d,null,x,_):Jr(d,c.child,x,_)}function u1(c,d,x,_,C){x=x.render;var B=d.ref;if("ref"in _){var q={};for(var Ae in _)Ae!=="ref"&&(q[Ae]=_[Ae])}else q=_;return Tt(d),_=He(c,d,x,q,B,C),Ae=Wt(),c!==null&&!Li?(ln(c,d,C),ro(c,d,C)):(kn&&Ae&&me(d),d.flags|=1,Yr(c,d,_,C),d.child)}function d1(c,d,x,_,C){if(c===null){var B=x.type;return typeof B=="function"&&!vc(B)&&B.defaultProps===void 0&&x.compare===null?(d.tag=15,d.type=B,f1(c,d,B,_,C)):(c=Wo(x.type,null,_,d,d.mode,C),c.ref=d.ref,c.return=d,d.child=c)}if(B=c.child,!Ld(c,C)){var q=B.memoizedProps;if(x=x.compare,x=x!==null?x:ut,x(q,_)&&c.ref===d.ref)return ro(c,d,C)}return d.flags|=1,c=Qs(B,_),c.ref=d.ref,c.return=d,d.child=c}function f1(c,d,x,_,C){if(c!==null){var B=c.memoizedProps;if(ut(B,_)&&c.ref===d.ref)if(Li=!1,d.pendingProps=_=B,Ld(c,C))(c.flags&131072)!==0&&(Li=!0);else return d.lanes=c.lanes,ro(c,d,C)}return Eh(c,d,x,_,C)}function h1(c,d,x,_){var C=_.children,B=c!==null?c.memoizedState:null;if(c===null&&d.stateNode===null&&(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),_.mode==="hidden"){if((d.flags&128)!==0){if(B=B!==null?B.baseLanes|x:x,c!==null){for(_=d.child=c.child,C=0;_!==null;)C=C|_.lanes|_.childLanes,_=_.sibling;_=C&~B}else _=0,d.child=null;return gu(c,d,B,x,_)}if((x&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},c!==null&&It(d,B!==null?B.cachePool:null),B!==null?_e(d,B):De(),ae(d);else return _=d.lanes=536870912,gu(c,d,B!==null?B.baseLanes|x:x,x,_)}else B!==null?(It(d,B.cachePool),_e(d,B),ie(),d.memoizedState=null):(c!==null&&It(d,null),De(),ie());return Yr(c,d,C,x),d.child}function hc(c,d){return c!==null&&c.tag===22||d.stateNode!==null||(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.sibling}function gu(c,d,x,_,C){var B=Oe();return B=B===null?null:{parent:lr?Gi._currentValue:Gi._currentValue2,pool:B},d.memoizedState={baseLanes:x,cachePool:B},c!==null&&It(d,null),De(),ae(d),c!==null&&Dt(c,d,_,!0),d.childLanes=C,null}function bh(c,d){return d=Sl({mode:d.mode,children:d.children},c.mode),d.ref=c.ref,c.child=d,d.return=c,d}function $m(c,d,x){return Jr(d,c.child,null,x),c=bh(d,d.pendingProps),c.flags|=2,we(d),d.memoizedState=null,c}function p1(c,d,x){var _=d.pendingProps,C=(d.flags&128)!==0;if(d.flags&=-129,c===null){if(kn){if(_.mode==="hidden")return c=bh(d,_),d.lanes=536870912,hc(null,c);if(se(d),(c=Hi)?(c=H0(c,ys),c!==null&&(d.memoizedState={dehydrated:c,treeContext:wa!==null?{id:Qr,overflow:Va}:null,retryLane:536870912,hydrationErrors:null},x=g0(c),x.return=d,d.child=x,wr=d,Hi=null)):c=null,c===null)throw Ee(d);return d.lanes=536870912,null}return bh(d,_)}var B=c.memoizedState;if(B!==null){var q=B.dehydrated;if(se(d),C)if(d.flags&256)d.flags&=-257,d=$m(c,d,x);else if(d.memoizedState!==null)d.child=c.child,d.flags|=128,d=null;else throw Error(r(558));else if(Li||Dt(c,d,x,!1),C=(x&c.childLanes)!==0,Li||C){if(_=In,_!==null&&(q=H(_,x),q!==0&&q!==B.retryLane))throw B.retryLane=q,rn(c,q),Xi(_,c,q),_s;Tu(),d=$m(c,d,x)}else c=B.treeContext,zi&&(Hi=K1(q),wr=d,kn=!0,Ao=null,ys=!1,c!==null&&Ze(d,c)),d=bh(d,_),d.flags|=4096;return d}return c=Qs(c.child,{mode:_.mode,children:_.children}),c.ref=d.ref,d.child=c,c.return=d,c}function Od(c,d){var x=d.ref;if(x===null)c!==null&&c.ref!==null&&(d.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(r(284));(c===null||c.ref!==x)&&(d.flags|=4194816)}}function Eh(c,d,x,_,C){return Tt(d),x=He(c,d,x,_,void 0,C),_=Wt(),c!==null&&!Li?(ln(c,d,C),ro(c,d,C)):(kn&&_&&me(d),d.flags|=1,Yr(c,d,x,C),d.child)}function e0(c,d,x,_,C,B){return Tt(d),d.updateQueue=null,x=nt(d,_,x,C),at(c),_=Wt(),c!==null&&!Li?(ln(c,d,B),ro(c,d,B)):(kn&&_&&me(d),d.flags|=1,Yr(c,d,x,B),d.child)}function pc(c,d,x,_,C){if(Tt(d),d.stateNode===null){var B=vo,q=x.contextType;typeof q=="object"&&q!==null&&(B=te(q)),B=new x(_,B),d.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=lf,d.stateNode=B,B._reactInternals=d,B=d.stateNode,B.props=_,B.state=d.memoizedState,B.refs={},V(d),q=x.contextType,B.context=typeof q=="object"&&q!==null?te(q):vo,B.state=d.memoizedState,q=x.getDerivedStateFromProps,typeof q=="function"&&(Jm(d,x,q,_),B.state=d.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(q=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),q!==B.state&&lf.enqueueReplaceState(B,B.state,null),k(d,_,B,C),N(),B.state=d.memoizedState),typeof B.componentDidMount=="function"&&(d.flags|=4194308),_=!0}else if(c===null){B=d.stateNode;var Ae=d.memoizedProps,it=fc(x,Ae);B.props=it;var bt=B.context,Lt=x.contextType;q=vo,typeof Lt=="object"&&Lt!==null&&(q=te(Lt));var Ct=x.getDerivedStateFromProps;Lt=typeof Ct=="function"||typeof B.getSnapshotBeforeUpdate=="function",Ae=d.pendingProps!==Ae,Lt||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Ae||bt!==q)&&o1(d,B,_,q),Ks=!1;var Xt=d.memoizedState;B.state=Xt,k(d,_,B,C),N(),bt=d.memoizedState,Ae||Xt!==bt||Ks?(typeof Ct=="function"&&(Jm(d,x,Ct,_),bt=d.memoizedState),(it=Ks||_h(d,x,it,_,Xt,bt,q))?(Lt||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(d.flags|=4194308)):(typeof B.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=_,d.memoizedState=bt),B.props=_,B.state=bt,B.context=q,_=it):(typeof B.componentDidMount=="function"&&(d.flags|=4194308),_=!1)}else{B=d.stateNode,ee(c,d),q=d.memoizedProps,Lt=fc(x,q),B.props=Lt,Ct=d.pendingProps,Xt=B.context,bt=x.contextType,it=vo,typeof bt=="object"&&bt!==null&&(it=te(bt)),Ae=x.getDerivedStateFromProps,(bt=typeof Ae=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(q!==Ct||Xt!==it)&&o1(d,B,_,it),Ks=!1,Xt=d.memoizedState,B.state=Xt,k(d,_,B,C),N();var Sn=d.memoizedState;q!==Ct||Xt!==Sn||Ks||c!==null&&c.dependencies!==null&&qt(c.dependencies)?(typeof Ae=="function"&&(Jm(d,x,Ae,_),Sn=d.memoizedState),(Lt=Ks||_h(d,x,Lt,_,Xt,Sn,it)||c!==null&&c.dependencies!==null&&qt(c.dependencies))?(bt||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(_,Sn,it),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(_,Sn,it)),typeof B.componentDidUpdate=="function"&&(d.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof B.componentDidUpdate!="function"||q===c.memoizedProps&&Xt===c.memoizedState||(d.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||q===c.memoizedProps&&Xt===c.memoizedState||(d.flags|=1024),d.memoizedProps=_,d.memoizedState=Sn),B.props=_,B.state=Sn,B.context=it,_=Lt):(typeof B.componentDidUpdate!="function"||q===c.memoizedProps&&Xt===c.memoizedState||(d.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||q===c.memoizedProps&&Xt===c.memoizedState||(d.flags|=1024),_=!1)}return B=_,Od(c,d),_=(d.flags&128)!==0,B||_?(B=d.stateNode,x=_&&typeof x.getDerivedStateFromError!="function"?null:B.render(),d.flags|=1,c!==null&&_?(d.child=Jr(d,c.child,null,C),d.child=Jr(d,null,x,C)):Yr(c,d,x,C),d.memoizedState=B.state,c=d.child):c=ro(c,d,C),c}function m1(c,d,x,_){return Mt(),d.flags|=256,Yr(c,d,x,_),d.child}function t0(c){return{baseLanes:c,cachePool:_t()}}function n0(c,d,x){return c=c!==null?c.childLanes&~x:0,d&&(c|=Ss),c}function i0(c,d,x){var _=d.pendingProps,C=!1,B=(d.flags&128)!==0,q;if((q=B)||(q=c!==null&&c.memoizedState===null?!1:(nr.current&2)!==0),q&&(C=!0,d.flags&=-129),q=(d.flags&32)!==0,d.flags&=-33,c===null){if(kn){if(C?Z(d):ie(),(c=Hi)?(c=tx(c,ys),c!==null&&(d.memoizedState={dehydrated:c,treeContext:wa!==null?{id:Qr,overflow:Va}:null,retryLane:536870912,hydrationErrors:null},x=g0(c),x.return=d,d.child=x,wr=d,Hi=null)):c=null,c===null)throw Ee(d);return Qh(c)?d.lanes=32:d.lanes=536870912,null}var Ae=_.children;return _=_.fallback,C?(ie(),C=d.mode,Ae=Sl({mode:"hidden",children:Ae},C),_=Sa(_,C,x,null),Ae.return=d,_.return=d,Ae.sibling=_,d.child=Ae,_=d.child,_.memoizedState=t0(x),_.childLanes=n0(c,q,x),d.memoizedState=Oc,hc(null,_)):(Z(d),Mh(d,Ae))}var it=c.memoizedState;if(it!==null&&(Ae=it.dehydrated,Ae!==null)){if(B)d.flags&256?(Z(d),d.flags&=-257,d=mc(c,d,x)):d.memoizedState!==null?(ie(),d.child=c.child,d.flags|=128,d=null):(ie(),Ae=_.fallback,C=d.mode,_=Sl({mode:"visible",children:_.children},C),Ae=Sa(Ae,C,x,null),Ae.flags|=2,_.return=d,Ae.return=d,_.sibling=Ae,d.child=_,Jr(d,c.child,null,x),_=d.child,_.memoizedState=t0(x),_.childLanes=n0(c,q,x),d.memoizedState=Oc,d=hc(null,_));else if(Z(d),Qh(Ae))q=qh(Ae).digest,_=Error(r(419)),_.stack="",_.digest=q,st({value:_,source:null,stack:null}),d=mc(c,d,x);else if(Li||Dt(c,d,x,!1),q=(x&c.childLanes)!==0,Li||q){if(q=In,q!==null&&(_=H(q,x),_!==0&&_!==it.retryLane))throw it.retryLane=_,rn(c,_),Xi(q,c,_),_s;Ll(Ae)||Tu(),d=mc(c,d,x)}else Ll(Ae)?(d.flags|=192,d.child=c.child,d=null):(c=it.treeContext,zi&&(Hi=Z1(Ae),wr=d,kn=!0,Ao=null,ys=!1,c!==null&&Ze(d,c)),d=Mh(d,_.children),d.flags|=4096);return d}return C?(ie(),Ae=_.fallback,C=d.mode,it=c.child,B=it.sibling,_=Qs(it,{mode:"hidden",children:_.children}),_.subtreeFlags=it.subtreeFlags&65011712,B!==null?Ae=Qs(B,Ae):(Ae=Sa(Ae,C,x,null),Ae.flags|=2),Ae.return=d,_.return=d,_.sibling=Ae,d.child=_,hc(null,_),_=d.child,Ae=c.child.memoizedState,Ae===null?Ae=t0(x):(C=Ae.cachePool,C!==null?(it=lr?Gi._currentValue:Gi._currentValue2,C=C.parent!==it?{parent:it,pool:it}:C):C=_t(),Ae={baseLanes:Ae.baseLanes|x,cachePool:C}),_.memoizedState=Ae,_.childLanes=n0(c,q,x),d.memoizedState=Oc,hc(c.child,_)):(Z(d),x=c.child,c=x.sibling,x=Qs(x,{mode:"visible",children:_.children}),x.return=d,x.sibling=null,c!==null&&(q=d.deletions,q===null?(d.deletions=[c],d.flags|=16):q.push(c)),d.child=x,d.memoizedState=null,x)}function Mh(c,d){return d=Sl({mode:"visible",children:d},c.mode),d.return=c,c.child=d}function Sl(c,d){return c=t(22,c,null,d),c.lanes=0,c}function mc(c,d,x){return Jr(d,c.child,null,x),c=Mh(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function g1(c,d,x){c.lanes|=d;var _=c.alternate;_!==null&&(_.lanes|=d),oe(c.return,d,x)}function vu(c,d,x,_,C,B){var q=c.memoizedState;q===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:_,tail:x,tailMode:C,treeForkCount:B}:(q.isBackwards=d,q.rendering=null,q.renderingStartTime=0,q.last=_,q.tail=x,q.tailMode=C,q.treeForkCount=B)}function r0(c,d,x){var _=d.pendingProps,C=_.revealOrder,B=_.tail;_=_.children;var q=nr.current,Ae=(q&2)!==0;if(Ae?(q=q&1|2,d.flags|=128):q&=1,S(nr,q),Yr(c,d,_,x),_=kn?sf:0,!Ae&&c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&g1(c,x,d);else if(c.tag===19)g1(c,x,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}switch(C){case"forwards":for(x=d.child,C=null;x!==null;)c=x.alternate,c!==null&&Ie(c)===null&&(C=x),x=x.sibling;x=C,x===null?(C=d.child,d.child=null):(C=x.sibling,x.sibling=null),vu(d,!1,C,x,B,_);break;case"backwards":case"unstable_legacy-backwards":for(x=null,C=d.child,d.child=null;C!==null;){if(c=C.alternate,c!==null&&Ie(c)===null){d.child=C;break}c=C.sibling,C.sibling=x,x=C,C=c}vu(d,!0,x,null,B,_);break;case"together":vu(d,!1,null,null,void 0,_);break;default:d.memoizedState=null}return d.child}function ro(c,d,x){if(c!==null&&(d.dependencies=c.dependencies),el|=d.lanes,(x&d.childLanes)===0)if(c!==null){if(Dt(c,d,x,!1),(x&d.childLanes)===0)return null}else return null;if(c!==null&&d.child!==c.child)throw Error(r(153));if(d.child!==null){for(c=d.child,x=Qs(c,c.pendingProps),d.child=x,x.return=d;c.sibling!==null;)c=c.sibling,x=x.sibling=Qs(c,c.pendingProps),x.return=d;x.sibling=null}return d.child}function Ld(c,d){return(c.lanes&d)!==0?!0:(c=c.dependencies,!!(c!==null&&qt(c)))}function s0(c,d,x){switch(d.tag){case 3:xt(d,d.stateNode.containerInfo),et(d,Gi,c.memoizedState.cache),Mt();break;case 27:case 5:ze(d);break;case 4:xt(d,d.stateNode.containerInfo);break;case 10:et(d,d.type,d.memoizedProps.value);break;case 31:if(d.memoizedState!==null)return d.flags|=128,se(d),null;break;case 13:var _=d.memoizedState;if(_!==null)return _.dehydrated!==null?(Z(d),d.flags|=128,null):(x&d.child.childLanes)!==0?i0(c,d,x):(Z(d),c=ro(c,d,x),c!==null?c.sibling:null);Z(d);break;case 19:var C=(c.flags&128)!==0;if(_=(x&d.childLanes)!==0,_||(Dt(c,d,x,!1),_=(x&d.childLanes)!==0),C){if(_)return r0(c,d,x);d.flags|=128}if(C=d.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),S(nr,nr.current),_)break;return null;case 22:return d.lanes=0,h1(c,d,x,d.pendingProps);case 24:et(d,Gi,c.memoizedState.cache)}return ro(c,d,x)}function a0(c,d,x){if(c!==null)if(c.memoizedProps!==d.pendingProps)Li=!0;else{if(!Ld(c,x)&&(d.flags&128)===0)return Li=!1,s0(c,d,x);Li=(c.flags&131072)!==0}else Li=!1,kn&&(d.flags&1048576)!==0&&Y(d,sf,d.index);switch(d.lanes=0,d.tag){case 16:e:{var _=d.pendingProps;if(c=yn(d.elementType),d.type=c,typeof c=="function")vc(c)?(_=fc(c,_),d.tag=1,d=pc(null,d,c,_,x)):(d.tag=0,d=Eh(null,d,c,_,x));else{if(c!=null){var C=c.$$typeof;if(C===Du){d.tag=11,d=u1(null,d,c,_,x);break e}else if(C===kh){d.tag=14,d=d1(null,d,c,_,x);break e}}throw d=v(c)||c,Error(r(306,d,""))}}return d;case 0:return Eh(c,d,d.type,d.pendingProps,x);case 1:return _=d.type,C=fc(_,d.pendingProps),pc(c,d,_,C,x);case 3:e:{if(xt(d,d.stateNode.containerInfo),c===null)throw Error(r(387));var B=d.pendingProps;C=d.memoizedState,_=C.element,ee(c,d),k(d,B,null,x);var q=d.memoizedState;if(B=q.cache,et(d,Gi,B),B!==C.cache&&Gt(d,[Gi],x,!0),N(),B=q.element,zi&&C.isDehydrated)if(C={element:B,isDehydrated:!1,cache:q.cache},d.updateQueue.baseState=C,d.memoizedState=C,d.flags&256){d=m1(c,d,B,x);break e}else if(B!==_){_=Te(Error(r(424)),d),st(_),d=m1(c,d,B,x);break e}else for(zi&&(Hi=J1(d.stateNode.containerInfo),wr=d,kn=!0,Ao=null,ys=!0),x=ng(d,null,B,x),d.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(Mt(),B===_){d=ro(c,d,x);break e}Yr(c,d,B,x)}d=d.child}return d;case 26:if(Ma)return Od(c,d),c===null?(x=W0(d.type,null,d.pendingProps,null))?d.memoizedState=x:kn||(d.stateNode=$h(d.type,d.pendingProps,qr.current,d)):d.memoizedState=W0(d.type,c.memoizedProps,d.pendingProps,c.memoizedState),null;case 27:if(Tr)return ze(d),c===null&&Tr&&kn&&(_=d.stateNode=ep(d.type,d.pendingProps,qr.current,Fr.current,!1),wr=d,ys=!0,Hi=z0(d.type,_,Hi)),Yr(c,d,d.pendingProps.children,x),Od(c,d),c===null&&(d.flags|=4194304),d.child;case 5:return c===null&&kn&&(ux(d.type,d.pendingProps,Fr.current),(C=_=Hi)&&(_=$1(_,d.type,d.pendingProps,ys),_!==null?(d.stateNode=_,wr=d,Hi=q1(_),ys=!1,C=!0):C=!1),C||Ee(d)),ze(d),C=d.type,B=d.pendingProps,q=c!==null?c.memoizedProps:null,_=B.children,xs(C,B)?_=null:q!==null&&xs(C,q)&&(d.flags|=32),d.memoizedState!==null&&(C=He(c,d,Et,null,null,x),lr?Tc._currentValue=C:Tc._currentValue2=C),Od(c,d),Yr(c,d,_,x),d.child;case 6:return c===null&&kn&&(j0(d.pendingProps,Fr.current),(c=x=Hi)&&(x=ex(x,d.pendingProps,ys),x!==null?(d.stateNode=x,wr=d,Hi=null,c=!0):c=!1),c||Ee(d)),null;case 13:return i0(c,d,x);case 4:return xt(d,d.stateNode.containerInfo),_=d.pendingProps,c===null?d.child=Jr(d,null,_,x):Yr(c,d,_,x),d.child;case 11:return u1(c,d,d.type,d.pendingProps,x);case 7:return Yr(c,d,d.pendingProps,x),d.child;case 8:return Yr(c,d,d.pendingProps.children,x),d.child;case 12:return Yr(c,d,d.pendingProps.children,x),d.child;case 10:return _=d.pendingProps,et(d,d.type,_.value),Yr(c,d,_.children,x),d.child;case 9:return C=d.type._context,_=d.pendingProps.children,Tt(d),C=te(C),_=_(C),d.flags|=1,Yr(c,d,_,x),d.child;case 14:return d1(c,d,d.type,d.pendingProps,x);case 15:return f1(c,d,d.type,d.pendingProps,x);case 19:return r0(c,d,x);case 31:return p1(c,d,x);case 22:return h1(c,d,x,d.pendingProps);case 24:return Tt(d),_=te(Gi),c===null?(C=Oe(),C===null&&(C=In,B=Ye(),C.pooledCache=B,B.refCount++,B!==null&&(C.pooledCacheLanes|=x),C=B),d.memoizedState={parent:_,cache:C},V(d),et(d,Gi,C)):((c.lanes&x)!==0&&(ee(c,d),k(d,null,null,x),N()),C=c.memoizedState,B=d.memoizedState,C.parent!==_?(C={parent:_,cache:_},d.memoizedState=C,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=C),et(d,Gi,_)):(_=B.cache,et(d,Gi,_),_!==C.cache&&Gt(d,[Gi],x,!0))),Yr(c,d,d.pendingProps.children,x),d.child;case 29:throw d.pendingProps}throw Error(r(156,d.tag))}function va(c){c.flags|=4}function Pd(c){qs&&(c.flags|=8)}function v1(c,d){if(c!==null&&c.child===d.child)return!1;if((d.flags&16)!==0)return!0;for(c=d.child;c!==null;){if((c.flags&8218)!==0||(c.subtreeFlags&8218)!==0)return!0;c=c.sibling}return!1}function o0(c,d,x,_){if(Xn)for(x=d.child;x!==null;){if(x.tag===5||x.tag===6)Jd(c,x.stateNode);else if(!(x.tag===4||Tr&&x.tag===27)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===d)break;for(;x.sibling===null;){if(x.return===null||x.return===d)return;x=x.return}x.sibling.return=x.return,x=x.sibling}else if(qs)for(var C=d.child;C!==null;){if(C.tag===5){var B=C.stateNode;x&&_&&(B=W1(B,C.type,C.memoizedProps)),Jd(c,B)}else if(C.tag===6)B=C.stateNode,x&&_&&(B=U0(B,C.memoizedProps)),Jd(c,B);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)B=C.child,B!==null&&(B.return=C),o0(c,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===d)break;for(;C.sibling===null;){if(C.return===null||C.return===d)return;C=C.return}C.sibling.return=C.return,C=C.sibling}}function x1(c,d,x,_){var C=!1;if(qs)for(var B=d.child;B!==null;){if(B.tag===5){var q=B.stateNode;x&&_&&(q=W1(q,B.type,B.memoizedProps)),L0(c,q)}else if(B.tag===6)q=B.stateNode,x&&_&&(q=U0(q,B.memoizedProps)),L0(c,q);else if(B.tag!==4){if(B.tag===22&&B.memoizedState!==null)C=B.child,C!==null&&(C.return=B),x1(c,B,!0,!0),C=!0;else if(B.child!==null){B.child.return=B,B=B.child;continue}}if(B===d)break;for(;B.sibling===null;){if(B.return===null||B.return===d)return C;B=B.return}B.sibling.return=B.return,B=B.sibling}return C}function y1(c,d){if(qs&&v1(c,d)){c=d.stateNode;var x=c.containerInfo,_=O0();x1(_,d,!1,!1),c.pendingChildren=_,va(d),j1(x,_)}}function l0(c,d,x,_){if(Xn)c.memoizedProps!==_&&va(d);else if(qs){var C=c.stateNode,B=c.memoizedProps;if((c=v1(c,d))||B!==_){var q=Fr.current;B=V1(C,x,B,_,!c,null),B===C?d.stateNode=C:(Pd(d),Ds(B,x,_,q)&&va(d),d.stateNode=B,c&&o0(B,d,!1,!1))}else d.stateNode=C}}function ms(c,d,x,_,C){if((c.mode&32)!==0&&(x===null?Kd(d,_):Lu(d,x,_))){if(c.flags|=16777216,(C&335544128)===C||b0(d,_))if(Yi(c.stateNode,d,_))c.flags|=8192;else if(Wn())c.flags|=8192;else throw As=_o,dp}else c.flags&=-16777217}function xu(c,d){if(q0(d)){if(c.flags|=16777216,!J0(d))if(Wn())c.flags|=8192;else throw As=_o,dp}else c.flags&=-16777217}function Ud(c,d){d!==null&&(c.flags|=4),c.flags&16384&&(d=c.tag!==22?O():536870912,c.lanes|=d,ju|=d)}function yu(c,d){if(!kn)switch(c.tailMode){case"hidden":d=c.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?c.tail=null:x.sibling=null;break;case"collapsed":x=c.tail;for(var _=null;x!==null;)x.alternate!==null&&(_=x),x=x.sibling;_===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function wi(c){var d=c.alternate!==null&&c.alternate.child===c.child,x=0,_=0;if(d)for(var C=c.child;C!==null;)x|=C.lanes|C.childLanes,_|=C.subtreeFlags&65011712,_|=C.flags&65011712,C.return=c,C=C.sibling;else for(C=c.child;C!==null;)x|=C.lanes|C.childLanes,_|=C.subtreeFlags,_|=C.flags,C.return=c,C=C.sibling;return c.subtreeFlags|=_,c.childLanes=x,d}function A1(c,d,x){var _=d.pendingProps;switch(Ce(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wi(d),null;case 1:return wi(d),null;case 3:return x=d.stateNode,_=null,c!==null&&(_=c.memoizedState.cache),d.memoizedState.cache!==_&&(d.flags|=2048),At(Gi),ve(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(c===null||c.child===null)&&(Ot(d)?va(d):c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,je())),y1(c,d),wi(d),null;case 26:if(Ma){var C=d.type,B=d.memoizedState;return c===null?(va(d),B!==null?(wi(d),xu(d,B)):(wi(d),ms(d,C,null,_,x))):B?B!==c.memoizedState?(va(d),wi(d),xu(d,B)):(wi(d),d.flags&=-16777217):(B=c.memoizedProps,Xn?B!==_&&va(d):l0(c,d,C,_),wi(d),ms(d,C,B,_,x)),null}case 27:if(Tr){if(dt(d),x=qr.current,C=d.type,c!==null&&d.stateNode!=null)Xn?c.memoizedProps!==_&&va(d):l0(c,d,C,_);else{if(!_){if(d.stateNode===null)throw Error(r(166));return wi(d),null}c=Fr.current,Ot(d)?yt(d,c):(c=ep(C,_,x,c,!0),d.stateNode=c,va(d))}return wi(d),null}case 5:if(dt(d),C=d.type,c!==null&&d.stateNode!=null)l0(c,d,C,_);else{if(!_){if(d.stateNode===null)throw Error(r(166));return wi(d),null}if(B=Fr.current,Ot(d))yt(d,B),ox(d.stateNode,C,_,B)&&(d.flags|=64);else{var q=_0(C,_,qr.current,B,d);Pd(d),o0(q,d,!1,!1),d.stateNode=q,Ds(q,C,_,B)&&va(d)}}return wi(d),ms(d,d.type,c===null?null:c.memoizedProps,d.pendingProps,x),null;case 6:if(c&&d.stateNode!=null)x=c.memoizedProps,Xn?x!==_&&va(d):qs&&(x!==_?(c=qr.current,x=Fr.current,Pd(d),d.stateNode=Qo(_,c,x,d)):d.stateNode=c.stateNode);else{if(typeof _!="string"&&d.stateNode===null)throw Error(r(166));if(c=qr.current,x=Fr.current,Ot(d)){if(!zi)throw Error(r(176));if(c=d.stateNode,x=d.memoizedProps,_=null,C=wr,C!==null)switch(C.tag){case 27:case 5:_=C.memoizedProps}bS(c,x,d,_)||Ee(d,!0)}else Pd(d),d.stateNode=Qo(_,c,x,d)}return wi(d),null;case 31:if(x=d.memoizedState,c===null||c.memoizedState!==null){if(_=Ot(d),x!==null){if(c===null){if(!_)throw Error(r(318));if(!zi)throw Error(r(556));if(c=d.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(557));G0(c,d)}else Mt(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;wi(d),c=!1}else x=je(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=x),c=!0;if(!c)return d.flags&256?(we(d),d):(we(d),null);if((d.flags&128)!==0)throw Error(r(558))}return wi(d),null;case 13:if(_=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(C=Ot(d),_!==null&&_.dehydrated!==null){if(c===null){if(!C)throw Error(r(318));if(!zi)throw Error(r(344));if(C=d.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));ix(C,d)}else Mt(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;wi(d),C=!1}else C=je(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=C),C=!0;if(!C)return d.flags&256?(we(d),d):(we(d),null)}return we(d),(d.flags&128)!==0?(d.lanes=x,d):(x=_!==null,c=c!==null&&c.memoizedState!==null,x&&(_=d.child,C=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(C=_.alternate.memoizedState.cachePool.pool),B=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(B=_.memoizedState.cachePool.pool),B!==C&&(_.flags|=2048)),x!==c&&x&&(d.child.flags|=8192),Ud(d,d.updateQueue),wi(d),null);case 4:return ve(),y1(c,d),c===null&&mi(d.stateNode.containerInfo),wi(d),null;case 10:return At(d.type),wi(d),null;case 19:if(A(nr),_=d.memoizedState,_===null)return wi(d),null;if(C=(d.flags&128)!==0,B=_.rendering,B===null)if(C)yu(_,!1);else{if(Ji!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(B=Ie(c),B!==null){for(d.flags|=128,yu(_,!1),c=B.updateQueue,d.updateQueue=c,Ud(d,c),d.subtreeFlags=0,c=x,x=d.child;x!==null;)Uh(x,c),x=x.sibling;return S(nr,nr.current&1|2),kn&&Se(d,_.treeForkCount),d.child}c=c.sibling}_.tail!==null&&ss()>Xl&&(d.flags|=128,C=!0,yu(_,!1),d.lanes=4194304)}else{if(!C)if(c=Ie(B),c!==null){if(d.flags|=128,C=!0,c=c.updateQueue,d.updateQueue=c,Ud(d,c),yu(_,!0),_.tail===null&&_.tailMode==="hidden"&&!B.alternate&&!kn)return wi(d),null}else 2*ss()-_.renderingStartTime>Xl&&x!==536870912&&(d.flags|=128,C=!0,yu(_,!1),d.lanes=4194304);_.isBackwards?(B.sibling=d.child,d.child=B):(c=_.last,c!==null?c.sibling=B:d.child=B,_.last=B)}return _.tail!==null?(c=_.tail,_.rendering=c,_.tail=c.sibling,_.renderingStartTime=ss(),c.sibling=null,x=nr.current,S(nr,C?x&1|2:x&1),kn&&Se(d,_.treeForkCount),c):(wi(d),null);case 22:case 23:return we(d),P(),_=d.memoizedState!==null,c!==null?c.memoizedState!==null!==_&&(d.flags|=8192):_&&(d.flags|=8192),_?(x&536870912)!==0&&(d.flags&128)===0&&(wi(d),d.subtreeFlags&6&&(d.flags|=8192)):wi(d),x=d.updateQueue,x!==null&&Ud(d,x.retryQueue),x=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),_=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),_!==x&&(d.flags|=2048),c!==null&&A(Fl),null;case 24:return x=null,c!==null&&(x=c.memoizedState.cache),d.memoizedState.cache!==x&&(d.flags|=2048),At(Gi),wi(d),null;case 25:return null;case 30:return null}throw Error(r(156,d.tag))}function c0(c,d){switch(Ce(d),d.tag){case 1:return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return At(Gi),ve(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 26:case 27:case 5:return dt(d),null;case 31:if(d.memoizedState!==null){if(we(d),d.alternate===null)throw Error(r(340));Mt()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 13:if(we(d),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(r(340));Mt()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return A(nr),null;case 4:return ve(),null;case 10:return At(d.type),null;case 22:case 23:return we(d),P(),c!==null&&A(Fl),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 24:return At(Gi),null;case 25:return null;default:return null}}function _1(c,d){switch(Ce(d),d.tag){case 3:At(Gi),ve();break;case 26:case 27:case 5:dt(d);break;case 4:ve();break;case 31:d.memoizedState!==null&&we(d);break;case 13:we(d);break;case 19:A(nr);break;case 10:At(d.type);break;case 22:case 23:we(d),P(),c!==null&&A(Fl);break;case 24:At(Gi)}}function so(c,d){try{var x=d.updateQueue,_=x!==null?x.lastEffect:null;if(_!==null){var C=_.next;x=C;do{if((x.tag&c)===c){_=void 0;var B=x.create,q=x.inst;_=B(),q.destroy=_}x=x.next}while(x!==C)}}catch(Ae){mn(d,d.return,Ae)}}function ao(c,d,x){try{var _=d.updateQueue,C=_!==null?_.lastEffect:null;if(C!==null){var B=C.next;_=B;do{if((_.tag&c)===c){var q=_.inst,Ae=q.destroy;if(Ae!==void 0){q.destroy=void 0,C=d;var it=x,bt=Ae;try{bt()}catch(Lt){mn(C,it,Lt)}}}_=_.next}while(_!==B)}}catch(Lt){mn(d,d.return,Lt)}}function Au(c){var d=c.updateQueue;if(d!==null){var x=c.stateNode;try{ue(d,x)}catch(_){mn(c,c.return,_)}}}function Th(c,d,x){x.props=fc(c.type,c.memoizedProps),x.state=c.memoizedState;try{x.componentWillUnmount()}catch(_){mn(c,d,_)}}function _u(c,d){try{var x=c.ref;if(x!==null){switch(c.tag){case 26:case 27:case 5:var _=Bu(c.stateNode);break;case 30:_=c.stateNode;break;default:_=c.stateNode}typeof x=="function"?c.refCleanup=x(_):x.current=_}}catch(C){mn(c,d,C)}}function rs(c,d){var x=c.ref,_=c.refCleanup;if(x!==null)if(typeof _=="function")try{_()}catch(C){mn(c,d,C)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(C){mn(c,d,C)}else x.current=null}function gc(c){var d=c.type,x=c.memoizedProps,_=c.stateNode;try{L1(_,d,x,c)}catch(C){mn(c,c.return,C)}}function Fd(c,d,x){try{P1(c.stateNode,c.type,x,d,c)}catch(_){mn(c,c.return,_)}}function u0(c){return c.tag===5||c.tag===3||(Ma?c.tag===26:!1)||(Tr?c.tag===27&&wc(c.type):!1)||c.tag===4}function Ho(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||u0(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(Tr&&c.tag===27&&wc(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function wh(c,d,x){var _=c.tag;if(_===5||_===6)c=c.stateNode,d?F1(x,c,d):D0(x,c);else if(_!==4&&(Tr&&_===27&&wc(c.type)&&(x=c.stateNode,d=null),c=c.child,c!==null))for(wh(c,d,x),c=c.sibling;c!==null;)wh(c,d,x),c=c.sibling}function zd(c,d,x){var _=c.tag;if(_===5||_===6)c=c.stateNode,d?U1(x,c,d):R0(x,c);else if(_!==4&&(Tr&&_===27&&wc(c.type)&&(x=c.stateNode),c=c.child,c!==null))for(zd(c,d,x),c=c.sibling;c!==null;)zd(c,d,x),c=c.sibling}function d0(c,d,x){c=c.containerInfo;try{P0(c,x)}catch(_){mn(d,d.return,_)}}function S1(c){var d=c.stateNode,x=c.memoizedProps;try{yr(c.type,x,d,c)}catch(_){mn(c,c.return,_)}}function yS(c,d){for(Vh(c.containerInfo),dr=d;dr!==null;)if(c=dr,d=c.child,(c.subtreeFlags&1028)!==0&&d!==null)d.return=c,dr=d;else for(;dr!==null;){c=dr;var x=c.alternate;switch(d=c.flags,c.tag){case 0:if((d&4)!==0&&(d=c.updateQueue,d=d!==null?d.events:null,d!==null))for(var _=0;_<d.length;_++){var C=d[_];C.ref.impl=C.nextImpl}break;case 11:case 15:break;case 1:if((d&1024)!==0&&x!==null){d=void 0,_=c,C=x.memoizedProps,x=x.memoizedState;var B=_.stateNode;try{var q=fc(_.type,C);d=B.getSnapshotBeforeUpdate(q,x),B.__reactInternalSnapshotBeforeUpdate=d}catch(Ae){mn(_,_.return,Ae)}}break;case 3:(d&1024)!==0&&Xn&&N0(c.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(r(163))}if(d=c.sibling,d!==null){d.return=c.return,dr=d;break}dr=c.return}}function b1(c,d,x){var _=x.flags;switch(x.tag){case 0:case 11:case 15:gs(c,x),_&4&&so(5,x);break;case 1:if(gs(c,x),_&4)if(c=x.stateNode,d===null)try{c.componentDidMount()}catch(q){mn(x,x.return,q)}else{var C=fc(x.type,d.memoizedProps);d=d.memoizedState;try{c.componentDidUpdate(C,d,c.__reactInternalSnapshotBeforeUpdate)}catch(q){mn(x,x.return,q)}}_&64&&Au(x),_&512&&_u(x,x.return);break;case 3:if(gs(c,x),_&64&&(_=x.updateQueue,_!==null)){if(c=null,x.child!==null)switch(x.child.tag){case 27:case 5:c=Bu(x.child.stateNode);break;case 1:c=x.child.stateNode}try{ue(_,c)}catch(q){mn(x,x.return,q)}}break;case 27:Tr&&d===null&&_&4&&S1(x);case 26:case 5:if(gs(c,x),d===null){if(_&4)gc(x);else if(_&64){c=x.type,d=x.memoizedProps,C=x.stateNode;try{sx(C,c,d,x)}catch(q){mn(x,x.return,q)}}}_&512&&_u(x,x.return);break;case 12:gs(c,x);break;case 31:gs(c,x),_&4&&ya(c,x);break;case 13:gs(c,x),_&4&&Gd(c,x),_&64&&(_=x.memoizedState,_!==null&&(_=_.dehydrated,_!==null&&(x=AS.bind(null,x),Jh(_,x))));break;case 22:if(_=x.memoizedState!==null||ir,!_){d=d!==null&&d.memoizedState!==null||rr,C=ir;var B=rr;ir=_,(rr=d)&&!B?_a(c,x,(x.subtreeFlags&8772)!==0):gs(c,x),ir=C,rr=B}break;case 30:break;default:gs(c,x)}}function f0(c){var d=c.alternate;d!==null&&(c.alternate=null,f0(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&jh(d)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function xa(c,d,x){for(x=x.child;x!==null;)Hd(c,d,x),x=x.sibling}function Hd(c,d,x){if(Ns&&typeof Ns.onCommitFiberUnmount=="function")try{Ns.onCommitFiberUnmount(Dc,x)}catch{}switch(x.tag){case 26:if(Ma){rr||rs(x,d),xa(c,d,x),x.memoizedState?Pl(x.memoizedState):x.stateNode&&Q0(x.stateNode);break}case 27:if(Tr){rr||rs(x,d);var _=qi,C=fr;wc(x.type)&&(qi=x.stateNode,fr=!1),xa(c,d,x),Ur(x.stateNode),qi=_,fr=C;break}case 5:rr||rs(x,d);case 6:if(Xn){if(_=qi,C=fr,qi=null,xa(c,d,x),qi=_,fr=C,qi!==null)if(fr)try{I0(qi,x.stateNode)}catch(B){mn(x,d,B)}else try{z1(qi,x.stateNode)}catch(B){mn(x,d,B)}}else xa(c,d,x);break;case 18:Xn&&qi!==null&&(fr?Kh(qi,x.stateNode):V0(qi,x.stateNode));break;case 4:Xn?(_=qi,C=fr,qi=x.stateNode.containerInfo,fr=!0,xa(c,d,x),qi=_,fr=C):(qs&&d0(x.stateNode,x,O0()),xa(c,d,x));break;case 0:case 11:case 14:case 15:ao(2,x,d),rr||ao(4,x,d),xa(c,d,x);break;case 1:rr||(rs(x,d),_=x.stateNode,typeof _.componentWillUnmount=="function"&&Th(x,d,_)),xa(c,d,x);break;case 21:xa(c,d,x);break;case 22:rr=(_=rr)||x.memoizedState!==null,xa(c,d,x),rr=_;break;default:xa(c,d,x)}}function ya(c,d){if(zi&&d.memoizedState===null&&(c=d.alternate,c!==null&&(c=c.memoizedState,c!==null))){c=c.dehydrated;try{ES(c)}catch(x){mn(d,d.return,x)}}}function Gd(c,d){if(zi&&d.memoizedState===null&&(c=d.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{MS(c)}catch(x){mn(d,d.return,x)}}function Aa(c){switch(c.tag){case 31:case 13:case 19:var d=c.stateNode;return d===null&&(d=c.stateNode=new rg),d;case 22:return c=c.stateNode,d=c._retryCache,d===null&&(d=c._retryCache=new rg),d;default:throw Error(r(435,c.tag))}}function Go(c,d){var x=Aa(c);d.forEach(function(_){if(!x.has(_)){x.add(_);var C=_S.bind(null,c,_);_.then(C,C)}})}function Lr(c,d){var x=d.deletions;if(x!==null)for(var _=0;_<x.length;_++){var C=x[_],B=c,q=d;if(Xn){var Ae=q;e:for(;Ae!==null;){switch(Ae.tag){case 27:if(Tr){if(wc(Ae.type)){qi=Ae.stateNode,fr=!1;break e}break}case 5:qi=Ae.stateNode,fr=!1;break e;case 3:case 4:qi=Ae.stateNode.containerInfo,fr=!0;break e}Ae=Ae.return}if(qi===null)throw Error(r(160));Hd(B,q,C),qi=null,fr=!1}else Hd(B,q,C);B=C.alternate,B!==null&&(B.return=null),C.return=null}if(d.subtreeFlags&13886)for(d=d.child;d!==null;)kd(d,c),d=d.sibling}function kd(c,d){var x=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:Lr(d,c),Pr(c),_&4&&(ao(3,c,c.return),so(3,c),ao(5,c,c.return));break;case 1:Lr(d,c),Pr(c),_&512&&(rr||x===null||rs(x,x.return)),_&64&&ir&&(c=c.updateQueue,c!==null&&(_=c.callbacks,_!==null&&(x=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=x===null?_:x.concat(_))));break;case 26:if(Ma){var C=hi;if(Lr(d,c),Pr(c),_&512&&(rr||x===null||rs(x,x.return)),_&4){_=x!==null?x.memoizedState:null;var B=c.memoizedState;x===null?B===null?c.stateNode===null?c.stateNode=dx(C,c.type,c.memoizedProps,c):Y0(C,c.type,c.stateNode):c.stateNode=X0(C,B,c.memoizedProps):_!==B?(_===null?x.stateNode!==null&&Q0(x.stateNode):Pl(_),B===null?Y0(C,c.type,c.stateNode):X0(C,B,c.memoizedProps)):B===null&&c.stateNode!==null&&Fd(c,c.memoizedProps,x.memoizedProps)}break}case 27:if(Tr){Lr(d,c),Pr(c),_&512&&(rr||x===null||rs(x,x.return)),x!==null&&_&4&&Fd(c,c.memoizedProps,x.memoizedProps);break}case 5:if(Lr(d,c),Pr(c),_&512&&(rr||x===null||rs(x,x.return)),Xn){if(c.flags&32){C=c.stateNode;try{B0(C)}catch(Ct){mn(c,c.return,Ct)}}_&4&&c.stateNode!=null&&(C=c.memoizedProps,Fd(c,C,x!==null?x.memoizedProps:C)),_&1024&&(zu=!0)}else qs&&c.alternate!==null&&(c.alternate.stateNode=c.stateNode);break;case 6:if(Lr(d,c),Pr(c),_&4&&Xn){if(c.stateNode===null)throw Error(r(162));_=c.memoizedProps,x=x!==null?x.memoizedProps:_,C=c.stateNode;try{O1(C,x,_)}catch(Ct){mn(c,c.return,Ct)}}break;case 3:if(Ma?(fx(),C=hi,hi=ef(d.containerInfo),Lr(d,c),hi=C):Lr(d,c),Pr(c),_&4){if(Xn&&zi&&x!==null&&x.memoizedState.isDehydrated)try{ax(d.containerInfo)}catch(Ct){mn(c,c.return,Ct)}if(qs){_=d.containerInfo,x=d.pendingChildren;try{P0(_,x)}catch(Ct){mn(c,c.return,Ct)}}}zu&&(zu=!1,Ch(c));break;case 4:Ma?(x=hi,hi=ef(c.stateNode.containerInfo),Lr(d,c),Pr(c),hi=x):(Lr(d,c),Pr(c)),_&4&&qs&&d0(c.stateNode,c,c.stateNode.pendingChildren);break;case 12:Lr(d,c),Pr(c);break;case 31:Lr(d,c),Pr(c),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,Go(c,_)));break;case 13:Lr(d,c),Pr(c),c.child.flags&8192&&c.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(df=ss()),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,Go(c,_)));break;case 22:C=c.memoizedState!==null;var q=x!==null&&x.memoizedState!==null,Ae=ir,it=rr;if(ir=Ae||C,rr=it||q,Lr(d,c),rr=it,ir=Ae,Pr(c),_&8192&&(d=c.stateNode,d._visibility=C?d._visibility&-2:d._visibility|1,C&&(x===null||q||ir||rr||bl(c)),Xn)){e:if(x=null,Xn)for(d=c;;){if(d.tag===5||Ma&&d.tag===26){if(x===null){q=x=d;try{B=q.stateNode,C?SS(B):G1(q.stateNode,q.memoizedProps)}catch(Ct){mn(q,q.return,Ct)}}}else if(d.tag===6){if(x===null){q=d;try{var bt=q.stateNode;C?H1(bt):k1(bt,q.memoizedProps)}catch(Ct){mn(q,q.return,Ct)}}}else if(d.tag===18){if(x===null){q=d;try{var Lt=q.stateNode;C?lx(Lt):cx(q.stateNode)}catch(Ct){mn(q,q.return,Ct)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===c)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break e;for(;d.sibling===null;){if(d.return===null||d.return===c)break e;x===d&&(x=null),d=d.return}x===d&&(x=null),d.sibling.return=d.return,d=d.sibling}}_&4&&(_=c.updateQueue,_!==null&&(x=_.retryQueue,x!==null&&(_.retryQueue=null,Go(c,x))));break;case 19:Lr(d,c),Pr(c),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,Go(c,_)));break;case 30:break;case 21:break;default:Lr(d,c),Pr(c)}}function Pr(c){var d=c.flags;if(d&2){try{for(var x,_=c.return;_!==null;){if(u0(_)){x=_;break}_=_.return}if(Xn){if(x==null)throw Error(r(160));switch(x.tag){case 27:if(Tr){var C=x.stateNode,B=Ho(c);zd(c,B,C);break}case 5:var q=x.stateNode;x.flags&32&&(B0(q),x.flags&=-33);var Ae=Ho(c);zd(c,Ae,q);break;case 3:case 4:var it=x.stateNode.containerInfo,bt=Ho(c);wh(c,bt,it);break;default:throw Error(r(161))}}}catch(Lt){mn(c,c.return,Lt)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function Ch(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var d=c;Ch(d),d.tag===5&&d.flags&1024&&M0(d.stateNode),c=c.sibling}}function gs(c,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)b1(c,d.alternate,d),d=d.sibling}function bl(c){for(c=c.child;c!==null;){var d=c;switch(d.tag){case 0:case 11:case 14:case 15:ao(4,d,d.return),bl(d);break;case 1:rs(d,d.return);var x=d.stateNode;typeof x.componentWillUnmount=="function"&&Th(d,d.return,x),bl(d);break;case 27:Tr&&Ur(d.stateNode);case 26:case 5:rs(d,d.return),bl(d);break;case 22:d.memoizedState===null&&bl(d);break;case 30:bl(d);break;default:bl(d)}c=c.sibling}}function _a(c,d,x){for(x=x&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var _=d.alternate,C=c,B=d,q=B.flags;switch(B.tag){case 0:case 11:case 15:_a(C,B,x),so(4,B);break;case 1:if(_a(C,B,x),_=B,C=_.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(bt){mn(_,_.return,bt)}if(_=B,C=_.updateQueue,C!==null){var Ae=_.stateNode;try{var it=C.shared.hiddenCallbacks;if(it!==null)for(C.shared.hiddenCallbacks=null,C=0;C<it.length;C++)$(it[C],Ae)}catch(bt){mn(_,_.return,bt)}}x&&q&64&&Au(B),_u(B,B.return);break;case 27:Tr&&S1(B);case 26:case 5:_a(C,B,x),x&&_===null&&q&4&&gc(B),_u(B,B.return);break;case 12:_a(C,B,x);break;case 31:_a(C,B,x),x&&q&4&&ya(C,B);break;case 13:_a(C,B,x),x&&q&4&&Gd(C,B);break;case 22:B.memoizedState===null&&_a(C,B,x),_u(B,B.return);break;case 30:break;default:_a(C,B,x)}d=d.sibling}}function El(c,d){var x=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),c=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(c=d.memoizedState.cachePool.pool),c!==x&&(c!=null&&c.refCount++,x!=null&&ot(x))}function h0(c,d){c=null,d.alternate!==null&&(c=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==c&&(d.refCount++,c!=null&&ot(c))}function Wi(c,d,x,_){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Rh(c,d,x,_),d=d.sibling}function Rh(c,d,x,_){var C=d.flags;switch(d.tag){case 0:case 11:case 15:Wi(c,d,x,_),C&2048&&so(9,d);break;case 1:Wi(c,d,x,_);break;case 3:Wi(c,d,x,_),C&2048&&(c=null,d.alternate!==null&&(c=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==c&&(d.refCount++,c!=null&&ot(c)));break;case 12:if(C&2048){Wi(c,d,x,_),c=d.stateNode;try{var B=d.memoizedProps,q=B.id,Ae=B.onPostCommit;typeof Ae=="function"&&Ae(q,d.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(it){mn(d,d.return,it)}}else Wi(c,d,x,_);break;case 31:Wi(c,d,x,_);break;case 13:Wi(c,d,x,_);break;case 23:break;case 22:B=d.stateNode,q=d.alternate,d.memoizedState!==null?B._visibility&2?Wi(c,d,x,_):Su(c,d):B._visibility&2?Wi(c,d,x,_):(B._visibility|=2,ws(c,d,x,_,(d.subtreeFlags&10256)!==0||!1)),C&2048&&El(q,d);break;case 24:Wi(c,d,x,_),C&2048&&h0(d.alternate,d);break;default:Wi(c,d,x,_)}}function ws(c,d,x,_,C){for(C=C&&((d.subtreeFlags&10256)!==0||!1),d=d.child;d!==null;){var B=c,q=d,Ae=x,it=_,bt=q.flags;switch(q.tag){case 0:case 11:case 15:ws(B,q,Ae,it,C),so(8,q);break;case 23:break;case 22:var Lt=q.stateNode;q.memoizedState!==null?Lt._visibility&2?ws(B,q,Ae,it,C):Su(B,q):(Lt._visibility|=2,ws(B,q,Ae,it,C)),C&&bt&2048&&El(q.alternate,q);break;case 24:ws(B,q,Ae,it,C),C&&bt&2048&&h0(q.alternate,q);break;default:ws(B,q,Ae,it,C)}d=d.sibling}}function Su(c,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var x=c,_=d,C=_.flags;switch(_.tag){case 22:Su(x,_),C&2048&&El(_.alternate,_);break;case 24:Su(x,_),C&2048&&h0(_.alternate,_);break;default:Su(x,_)}d=d.sibling}}function oo(c,d,x){if(c.subtreeFlags&$s)for(c=c.child;c!==null;)Ml(c,d,x),c=c.sibling}function Ml(c,d,x){switch(c.tag){case 26:if(oo(c,d,x),c.flags&$s)if(c.memoizedState!==null)hx(x,hi,c.memoizedState,c.memoizedProps);else{var _=c.stateNode,C=c.type;c=c.memoizedProps,((d&335544128)===d||b0(C,c))&&Wh(x,_,C,c)}break;case 5:oo(c,d,x),c.flags&$s&&(_=c.stateNode,C=c.type,c=c.memoizedProps,((d&335544128)===d||b0(C,c))&&Wh(x,_,C,c));break;case 3:case 4:Ma?(_=hi,hi=ef(c.stateNode.containerInfo),oo(c,d,x),hi=_):oo(c,d,x);break;case 22:c.memoizedState===null&&(_=c.alternate,_!==null&&_.memoizedState!==null?(_=$s,$s=16777216,oo(c,d,x),$s=_):oo(c,d,x));break;default:oo(c,d,x)}}function Dh(c){var d=c.alternate;if(d!==null&&(c=d.child,c!==null)){d.child=null;do d=c.sibling,c.sibling=null,c=d;while(c!==null)}}function bu(c){var d=c.deletions;if((c.flags&16)!==0){if(d!==null)for(var x=0;x<d.length;x++){var _=d[x];dr=_,Xs(_,c)}Dh(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Ih(c),c=c.sibling}function Ih(c){switch(c.tag){case 0:case 11:case 15:bu(c),c.flags&2048&&ao(9,c,c.return);break;case 3:bu(c);break;case 12:bu(c);break;case 22:var d=c.stateNode;c.memoizedState!==null&&d._visibility&2&&(c.return===null||c.return.tag!==13)?(d._visibility&=-3,Vd(c)):bu(c);break;default:bu(c)}}function Vd(c){var d=c.deletions;if((c.flags&16)!==0){if(d!==null)for(var x=0;x<d.length;x++){var _=d[x];dr=_,Xs(_,c)}Dh(c)}for(c=c.child;c!==null;){switch(d=c,d.tag){case 0:case 11:case 15:ao(8,d,d.return),Vd(d);break;case 22:x=d.stateNode,x._visibility&2&&(x._visibility&=-3,Vd(d));break;default:Vd(d)}c=c.sibling}}function Xs(c,d){for(;dr!==null;){var x=dr;switch(x.tag){case 0:case 11:case 15:ao(8,x,d);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var _=x.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:ot(x.memoizedState.cache)}if(_=x.child,_!==null)_.return=x,dr=_;else e:for(x=c;dr!==null;){_=dr;var C=_.sibling,B=_.return;if(f0(_),_===x){dr=null;break e}if(C!==null){C.return=B,dr=C;break e}dr=B}}}function Tl(c){var d=Mn(c);if(d!=null){if(typeof d.memoizedProps["data-testname"]!="string")throw Error(r(364));return d}if(c=cr(c),c===null)throw Error(r(362));return c.stateNode.current}function wl(c,d){var x=c.tag;switch(d.$$typeof){case Na:if(c.type===d.value)return!0;break;case Gu:e:{for(d=d.value,c=[c,0],x=0;x<c.length;){var _=c[x++],C=_.tag,B=c[x++],q=d[B];if(C!==5&&C!==26&&C!==27||!Ol(_)){for(;q!=null&&wl(_,q);)B++,q=d[B];if(B===d.length){d=!0;break e}else for(_=_.child;_!==null;)c.push(_,B),_=_.sibling}}d=!1}return d;case ku:if((x===5||x===26||x===27)&&C0(c.stateNode,d.value))return!0;break;case kl:if((x===5||x===6||x===26||x===27)&&(c=Zd(c),c!==null&&0<=c.indexOf(d.value)))return!0;break;case cf:if((x===5||x===26||x===27)&&(c=c.memoizedProps["data-testname"],typeof c=="string"&&c.toLowerCase()===d.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Eu(c){switch(c.$$typeof){case Na:return"<"+(v(c.value)||"Unknown")+">";case Gu:return":has("+(Eu(c)||"")+")";case ku:return'[role="'+c.value+'"]';case kl:return'"'+c.value+'"';case cf:return'[data-testname="'+c.value+'"]';default:throw Error(r(365))}}function Mu(c,d){var x=[];c=[c,0];for(var _=0;_<c.length;){var C=c[_++],B=C.tag,q=c[_++],Ae=d[q];if(B!==5&&B!==26&&B!==27||!Ol(C)){for(;Ae!=null&&wl(C,Ae);)q++,Ae=d[q];if(q===d.length)x.push(C);else for(C=C.child;C!==null;)c.push(C,q),C=C.sibling}}return x}function Cs(c,d){if(!Mr)throw Error(r(363));c=Tl(c),c=Mu(c,d),d=[],c=Array.from(c);for(var x=0;x<c.length;){var _=c[x++],C=_.tag;if(C===5||C===26||C===27)Ol(_)||d.push(_.stateNode);else for(_=_.child;_!==null;)c.push(_),_=_.sibling}return d}function Fi(){return(Un&2)!==0&&Vn!==0?Vn&-Vn:sn.T!==null?Be():Ou()}function ko(){if(Ss===0)if((Vn&536870912)===0||kn){var c=Rc;Rc<<=1,(Rc&3932160)===0&&(Rc=262144),Ss=c}else Ss=536870912;return c=Os.current,c!==null&&(c.flags|=32),Ss}function Xi(c,d,x){(c===In&&(pi===2||pi===9)||c.cancelPendingCommit!==null)&&(tr(c,0),co(c,Vn,Ss,!1)),z(c,x),((Un&2)===0||c!==In)&&(c===In&&((Un&2)===0&&(Wl|=x),Ji===4&&co(c,Vn,Ss,!1)),Ut(c))}function ka(c,d,x){if((Un&6)!==0)throw Error(r(327));var _=!x&&(d&127)===0&&(d&c.expiredLanes)===0||R(c,d),C=_?T1(c,d):uo(c,d,!0),B=_;do{if(C===0){Vl&&!_&&co(c,d,0,!1);break}else{if(x=c.current.alternate,B&&!E1(x)){C=uo(c,d,!1),B=!1;continue}if(C===2){if(B=d,c.errorRecoveryDisabledLanes&B)var q=0;else q=c.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){d=q;e:{var Ae=c;C=uf;var it=zi&&Ae.current.memoizedState.isDehydrated;if(it&&(tr(Ae,q).flags|=256),q=uo(Ae,q,!1),q!==2){if(jl&&!it){Ae.errorRecoveryDisabledLanes|=B,Wl|=B,C=4;break e}B=Ps,Ps=C,B!==null&&(Ps===null?Ps=B:Ps.push.apply(Ps,B))}C=q}if(B=!1,C!==2)continue}}if(C===1){tr(c,0),co(c,d,0,!0);break}e:{switch(_=c,B=C,B){case 0:case 1:throw Error(r(345));case 4:if((d&4194048)!==d)break;case 6:co(_,d,Ss,!Xa);break e;case 2:Ps=null;break;case 3:case 5:break;default:throw Error(r(329))}if((d&62914560)===d&&(C=df+300-ss(),10<C)){if(co(_,d,Ss,!Xa),E(_,0,!0)!==0)break e;Mo=d,_.timeoutHandle=S0(lo.bind(null,_,x,Ps,ff,hp,d,Ss,Wl,ju,Xa,B,"Throttled",-0,0),C);break e}lo(_,x,Ps,ff,hp,d,Ss,Wl,ju,Xa,B,null,-0,0)}}break}while(!0);Ut(c)}function lo(c,d,x,_,C,B,q,Ae,it,bt,Lt,Ct,Xt,Sn){if(c.timeoutHandle=Is,Ct=d.subtreeFlags,Ct&8192||(Ct&16785408)===16785408){Ct=E0(),Ml(d,B,Ct);var hr=(B&62914560)===B?df-ss():(B&4194048)===B?Pc-ss():0;if(hr=N1(Ct,hr),hr!==null){Mo=B,c.cancelPendingCommit=hr(ho.bind(null,c,d,B,x,_,C,q,Ae,it,Lt,Ct,null,Xt,Sn)),co(c,B,q,!bt);return}}ho(c,d,B,x,_,C,q,Ae,it)}function E1(c){for(var d=c;;){var x=d.tag;if((x===0||x===11||x===15)&&d.flags&16384&&(x=d.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var _=0;_<x.length;_++){var C=x[_],B=C.getSnapshot;C=C.value;try{if(!ur(B(),C))return!1}catch{return!1}}if(x=d.child,d.subtreeFlags&16384&&x!==null)x.return=d,d=x;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function co(c,d,x,_){d&=~Vu,d&=~Wl,c.suspendedLanes|=d,c.pingedLanes&=~d,_&&(c.warmLanes|=d),_=c.expirationTimes;for(var C=d;0<C;){var B=31-Bs(C),q=1<<B;_[B]=-1,C&=~q}x!==0&&W(c,x,d)}function Bh(){return(Un&6)===0?(Rt(0),!1):!0}function Nh(){if(Fn!==null){if(pi===0)var c=Fn.return;else c=Fn,ja=Ri=null,Yt(c),zl=null,Ic=0,c=Fn;for(;c!==null;)_1(c.alternate,c),c=c.return;Fn=null}}function tr(c,d){var x=c.timeoutHandle;x!==Is&&(c.timeoutHandle=Is,B1(x)),x=c.cancelPendingCommit,x!==null&&(c.cancelPendingCommit=null,x()),Mo=0,Nh(),In=c,Fn=x=Qs(c.current,null),Vn=d,pi=0,Ar=null,Xa=!1,Vl=R(c,d),jl=!1,ju=Ss=Vu=Wl=el=Ji=0,Ps=uf=null,hp=!1,(d&8)!==0&&(d|=d&32);var _=c.entangledLanes;if(_!==0)for(c=c.entanglements,_&=d;0<_;){var C=31-Bs(_),B=1<<C;d|=c[C],_&=~B}return Eo=d,ma(),x}function Ci(c,d){Tn=null,sn.H=Zs,d===Rr||d===Ia?(d=_n(),pi=3):d===dp?(d=_n(),pi=4):pi=d===_s?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,Ar=d,Fn===null&&(Ji=1,Sh(c,Te(d,c.current)))}function Wn(){var c=Os.current;return c===null?!0:(Vn&4194048)===Vn?Ls===null:(Vn&62914560)===Vn||(Vn&536870912)!==0?c===Ls:!1}function Vo(){var c=sn.H;return sn.H=Zs,c===null?Zs:c}function Ys(){var c=sn.A;return sn.A=Hu,c}function Tu(){Ji=4,Xa||(Vn&4194048)!==Vn&&Os.current!==null||(Vl=!0),(el&134217727)===0&&(Wl&134217727)===0||In===null||co(In,Vn,Ss,!1)}function uo(c,d,x){var _=Un;Un|=2;var C=Vo(),B=Ys();(In!==c||Vn!==d)&&(ff=null,tr(c,d)),d=!1;var q=Ji;e:do try{if(pi!==0&&Fn!==null){var Ae=Fn,it=Ar;switch(pi){case 8:Nh(),q=6;break e;case 3:case 2:case 9:case 6:Os.current===null&&(d=!0);var bt=pi;if(pi=0,Ar=null,fo(c,Ae,it,bt),x&&Vl){q=0;break e}break;default:bt=pi,pi=0,Ar=null,fo(c,Ae,it,bt)}}M1(),q=Ji;break}catch(Lt){Ci(c,Lt)}while(!0);return d&&c.shellSuspendCounter++,ja=Ri=null,Un=_,sn.H=C,sn.A=B,Fn===null&&(In=null,Vn=0,ma()),q}function M1(){for(;Fn!==null;)Cl(Fn)}function T1(c,d){var x=Un;Un|=2;var _=Vo(),C=Ys();In!==c||Vn!==d?(ff=null,Xl=ss()+500,tr(c,d)):Vl=R(c,d);e:do try{if(pi!==0&&Fn!==null){d=Fn;var B=Ar;t:switch(pi){case 1:pi=0,Ar=null,fo(c,d,B,1);break;case 2:case 9:if(wt(B)){pi=0,Ar=null,Oh(d);break}d=function(){pi!==2&&pi!==9||In!==c||(pi=7),Ut(c)},B.then(d,d);break e;case 3:pi=7;break e;case 4:pi=5;break e;case 7:wt(B)?(pi=0,Ar=null,Oh(d)):(pi=0,Ar=null,fo(c,d,B,7));break;case 5:var q=null;switch(Fn.tag){case 26:q=Fn.memoizedState;case 5:case 27:var Ae=Fn,it=Ae.type,bt=Ae.pendingProps;if(q?J0(q):Yi(Ae.stateNode,it,bt)){pi=0,Ar=null;var Lt=Ae.sibling;if(Lt!==null)Fn=Lt;else{var Ct=Ae.return;Ct!==null?(Fn=Ct,Cu(Ct)):Fn=null}break t}}pi=0,Ar=null,fo(c,d,B,5);break;case 6:pi=0,Ar=null,fo(c,d,B,6);break;case 8:Nh(),Ji=6;break e;default:throw Error(r(462))}}wu();break}catch(Xt){Ci(c,Xt)}while(!0);return ja=Ri=null,sn.H=_,sn.A=C,Un=x,Fn!==null?0:(In=null,Vn=0,ma(),Ji)}function wu(){for(;Fn!==null&&!mx();)Cl(Fn)}function Cl(c){var d=a0(c.alternate,c,Eo);c.memoizedProps=c.pendingProps,d===null?Cu(c):Fn=d}function Oh(c){var d=c,x=d.alternate;switch(d.tag){case 15:case 0:d=e0(x,d,d.pendingProps,d.type,void 0,Vn);break;case 11:d=e0(x,d,d.pendingProps,d.type.render,d.ref,Vn);break;case 5:Yt(d);default:_1(x,d),d=Fn=Uh(d,Eo),d=a0(x,d,Eo)}c.memoizedProps=c.pendingProps,d===null?Cu(c):Fn=d}function fo(c,d,x,_){ja=Ri=null,Yt(d),zl=null,Ic=0;var C=d.return;try{if(xS(c,C,d,x,Vn)){Ji=1,Sh(c,Te(x,c.current)),Fn=null;return}}catch(B){if(C!==null)throw Fn=C,B;Ji=1,Sh(c,Te(x,c.current)),Fn=null;return}d.flags&32768?(kn||_===1?c=!0:Vl||(Vn&536870912)!==0?c=!1:(Xa=c=!0,(_===2||_===9||_===3||_===6)&&(_=Os.current,_!==null&&_.tag===13&&(_.flags|=16384))),Rl(d,c)):Cu(d)}function Cu(c){var d=c;do{if((d.flags&32768)!==0){Rl(d,Xa);return}c=d.return;var x=A1(d.alternate,d,Eo);if(x!==null){Fn=x;return}if(d=d.sibling,d!==null){Fn=d;return}Fn=d=c}while(d!==null);Ji===0&&(Ji=5)}function Rl(c,d){do{var x=c0(c.alternate,c);if(x!==null){x.flags&=32767,Fn=x;return}if(x=c.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!d&&(c=c.sibling,c!==null)){Fn=c;return}Fn=c=x}while(c!==null);Ji=6,Fn=null}function ho(c,d,x,_,C,B,q,Ae,it){c.cancelPendingCommit=null;do mo();while(_r!==0);if((Un&6)!==0)throw Error(r(327));if(d!==null){if(d===c.current)throw Error(r(177));if(B=d.lanes|d.childLanes,B|=Bc,j(c,x,B,q,Ae,it),c===In&&(Fn=In=null,Vn=0),Uc=d,nl=c,Mo=x,Wu=B,pp=C,sg=_,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,xr(nf,function(){return jd(),null})):(c.callbackNode=null,c.callbackPriority=0),_=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||_){_=sn.T,sn.T=null,C=Ea(),Gn(2),q=Un,Un|=4;try{yS(c,d,x)}finally{Un=q,Gn(C),sn.T=_}}_r=1,jo(),po(),Lh()}}function jo(){if(_r===1){_r=0;var c=nl,d=Uc,x=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||x){x=sn.T,sn.T=null;var _=Ea();Gn(2);var C=Un;Un|=4;try{kd(d,c),I1(c.containerInfo)}finally{Un=C,Gn(_),sn.T=x}}c.current=d,_r=2}}function po(){if(_r===2){_r=0;var c=nl,d=Uc,x=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||x){x=sn.T,sn.T=null;var _=Ea();Gn(2);var C=Un;Un|=4;try{b1(c,d.alternate,d)}finally{Un=C,Gn(_),sn.T=x}}_r=3}}function Lh(){if(_r===4||_r===3){_r=0,Z0();var c=nl,d=Uc,x=Mo,_=sg;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?_r=5:(_r=0,Uc=nl=null,Ph(c,c.pendingLanes));var C=c.pendingLanes;if(C===0&&(tl=null),de(x),d=d.stateNode,Ns&&typeof Ns.onCommitFiberRoot=="function")try{Ns.onCommitFiberRoot(Dc,d,void 0,(d.current.flags&128)===128)}catch{}if(_!==null){d=sn.T,C=Ea(),Gn(2),sn.T=null;try{for(var B=c.onRecoverableError,q=0;q<_.length;q++){var Ae=_[q];B(Ae.value,{componentStack:Ae.stack})}}finally{sn.T=d,Gn(C)}}(Mo&3)!==0&&mo(),Ut(c),C=c.pendingLanes,(x&261930)!==0&&(C&42)!==0?c===hf?ei++:(ei=0,hf=c):ei=0,zi&&$d(),Rt(0)}}function Ph(c,d){(c.pooledCacheLanes&=d)===0&&(d=c.pooledCache,d!=null&&(c.pooledCache=null,ot(d)))}function mo(){return jo(),po(),Lh(),jd()}function jd(){if(_r!==5)return!1;var c=nl,d=Wu;Wu=0;var x=de(Mo),_=32>x?32:x;x=sn.T;var C=Ea();try{Gn(_),sn.T=null,_=pp,pp=null;var B=nl,q=Mo;if(_r=0,Uc=nl=null,Mo=0,(Un&6)!==0)throw Error(r(331));var Ae=Un;if(Un|=4,Ih(B.current),Rh(B,B.current,q,_),Un=Ae,Rt(0,!1),Ns&&typeof Ns.onPostCommitFiberRoot=="function")try{Ns.onPostCommitFiberRoot(Dc,B)}catch{}return!0}finally{Gn(C),sn.T=x,Ph(c,d)}}function Dl(c,d,x){d=Te(x,d),d=Zm(c.stateNode,d,2),c=Ge(c,d,2),c!==null&&(z(c,2),Ut(c))}function mn(c,d,x){if(c.tag===3)Dl(c,c,x);else for(;d!==null;){if(d.tag===3){Dl(d,c,x);break}else if(d.tag===1){var _=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(tl===null||!tl.has(_))){c=Te(x,c),x=l1(2),_=Ge(d,x,2),_!==null&&(c1(x,_,d,c),z(_,2),Ut(_));break}}d=d.return}}function Ru(c,d,x){var _=c.pingCache;if(_===null){_=c.pingCache=new ea;var C=new Set;_.set(d,C)}else C=_.get(d),C===void 0&&(C=new Set,_.set(d,C));C.has(x)||(jl=!0,C.add(x),c=w1.bind(null,c,d,x),d.then(c,c))}function w1(c,d,x){var _=c.pingCache;_!==null&&_.delete(d),c.pingedLanes|=c.suspendedLanes&x,c.warmLanes&=~x,In===c&&(Vn&x)===x&&(Ji===4||Ji===3&&(Vn&62914560)===Vn&&300>ss()-df?(Un&2)===0&&tr(c,0):Vu|=x,ju===Vn&&(ju=0)),Ut(c)}function C1(c,d){d===0&&(d=O()),c=rn(c,d),c!==null&&(z(c,d),Ut(c))}function AS(c){var d=c.memoizedState,x=0;d!==null&&(x=d.retryLane),C1(c,x)}function _S(c,d){var x=0;switch(c.tag){case 31:case 13:var _=c.stateNode,C=c.memoizedState;C!==null&&(x=C.retryLane);break;case 19:_=c.stateNode;break;case 22:_=c.stateNode._retryCache;break;default:throw Error(r(314))}_!==null&&_.delete(d),C1(c,x)}function xr(c,d){return tf(c,d)}function p0(c,d,x,_){this.tag=c,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vc(c){return c=c.prototype,!(!c||!c.isReactComponent)}function Qs(c,d){var x=c.alternate;return x===null?(x=t(c.tag,d,c.key,c.mode),x.elementType=c.elementType,x.type=c.type,x.stateNode=c.stateNode,x.alternate=c,c.alternate=x):(x.pendingProps=d,x.type=c.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=c.flags&65011712,x.childLanes=c.childLanes,x.lanes=c.lanes,x.child=c.child,x.memoizedProps=c.memoizedProps,x.memoizedState=c.memoizedState,x.updateQueue=c.updateQueue,d=c.dependencies,x.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},x.sibling=c.sibling,x.index=c.index,x.ref=c.ref,x.refCleanup=c.refCleanup,x}function Uh(c,d){c.flags&=65011714;var x=c.alternate;return x===null?(c.childLanes=0,c.lanes=d,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=x.childLanes,c.lanes=x.lanes,c.child=x.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=x.memoizedProps,c.memoizedState=x.memoizedState,c.updateQueue=x.updateQueue,c.type=x.type,d=x.dependencies,c.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),c}function Wo(c,d,x,_,C,B){var q=0;if(_=c,typeof c=="function")vc(c)&&(q=1);else if(typeof c=="string")q=Ma&&Tr?Zh(c,x,Fr.current)?26:K0(c)?27:5:Ma?Zh(c,x,Fr.current)?26:5:Tr&&K0(c)?27:5;else e:switch(c){case Qd:return c=t(31,x,d,C),c.elementType=Qd,c.lanes=B,c;case _c:return Sa(x.children,C,B,d);case Sc:q=8,C|=24;break;case bc:return c=t(12,x,d,C|2),c.elementType=bc,c.lanes=B,c;case Gh:return c=t(13,x,d,C),c.elementType=Gh,c.lanes=B,c;case Xo:return c=t(19,x,d,C),c.elementType=Xo,c.lanes=B,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case ba:q=10;break e;case Yd:q=9;break e;case Du:q=11;break e;case kh:q=14;break e;case vs:q=16,_=null;break e}q=29,x=Error(r(130,c===null?"null":typeof c,"")),_=null}return d=t(q,x,d,C),d.elementType=c,d.type=_,d.lanes=B,d}function Sa(c,d,x,_){return c=t(7,c,_,d),c.lanes=x,c}function m0(c,d,x){return c=t(6,c,null,d),c.lanes=x,c}function g0(c){var d=t(18,null,null,0);return d.stateNode=c,d}function v0(c,d,x){return d=t(4,c.children!==null?c.children:[],c.key,d),d.lanes=x,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function R1(c,d,x,_,C,B,q,Ae,it){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Is,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=F(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=F(0),this.hiddenUpdates=F(null),this.identifierPrefix=_,this.onUncaughtError=C,this.onCaughtError=B,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=it,this.incompleteTransitions=new Map}function Il(c,d,x,_,C,B,q,Ae,it,bt,Lt,Ct){return c=new R1(c,d,x,q,it,bt,Lt,Ct,Ae),d=1,B===!0&&(d|=24),B=t(3,null,null,d),c.current=B,B.stateNode=c,d=Ye(),d.refCount++,c.pooledCache=d,d.refCount++,B.memoizedState={element:_,isDehydrated:x,cache:d},V(B),c}function Fh(c){return c?(c=vo,c):vo}function Wd(c){var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=u(d),c=c!==null?f(c):null,c===null?null:Bu(c.stateNode)}function x0(c,d,x,_,C,B){C=Fh(C),_.context===null?_.context=C:_.pendingContext=C,_=xe(d),_.payload={element:x},B=B===void 0?null:B,B!==null&&(_.callback=B),x=Ge(c,_,d),x!==null&&(Xi(x,c,d),Je(x,c,d))}function xc(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var x=c.retryLane;c.retryLane=x!==0&&x<d?x:d}}function Xd(c,d){xc(c,d),(c=c.alternate)&&xc(c,d)}var Rn={},zh=Cv,Rs=w9,Hh=Object.assign,yc=Symbol.for("react.element"),go=Symbol.for("react.transitional.element"),Ac=Symbol.for("react.portal"),_c=Symbol.for("react.fragment"),Sc=Symbol.for("react.strict_mode"),bc=Symbol.for("react.profiler"),Yd=Symbol.for("react.consumer"),ba=Symbol.for("react.context"),Du=Symbol.for("react.forward_ref"),Gh=Symbol.for("react.suspense"),Xo=Symbol.for("react.suspense_list"),kh=Symbol.for("react.memo"),vs=Symbol.for("react.lazy"),Qd=Symbol.for("react.activity"),y0=Symbol.for("react.memo_cache_sentinel"),Yo=Symbol.iterator,Bl=Symbol.for("react.client.reference"),Nl=Array.isArray,sn=zh.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A0=e.rendererVersion,qd=e.rendererPackageName,Iu=e.extraDevToolsConfig,Bu=e.getPublicInstance,D1=e.getRootHostContext,Nu=e.getChildHostContext,Vh=e.prepareForCommit,I1=e.resetAfterCommit,_0=e.createInstance;e.cloneMutableInstance;var Jd=e.appendInitialChild,Ds=e.finalizeInitialChildren,xs=e.shouldSetTextContent,Qo=e.createTextInstance;e.cloneMutableTextInstance;var S0=e.scheduleTimeout,B1=e.cancelTimeout,Is=e.noTimeout,lr=e.isPrimaryRenderer;e.warnsIfNotActing;var Xn=e.supportsMutation,qs=e.supportsPersistence,zi=e.supportsHydration,Mn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var mi=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Gn=e.setCurrentUpdatePriority,Ea=e.getCurrentUpdatePriority,Ou=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Ec=e.shouldAttemptEagerTransition,jh=e.detachDeletedInstance;e.requestPostPaintCallback;var Kd=e.maySuspendCommit,Lu=e.maySuspendCommitOnUpdate,b0=e.maySuspendCommitInSyncRender,Yi=e.preloadInstance,E0=e.startSuspendingCommit,Wh=e.suspendInstance;e.suspendOnActiveViewTransition;var N1=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Mc=e.NotPendingTransition,Tc=e.HostTransitionContext,M0=e.resetFormInstance;e.bindToConsole;var T0=e.supportsMicrotasks,w0=e.scheduleMicrotask,Mr=e.supportsTestSelectors,cr=e.findFiberRoot,Xh=e.getBoundingRect,Zd=e.getTextContent,Ol=e.isHiddenSubtree,C0=e.matchAccessibilityRole,qo=e.setFocusIfFocusable,Yh=e.setupIntersectionObserver,R0=e.appendChild,D0=e.appendChildToContainer,O1=e.commitTextUpdate,L1=e.commitMount,P1=e.commitUpdate,U1=e.insertBefore,F1=e.insertInContainerBefore,z1=e.removeChild,I0=e.removeChildFromContainer,B0=e.resetTextContent,SS=e.hideInstance,H1=e.hideTextInstance,G1=e.unhideInstance,k1=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var N0=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var V1=e.cloneInstance,O0=e.createContainerChildSet,L0=e.appendChildToContainerChildSet,j1=e.finalizeContainerChildren,P0=e.replaceContainerChildren,W1=e.cloneHiddenInstance,U0=e.cloneHiddenTextInstance,Ll=e.isSuspenseInstancePending,Qh=e.isSuspenseInstanceFallback,qh=e.getSuspenseInstanceFallbackErrorDetails,Jh=e.registerSuspenseInstanceRetry,X1=e.canHydrateFormStateMarker,F0=e.isFormStateMarkerMatching,Y1=e.getNextHydratableSibling,Q1=e.getNextHydratableSiblingAfterSingleton,q1=e.getFirstHydratableChild,J1=e.getFirstHydratableChildWithinContainer,K1=e.getFirstHydratableChildWithinActivityInstance,Z1=e.getFirstHydratableChildWithinSuspenseInstance,z0=e.getFirstHydratableChildWithinSingleton,$1=e.canHydrateInstance,ex=e.canHydrateTextInstance,H0=e.canHydrateActivityInstance,tx=e.canHydrateSuspenseInstance,nx=e.hydrateInstance,bS=e.hydrateTextInstance,G0=e.hydrateActivityInstance,ix=e.hydrateSuspenseInstance,rx=e.getNextHydratableInstanceAfterActivityInstance,k0=e.getNextHydratableInstanceAfterSuspenseInstance,sx=e.commitHydratedInstance,ax=e.commitHydratedContainer,ES=e.commitHydratedActivityInstance,MS=e.commitHydratedSuspenseInstance,ox=e.finalizeHydratedChildren,$d=e.flushHydrationEvents;e.clearActivityBoundary;var V0=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Kh=e.clearSuspenseBoundaryFromContainer,lx=e.hideDehydratedBoundary,cx=e.unhideDehydratedBoundary,Pu=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var ux=e.validateHydratableInstance,j0=e.validateHydratableTextInstance,Ma=e.supportsResources,Zh=e.isHostHoistableType,ef=e.getHoistableRoot,W0=e.getResource,X0=e.acquireResource,Pl=e.releaseResource,dx=e.hydrateHoistable,Y0=e.mountHoistable,Q0=e.unmountHoistable,$h=e.createHoistableInstance,fx=e.prepareToCommitHoistables,q0=e.mayResourceSuspendCommit,J0=e.preloadResource,hx=e.suspendResource,Tr=e.supportsSingletons,ep=e.resolveSingletonInstance,yr=e.acquireSingletonInstance,Ur=e.releaseSingletonInstance,K0=e.isHostSingletonType,wc=e.isSingletonScope,tp=[],Cc=-1,vo={},Bs=Math.clz32?Math.clz32:T,np=Math.log,px=Math.LN2,ip=256,Rc=262144,Uu=4194304,tf=Rs.unstable_scheduleCallback,rp=Rs.unstable_cancelCallback,mx=Rs.unstable_shouldYield,Z0=Rs.unstable_requestPaint,ss=Rs.unstable_now,sp=Rs.unstable_ImmediatePriority,gx=Rs.unstable_UserBlockingPriority,nf=Rs.unstable_NormalPriority,ap=Rs.unstable_IdlePriority,$0=Rs.log,vx=Rs.unstable_setDisableYieldValue,Dc=null,Ns=null,ur=typeof Object.is=="function"?Object.is:ne,op=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)},TS=Object.prototype.hasOwnProperty,lp,xo,rf=!1,eg=new WeakMap,Jo=[],yo=0,gi=null,sf=0,Ta=[],Js=0,wa=null,Qr=1,Va="",Fr=y(null),Ko=y(null),qr=y(null),af=y(null),wr=null,Hi=null,kn=!1,Ao=null,ys=!1,cp=Error(r(519)),Ca=y(null),Ri=null,ja=null,xx=typeof AbortController<"u"?AbortController:function(){var c=[],d=this.signal={aborted:!1,addEventListener:function(x,_){c.push(_)}};this.abort=function(){d.aborted=!0,c.forEach(function(x){return x()})}},zr=Rs.unstable_scheduleCallback,wS=Rs.unstable_NormalPriority,Gi={$$typeof:ba,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},of=null,fi=null,as=!1,Ra=!1,up=!1,Ul=0,Fu=null,tg=0,Zo=0,Cr=null,Da=sn.S;sn.S=function(c,d){Pc=ss(),typeof d=="object"&&d!==null&&typeof d.then=="function"&&ft(c,d),Da!==null&&Da(c,d)};var Fl=y(null),Rr=Error(r(460)),dp=Error(r(474)),Ia=Error(r(542)),_o={then:function(){}},As=null,zl=null,Ic=0,Jr=Ts(!0),ng=Ts(!1),Kr=[],So=0,Bc=0,Ks=!1,fp=!1,Nc=y(null),Hl=y(0),Os=y(null),Ls=null,nr=y(0),$o=0,Tn=null,tn=null,xn=null,Dn=!1,Cn=!1,Yn=!1,os=0,Ba=0,Wa=null,ig=0,Zs={readContext:te,use:Qt,useCallback:Re,useContext:Re,useEffect:Re,useImperativeHandle:Re,useLayoutEffect:Re,useInsertionEffect:Re,useMemo:Re,useReducer:Re,useRef:Re,useState:Re,useDebugValue:Re,useDeferredValue:Re,useTransition:Re,useSyncExternalStore:Re,useId:Re,useHostTransitionStatus:Re,useFormState:Re,useActionState:Re,useOptimistic:Re,useMemoCache:Re,useCacheRefresh:Re};Zs.useEffectEvent=Re;var Qi={readContext:te,use:Qt,useCallback:function(c,d){return mt().memoizedState=[c,d===void 0?null:d],c},useContext:te,useEffect:Dd,useImperativeHandle:function(c,d,x){x=x!=null?x.concat([c]):null,dc(4194308,4,hu.bind(null,d,c),x)},useLayoutEffect:function(c,d){return dc(4194308,4,c,d)},useInsertionEffect:function(c,d){dc(4,2,c,d)},useMemo:function(c,d){var x=mt();d=d===void 0?null:d;var _=c();if(Yn){ce(!0);try{c()}finally{ce(!1)}}return x.memoizedState=[_,d],_},useReducer:function(c,d,x){var _=mt();if(x!==void 0){var C=x(d);if(Yn){ce(!0);try{x(d)}finally{ce(!1)}}}else C=d;return _.memoizedState=_.baseState=C,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:C},_.queue=c,c=c.dispatch=vS.bind(null,Tn,c),[_.memoizedState,c]},useRef:function(c){var d=mt();return c={current:c},d.memoizedState=c},useState:function(c){c=jm(c);var d=c.queue,x=r1.bind(null,Tn,d);return d.dispatch=x,[c.memoizedState,x]},useDebugValue:Bd,useDeferredValue:function(c,d){var x=mt();return mu(x,c,d)},useTransition:function(){var c=jm(!1);return c=t1.bind(null,Tn,c.queue,!0,!1),mt().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,d,x){var _=Tn,C=mt();if(kn){if(x===void 0)throw Error(r(407));x=x()}else{if(x=d(),In===null)throw Error(r(349));(Vn&127)!==0||Nr(_,d,x)}C.memoizedState=x;var B={value:x,getSnapshot:d};return C.queue=B,Dd(cc.bind(null,_,B,c),[c]),_.flags|=2048,Ws(9,{destroy:void 0},Or.bind(null,_,B,x,d),null),x},useId:function(){var c=mt(),d=In.identifierPrefix;if(kn){var x=Va,_=Qr;x=(_&~(1<<32-Bs(_)-1)).toString(32)+x,d="_"+d+"R_"+x,x=os++,0<x&&(d+="H"+x.toString(32)),d+="_"}else x=ig++,d="_"+d+"r_"+x.toString(32)+"_";return c.memoizedState=d},useHostTransitionStatus:qm,useFormState:Xm,useActionState:Xm,useOptimistic:function(c){var d=mt();d.memoizedState=d.baseState=c;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=x,d=yh.bind(null,Tn,!0,x),x.dispatch=d,[c,d]},useMemoCache:vn,useCacheRefresh:function(){return mt().memoizedState=gS.bind(null,Tn)},useEffectEvent:function(c){var d=mt(),x={impl:c};return d.memoizedState=x,function(){if((Un&2)!==0)throw Error(r(440));return x.impl.apply(void 0,arguments)}}},bo={readContext:te,use:Qt,useCallback:vh,useContext:te,useEffect:fu,useImperativeHandle:e1,useInsertionEffect:_l,useLayoutEffect:Id,useMemo:pu,useReducer:oi,useRef:gh,useState:function(){return oi(fn)},useDebugValue:Bd,useDeferredValue:function(c,d){var x=ht();return Qm(x,tn.memoizedState,c,d)},useTransition:function(){var c=oi(fn)[0],d=ht().memoizedState;return[typeof c=="boolean"?c:St(c),d]},useSyncExternalStore:vr,useId:xh,useHostTransitionStatus:qm,useFormState:uu,useActionState:uu,useOptimistic:function(c,d){var x=ht();return Cd(x,tn,c,d)},useMemoCache:vn,useCacheRefresh:i1};bo.useEffectEvent=ps;var Gl={readContext:te,use:Qt,useCallback:vh,useContext:te,useEffect:fu,useImperativeHandle:e1,useInsertionEffect:_l,useLayoutEffect:Id,useMemo:pu,useReducer:Ui,useRef:gh,useState:function(){return Ui(fn)},useDebugValue:Bd,useDeferredValue:function(c,d){var x=ht();return tn===null?mu(x,c,d):Qm(x,tn.memoizedState,c,d)},useTransition:function(){var c=Ui(fn)[0],d=ht().memoizedState;return[typeof c=="boolean"?c:St(c),d]},useSyncExternalStore:vr,useId:xh,useHostTransitionStatus:qm,useFormState:du,useActionState:du,useOptimistic:function(c,d){var x=ht();return tn!==null?Cd(x,tn,c,d):(x.baseState=c,[c,x.queue.dispatch])},useMemoCache:vn,useCacheRefresh:i1};Gl.useEffectEvent=ps;var lf={enqueueSetState:function(c,d,x){c=c._reactInternals;var _=Fi(),C=xe(_);C.payload=d,x!=null&&(C.callback=x),d=Ge(c,C,_),d!==null&&(Xi(d,c,_),Je(d,c,_))},enqueueReplaceState:function(c,d,x){c=c._reactInternals;var _=Fi(),C=xe(_);C.tag=1,C.payload=d,x!=null&&(C.callback=x),d=Ge(c,C,_),d!==null&&(Xi(d,c,_),Je(d,c,_))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var x=Fi(),_=xe(x);_.tag=2,d!=null&&(_.callback=d),d=Ge(c,_,x),d!==null&&(Xi(d,c,x),Je(d,c,x))}},_s=Error(r(461)),Li=!1,Oc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},ir=!1,rr=!1,zu=!1,rg=typeof WeakSet=="function"?WeakSet:Set,dr=null,qi=null,fr=!1,hi=null,$s=8192,Hu={getCacheForType:function(c){var d=te(Gi),x=d.data.get(c);return x===void 0&&(x=c(),d.data.set(c,x)),x},cacheSignal:function(){return te(Gi).controller.signal}},Na=0,Gu=1,ku=2,cf=3,kl=4;if(typeof Symbol=="function"&&Symbol.for){var Lc=Symbol.for;Na=Lc("selector.component"),Gu=Lc("selector.has_pseudo_class"),ku=Lc("selector.role"),cf=Lc("selector.test_id"),kl=Lc("selector.text")}var ea=typeof WeakMap=="function"?WeakMap:Map,Un=0,In=null,Fn=null,Vn=0,pi=0,Ar=null,Xa=!1,Vl=!1,jl=!1,Eo=0,Ji=0,el=0,Wl=0,Vu=0,Ss=0,ju=0,uf=null,Ps=null,hp=!1,df=0,Pc=0,Xl=1/0,ff=null,tl=null,_r=0,nl=null,Uc=null,Mo=0,Wu=0,pp=null,sg=null,ei=0,hf=null;return Rn.attemptContinuousHydration=function(c){if(c.tag===13||c.tag===31){var d=rn(c,67108864);d!==null&&Xi(d,c,67108864),Xd(c,67108864)}},Rn.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13||c.tag===31){var d=Fi();d=K(d);var x=rn(c,d);x!==null&&Xi(x,c,d),Xd(c,d)}},Rn.attemptSynchronousHydration=function(c){switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=M(c.pendingLanes);if(d!==0){for(c.pendingLanes|=2,c.entangledLanes|=2;d;){var x=1<<31-Bs(d);c.entanglements[1]|=x,d&=~x}Ut(c),(Un&6)===0&&(Xl=ss()+500,Rt(0))}}break;case 31:case 13:d=rn(c,2),d!==null&&Xi(d,c,2),Bh(),Xd(c,2)}},Rn.batchedUpdates=function(c,d){return c(d)},Rn.createComponentSelector=function(c){return{$$typeof:Na,value:c}},Rn.createContainer=function(c,d,x,_,C,B,q,Ae,it,bt){return Il(c,d,!1,null,x,_,B,null,q,Ae,it,bt)},Rn.createHasPseudoClassSelector=function(c){return{$$typeof:Gu,value:c}},Rn.createHydrationContainer=function(c,d,x,_,C,B,q,Ae,it,bt,Lt,Ct,Xt,Sn){var hr;return c=Il(x,_,!0,c,C,B,Ae,Sn,it,bt,Lt,Ct),c.context=Fh(null),x=c.current,_=Fi(),_=K(_),C=xe(_),C.callback=(hr=d)!=null?hr:null,Ge(x,C,_),d=_,c.current.lanes=d,z(c,d),Ut(c),c},Rn.createPortal=function(c,d,x){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ac,key:_==null?null:""+_,children:c,containerInfo:d,implementation:x}},Rn.createRoleSelector=function(c){return{$$typeof:ku,value:c}},Rn.createTestNameSelector=function(c){return{$$typeof:cf,value:c}},Rn.createTextSelector=function(c){return{$$typeof:kl,value:c}},Rn.defaultOnCaughtError=function(c){console.error(c)},Rn.defaultOnRecoverableError=function(c){op(c)},Rn.defaultOnUncaughtError=function(c){op(c)},Rn.deferredUpdates=function(c){var d=sn.T,x=Ea();try{return Gn(32),sn.T=null,c()}finally{Gn(x),sn.T=d}},Rn.discreteUpdates=function(c,d,x,_,C){var B=sn.T,q=Ea();try{return Gn(2),sn.T=null,c(d,x,_,C)}finally{Gn(q),sn.T=B,Un===0&&(Xl=ss()+500)}},Rn.findAllNodes=Cs,Rn.findBoundingRects=function(c,d){if(!Mr)throw Error(r(363));d=Cs(c,d),c=[];for(var x=0;x<d.length;x++)c.push(Xh(d[x]));for(d=c.length-1;0<d;d--){x=c[d];for(var _=x.x,C=_+x.width,B=x.y,q=B+x.height,Ae=d-1;0<=Ae;Ae--)if(d!==Ae){var it=c[Ae],bt=it.x,Lt=bt+it.width,Ct=it.y,Xt=Ct+it.height;if(_>=bt&&B>=Ct&&C<=Lt&&q<=Xt){c.splice(d,1);break}else if(_!==bt||x.width!==it.width||Xt<B||Ct>q){if(!(B!==Ct||x.height!==it.height||Lt<_||bt>C)){bt>_&&(it.width+=bt-_,it.x=_),Lt<C&&(it.width=C-bt),c.splice(d,1);break}}else{Ct>B&&(it.height+=Ct-B,it.y=B),Xt<q&&(it.height=q-Ct),c.splice(d,1);break}}}return c},Rn.findHostInstance=Wd,Rn.findHostInstanceWithNoPortals=function(c){return c=u(c),c=c!==null?p(c):null,c===null?null:Bu(c.stateNode)},Rn.findHostInstanceWithWarning=function(c){return Wd(c)},Rn.flushPassiveEffects=mo,Rn.flushSyncFromReconciler=function(c){var d=Un;Un|=1;var x=sn.T,_=Ea();try{if(Gn(2),sn.T=null,c)return c()}finally{Gn(_),sn.T=x,Un=d,(Un&6)===0&&Rt(0)}},Rn.flushSyncWork=Bh,Rn.focusWithin=function(c,d){if(!Mr)throw Error(r(363));for(c=Tl(c),d=Mu(c,d),d=Array.from(d),c=0;c<d.length;){var x=d[c++],_=x.tag;if(!Ol(x)){if((_===5||_===26||_===27)&&qo(x.stateNode))return!0;for(x=x.child;x!==null;)d.push(x),x=x.sibling}}return!1},Rn.getFindAllNodesFailureDescription=function(c,d){if(!Mr)throw Error(r(363));var x=0,_=[];c=[Tl(c),0];for(var C=0;C<c.length;){var B=c[C++],q=B.tag,Ae=c[C++],it=d[Ae];if((q!==5&&q!==26&&q!==27||!Ol(B))&&(wl(B,it)&&(_.push(Eu(it)),Ae++,Ae>x&&(x=Ae)),Ae<d.length))for(B=B.child;B!==null;)c.push(B,Ae),B=B.sibling}if(x<d.length){for(c=[];x<d.length;x++)c.push(Eu(d[x]));return`findAllNodes was able to match part of the selector:
  `+(_.join(" > ")+`

No matching component was found for:
  `)+c.join(" > ")}return null},Rn.getPublicRootInstance=function(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 27:case 5:return Bu(c.child.stateNode);default:return c.child.stateNode}},Rn.injectIntoDevTools=function(){var c={bundleType:0,version:A0,rendererPackageName:qd,currentDispatcherRef:sn,reconcilerVersion:"19.2.0"};if(Iu!==null&&(c.rendererConfig=Iu),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(d.isDisabled||!d.supportsFiber)c=!0;else{try{Dc=d.inject(c),Ns=d}catch{}c=!!d.checkDCE}}return c},Rn.isAlreadyRendering=function(){return(Un&6)!==0},Rn.observeVisibleRects=function(c,d,x,_){if(!Mr)throw Error(r(363));c=Cs(c,d);var C=Yh(c,x,_).disconnect;return{disconnect:function(){C()}}},Rn.shouldError=function(){return null},Rn.shouldSuspend=function(){return!1},Rn.startHostTransition=function(c,d,x,_){if(c.tag!==5)throw Error(r(476));var C=n1(c).queue;t1(c,C,d,Mc,x===null?n:function(){var B=n1(c);return B.next===null&&(B=c.alternate.memoizedState),Nd(c,B.next.queue,{},Fi()),x(_)})},Rn.updateContainer=function(c,d,x,_){var C=d.current,B=Fi();return x0(C,B,c,d,x,_),B},Rn.updateContainerSync=function(c,d,x,_){return x0(d.current,2,c,d,x,_),2},Rn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(z3)),z3.exports}var G3;function tF(){return G3||(G3=1,F3.exports=eF()),F3.exports}var nF=tF();const iF=$9(nF);function rF(i){const e=iF(i);return e.injectIntoDevTools(),e}const tD=0,Mm={},sF=/^three(?=[A-Z])/,Q_=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let aF=0;const oF=i=>typeof i=="function";function q_(i){if(oF(i)){const e=`${aF++}`;return Mm[e]=i,e}else Object.assign(Mm,i)}function nD(i,e){const t=Q_(i),n=Mm[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function lF(i,e,t){var n;return i=Q_(i)in Mm?i:i.replace(sF,""),nD(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,XA(e.object,t,i,e)}function cF(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?QA(i.parent,i):ra(i.object)&&(i.object.visible=!1),i.isHidden=!0,Pm(i)}}function iD(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?YA(i.parent,i):ra(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Pm(i)}}function MT(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var r,s;const o=Mm[Q_(e.type)];e.object=(r=e.props.object)!=null?r:new o(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(ec(e.object,e.props),e.props.attach)YA(i,e);else if(ra(e.object)&&ra(i.object)){const o=i.object.children.indexOf(t==null?void 0:t.object);if(t&&o!==-1){const u=i.object.children.indexOf(e.object);if(u!==-1){i.object.children.splice(u,1);const f=u<o?o-1:o;i.object.children.splice(f,0,e.object)}else e.object.parent=i.object,i.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const o of e.children)MT(e,o);Pm(e)}}function qb(i,e){e&&(e.parent=i,i.children.push(e),MT(i,e))}function k3(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),MT(i,e,t)}function rD(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():VE.unstable_scheduleCallback(VE.unstable_IdlePriority,e)}}function WE(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?QA(i,e):ra(e.object)&&ra(i.object)&&(i.object.remove(e.object),j9(Q4(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const o=e.children[s];WE(e,o,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&rD(e.object),t===void 0&&Pm(e)}function uF(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const qy=[];function dF(){for(const[t]of qy){const n=t.parent;if(n){t.props.attach?QA(n,t):ra(t.object)&&ra(n.object)&&n.object.remove(t.object);for(const r of t.children)r.props.attach?QA(t,r):ra(r.object)&&ra(t.object)&&t.object.remove(r.object)}t.isHidden&&iD(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&rD(t.object)}for(const[t,n,r]of qy){t.props=n;const s=t.parent;if(s){var i,e;const o=Mm[Q_(t.type)];t.object=(i=t.props.object)!=null?i:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,uF(r,t.object),ec(t.object,t.props),t.props.attach?YA(s,t):ra(t.object)&&ra(s.object)&&s.object.add(t.object);for(const u of t.children)u.props.attach?YA(t,u):ra(u.object)&&ra(t.object)&&t.object.add(u.object);Pm(t)}}qy.length=0}const Jb=()=>{},V3={};let Ty=tD;const fF=0,hF=4,qA=rF({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:lF,removeChild:WE,appendChild:qb,appendInitialChild:qb,insertBefore:k3,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||qb(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||WE(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||k3(n,e,t)},getRootHostContext:()=>V3,getChildHostContext:()=>V3,commitUpdate(i,e,t,n,r){var s,o,u;nD(e,n);let f=!1;if((i.type==="primitive"&&t.object!==n.object||((s=n.args)==null?void 0:s.length)!==((o=t.args)==null?void 0:o.length)||(u=n.args)!=null&&u.some((g,v)=>{var y;return g!==((y=t.args)==null?void 0:y[v])}))&&(f=!0),f)qy.push([i,{...n},r]);else{const g=G9(i,n);Object.keys(g).length&&(Object.assign(i.props,g),ec(i.object,g))}(r.sibling===null||(r.flags&hF)===fF)&&dF()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i==null?void 0:i.object,prepareForCommit:()=>null,preparePortalMount:i=>XA(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:cF,unhideInstance:iD,createTextInstance:Jb,hideTextInstance:Jb,unhideTextInstance:Jb,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:le.createContext(null),setCurrentUpdatePriority(i){Ty=i},getCurrentUpdatePriority(){return Ty},resolveUpdatePriority(){var i;if(Ty!==tD)return Ty;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return K9;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return q9;default:return J9}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:Z9.version,applyViewTransitionName(i,e,t){},restoreViewTransitionName(i,e){},cancelViewTransitionName(i,e,t){},cancelRootViewTransitionName(i){},restoreRootViewTransitionName(i){},InstanceMeasurement:null,measureInstance:i=>null,wasInstanceInViewport:i=>!0,hasInstanceChanged:(i,e)=>!1,hasInstanceAffectedParent:(i,e)=>!1,suspendOnActiveViewTransition(i,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(i){},createViewTransitionInstance:i=>null,getCurrentGestureOffset(i){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(i,e){return i},cloneMutableTextInstance(i){return i},cloneRootViewTransitionContainer(i){throw new Error("Not implemented.")},removeRootViewTransitionClone(i,e){throw new Error("Not implemented.")},createFragmentInstance:i=>null,updateFragmentInstanceFiber(i,e){},commitNewChildToFragmentInstance(i,e){},deleteChildFromFragmentInstance(i,e){},measureClonedInstance:i=>null,maySuspendCommitOnUpdate:(i,e,t)=>!1,maySuspendCommitInSyncRender:(i,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(i,e)=>null}),sh=new Map,Gp={objects:"shallow",strict:!1};function pF(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function mF(i){const e=sh.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||X9(QE,W3),o=t||qA.createContainer(s,Q9,null,!1,null,"",r,r,r,null);e||sh.set(i,{fiber:o,store:s});let u,f,p=!1,g=null;return{async configure(v={}){let y;g=new Promise(Y=>y=Y);let{gl:A,size:S,scene:T,events:M,onCreated:E,shadows:R=!1,linear:I=!1,flat:O=!1,legacy:F=!1,orthographic:z=!1,frameloop:j="always",dpr:W=[1,2],performance:L,raycaster:H,camera:K,onPointerMissed:de}=v,ce=s.getState(),ne=ce.gl;if(!ce.gl){const Y={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},me=typeof A=="function"?await A(Y):A;P3(me)?ne=me:ne=new Y_({...Y,...A}),ce.set({gl:ne})}let fe=ce.raycaster;fe||ce.set({raycaster:fe=new xT});const{params:X,...re}=H||{};if(ar.equ(re,fe,Gp)||ec(fe,{...re}),ar.equ(X,fe.params,Gp)||ec(fe,{params:{...fe.params,...X}}),!ce.camera||ce.camera===f&&!ar.equ(f,K,Gp)){f=K;const Y=K==null?void 0:K.isCamera,me=Y?K:z?new Ha(0,0,0,0,.1,1e3):new ki(75,0,.1,1e3);Y||(me.position.z=5,K&&(ec(me,K),me.manual||("aspect"in K||"left"in K||"right"in K||"bottom"in K||"top"in K)&&(me.manual=!0,me.updateProjectionMatrix())),!ce.camera&&!(K!=null&&K.rotation)&&me.lookAt(0,0,0)),ce.set({camera:me}),fe.camera=me}if(!ce.scene){let Y;T!=null&&T.isScene?(Y=T,XA(Y,s,"",{})):(Y=new Ad,XA(Y,s,"",{}),T&&ec(Y,T)),ce.set({scene:Y})}M&&!ce.events.handlers&&ce.set({events:M(s)});const ge=pF(i,S);if(ar.equ(ge,ce.size,Gp)||ce.setSize(ge.width,ge.height,ge.top,ge.left),W&&ce.viewport.dpr!==J4(W)&&ce.setDpr(W),ce.frameloop!==j&&ce.setFrameloop(j),ce.onPointerMissed||ce.set({onPointerMissed:de}),L&&!ar.equ(L,ce.performance,Gp)&&ce.set(Y=>({performance:{...Y.performance,...L}})),!ce.xr){var Te;const Y=(Ze,xt)=>{const ve=s.getState();ve.frameloop!=="never"&&W3(Ze,!0,ve,xt)},me=()=>{const Ze=s.getState();Ze.gl.xr.enabled=Ze.gl.xr.isPresenting,Ze.gl.xr.setAnimationLoop(Ze.gl.xr.isPresenting?Y:null),Ze.gl.xr.isPresenting||QE(Ze)},Ce={connect(){const Ze=s.getState().gl;Ze.xr.addEventListener("sessionstart",me),Ze.xr.addEventListener("sessionend",me)},disconnect(){const Ze=s.getState().gl;Ze.xr.removeEventListener("sessionstart",me),Ze.xr.removeEventListener("sessionend",me)}};typeof((Te=ne.xr)==null?void 0:Te.addEventListener)=="function"&&Ce.connect(),ce.set({xr:Ce})}if(ne.shadowMap){const Y=ne.shadowMap.enabled,me=ne.shadowMap.type;if(ne.shadowMap.enabled=!!R,ar.boo(R))ne.shadowMap.type=Qg;else if(ar.str(R)){var Se;const Ce={basic:d2,percentage:am,soft:Qg,variance:Pf};ne.shadowMap.type=(Se=Ce[R])!=null?Se:Qg}else ar.obj(R)&&Object.assign(ne.shadowMap,R);(Y!==ne.shadowMap.enabled||me!==ne.shadowMap.type)&&(ne.shadowMap.needsUpdate=!0)}return $n.enabled=!F,p||(ne.outputColorSpace=I?kr:Hn,ne.toneMapping=O?aa:Dv),ce.legacy!==F&&ce.set(()=>({legacy:F})),ce.linear!==I&&ce.set(()=>({linear:I})),ce.flat!==O&&ce.set(()=>({flat:O})),A&&!ar.fun(A)&&!P3(A)&&!ar.equ(A,ne,Gp)&&ec(ne,A),u=E,p=!0,y(),this},render(v){return!p&&!g&&this.configure(),g.then(()=>{qA.updateContainer(D.jsx(gF,{store:s,children:v,onCreated:u,rootElement:i}),o,null,()=>{})}),s},unmount(){sD(i)}}}function gF({store:i,children:e,onCreated:t,rootElement:n}){return Wv(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),D.jsx(bT.Provider,{value:i,children:e})}function sD(i,e){const t=sh.get(i),n=t==null?void 0:t.fiber;if(n){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),qA.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,u,f;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(u=r.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=r.gl)!=null&&f.xr&&r.xr.disconnect(),F9(r.scene),sh.delete(i)}catch{}},500)})}}function vF(i,e,t){return D.jsx(xF,{children:i,container:e,state:t})}function xF({state:i={},children:e,container:t}){const{events:n,size:r,...s}=i,o=ET(),[u]=le.useState(()=>new xT),[f]=le.useState(()=>new qe),p=ST((v,y)=>{let A;if(y.camera&&r){const S=y.camera;A=v.viewport.getCurrentViewport(S,new Q,r),S!==v.camera&&Z4(S,r)}return{...v,...y,scene:t,raycaster:u,pointer:f,mouse:f,previousRoot:o,events:{...v.events,...y.events,...n},size:{...v.size,...r},viewport:{...v.viewport,...A},setEvents:S=>y.set(T=>({...T,events:{...T.events,...S}}))}}),g=le.useMemo(()=>{const v=k4((A,S)=>({...s,set:A,get:S})),y=A=>v.setState(S=>p.current(A,S));return y(o.getState()),o.subscribe(y),v},[o,t]);return D.jsx(D.Fragment,{children:qA.createPortal(D.jsx(bT.Provider,{value:g,children:e}),g,null)})}function aD(i,e){const t={callback:i};return e.add(t),()=>void e.delete(t)}const oD=new Set,lD=new Set,yF=new Set,AF=i=>aD(i,oD),_F=i=>aD(i,lD);function Kb(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function nv(i,e){switch(i){case"before":return Kb(oD,e);case"after":return Kb(lD,e);case"tail":return Kb(yF,e)}}let Zb,$b;function XE(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),Zb=e.internal.subscribers;for(let r=0;r<Zb.length;r++)$b=Zb[r],$b.ref.current($b.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let JA=!1,YE=!1,eE,j3,kp;function cD(i){j3=requestAnimationFrame(cD),JA=!0,eE=0,nv("before",i),YE=!0;for(const t of sh.values()){var e;kp=t.store.getState(),kp.internal.active&&(kp.frameloop==="always"||kp.internal.frames>0)&&!((e=kp.gl.xr)!=null&&e.isPresenting)&&(eE+=XE(i,kp))}if(YE=!1,nv("after",i),eE===0)return nv("tail",i),JA=!1,cancelAnimationFrame(j3)}function QE(i,e=1){var t;if(!i)return sh.forEach(n=>QE(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):YE?i.internal.frames=2:i.internal.frames=1,JA||(JA=!0,requestAnimationFrame(cD)))}function W3(i,e=!0,t,n){if(e&&nv("before",i),t)XE(i,t,n);else for(const r of sh.values())XE(i,r.store.getState());e&&nv("after",i)}const tE={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function SF(i){const{handlePointer:e}=W9(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(tE).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=i.getState();if(r.disconnect==null||r.disconnect(),n(s=>({events:{...s.events,connected:t}})),r.handlers)for(const s in r.handlers){const o=r.handlers[s],[u,f]=tE[s];t.addEventListener(u,o,{passive:f})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const r in n.handlers){const s=n.handlers[r],[o]=tE[r];n.connected.removeEventListener(o,s)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function X3(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function bF({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=le.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=le.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),f=i?typeof i=="number"?i:i.scroll:null,p=i?typeof i=="number"?i:i.resize:null,g=le.useRef(!1);le.useEffect(()=>(g.current=!0,()=>void(g.current=!1)));const[v,y,A]=le.useMemo(()=>{const E=()=>{if(!u.current.element)return;const{left:R,top:I,width:O,height:F,bottom:z,right:j,x:W,y:L}=u.current.element.getBoundingClientRect(),H={left:R,top:I,width:O,height:F,bottom:z,right:j,x:W,y:L};u.current.element instanceof HTMLElement&&n&&(H.height=u.current.element.offsetHeight,H.width=u.current.element.offsetWidth),Object.freeze(H),g.current&&!wF(u.current.lastBounds,H)&&o(u.current.lastBounds=H)};return[E,p?X3(E,p):E,f?X3(E,f):E]},[o,n,f,p]);function S(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",A,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function T(){u.current.element&&(u.current.resizeObserver=new r(A),u.current.resizeObserver.observe(u.current.element),e&&u.current.scrollContainers&&u.current.scrollContainers.forEach(E=>E.addEventListener("scroll",A,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{A()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const M=E=>{!E||E===u.current.element||(S(),u.current.element=E,u.current.scrollContainers=uD(E),T())};return MF(A,!!e),EF(y),le.useEffect(()=>{S(),T()},[e,A,y]),le.useEffect(()=>S,[]),[M,s,v]}function EF(i){le.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function MF(i,e){le.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function uD(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...uD(i.parentElement)]}const TF=["x","y","top","bottom","left","right","width","height"],wF=(i,e)=>TF.every(t=>i[t]===e[t]);function CF({ref:i,children:e,fallback:t,resize:n,style:r,gl:s,events:o=SF,eventSource:u,eventPrefix:f,shadows:p,linear:g,flat:v,legacy:y,orthographic:A,frameloop:S,dpr:T,performance:M,raycaster:E,camera:R,scene:I,onPointerMissed:O,onCreated:F,...z}){le.useMemo(()=>q_(h9),[]);const j=O9(),[W,L]=bF({scroll:!0,debounce:{scroll:50,resize:0},...n}),H=le.useRef(null),K=le.useRef(null);le.useImperativeHandle(i,()=>H.current);const de=ST(O),[ce,ne]=le.useState(!1),[fe,X]=le.useState(!1);if(ce)throw ce;if(fe)throw fe;const re=le.useRef(null);Wv(()=>{const Te=H.current;if(L.width>0&&L.height>0&&Te){re.current||(re.current=mF(Te));async function Se(){await re.current.configure({gl:s,scene:I,events:o,shadows:p,linear:g,flat:v,legacy:y,orthographic:A,frameloop:S,dpr:T,performance:M,raycaster:E,camera:R,size:L,onPointerMissed:(...Y)=>de.current==null?void 0:de.current(...Y),onCreated:Y=>{Y.events.connect==null||Y.events.connect(u?B9(u)?u.current:u:K.current),f&&Y.setEvents({compute:(me,Ce)=>{const Ze=me[f+"X"],xt=me[f+"Y"];Ce.pointer.set(Ze/Ce.size.width*2-1,-(xt/Ce.size.height)*2+1),Ce.raycaster.setFromCamera(Ce.pointer,Ce.camera)}}),F==null||F(Y)}}),re.current.render(D.jsx(j,{children:D.jsx(P9,{set:X,children:D.jsx(le.Suspense,{fallback:D.jsx(L9,{set:ne}),children:e??null})})}))}Se()}}),le.useEffect(()=>{const Te=H.current;if(Te)return()=>sD(Te)},[]);const ge=u?"none":"auto";return D.jsx("div",{ref:K,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ge,...r},...z,children:D.jsx("div",{ref:W,style:{width:"100%",height:"100%"},children:D.jsx("canvas",{ref:H,style:{display:"block"},children:t})})})}function RF(i){return D.jsx(X4,{children:D.jsx(CF,{...i})})}function vl(){return vl=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},vl.apply(null,arguments)}const Xv=new Q,TT=new Q,DF=new Q,Y3=new qe;function IF(i,e,t){const n=Xv.setFromMatrixPosition(i.matrixWorld);n.project(e);const r=t.width/2,s=t.height/2;return[n.x*r+r,-(n.y*s)+s]}function BF(i,e){const t=Xv.setFromMatrixPosition(i.matrixWorld),n=TT.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),s=e.getWorldDirection(DF);return r.angleTo(s)>Math.PI/2}function NF(i,e,t,n){const r=Xv.setFromMatrixPosition(i.matrixWorld),s=r.clone();s.project(e),Y3.set(s.x,s.y),t.setFromCamera(Y3,e);const o=t.intersectObjects(n,!0);if(o.length){const u=o[0].distance;return r.distanceTo(t.ray.origin)<u}return!0}function OF(i,e){if(e instanceof Ha)return e.zoom;if(e instanceof ki){const t=Xv.setFromMatrixPosition(i.matrixWorld),n=TT.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function LF(i,e,t){if(e instanceof ki||e instanceof Ha){const n=Xv.setFromMatrixPosition(i.matrixWorld),r=TT.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near),u=t[1]-o*e.far;return Math.round(o*s+u)}}const qE=i=>Math.abs(i)<1e-10?0:i;function dD(i,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=qE(e[r]*i.elements[r])+(r!==15?",":")");return t+n}const PF=(i=>e=>dD(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),UF=(i=>(e,t)=>dD(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function FF(i){return i&&typeof i=="object"&&"current"in i}const wT=le.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:r,center:s,fullscreen:o,portal:u,distanceFactor:f,sprite:p=!1,transform:g=!1,occlude:v,onOcclude:y,castShadow:A,receiveShadow:S,material:T,geometry:M,zIndexRange:E=[16777271,0],calculatePosition:R=IF,as:I="div",wrapperClass:O,pointerEvents:F="auto",...z},j)=>{const{gl:W,camera:L,scene:H,size:K,raycaster:de,events:ce,viewport:ne}=Nn(),[fe]=le.useState(()=>document.createElement(I)),X=le.useRef(null),re=le.useRef(null),ge=le.useRef(0),Te=le.useRef([0,0]),Se=le.useRef(null),Y=le.useRef(null),me=(u==null?void 0:u.current)||ce.connected||W.domElement.parentNode,Ce=le.useRef(null),Ze=le.useRef(!1),xt=le.useMemo(()=>v&&v!=="blending"||Array.isArray(v)&&v.length&&FF(v[0]),[v]);le.useLayoutEffect(()=>{const yt=W.domElement;v&&v==="blending"?(yt.style.zIndex=`${Math.floor(E[0]/2)}`,yt.style.position="absolute",yt.style.pointerEvents="none"):(yt.style.zIndex=null,yt.style.position=null,yt.style.pointerEvents=null)},[v]),le.useLayoutEffect(()=>{if(re.current){const yt=X.current=l2.createRoot(fe);if(H.updateMatrixWorld(),g)fe.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Pt=R(re.current,L,K);fe.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Pt[0]}px,${Pt[1]}px,0);transform-origin:0 0;`}return me&&(r?me.prepend(fe):me.appendChild(fe)),()=>{me&&me.removeChild(fe),yt.unmount()}}},[me,g]),le.useLayoutEffect(()=>{O&&(fe.className=O)},[O]);const ve=le.useMemo(()=>g?{position:"absolute",top:0,left:0,width:K.width,height:K.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-K.height/2,left:-K.width/2,width:K.width,height:K.height},...t},[t,s,o,K,g]),ze=le.useMemo(()=>({position:"absolute",pointerEvents:F}),[F]);le.useLayoutEffect(()=>{if(Ze.current=!1,g){var yt;(yt=X.current)==null||yt.render(le.createElement("div",{ref:Se,style:ve},le.createElement("div",{ref:Y,style:ze},le.createElement("div",{ref:j,className:n,style:t,children:i}))))}else{var Pt;(Pt=X.current)==null||Pt.render(le.createElement("div",{ref:j,style:ve,className:n,children:i}))}});const dt=le.useRef(!0);da(yt=>{if(re.current){L.updateMatrixWorld(),re.current.updateWorldMatrix(!0,!1);const Pt=g?Te.current:R(re.current,L,K);if(g||Math.abs(ge.current-L.zoom)>e||Math.abs(Te.current[0]-Pt[0])>e||Math.abs(Te.current[1]-Pt[1])>e){const Ot=BF(re.current,L);let Mt=!1;xt&&(Array.isArray(v)?Mt=v.map(At=>At.current):v!=="blending"&&(Mt=[H]));const je=dt.current;if(Mt){const At=NF(re.current,L,de,Mt);dt.current=At&&!Ot}else dt.current=!Ot;je!==dt.current&&(y?y(!dt.current):fe.style.display=dt.current?"block":"none");const st=Math.floor(E[0]/2),et=v?xt?[E[0],st]:[st-1,0]:E;if(fe.style.zIndex=`${LF(re.current,L,et)}`,g){const[At,oe]=[K.width/2,K.height/2],Gt=L.projectionMatrix.elements[5]*oe,{isOrthographicCamera:Dt,top:qt,left:Tt,bottom:te,right:G}=L,be=PF(L.matrixWorldInverse),Ye=Dt?`scale(${Gt})translate(${qE(-(G+Tt)/2)}px,${qE((qt+te)/2)}px)`:`translateZ(${Gt}px)`;let ot=re.current.matrixWorld;p&&(ot=L.matrixWorldInverse.clone().transpose().copyPosition(ot).scale(re.current.scale),ot.elements[3]=ot.elements[7]=ot.elements[11]=0,ot.elements[15]=1),fe.style.width=K.width+"px",fe.style.height=K.height+"px",fe.style.perspective=Dt?"":`${Gt}px`,Se.current&&Y.current&&(Se.current.style.transform=`${Ye}${be}translate(${At}px,${oe}px)`,Y.current.style.transform=UF(ot,1/((f||10)/400)))}else{const At=f===void 0?1:OF(re.current,L)*f;fe.style.transform=`translate3d(${Pt[0]}px,${Pt[1]}px,0) scale(${At})`}Te.current=Pt,ge.current=L.zoom}}if(!xt&&Ce.current&&!Ze.current)if(g){if(Se.current){const Pt=Se.current.children[0];if(Pt!=null&&Pt.clientWidth&&Pt!=null&&Pt.clientHeight){const{isOrthographicCamera:Ot}=L;if(Ot||M)z.scale&&(Array.isArray(z.scale)?z.scale instanceof Q?Ce.current.scale.copy(z.scale.clone().divideScalar(1)):Ce.current.scale.set(1/z.scale[0],1/z.scale[1],1/z.scale[2]):Ce.current.scale.setScalar(1/z.scale));else{const Mt=(f||10)/400,je=Pt.clientWidth*Mt,st=Pt.clientHeight*Mt;Ce.current.scale.set(je,st,1)}Ze.current=!0}}}else{const Pt=fe.children[0];if(Pt!=null&&Pt.clientWidth&&Pt!=null&&Pt.clientHeight){const Ot=1/ne.factor,Mt=Pt.clientWidth*Ot,je=Pt.clientHeight*Ot;Ce.current.scale.set(Mt,je,1),Ze.current=!0}Ce.current.lookAt(yt.camera.position)}});const Ee=le.useMemo(()=>({vertexShader:g?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[g]);return le.createElement("group",vl({},z,{ref:re}),v&&!xt&&le.createElement("mesh",{castShadow:A,receiveShadow:S,ref:Ce},M||le.createElement("planeGeometry",null),T||le.createElement("shaderMaterial",{side:Vr,vertexShader:Ee.vertexShader,fragmentShader:Ee.fragmentShader})))}),J_=parseInt(lu.replace(/\D+/g,""));function Q3(i,e){if(e===O2)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===HA||e===HM){let t=i.getIndex();if(t===null){const o=[],u=i.getAttribute("position");if(u!==void 0){for(let f=0;f<u.count;f++)o.push(f);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,r=[];if(t)if(e===HA)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var No=Uint8Array,pd=Uint16Array,JE=Uint32Array,fD=new No([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hD=new No([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zF=new No([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pD=function(i,e){for(var t=new pd(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new JE(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},mD=pD(fD,2),gD=mD[0],HF=mD[1];gD[28]=258,HF[258]=28;var GF=pD(hD,0),kF=GF[0],KE=new pd(32768);for(var $i=0;$i<32768;++$i){var ad=($i&43690)>>>1|($i&21845)<<1;ad=(ad&52428)>>>2|(ad&13107)<<2,ad=(ad&61680)>>>4|(ad&3855)<<4,KE[$i]=((ad&65280)>>>8|(ad&255)<<8)>>>1}var iv=(function(i,e,t){for(var n=i.length,r=0,s=new pd(e);r<n;++r)++s[i[r]-1];var o=new pd(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var u;if(t){u=new pd(1<<e);var f=15-e;for(r=0;r<n;++r)if(i[r])for(var p=r<<4|i[r],g=e-i[r],v=o[i[r]-1]++<<g,y=v|(1<<g)-1;v<=y;++v)u[KE[v]>>>f]=p}else for(u=new pd(n),r=0;r<n;++r)i[r]&&(u[r]=KE[o[i[r]-1]++]>>>15-i[r]);return u}),Yv=new No(288);for(var $i=0;$i<144;++$i)Yv[$i]=8;for(var $i=144;$i<256;++$i)Yv[$i]=9;for(var $i=256;$i<280;++$i)Yv[$i]=7;for(var $i=280;$i<288;++$i)Yv[$i]=8;var vD=new No(32);for(var $i=0;$i<32;++$i)vD[$i]=5;var VF=iv(Yv,9,1),jF=iv(vD,5,1),nE=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},al=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},iE=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},WF=function(i){return(i/8|0)+(i&7&&1)},XF=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof pd?pd:i instanceof JE?JE:No)(t-e);return n.set(i.subarray(e,t)),n},YF=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new No(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new No(n*3));var o=function(ve){var ze=e.length;if(ve>ze){var dt=new No(Math.max(ze*2,ve));dt.set(e),e=dt}},u=t.f||0,f=t.p||0,p=t.b||0,g=t.l,v=t.d,y=t.m,A=t.n,S=n*8;do{if(!g){t.f=u=al(i,f,1);var T=al(i,f+1,3);if(f+=3,T)if(T==1)g=VF,v=jF,y=9,A=5;else if(T==2){var I=al(i,f,31)+257,O=al(i,f+10,15)+4,F=I+al(i,f+5,31)+1;f+=14;for(var z=new No(F),j=new No(19),W=0;W<O;++W)j[zF[W]]=al(i,f+W*3,7);f+=O*3;for(var L=nE(j),H=(1<<L)-1,K=iv(j,L,1),W=0;W<F;){var de=K[al(i,f,H)];f+=de&15;var M=de>>>4;if(M<16)z[W++]=M;else{var ce=0,ne=0;for(M==16?(ne=3+al(i,f,3),f+=2,ce=z[W-1]):M==17?(ne=3+al(i,f,7),f+=3):M==18&&(ne=11+al(i,f,127),f+=7);ne--;)z[W++]=ce}}var fe=z.subarray(0,I),X=z.subarray(I);y=nE(fe),A=nE(X),g=iv(fe,y,1),v=iv(X,A,1)}else throw"invalid block type";else{var M=WF(f)+4,E=i[M-4]|i[M-3]<<8,R=M+E;if(R>n){if(s)throw"unexpected EOF";break}r&&o(p+E),e.set(i.subarray(M,R),p),t.b=p+=E,t.p=f=R*8;continue}if(f>S){if(s)throw"unexpected EOF";break}}r&&o(p+131072);for(var re=(1<<y)-1,ge=(1<<A)-1,Te=f;;Te=f){var ce=g[iE(i,f)&re],Se=ce>>>4;if(f+=ce&15,f>S){if(s)throw"unexpected EOF";break}if(!ce)throw"invalid length/literal";if(Se<256)e[p++]=Se;else if(Se==256){Te=f,g=null;break}else{var Y=Se-254;if(Se>264){var W=Se-257,me=fD[W];Y=al(i,f,(1<<me)-1)+gD[W],f+=me}var Ce=v[iE(i,f)&ge],Ze=Ce>>>4;if(!Ce)throw"invalid distance";f+=Ce&15;var X=kF[Ze];if(Ze>3){var me=hD[Ze];X+=iE(i,f)&(1<<me)-1,f+=me}if(f>S){if(s)throw"unexpected EOF";break}r&&o(p+131072);for(var xt=p+Y;p<xt;p+=4)e[p]=e[p-X],e[p+1]=e[p+1-X],e[p+2]=e[p+2-X],e[p+3]=e[p+3-X];p=xt}}t.l=g,t.p=Te,t.b=p,g&&(u=1,t.m=y,t.d=v,t.n=A)}while(!u);return p==e.length?e:XF(e,0,p)},QF=new No(0),qF=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function wy(i,e){return YF((qF(i),i.subarray(2,-4)),e)}var JF=typeof TextDecoder<"u"&&new TextDecoder,KF=0;try{JF.decode(QF,{stream:!0}),KF=1}catch{}var ZF=Object.defineProperty,$F=(i,e,t)=>e in i?ZF(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,q3=(i,e,t)=>($F(i,typeof e!="symbol"?e+"":e,t),t);const e7=(()=>{const i={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Q},up:{value:new Q(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${J_>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},e=new ai({name:"SkyShader",fragmentShader:i.fragmentShader,vertexShader:i.vertexShader,uniforms:WM.clone(i.uniforms),side:jr,depthWrite:!1});class t extends Oi{constructor(){super(new Ed(1,1,1),e)}}return q3(t,"SkyShader",i),q3(t,"material",e),t})(),t7=i=>i&&i.isCubeTexture;class n7 extends Oi{constructor(e,t){var n,r;const s=t7(e),u=((r=s?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?r:1024)/4,f=Math.floor(Math.log2(u)),p=Math.pow(2,f),g=3*Math.max(p,112),v=4*p,y=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/g}`,`#define CUBEUV_TEXEL_HEIGHT ${1/v}`,`#define CUBEUV_MAX_MIP ${f}.0`],A=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,S=y.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${J_>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,T={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},M=new Fv(1,16),E=new ai({uniforms:T,fragmentShader:S,vertexShader:A,side:Vr});super(M,E)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var i7=Object.defineProperty,r7=(i,e,t)=>e in i?i7(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,s7=(i,e,t)=>(r7(i,e+"",t),t);class xD{constructor(){s7(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var a7=Object.defineProperty,o7=(i,e,t)=>e in i?a7(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Zr=(i,e,t)=>(o7(i,typeof e!="symbol"?e+"":e,t),t);const Vp=new Ga(0,0,0,"YXZ"),jp=new Q,l7={type:"change"},c7={type:"lock"},u7={type:"unlock"},J3=.002,K3=Math.PI/2;let d7=class extends xD{constructor(e,t){super(),Zr(this,"camera"),Zr(this,"domElement"),Zr(this,"isLocked"),Zr(this,"minPolarAngle"),Zr(this,"maxPolarAngle"),Zr(this,"pointerSpeed"),Zr(this,"onMouseMove",n=>{!this.domElement||this.isLocked===!1||(Vp.setFromQuaternion(this.camera.quaternion),Vp.y-=n.movementX*J3*this.pointerSpeed,Vp.x-=n.movementY*J3*this.pointerSpeed,Vp.x=Math.max(K3-this.maxPolarAngle,Math.min(K3-this.minPolarAngle,Vp.x)),this.camera.quaternion.setFromEuler(Vp),this.dispatchEvent(l7))}),Zr(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(c7),this.isLocked=!0):(this.dispatchEvent(u7),this.isLocked=!1))}),Zr(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),Zr(this,"connect",n=>{this.domElement=n||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),Zr(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),Zr(this,"dispose",()=>{this.disconnect()}),Zr(this,"getObject",()=>this.camera),Zr(this,"direction",new Q(0,0,-1)),Zr(this,"getDirection",n=>n.copy(this.direction).applyQuaternion(this.camera.quaternion)),Zr(this,"moveForward",n=>{jp.setFromMatrixColumn(this.camera.matrix,0),jp.crossVectors(this.camera.up,jp),this.camera.position.addScaledVector(jp,n)}),Zr(this,"moveRight",n=>{jp.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(jp,n)}),Zr(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),Zr(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}};var f7=Object.defineProperty,h7=(i,e,t)=>e in i?f7(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,dn=(i,e,t)=>(h7(i,typeof e!="symbol"?e+"":e,t),t);const Cy=new bd,Z3=new Kc,p7=Math.cos(70*(Math.PI/180)),$3=(i,e)=>(i%e+e)%e;let m7=class extends xD{constructor(e,t){super(),dn(this,"object"),dn(this,"domElement"),dn(this,"enabled",!0),dn(this,"target",new Q),dn(this,"minDistance",0),dn(this,"maxDistance",1/0),dn(this,"minZoom",0),dn(this,"maxZoom",1/0),dn(this,"minPolarAngle",0),dn(this,"maxPolarAngle",Math.PI),dn(this,"minAzimuthAngle",-1/0),dn(this,"maxAzimuthAngle",1/0),dn(this,"enableDamping",!1),dn(this,"dampingFactor",.05),dn(this,"enableZoom",!0),dn(this,"zoomSpeed",1),dn(this,"enableRotate",!0),dn(this,"rotateSpeed",1),dn(this,"enablePan",!0),dn(this,"panSpeed",1),dn(this,"screenSpacePanning",!0),dn(this,"keyPanSpeed",7),dn(this,"zoomToCursor",!1),dn(this,"autoRotate",!1),dn(this,"autoRotateSpeed",2),dn(this,"reverseOrbit",!1),dn(this,"reverseHorizontalOrbit",!1),dn(this,"reverseVerticalOrbit",!1),dn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),dn(this,"mouseButtons",{LEFT:If.ROTATE,MIDDLE:If.DOLLY,RIGHT:If.PAN}),dn(this,"touches",{ONE:Bf.ROTATE,TWO:Bf.DOLLY_PAN}),dn(this,"target0"),dn(this,"position0"),dn(this,"zoom0"),dn(this,"_domElementKeyEvents",null),dn(this,"getPolarAngle"),dn(this,"getAzimuthalAngle"),dn(this,"setPolarAngle"),dn(this,"setAzimuthalAngle"),dn(this,"getDistance"),dn(this,"getZoomScale"),dn(this,"listenToKeyEvents"),dn(this,"stopListenToKeyEvents"),dn(this,"saveState"),dn(this,"reset"),dn(this,"update"),dn(this,"connect"),dn(this,"dispose"),dn(this,"dollyIn"),dn(this,"dollyOut"),dn(this,"getScale"),dn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>g.phi,this.getAzimuthalAngle=()=>g.theta,this.setPolarAngle=he=>{let Be=$3(he,2*Math.PI),ft=g.phi;ft<0&&(ft+=2*Math.PI),Be<0&&(Be+=2*Math.PI);let pe=Math.abs(Be-ft);2*Math.PI-pe<pe&&(Be<ft?Be+=2*Math.PI:ft+=2*Math.PI),v.phi=Be-ft,n.update()},this.setAzimuthalAngle=he=>{let Be=$3(he,2*Math.PI),ft=g.theta;ft<0&&(ft+=2*Math.PI),Be<0&&(Be+=2*Math.PI);let pe=Math.abs(Be-ft);2*Math.PI-pe<pe&&(Be<ft?Be+=2*Math.PI:ft+=2*Math.PI),v.theta=Be-ft,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=he=>{he.addEventListener("keydown",Qe),this._domElementKeyEvents=he},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Qe),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),f=u.NONE},this.update=(()=>{const he=new Q,Be=new Q(0,1,0),ft=new es().setFromUnitVectors(e.up,Be),pe=ft.clone().invert(),Fe=new Q,Oe=new es,It=2*Math.PI;return function(){const ut=n.object.position;ft.setFromUnitVectors(e.up,Be),pe.copy(ft).invert(),he.copy(ut).sub(n.target),he.applyQuaternion(ft),g.setFromVector3(he),n.autoRotate&&f===u.NONE&&ne(de()),n.enableDamping?(g.theta+=v.theta*n.dampingFactor,g.phi+=v.phi*n.dampingFactor):(g.theta+=v.theta,g.phi+=v.phi);let wt=n.minAzimuthAngle,Zt=n.maxAzimuthAngle;isFinite(wt)&&isFinite(Zt)&&(wt<-Math.PI?wt+=It:wt>Math.PI&&(wt-=It),Zt<-Math.PI?Zt+=It:Zt>Math.PI&&(Zt-=It),wt<=Zt?g.theta=Math.max(wt,Math.min(Zt,g.theta)):g.theta=g.theta>(wt+Zt)/2?Math.max(wt,g.theta):Math.min(Zt,g.theta)),g.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,g.phi)),g.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(A,n.dampingFactor):n.target.add(A),n.zoomToCursor&&L||n.object.isOrthographicCamera?g.radius=Ce(g.radius):g.radius=Ce(g.radius*y),he.setFromSpherical(g),he.applyQuaternion(pe),ut.copy(n.target).add(he),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(v.theta*=1-n.dampingFactor,v.phi*=1-n.dampingFactor,A.multiplyScalar(1-n.dampingFactor)):(v.set(0,0,0),A.set(0,0,0));let yn=!1;if(n.zoomToCursor&&L){let _n=null;if(n.object instanceof ki&&n.object.isPerspectiveCamera){const Si=he.length();_n=Ce(Si*y);const ji=Si-_n;n.object.position.addScaledVector(j,ji),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Si=new Q(W.x,W.y,0);Si.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix(),yn=!0;const ji=new Q(W.x,W.y,0);ji.unproject(n.object),n.object.position.sub(ji).add(Si),n.object.updateMatrixWorld(),_n=he.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;_n!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(_n).add(n.object.position):(Cy.origin.copy(n.object.position),Cy.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Cy.direction))<p7?e.lookAt(n.target):(Z3.setFromNormalAndCoplanarPoint(n.object.up,n.target),Cy.intersectPlane(Z3,n.target))))}else n.object instanceof Ha&&n.object.isOrthographicCamera&&(yn=y!==1,yn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix()));return y=1,L=!1,yn||Fe.distanceToSquared(n.object.position)>p||8*(1-Oe.dot(n.object.quaternion))>p?(n.dispatchEvent(r),Fe.copy(n.object.position),Oe.copy(n.object.quaternion),yn=!1,!0):!1}})(),this.connect=he=>{n.domElement=he,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Vt),n.domElement.addEventListener("pointerdown",Tt),n.domElement.addEventListener("pointercancel",G),n.domElement.addEventListener("wheel",ot)},this.dispose=()=>{var he,Be,ft,pe,Fe,Oe;n.domElement&&(n.domElement.style.touchAction="auto"),(he=n.domElement)==null||he.removeEventListener("contextmenu",Vt),(Be=n.domElement)==null||Be.removeEventListener("pointerdown",Tt),(ft=n.domElement)==null||ft.removeEventListener("pointercancel",G),(pe=n.domElement)==null||pe.removeEventListener("wheel",ot),(Fe=n.domElement)==null||Fe.ownerDocument.removeEventListener("pointermove",te),(Oe=n.domElement)==null||Oe.ownerDocument.removeEventListener("pointerup",G),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Qe)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=u.NONE;const p=1e-6,g=new FE,v=new FE;let y=1;const A=new Q,S=new qe,T=new qe,M=new qe,E=new qe,R=new qe,I=new qe,O=new qe,F=new qe,z=new qe,j=new Q,W=new qe;let L=!1;const H=[],K={};function de(){return 2*Math.PI/60/60*n.autoRotateSpeed}function ce(){return Math.pow(.95,n.zoomSpeed)}function ne(he){n.reverseOrbit||n.reverseHorizontalOrbit?v.theta+=he:v.theta-=he}function fe(he){n.reverseOrbit||n.reverseVerticalOrbit?v.phi+=he:v.phi-=he}const X=(()=>{const he=new Q;return function(ft,pe){he.setFromMatrixColumn(pe,0),he.multiplyScalar(-ft),A.add(he)}})(),re=(()=>{const he=new Q;return function(ft,pe){n.screenSpacePanning===!0?he.setFromMatrixColumn(pe,1):(he.setFromMatrixColumn(pe,0),he.crossVectors(n.object.up,he)),he.multiplyScalar(ft),A.add(he)}})(),ge=(()=>{const he=new Q;return function(ft,pe){const Fe=n.domElement;if(Fe&&n.object instanceof ki&&n.object.isPerspectiveCamera){const Oe=n.object.position;he.copy(Oe).sub(n.target);let It=he.length();It*=Math.tan(n.object.fov/2*Math.PI/180),X(2*ft*It/Fe.clientHeight,n.object.matrix),re(2*pe*It/Fe.clientHeight,n.object.matrix)}else Fe&&n.object instanceof Ha&&n.object.isOrthographicCamera?(X(ft*(n.object.right-n.object.left)/n.object.zoom/Fe.clientWidth,n.object.matrix),re(pe*(n.object.top-n.object.bottom)/n.object.zoom/Fe.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function Te(he){n.object instanceof ki&&n.object.isPerspectiveCamera||n.object instanceof Ha&&n.object.isOrthographicCamera?y=he:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Se(he){Te(y/he)}function Y(he){Te(y*he)}function me(he){if(!n.zoomToCursor||!n.domElement)return;L=!0;const Be=n.domElement.getBoundingClientRect(),ft=he.clientX-Be.left,pe=he.clientY-Be.top,Fe=Be.width,Oe=Be.height;W.x=ft/Fe*2-1,W.y=-(pe/Oe)*2+1,j.set(W.x,W.y,1).unproject(n.object).sub(n.object.position).normalize()}function Ce(he){return Math.max(n.minDistance,Math.min(n.maxDistance,he))}function Ze(he){S.set(he.clientX,he.clientY)}function xt(he){me(he),O.set(he.clientX,he.clientY)}function ve(he){E.set(he.clientX,he.clientY)}function ze(he){T.set(he.clientX,he.clientY),M.subVectors(T,S).multiplyScalar(n.rotateSpeed);const Be=n.domElement;Be&&(ne(2*Math.PI*M.x/Be.clientHeight),fe(2*Math.PI*M.y/Be.clientHeight)),S.copy(T),n.update()}function dt(he){F.set(he.clientX,he.clientY),z.subVectors(F,O),z.y>0?Se(ce()):z.y<0&&Y(ce()),O.copy(F),n.update()}function Ee(he){R.set(he.clientX,he.clientY),I.subVectors(R,E).multiplyScalar(n.panSpeed),ge(I.x,I.y),E.copy(R),n.update()}function yt(he){me(he),he.deltaY<0?Y(ce()):he.deltaY>0&&Se(ce()),n.update()}function Pt(he){let Be=!1;switch(he.code){case n.keys.UP:ge(0,n.keyPanSpeed),Be=!0;break;case n.keys.BOTTOM:ge(0,-n.keyPanSpeed),Be=!0;break;case n.keys.LEFT:ge(n.keyPanSpeed,0),Be=!0;break;case n.keys.RIGHT:ge(-n.keyPanSpeed,0),Be=!0;break}Be&&(he.preventDefault(),n.update())}function Ot(){if(H.length==1)S.set(H[0].pageX,H[0].pageY);else{const he=.5*(H[0].pageX+H[1].pageX),Be=.5*(H[0].pageY+H[1].pageY);S.set(he,Be)}}function Mt(){if(H.length==1)E.set(H[0].pageX,H[0].pageY);else{const he=.5*(H[0].pageX+H[1].pageX),Be=.5*(H[0].pageY+H[1].pageY);E.set(he,Be)}}function je(){const he=H[0].pageX-H[1].pageX,Be=H[0].pageY-H[1].pageY,ft=Math.sqrt(he*he+Be*Be);O.set(0,ft)}function st(){n.enableZoom&&je(),n.enablePan&&Mt()}function et(){n.enableZoom&&je(),n.enableRotate&&Ot()}function At(he){if(H.length==1)T.set(he.pageX,he.pageY);else{const ft=Bt(he),pe=.5*(he.pageX+ft.x),Fe=.5*(he.pageY+ft.y);T.set(pe,Fe)}M.subVectors(T,S).multiplyScalar(n.rotateSpeed);const Be=n.domElement;Be&&(ne(2*Math.PI*M.x/Be.clientHeight),fe(2*Math.PI*M.y/Be.clientHeight)),S.copy(T)}function oe(he){if(H.length==1)R.set(he.pageX,he.pageY);else{const Be=Bt(he),ft=.5*(he.pageX+Be.x),pe=.5*(he.pageY+Be.y);R.set(ft,pe)}I.subVectors(R,E).multiplyScalar(n.panSpeed),ge(I.x,I.y),E.copy(R)}function Gt(he){const Be=Bt(he),ft=he.pageX-Be.x,pe=he.pageY-Be.y,Fe=Math.sqrt(ft*ft+pe*pe);F.set(0,Fe),z.set(0,Math.pow(F.y/O.y,n.zoomSpeed)),Se(z.y),O.copy(F)}function Dt(he){n.enableZoom&&Gt(he),n.enablePan&&oe(he)}function qt(he){n.enableZoom&&Gt(he),n.enableRotate&&At(he)}function Tt(he){var Be,ft;n.enabled!==!1&&(H.length===0&&((Be=n.domElement)==null||Be.ownerDocument.addEventListener("pointermove",te),(ft=n.domElement)==null||ft.ownerDocument.addEventListener("pointerup",G)),$t(he),he.pointerType==="touch"?Ut(he):be(he))}function te(he){n.enabled!==!1&&(he.pointerType==="touch"?Rt(he):Ye(he))}function G(he){var Be,ft,pe;vt(he),H.length===0&&((Be=n.domElement)==null||Be.releasePointerCapture(he.pointerId),(ft=n.domElement)==null||ft.ownerDocument.removeEventListener("pointermove",te),(pe=n.domElement)==null||pe.ownerDocument.removeEventListener("pointerup",G)),n.dispatchEvent(o),f=u.NONE}function be(he){let Be;switch(he.button){case 0:Be=n.mouseButtons.LEFT;break;case 1:Be=n.mouseButtons.MIDDLE;break;case 2:Be=n.mouseButtons.RIGHT;break;default:Be=-1}switch(Be){case If.DOLLY:if(n.enableZoom===!1)return;xt(he),f=u.DOLLY;break;case If.ROTATE:if(he.ctrlKey||he.metaKey||he.shiftKey){if(n.enablePan===!1)return;ve(he),f=u.PAN}else{if(n.enableRotate===!1)return;Ze(he),f=u.ROTATE}break;case If.PAN:if(he.ctrlKey||he.metaKey||he.shiftKey){if(n.enableRotate===!1)return;Ze(he),f=u.ROTATE}else{if(n.enablePan===!1)return;ve(he),f=u.PAN}break;default:f=u.NONE}f!==u.NONE&&n.dispatchEvent(s)}function Ye(he){if(n.enabled!==!1)switch(f){case u.ROTATE:if(n.enableRotate===!1)return;ze(he);break;case u.DOLLY:if(n.enableZoom===!1)return;dt(he);break;case u.PAN:if(n.enablePan===!1)return;Ee(he);break}}function ot(he){n.enabled===!1||n.enableZoom===!1||f!==u.NONE&&f!==u.ROTATE||(he.preventDefault(),n.dispatchEvent(s),yt(he),n.dispatchEvent(o))}function Qe(he){n.enabled===!1||n.enablePan===!1||Pt(he)}function Ut(he){switch(ct(he),H.length){case 1:switch(n.touches.ONE){case Bf.ROTATE:if(n.enableRotate===!1)return;Ot(),f=u.TOUCH_ROTATE;break;case Bf.PAN:if(n.enablePan===!1)return;Mt(),f=u.TOUCH_PAN;break;default:f=u.NONE}break;case 2:switch(n.touches.TWO){case Bf.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;st(),f=u.TOUCH_DOLLY_PAN;break;case Bf.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;et(),f=u.TOUCH_DOLLY_ROTATE;break;default:f=u.NONE}break;default:f=u.NONE}f!==u.NONE&&n.dispatchEvent(s)}function Rt(he){switch(ct(he),f){case u.TOUCH_ROTATE:if(n.enableRotate===!1)return;At(he),n.update();break;case u.TOUCH_PAN:if(n.enablePan===!1)return;oe(he),n.update();break;case u.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Dt(he),n.update();break;case u.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;qt(he),n.update();break;default:f=u.NONE}}function Vt(he){n.enabled!==!1&&he.preventDefault()}function $t(he){H.push(he)}function vt(he){delete K[he.pointerId];for(let Be=0;Be<H.length;Be++)if(H[Be].pointerId==he.pointerId){H.splice(Be,1);return}}function ct(he){let Be=K[he.pointerId];Be===void 0&&(Be=new qe,K[he.pointerId]=Be),Be.set(he.pageX,he.pageY)}function Bt(he){const Be=he.pointerId===H[0].pointerId?H[1]:H[0];return K[Be.pointerId]}this.dollyIn=(he=ce())=>{Y(he),n.update()},this.dollyOut=(he=ce())=>{Se(he),n.update()},this.getScale=()=>y,this.setScale=he=>{Te(he),n.update()},this.getZoomScale=()=>ce(),t!==void 0&&this.connect(t),this.update()}};function KA(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const kf="srgb",au="srgb-linear",eR=3001,g7=3e3;class CT extends gr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new _7(t)}),this.register(function(t){return new S7(t)}),this.register(function(t){return new I7(t)}),this.register(function(t){return new B7(t)}),this.register(function(t){return new N7(t)}),this.register(function(t){return new E7(t)}),this.register(function(t){return new M7(t)}),this.register(function(t){return new T7(t)}),this.register(function(t){return new w7(t)}),this.register(function(t){return new A7(t)}),this.register(function(t){return new C7(t)}),this.register(function(t){return new b7(t)}),this.register(function(t){return new D7(t)}),this.register(function(t){return new R7(t)}),this.register(function(t){return new x7(t)}),this.register(function(t){return new O7(t)}),this.register(function(t){return new L7(t)})}load(e,t,n,r){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const p=md.extractUrlBase(e);o=md.resolveURL(p,this.path)}else o=md.extractUrlBase(e);this.manager.itemStart(e);const u=function(p){r?r(p):console.error(p),s.manager.itemError(e),s.manager.itemEnd(e)},f=new ds(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(p){try{s.parse(p,o,function(g){t(g),s.manager.itemEnd(e)},u)}catch(g){u(g)}},n,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},u={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(KA(new Uint8Array(e.slice(0,4)))===yD){try{o[qn.KHR_BINARY_GLTF]=new P7(e)}catch(g){r&&r(g);return}s=JSON.parse(o[qn.KHR_BINARY_GLTF].content)}else s=JSON.parse(KA(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const f=new q7(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const g=this.pluginCallbacks[p](f);g.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[g.name]=g,o[g.name]=!0}if(s.extensionsUsed)for(let p=0;p<s.extensionsUsed.length;++p){const g=s.extensionsUsed[p],v=s.extensionsRequired||[];switch(g){case qn.KHR_MATERIALS_UNLIT:o[g]=new y7;break;case qn.KHR_DRACO_MESH_COMPRESSION:o[g]=new U7(s,this.dracoLoader);break;case qn.KHR_TEXTURE_TRANSFORM:o[g]=new F7;break;case qn.KHR_MESH_QUANTIZATION:o[g]=new z7;break;default:v.indexOf(g)>=0&&u[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}f.setExtensions(o),f.setPlugins(u),f.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function v7(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const qn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class x7{constructor(e){this.parser=e,this.name=qn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,f=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let p;const g=new Ft(16777215);f.color!==void 0&&g.setRGB(f.color[0],f.color[1],f.color[2],au);const v=f.range!==void 0?f.range:0;switch(f.type){case"directional":p=new fT(g),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new dT(g),p.distance=v;break;case"spot":p=new uT(g),p.distance=v,f.spot=f.spot||{},f.spot.innerConeAngle=f.spot.innerConeAngle!==void 0?f.spot.innerConeAngle:0,f.spot.outerConeAngle=f.spot.outerConeAngle!==void 0?f.spot.outerConeAngle:Math.PI/4,p.angle=f.spot.outerConeAngle,p.penumbra=1-f.spot.innerConeAngle/f.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+f.type)}return p.position.set(0,0,0),p.decay=2,Jc(p,f),f.intensity!==void 0&&(p.intensity=f.intensity),p.name=t.createUniqueName(f.name||"light_"+e),r=Promise.resolve(p),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],u=(s.extensions&&s.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(f){return n._getNodeRef(t.cache,u,f)})}}class y7{constructor(){this.name=qn.KHR_MATERIALS_UNLIT}getMaterialType(){return za}extendParams(e,t,n){const r=[];e.color=new Ft(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],au),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,kf))}return Promise.all(r)}}class A7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class _7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const u=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new qe(u,u)}return Promise.all(s)}}class S7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class b7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class E7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ft(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){const u=o.sheenColorFactor;t.sheenColor.setRGB(u[0],u[1],u[2],au)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,kf)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class M7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class T7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const u=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ft().setRGB(u[0],u[1],u[2],au),Promise.all(s)}}class w7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class C7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const u=o.specularColorFactor||[1,1,1];return t.specularColor=new Ft().setRGB(u[0],u[1],u[2],au),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,kf)),Promise.all(s)}}class R7{constructor(e){this.parser=e,this.name=qn.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class D7{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:no}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class I7{constructor(e){this.parser=e,this.name=qn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class B7{constructor(e){this.parser=e,this.name=qn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],u=r.images[o.source];let f=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(f=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o.source,f);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class N7{constructor(e){this.parser=e,this.name=qn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],u=r.images[o.source];let f=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(f=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o.source,f);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class O7{constructor(e){this.name=qn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(u){const f=r.byteOffset||0,p=r.byteLength||0,g=r.count,v=r.byteStride,y=new Uint8Array(u,f,p);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(g,v,y,r.mode,r.filter).then(function(A){return A.buffer}):o.ready.then(function(){const A=new ArrayBuffer(g*v);return o.decodeGltfBuffer(new Uint8Array(A),g,v,y,r.mode,r.filter),A})})}else return null}}class L7{constructor(e){this.name=qn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=t.meshes[n.mesh];for(const p of r.primitives)if(p.mode!==Do.TRIANGLES&&p.mode!==Do.TRIANGLE_STRIP&&p.mode!==Do.TRIANGLE_FAN&&p.mode!==void 0)return null;const o=n.extensions[this.name].attributes,u=[],f={};for(const p in o)u.push(this.parser.getDependency("accessor",o[p]).then(g=>(f[p]=g,f[p])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(p=>{const g=p.pop(),v=g.isGroup?g.children:[g],y=p[0].count,A=[];for(const S of v){const T=new jt,M=new Q,E=new es,R=new Q(1,1,1),I=new QM(S.geometry,S.material,y);for(let O=0;O<y;O++)f.TRANSLATION&&M.fromBufferAttribute(f.TRANSLATION,O),f.ROTATION&&E.fromBufferAttribute(f.ROTATION,O),f.SCALE&&R.fromBufferAttribute(f.SCALE,O),I.setMatrixAt(O,T.compose(M,E,R));for(const O in f)if(O==="_COLOR_0"){const F=f[O];I.instanceColor=new eh(F.array,F.itemSize,F.normalized)}else O!=="TRANSLATION"&&O!=="ROTATION"&&O!=="SCALE"&&S.geometry.setAttribute(O,f[O]);ni.prototype.copy.call(I,S),this.parser.assignFinalMaterial(I),A.push(I)}return g.isGroup?(g.clear(),g.add(...A),g):A[0]}))}}const yD="glTF",Rg=12,tR={JSON:1313821514,BIN:5130562};class P7{constructor(e){this.name=qn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Rg);if(this.header={magic:KA(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==yD)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Rg,r=new DataView(e,Rg);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const u=r.getUint32(s,!0);if(s+=4,u===tR.JSON){const f=new Uint8Array(e,Rg+s,o);this.content=KA(f)}else if(u===tR.BIN){const f=Rg+s;this.body=e.slice(f,f+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class U7{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=qn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,u={},f={},p={};for(const g in o){const v=ZE[g]||g.toLowerCase();u[v]=o[g]}for(const g in e.attributes){const v=ZE[g]||g.toLowerCase();if(o[g]!==void 0){const y=n.accessors[e.attributes[g]],A=cm[y.componentType];p[v]=A.name,f[v]=y.normalized===!0}}return t.getDependency("bufferView",s).then(function(g){return new Promise(function(v,y){r.decodeDracoFile(g,function(A){for(const S in A.attributes){const T=A.attributes[S],M=f[S];M!==void 0&&(T.normalized=M)}v(A)},u,p,au,y)})})}}class F7{constructor(){this.name=qn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class z7{constructor(){this.name=qn.KHR_MESH_QUANTIZATION}}class AD extends Om{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=u*2,p=u*3,g=r-t,v=(n-t)/g,y=v*v,A=y*v,S=e*p,T=S-p,M=-2*A+3*y,E=A-y,R=1-M,I=E-y+v;for(let O=0;O!==u;O++){const F=o[T+O+u],z=o[T+O+f]*g,j=o[S+O+u],W=o[S+O]*g;s[O]=R*F+I*z+M*j+E*W}return s}}const H7=new es;class G7 extends AD{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return H7.fromArray(s).normalize().toArray(s),s}}const Do={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},cm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},nR={9728:di,9729:on,9984:h_,9985:om,9986:Uf,9987:Ka},iR={33071:Ni,33648:pm,10497:Lo},rE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ZE={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...J_>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},od={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},k7={CUBICSPLINE:void 0,LINEAR:gm,STEP:mm},sE={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function V7(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new kv({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ml})),i.DefaultMaterial}function Cf(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Jc(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function j7(i,e,t){let n=!1,r=!1,s=!1;for(let p=0,g=e.length;p<g;p++){const v=e[p];if(v.POSITION!==void 0&&(n=!0),v.NORMAL!==void 0&&(r=!0),v.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],u=[],f=[];for(let p=0,g=e.length;p<g;p++){const v=e[p];if(n){const y=v.POSITION!==void 0?t.getDependency("accessor",v.POSITION):i.attributes.position;o.push(y)}if(r){const y=v.NORMAL!==void 0?t.getDependency("accessor",v.NORMAL):i.attributes.normal;u.push(y)}if(s){const y=v.COLOR_0!==void 0?t.getDependency("accessor",v.COLOR_0):i.attributes.color;f.push(y)}}return Promise.all([Promise.all(o),Promise.all(u),Promise.all(f)]).then(function(p){const g=p[0],v=p[1],y=p[2];return n&&(i.morphAttributes.position=g),r&&(i.morphAttributes.normal=v),s&&(i.morphAttributes.color=y),i.morphTargetsRelative=!0,i})}function W7(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function X7(i){let e;const t=i.extensions&&i.extensions[qn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+aE(t.attributes):e=i.indices+":"+aE(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+aE(i.targets[n]);return e}function aE(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function $E(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Y7(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Q7=new jt;class q7{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new v7,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new jv(this.options.manager):this.textureLoader=new R4(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ds(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const u={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};return Cf(s,u,r),Jc(u,r),Promise.all(n._invokeAll(function(f){return f.afterRoot&&f.afterRoot(u)})).then(function(){for(const f of u.scenes)f.updateMatrixWorld();e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let u=0,f=o.length;u<f;u++)e[o[u]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,u)=>{const f=this.associations.get(o);f!=null&&this.associations.set(u,f);for(const[p,g]of o.children.entries())s(g,u.children[p])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[qn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(md.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=rE[r.type],u=cm[r.componentType],f=r.normalized===!0,p=new u(r.count*o);return Promise.resolve(new jn(p,o,f))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const u=o[0],f=rE[r.type],p=cm[r.componentType],g=p.BYTES_PER_ELEMENT,v=g*f,y=r.byteOffset||0,A=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,S=r.normalized===!0;let T,M;if(A&&A!==v){const E=Math.floor(y/A),R="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+E+":"+r.count;let I=t.cache.get(R);I||(T=new p(u,E*A,r.count*A/g),I=new $f(T,A/g),t.cache.add(R,I)),M=new pl(I,f,y%A/g,S)}else u===null?T=new p(r.count*f):T=new p(u,y,r.count*f),M=new jn(T,f,S);if(r.sparse!==void 0){const E=rE.SCALAR,R=cm[r.sparse.indices.componentType],I=r.sparse.indices.byteOffset||0,O=r.sparse.values.byteOffset||0,F=new R(o[1],I,r.sparse.count*E),z=new p(o[2],O,r.sparse.count*f);u!==null&&(M=new jn(M.array.slice(),M.itemSize,M.normalized));for(let j=0,W=F.length;j<W;j++){const L=F[j];if(M.setX(L,z[j*f]),f>=2&&M.setY(L,z[j*f+1]),f>=3&&M.setZ(L,z[j*f+2]),f>=4&&M.setW(L,z[j*f+3]),f>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s];let u=this.textureLoader;if(o.uri){const f=n.manager.getHandler(o.uri);f!==null&&(u=f)}return this.loadTextureImage(e,s,u)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],u=s.images[t],f=(u.uri||u.bufferView)+":"+o.sampler;if(this.textureCache[f])return this.textureCache[f];const p=this.loadImageSource(t,n).then(function(g){g.flipY=!1,g.name=o.name||u.name||"",g.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(g.name=u.uri);const y=(s.samplers||{})[o.sampler]||{};return g.magFilter=nR[y.magFilter]||on,g.minFilter=nR[y.minFilter]||Ka,g.wrapS=iR[y.wrapS]||Lo,g.wrapT=iR[y.wrapT]||Lo,r.associations.set(g,{textures:e}),g}).catch(function(){return null});return this.textureCache[f]=p,p}loadImageSource(e,t){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(v=>v.clone());const o=r.images[e],u=self.URL||self.webkitURL;let f=o.uri||"",p=!1;if(o.bufferView!==void 0)f=n.getDependency("bufferView",o.bufferView).then(function(v){p=!0;const y=new Blob([v],{type:o.mimeType});return f=u.createObjectURL(y),f});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const g=Promise.resolve(f).then(function(v){return new Promise(function(y,A){let S=y;t.isImageBitmapLoader===!0&&(S=function(T){const M=new Jn(T);M.needsUpdate=!0,y(M)}),t.load(md.resolveURL(v,s.path),S,void 0,A)})}).then(function(v){return p===!0&&u.revokeObjectURL(f),Jc(v,o),v.userData.mimeType=o.mimeType||Y7(o.uri),v}).catch(function(v){throw console.error("THREE.GLTFLoader: Couldn't load texture",f),v});return this.sourceCache[e]=g,g}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[qn.KHR_TEXTURE_TRANSFORM]){const u=n.extensions!==void 0?n.extensions[qn.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const f=s.associations.get(o);o=s.extensions[qn.KHR_TEXTURE_TRANSFORM].extendTexture(o,u),s.associations.set(o,f)}}return r!==void 0&&(typeof r=="number"&&(r=r===eR?kf:au),"colorSpace"in o?o.colorSpace=r:o.encoding=r===kf?eR:g7),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+n.uuid;let f=this.cache.get(u);f||(f=new w_,mr.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,f.sizeAttenuation=!1,this.cache.add(u,f)),n=f}else if(e.isLine){const u="LineBasicMaterial:"+n.uuid;let f=this.cache.get(u);f||(f=new Ms,mr.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,this.cache.add(u,f)),n=f}if(r||s||o){let u="ClonedMaterial:"+n.uuid+":";r&&(u+="derivative-tangents:"),s&&(u+="vertex-colors:"),o&&(u+="flat-shading:");let f=this.cache.get(u);f||(f=n.clone(),s&&(f.vertexColors=!0),o&&(f.flatShading=!0),r&&(f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(u,f),this.associations.set(f,this.associations.get(n))),n=f}e.material=n}getMaterialType(){return kv}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const u={},f=s.extensions||{},p=[];if(f[qn.KHR_MATERIALS_UNLIT]){const v=r[qn.KHR_MATERIALS_UNLIT];o=v.getMaterialType(),p.push(v.extendParams(u,s,t))}else{const v=s.pbrMetallicRoughness||{};if(u.color=new Ft(1,1,1),u.opacity=1,Array.isArray(v.baseColorFactor)){const y=v.baseColorFactor;u.color.setRGB(y[0],y[1],y[2],au),u.opacity=y[3]}v.baseColorTexture!==void 0&&p.push(t.assignTexture(u,"map",v.baseColorTexture,kf)),u.metalness=v.metallicFactor!==void 0?v.metallicFactor:1,u.roughness=v.roughnessFactor!==void 0?v.roughnessFactor:1,v.metallicRoughnessTexture!==void 0&&(p.push(t.assignTexture(u,"metalnessMap",v.metallicRoughnessTexture)),p.push(t.assignTexture(u,"roughnessMap",v.metallicRoughnessTexture))),o=this._invokeOne(function(y){return y.getMaterialType&&y.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(y){return y.extendMaterialParams&&y.extendMaterialParams(e,u)})))}s.doubleSided===!0&&(u.side=Vr);const g=s.alphaMode||sE.OPAQUE;if(g===sE.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,g===sE.MASK&&(u.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==za&&(p.push(t.assignTexture(u,"normalMap",s.normalTexture)),u.normalScale=new qe(1,1),s.normalTexture.scale!==void 0)){const v=s.normalTexture.scale;u.normalScale.set(v,v)}if(s.occlusionTexture!==void 0&&o!==za&&(p.push(t.assignTexture(u,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==za){const v=s.emissiveFactor;u.emissive=new Ft().setRGB(v[0],v[1],v[2],au)}return s.emissiveTexture!==void 0&&o!==za&&p.push(t.assignTexture(u,"emissiveMap",s.emissiveTexture,kf)),Promise.all(p).then(function(){const v=new o(u);return s.name&&(v.name=s.name),Jc(v,s),t.associations.set(v,{materials:e}),s.extensions&&Cf(r,v,s),v})}createUniqueName(e){const t=ri.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(u){return n[qn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(f){return rR(f,u,t)})}const o=[];for(let u=0,f=e.length;u<f;u++){const p=e[u],g=X7(p),v=r[g];if(v)o.push(v.promise);else{let y;p.extensions&&p.extensions[qn.KHR_DRACO_MESH_COMPRESSION]?y=s(p):y=rR(new pn,p,t),r[g]={primitive:p,promise:y},o.push(y)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,u=[];for(let f=0,p=o.length;f<p;f++){const g=o[f].material===void 0?V7(this.cache):this.getDependency("material",o[f].material);u.push(g)}return u.push(t.loadGeometries(o)),Promise.all(u).then(function(f){const p=f.slice(0,f.length-1),g=f[f.length-1],v=[];for(let A=0,S=g.length;A<S;A++){const T=g[A],M=o[A];let E;const R=p[A];if(M.mode===Do.TRIANGLES||M.mode===Do.TRIANGLE_STRIP||M.mode===Do.TRIANGLE_FAN||M.mode===void 0)E=s.isSkinnedMesh===!0?new YM(T,R):new Oi(T,R),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),M.mode===Do.TRIANGLE_STRIP?E.geometry=Q3(E.geometry,HM):M.mode===Do.TRIANGLE_FAN&&(E.geometry=Q3(E.geometry,HA));else if(M.mode===Do.LINES)E=new xl(T,R);else if(M.mode===Do.LINE_STRIP)E=new sc(T,R);else if(M.mode===Do.LINE_LOOP)E=new qM(T,R);else if(M.mode===Do.POINTS)E=new JM(T,R);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(E.geometry.morphAttributes).length>0&&W7(E,s),E.name=t.createUniqueName(s.name||"mesh_"+e),Jc(E,s),M.extensions&&Cf(r,E,M),t.assignFinalMaterial(E),v.push(E)}for(let A=0,S=v.length;A<S;A++)t.associations.set(v[A],{meshes:e,primitives:A});if(v.length===1)return s.extensions&&Cf(r,v[0],s),v[0];const y=new nc;s.extensions&&Cf(r,y,s),t.associations.set(y,{meshes:e});for(let A=0,S=v.length;A<S;A++)y.add(v[A]);return y})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new ki(to.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new Ha(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Jc(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),o=r,u=[],f=[];for(let p=0,g=o.length;p<g;p++){const v=o[p];if(v){u.push(v);const y=new jt;s!==null&&y.fromArray(s.array,p*16),f.push(y)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new Lv(u,f)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],u=[],f=[],p=[],g=[];for(let v=0,y=r.channels.length;v<y;v++){const A=r.channels[v],S=r.samplers[A.sampler],T=A.target,M=T.node,E=r.parameters!==void 0?r.parameters[S.input]:S.input,R=r.parameters!==void 0?r.parameters[S.output]:S.output;T.node!==void 0&&(o.push(this.getDependency("node",M)),u.push(this.getDependency("accessor",E)),f.push(this.getDependency("accessor",R)),p.push(S),g.push(T))}return Promise.all([Promise.all(o),Promise.all(u),Promise.all(f),Promise.all(p),Promise.all(g)]).then(function(v){const y=v[0],A=v[1],S=v[2],T=v[3],M=v[4],E=[];for(let R=0,I=y.length;R<I;R++){const O=y[R],F=A[R],z=S[R],j=T[R],W=M[R];if(O===void 0)continue;O.updateMatrix&&O.updateMatrix();const L=n._createAnimationTracks(O,F,z,j,W);if(L)for(let H=0;H<L.length;H++)E.push(L[H])}return new Em(s,void 0,E)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(u){if(u.isMesh)for(let f=0,p=r.weights.length;f<p;f++)u.morphTargetInfluences[f]=r.weights[f]}),o})}loadNode(e){const t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),o=[],u=r.children||[];for(let p=0,g=u.length;p<g;p++)o.push(n.getDependency("node",u[p]));const f=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),f]).then(function(p){const g=p[0],v=p[1],y=p[2];y!==null&&g.traverse(function(A){A.isSkinnedMesh&&A.bind(y,Q7)});for(let A=0,S=v.length;A<S;A++)g.add(v[A]);return g})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",u=[],f=r._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return f&&u.push(f),s.camera!==void 0&&u.push(r.getDependency("camera",s.camera).then(function(p){return r._getNodeRef(r.cameraCache,s.camera,p)})),r._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){u.push(p)}),this.nodeCache[e]=Promise.all(u).then(function(p){let g;if(s.isBone===!0?g=new M_:p.length>1?g=new nc:p.length===1?g=p[0]:g=new ni,g!==p[0])for(let v=0,y=p.length;v<y;v++)g.add(p[v]);if(s.name&&(g.userData.name=s.name,g.name=o),Jc(g,s),s.extensions&&Cf(n,g,s),s.matrix!==void 0){const v=new jt;v.fromArray(s.matrix),g.applyMatrix4(v)}else s.translation!==void 0&&g.position.fromArray(s.translation),s.rotation!==void 0&&g.quaternion.fromArray(s.rotation),s.scale!==void 0&&g.scale.fromArray(s.scale);return r.associations.has(g)||r.associations.set(g,{}),r.associations.get(g).nodes=e,g}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new nc;n.name&&(s.name=r.createUniqueName(n.name)),Jc(s,n),n.extensions&&Cf(t,s,n);const o=n.nodes||[],u=[];for(let f=0,p=o.length;f<p;f++)u.push(r.getDependency("node",o[f]));return Promise.all(u).then(function(f){for(let g=0,v=f.length;g<v;g++)s.add(f[g]);const p=g=>{const v=new Map;for(const[y,A]of r.associations)(y instanceof mr||y instanceof Jn)&&v.set(y,A);return g.traverse(y=>{const A=r.associations.get(y);A!=null&&v.set(y,A)}),v};return r.associations=p(s),s})}_createAnimationTracks(e,t,n,r,s){const o=[],u=e.name?e.name:e.uuid,f=[];od[s.path]===od.weights?e.traverse(function(y){y.morphTargetInfluences&&f.push(y.name?y.name:y.uuid)}):f.push(u);let p;switch(od[s.path]){case od.weights:p=nh;break;case od.rotation:p=ih;break;case od.position:case od.scale:p=rh;break;default:switch(n.itemSize){case 1:p=nh;break;case 2:case 3:default:p=rh;break}break}const g=r.interpolation!==void 0?k7[r.interpolation]:gm,v=this._getArrayFromAccessor(n);for(let y=0,A=f.length;y<A;y++){const S=new p(f[y]+"."+od[s.path],t.array,v,g);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(S),o.push(S)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=$E(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const r=this instanceof ih?G7:AD;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function J7(i,e,t){const n=e.attributes,r=new Es;if(n.POSITION!==void 0){const u=t.json.accessors[n.POSITION],f=u.min,p=u.max;if(f!==void 0&&p!==void 0){if(r.set(new Q(f[0],f[1],f[2]),new Q(p[0],p[1],p[2])),u.normalized){const g=$E(cm[u.componentType]);r.min.multiplyScalar(g),r.max.multiplyScalar(g)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const u=new Q,f=new Q;for(let p=0,g=s.length;p<g;p++){const v=s[p];if(v.POSITION!==void 0){const y=t.json.accessors[v.POSITION],A=y.min,S=y.max;if(A!==void 0&&S!==void 0){if(f.setX(Math.max(Math.abs(A[0]),Math.abs(S[0]))),f.setY(Math.max(Math.abs(A[1]),Math.abs(S[1]))),f.setZ(Math.max(Math.abs(A[2]),Math.abs(S[2]))),y.normalized){const T=$E(cm[y.componentType]);f.multiplyScalar(T)}u.max(f)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(u)}i.boundingBox=r;const o=new Wr;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function rR(i,e,t){const n=e.attributes,r=[];function s(o,u){return t.getDependency("accessor",o).then(function(f){i.setAttribute(u,f)})}for(const o in n){const u=ZE[o]||o.toLowerCase();u in i.attributes||r.push(s(n[o],u))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(u){i.setIndex(u)});r.push(o)}return Jc(i,e),J7(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?j7(i,e.targets,t):i})}const K7={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},Z7={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class $7 extends V_{constructor(e){super(e),this.type=On}parse(e){const o=function(W,L){switch(W){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},v=function(W,L,H){L=L||1024;let de=W.pos,ce=-1,ne=0,fe="",X=String.fromCharCode.apply(null,new Uint16Array(W.subarray(de,de+128)));for(;0>(ce=X.indexOf(`
`))&&ne<L&&de<W.byteLength;)fe+=X,ne+=X.length,de+=128,X+=String.fromCharCode.apply(null,new Uint16Array(W.subarray(de,de+128)));return-1<ce?(W.pos+=ne+ce+1,fe+X.slice(0,ce)):!1},y=function(W){const L=/^#\?(\S+)/,H=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,K=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,de=/^\s*FORMAT=(\S+)\s*$/,ce=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ne={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let fe,X;for((W.pos>=W.byteLength||!(fe=v(W)))&&o(1,"no header found"),(X=fe.match(L))||o(3,"bad initial token"),ne.valid|=1,ne.programtype=X[1],ne.string+=fe+`
`;fe=v(W),fe!==!1;){if(ne.string+=fe+`
`,fe.charAt(0)==="#"){ne.comments+=fe+`
`;continue}if((X=fe.match(H))&&(ne.gamma=parseFloat(X[1])),(X=fe.match(K))&&(ne.exposure=parseFloat(X[1])),(X=fe.match(de))&&(ne.valid|=2,ne.format=X[1]),(X=fe.match(ce))&&(ne.valid|=4,ne.height=parseInt(X[1],10),ne.width=parseInt(X[2],10)),ne.valid&2&&ne.valid&4)break}return ne.valid&2||o(3,"missing format specifier"),ne.valid&4||o(3,"missing image size specifier"),ne},A=function(W,L,H){const K=L;if(K<8||K>32767||W[0]!==2||W[1]!==2||W[2]&128)return new Uint8Array(W);K!==(W[2]<<8|W[3])&&o(3,"wrong scanline width");const de=new Uint8Array(4*L*H);de.length||o(4,"unable to allocate buffer space");let ce=0,ne=0;const fe=4*K,X=new Uint8Array(4),re=new Uint8Array(fe);let ge=H;for(;ge>0&&ne<W.byteLength;){ne+4>W.byteLength&&o(1),X[0]=W[ne++],X[1]=W[ne++],X[2]=W[ne++],X[3]=W[ne++],(X[0]!=2||X[1]!=2||(X[2]<<8|X[3])!=K)&&o(3,"bad rgbe scanline format");let Te=0,Se;for(;Te<fe&&ne<W.byteLength;){Se=W[ne++];const me=Se>128;if(me&&(Se-=128),(Se===0||Te+Se>fe)&&o(3,"bad scanline data"),me){const Ce=W[ne++];for(let Ze=0;Ze<Se;Ze++)re[Te++]=Ce}else re.set(W.subarray(ne,ne+Se),Te),Te+=Se,ne+=Se}const Y=K;for(let me=0;me<Y;me++){let Ce=0;de[ce]=re[me+Ce],Ce+=K,de[ce+1]=re[me+Ce],Ce+=K,de[ce+2]=re[me+Ce],Ce+=K,de[ce+3]=re[me+Ce],ce+=4}ge--}return de},S=function(W,L,H,K){const de=W[L+3],ce=Math.pow(2,de-128)/255;H[K+0]=W[L+0]*ce,H[K+1]=W[L+1]*ce,H[K+2]=W[L+2]*ce,H[K+3]=1},T=function(W,L,H,K){const de=W[L+3],ce=Math.pow(2,de-128)/255;H[K+0]=iu.toHalfFloat(Math.min(W[L+0]*ce,65504)),H[K+1]=iu.toHalfFloat(Math.min(W[L+1]*ce,65504)),H[K+2]=iu.toHalfFloat(Math.min(W[L+2]*ce,65504)),H[K+3]=iu.toHalfFloat(1)},M=new Uint8Array(e);M.pos=0;const E=y(M),R=E.width,I=E.height,O=A(M.subarray(M.pos),R,I);let F,z,j;switch(this.type){case si:j=O.length/4;const W=new Float32Array(j*4);for(let H=0;H<j;H++)S(O,H*4,W,H*4);F=W,z=si;break;case On:j=O.length/4;const L=new Uint16Array(j*4);for(let H=0;H<j;H++)T(O,H*4,L,H*4);F=L,z=On;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:R,height:I,data:F,header:E.string,gamma:E.gamma,exposure:E.exposure,type:z}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(o,u){switch(o.type){case si:case On:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=on,o.magFilter=on,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,u)}return super.load(e,s,n,r)}}const Dg=J_>=152;let ez=class extends V_{constructor(e){super(e),this.type=On}parse(e){const L=Math.pow(2.7182818,2.2);function H(V,ee){for(var xe=0,Ge=0;Ge<65536;++Ge)(Ge==0||V[Ge>>3]&1<<(Ge&7))&&(ee[xe++]=Ge);for(var Je=xe-1;xe<65536;)ee[xe++]=0;return Je}function K(V){for(var ee=0;ee<16384;ee++)V[ee]={},V[ee].len=0,V[ee].lit=0,V[ee].p=null}const de={l:0,c:0,lc:0};function ce(V,ee,xe,Ge,Je){for(;xe<V;)ee=ee<<8|Bt(Ge,Je),xe+=8;xe-=V,de.l=ee>>xe&(1<<V)-1,de.c=ee,de.lc=xe}const ne=new Array(59);function fe(V){for(var ee=0;ee<=58;++ee)ne[ee]=0;for(var ee=0;ee<65537;++ee)ne[V[ee]]+=1;for(var xe=0,ee=58;ee>0;--ee){var Ge=xe+ne[ee]>>1;ne[ee]=xe,xe=Ge}for(var ee=0;ee<65537;++ee){var Je=V[ee];Je>0&&(V[ee]=Je|ne[Je]++<<6)}}function X(V,ee,xe,Ge,Je,Ke,N){for(var k=xe,$=0,ue=0;Je<=Ke;Je++){if(k.value-xe.value>Ge)return!1;ce(6,$,ue,V,k);var _e=de.l;if($=de.c,ue=de.lc,N[Je]=_e,_e==63){if(k.value-xe.value>Ge)throw"Something wrong with hufUnpackEncTable";ce(8,$,ue,V,k);var De=de.l+6;if($=de.c,ue=de.lc,Je+De>Ke+1)throw"Something wrong with hufUnpackEncTable";for(;De--;)N[Je++]=0;Je--}else if(_e>=59){var De=_e-59+2;if(Je+De>Ke+1)throw"Something wrong with hufUnpackEncTable";for(;De--;)N[Je++]=0;Je--}}fe(N)}function re(V){return V&63}function ge(V){return V>>6}function Te(V,ee,xe,Ge){for(;ee<=xe;ee++){var Je=ge(V[ee]),Ke=re(V[ee]);if(Je>>Ke)throw"Invalid table entry";if(Ke>14){var N=Ge[Je>>Ke-14];if(N.len)throw"Invalid table entry";if(N.lit++,N.p){var k=N.p;N.p=new Array(N.lit);for(var $=0;$<N.lit-1;++$)N.p[$]=k[$]}else N.p=new Array(1);N.p[N.lit-1]=ee}else if(Ke)for(var ue=0,$=1<<14-Ke;$>0;$--){var N=Ge[(Je<<14-Ke)+ue];if(N.len||N.p)throw"Invalid table entry";N.len=Ke,N.lit=ee,ue++}}return!0}const Se={c:0,lc:0};function Y(V,ee,xe,Ge){V=V<<8|Bt(xe,Ge),ee+=8,Se.c=V,Se.lc=ee}const me={c:0,lc:0};function Ce(V,ee,xe,Ge,Je,Ke,N,k,$,ue){if(V==ee){Ge<8&&(Y(xe,Ge,Je,N),xe=Se.c,Ge=Se.lc),Ge-=8;var _e=xe>>Ge,_e=new Uint8Array([_e])[0];if($.value+_e>ue)return!1;for(var De=k[$.value-1];_e-- >0;)k[$.value++]=De}else if($.value<ue)k[$.value++]=V;else return!1;me.c=xe,me.lc=Ge}function Ze(V){return V&65535}function xt(V){var ee=Ze(V);return ee>32767?ee-65536:ee}const ve={a:0,b:0};function ze(V,ee){var xe=xt(V),Ge=xt(ee),Je=Ge,Ke=xe+(Je&1)+(Je>>1),N=Ke,k=Ke-Je;ve.a=N,ve.b=k}function dt(V,ee){var xe=Ze(V),Ge=Ze(ee),Je=xe-(Ge>>1)&65535,Ke=Ge+Je-32768&65535;ve.a=Ke,ve.b=Je}function Ee(V,ee,xe,Ge,Je,Ke,N){for(var k=N<16384,$=xe>Je?Je:xe,ue=1,_e;ue<=$;)ue<<=1;for(ue>>=1,_e=ue,ue>>=1;ue>=1;){for(var De=0,P=De+Ke*(Je-_e),Z=Ke*ue,se=Ke*_e,ae=Ge*ue,ie=Ge*_e,we,Ie,Re,tt;De<=P;De+=se){for(var He=De,at=De+Ge*(xe-_e);He<=at;He+=ie){var nt=He+ae,Et=He+Z,Wt=Et+ae;k?(ze(V[He+ee],V[Et+ee]),we=ve.a,Re=ve.b,ze(V[nt+ee],V[Wt+ee]),Ie=ve.a,tt=ve.b,ze(we,Ie),V[He+ee]=ve.a,V[nt+ee]=ve.b,ze(Re,tt),V[Et+ee]=ve.a,V[Wt+ee]=ve.b):(dt(V[He+ee],V[Et+ee]),we=ve.a,Re=ve.b,dt(V[nt+ee],V[Wt+ee]),Ie=ve.a,tt=ve.b,dt(we,Ie),V[He+ee]=ve.a,V[nt+ee]=ve.b,dt(Re,tt),V[Et+ee]=ve.a,V[Wt+ee]=ve.b)}if(xe&ue){var Et=He+Z;k?ze(V[He+ee],V[Et+ee]):dt(V[He+ee],V[Et+ee]),we=ve.a,V[Et+ee]=ve.b,V[He+ee]=we}}if(Je&ue)for(var He=De,at=De+Ge*(xe-_e);He<=at;He+=ie){var nt=He+ae;k?ze(V[He+ee],V[nt+ee]):dt(V[He+ee],V[nt+ee]),we=ve.a,V[nt+ee]=ve.b,V[He+ee]=we}_e=ue,ue>>=1}return De}function yt(V,ee,xe,Ge,Je,Ke,N,k,$,ue){for(var _e=0,De=0,P=k,Z=Math.trunc(Je.value+(Ke+7)/8);Je.value<Z;)for(Y(_e,De,xe,Je),_e=Se.c,De=Se.lc;De>=14;){var se=_e>>De-14&16383,ae=ee[se];if(ae.len)De-=ae.len,Ce(ae.lit,N,_e,De,xe,Ge,Je,$,ue,P),_e=me.c,De=me.lc;else{if(!ae.p)throw"hufDecode issues";var ie;for(ie=0;ie<ae.lit;ie++){for(var we=re(V[ae.p[ie]]);De<we&&Je.value<Z;)Y(_e,De,xe,Je),_e=Se.c,De=Se.lc;if(De>=we&&ge(V[ae.p[ie]])==(_e>>De-we&(1<<we)-1)){De-=we,Ce(ae.p[ie],N,_e,De,xe,Ge,Je,$,ue,P),_e=me.c,De=me.lc;break}}if(ie==ae.lit)throw"hufDecode issues"}}var Ie=8-Ke&7;for(_e>>=Ie,De-=Ie;De>0;){var ae=ee[_e<<14-De&16383];if(ae.len)De-=ae.len,Ce(ae.lit,N,_e,De,xe,Ge,Je,$,ue,P),_e=me.c,De=me.lc;else throw"hufDecode issues"}return!0}function Pt(V,ee,xe,Ge,Je,Ke){var N={value:0},k=xe.value,$=ct(ee,xe),ue=ct(ee,xe);xe.value+=4;var _e=ct(ee,xe);if(xe.value+=4,$<0||$>=65537||ue<0||ue>=65537)throw"Something wrong with HUF_ENCSIZE";var De=new Array(65537),P=new Array(16384);K(P);var Z=Ge-(xe.value-k);if(X(V,ee,xe,Z,$,ue,De),_e>8*(Ge-(xe.value-k)))throw"Something wrong with hufUncompress";Te(De,$,ue,P),yt(De,P,V,ee,xe,_e,ue,Ke,Je,N)}function Ot(V,ee,xe){for(var Ge=0;Ge<xe;++Ge)ee[Ge]=V[ee[Ge]]}function Mt(V){for(var ee=1;ee<V.length;ee++){var xe=V[ee-1]+V[ee]-128;V[ee]=xe}}function je(V,ee){for(var xe=0,Ge=Math.floor((V.length+1)/2),Je=0,Ke=V.length-1;!(Je>Ke||(ee[Je++]=V[xe++],Je>Ke));)ee[Je++]=V[Ge++]}function st(V){for(var ee=V.byteLength,xe=new Array,Ge=0,Je=new DataView(V);ee>0;){var Ke=Je.getInt8(Ge++);if(Ke<0){var N=-Ke;ee-=N+1;for(var k=0;k<N;k++)xe.push(Je.getUint8(Ge++))}else{var N=Ke;ee-=2;for(var $=Je.getUint8(Ge++),k=0;k<N+1;k++)xe.push($)}}return xe}function et(V,ee,xe,Ge,Je,Ke){var nt=new DataView(Ke.buffer),N=xe[V.idx[0]].width,k=xe[V.idx[0]].height,$=3,ue=Math.floor(N/8),_e=Math.ceil(N/8),De=Math.ceil(k/8),P=N-(_e-1)*8,Z=k-(De-1)*8,se={value:0},ae=new Array($),ie=new Array($),we=new Array($),Ie=new Array($),Re=new Array($);for(let mt=0;mt<$;++mt)Re[mt]=ee[V.idx[mt]],ae[mt]=mt<1?0:ae[mt-1]+_e*De,ie[mt]=new Float32Array(64),we[mt]=new Uint16Array(64),Ie[mt]=new Uint16Array(_e*64);for(let mt=0;mt<De;++mt){var tt=8;mt==De-1&&(tt=Z);var He=8;for(let zt=0;zt<_e;++zt){zt==_e-1&&(He=P);for(let St=0;St<$;++St)we[St].fill(0),we[St][0]=Je[ae[St]++],At(se,Ge,we[St]),oe(we[St],ie[St]),Gt(ie[St]);Dt(ie);for(let St=0;St<$;++St)qt(ie[St],Ie[St],zt*64)}let ht=0;for(let zt=0;zt<$;++zt){const St=xe[V.idx[zt]].type;for(let Qt=8*mt;Qt<8*mt+tt;++Qt){ht=Re[zt][Qt];for(let vn=0;vn<ue;++vn){const fn=vn*64+(Qt&7)*8;nt.setUint16(ht+0*St,Ie[zt][fn+0],!0),nt.setUint16(ht+2*St,Ie[zt][fn+1],!0),nt.setUint16(ht+4*St,Ie[zt][fn+2],!0),nt.setUint16(ht+6*St,Ie[zt][fn+3],!0),nt.setUint16(ht+8*St,Ie[zt][fn+4],!0),nt.setUint16(ht+10*St,Ie[zt][fn+5],!0),nt.setUint16(ht+12*St,Ie[zt][fn+6],!0),nt.setUint16(ht+14*St,Ie[zt][fn+7],!0),ht+=16*St}}if(ue!=_e)for(let Qt=8*mt;Qt<8*mt+tt;++Qt){const vn=Re[zt][Qt]+8*ue*2*St,fn=ue*64+(Qt&7)*8;for(let oi=0;oi<He;++oi)nt.setUint16(vn+oi*2*St,Ie[zt][fn+oi],!0)}}}for(var at=new Uint16Array(N),nt=new DataView(Ke.buffer),Et=0;Et<$;++Et){xe[V.idx[Et]].decoded=!0;var Wt=xe[V.idx[Et]].type;if(xe[Et].type==2)for(var ln=0;ln<k;++ln){const mt=Re[Et][ln];for(var Yt=0;Yt<N;++Yt)at[Yt]=nt.getUint16(mt+Yt*2*Wt,!0);for(var Yt=0;Yt<N;++Yt)nt.setFloat32(mt+Yt*2*Wt,Fe(at[Yt]),!0)}}}function At(V,ee,xe){for(var Ge,Je=1;Je<64;)Ge=ee[V.value],Ge==65280?Je=64:Ge>>8==255?Je+=Ge&255:(xe[Je]=Ge,Je++),V.value++}function oe(V,ee){ee[0]=Fe(V[0]),ee[1]=Fe(V[1]),ee[2]=Fe(V[5]),ee[3]=Fe(V[6]),ee[4]=Fe(V[14]),ee[5]=Fe(V[15]),ee[6]=Fe(V[27]),ee[7]=Fe(V[28]),ee[8]=Fe(V[2]),ee[9]=Fe(V[4]),ee[10]=Fe(V[7]),ee[11]=Fe(V[13]),ee[12]=Fe(V[16]),ee[13]=Fe(V[26]),ee[14]=Fe(V[29]),ee[15]=Fe(V[42]),ee[16]=Fe(V[3]),ee[17]=Fe(V[8]),ee[18]=Fe(V[12]),ee[19]=Fe(V[17]),ee[20]=Fe(V[25]),ee[21]=Fe(V[30]),ee[22]=Fe(V[41]),ee[23]=Fe(V[43]),ee[24]=Fe(V[9]),ee[25]=Fe(V[11]),ee[26]=Fe(V[18]),ee[27]=Fe(V[24]),ee[28]=Fe(V[31]),ee[29]=Fe(V[40]),ee[30]=Fe(V[44]),ee[31]=Fe(V[53]),ee[32]=Fe(V[10]),ee[33]=Fe(V[19]),ee[34]=Fe(V[23]),ee[35]=Fe(V[32]),ee[36]=Fe(V[39]),ee[37]=Fe(V[45]),ee[38]=Fe(V[52]),ee[39]=Fe(V[54]),ee[40]=Fe(V[20]),ee[41]=Fe(V[22]),ee[42]=Fe(V[33]),ee[43]=Fe(V[38]),ee[44]=Fe(V[46]),ee[45]=Fe(V[51]),ee[46]=Fe(V[55]),ee[47]=Fe(V[60]),ee[48]=Fe(V[21]),ee[49]=Fe(V[34]),ee[50]=Fe(V[37]),ee[51]=Fe(V[47]),ee[52]=Fe(V[50]),ee[53]=Fe(V[56]),ee[54]=Fe(V[59]),ee[55]=Fe(V[61]),ee[56]=Fe(V[35]),ee[57]=Fe(V[36]),ee[58]=Fe(V[48]),ee[59]=Fe(V[49]),ee[60]=Fe(V[57]),ee[61]=Fe(V[58]),ee[62]=Fe(V[62]),ee[63]=Fe(V[63])}function Gt(V){const ee=.5*Math.cos(.7853975),xe=.5*Math.cos(3.14159/16),Ge=.5*Math.cos(3.14159/8),Je=.5*Math.cos(3*3.14159/16),Ke=.5*Math.cos(5*3.14159/16),N=.5*Math.cos(3*3.14159/8),k=.5*Math.cos(7*3.14159/16);for(var $=new Array(4),ue=new Array(4),_e=new Array(4),De=new Array(4),P=0;P<8;++P){var Z=P*8;$[0]=Ge*V[Z+2],$[1]=N*V[Z+2],$[2]=Ge*V[Z+6],$[3]=N*V[Z+6],ue[0]=xe*V[Z+1]+Je*V[Z+3]+Ke*V[Z+5]+k*V[Z+7],ue[1]=Je*V[Z+1]-k*V[Z+3]-xe*V[Z+5]-Ke*V[Z+7],ue[2]=Ke*V[Z+1]-xe*V[Z+3]+k*V[Z+5]+Je*V[Z+7],ue[3]=k*V[Z+1]-Ke*V[Z+3]+Je*V[Z+5]-xe*V[Z+7],_e[0]=ee*(V[Z+0]+V[Z+4]),_e[3]=ee*(V[Z+0]-V[Z+4]),_e[1]=$[0]+$[3],_e[2]=$[1]-$[2],De[0]=_e[0]+_e[1],De[1]=_e[3]+_e[2],De[2]=_e[3]-_e[2],De[3]=_e[0]-_e[1],V[Z+0]=De[0]+ue[0],V[Z+1]=De[1]+ue[1],V[Z+2]=De[2]+ue[2],V[Z+3]=De[3]+ue[3],V[Z+4]=De[3]-ue[3],V[Z+5]=De[2]-ue[2],V[Z+6]=De[1]-ue[1],V[Z+7]=De[0]-ue[0]}for(var se=0;se<8;++se)$[0]=Ge*V[16+se],$[1]=N*V[16+se],$[2]=Ge*V[48+se],$[3]=N*V[48+se],ue[0]=xe*V[8+se]+Je*V[24+se]+Ke*V[40+se]+k*V[56+se],ue[1]=Je*V[8+se]-k*V[24+se]-xe*V[40+se]-Ke*V[56+se],ue[2]=Ke*V[8+se]-xe*V[24+se]+k*V[40+se]+Je*V[56+se],ue[3]=k*V[8+se]-Ke*V[24+se]+Je*V[40+se]-xe*V[56+se],_e[0]=ee*(V[se]+V[32+se]),_e[3]=ee*(V[se]-V[32+se]),_e[1]=$[0]+$[3],_e[2]=$[1]-$[2],De[0]=_e[0]+_e[1],De[1]=_e[3]+_e[2],De[2]=_e[3]-_e[2],De[3]=_e[0]-_e[1],V[0+se]=De[0]+ue[0],V[8+se]=De[1]+ue[1],V[16+se]=De[2]+ue[2],V[24+se]=De[3]+ue[3],V[32+se]=De[3]-ue[3],V[40+se]=De[2]-ue[2],V[48+se]=De[1]-ue[1],V[56+se]=De[0]-ue[0]}function Dt(V){for(var ee=0;ee<64;++ee){var xe=V[0][ee],Ge=V[1][ee],Je=V[2][ee];V[0][ee]=xe+1.5747*Je,V[1][ee]=xe-.1873*Ge-.4682*Je,V[2][ee]=xe+1.8556*Ge}}function qt(V,ee,xe){for(var Ge=0;Ge<64;++Ge)ee[xe+Ge]=iu.toHalfFloat(Tt(V[Ge]))}function Tt(V){return V<=1?Math.sign(V)*Math.pow(Math.abs(V),2.2):Math.sign(V)*Math.pow(L,Math.abs(V)-1)}function te(V){return new DataView(V.array.buffer,V.offset.value,V.size)}function G(V){var ee=V.viewer.buffer.slice(V.offset.value,V.offset.value+V.size),xe=new Uint8Array(st(ee)),Ge=new Uint8Array(xe.length);return Mt(xe),je(xe,Ge),new DataView(Ge.buffer)}function be(V){var ee=V.array.slice(V.offset.value,V.offset.value+V.size),xe=wy(ee),Ge=new Uint8Array(xe.length);return Mt(xe),je(xe,Ge),new DataView(Ge.buffer)}function Ye(V){for(var ee=V.viewer,xe={value:V.offset.value},Ge=new Uint16Array(V.width*V.scanlineBlockSize*(V.channels*V.type)),Je=new Uint8Array(8192),Ke=0,N=new Array(V.channels),k=0;k<V.channels;k++)N[k]={},N[k].start=Ke,N[k].end=N[k].start,N[k].nx=V.width,N[k].ny=V.lines,N[k].size=V.type,Ke+=N[k].nx*N[k].ny*N[k].size;var $=Oe(ee,xe),ue=Oe(ee,xe);if(ue>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if($<=ue)for(var k=0;k<ue-$+1;k++)Je[k+$]=he(ee,xe);var _e=new Uint16Array(65536),De=H(Je,_e),P=ct(ee,xe);Pt(V.array,ee,xe,P,Ge,Ke);for(var k=0;k<V.channels;++k)for(var Z=N[k],se=0;se<N[k].size;++se)Ee(Ge,Z.start+se,Z.nx,Z.size,Z.ny,Z.nx*Z.size,De);Ot(_e,Ge,Ke);for(var ae=0,ie=new Uint8Array(Ge.buffer.byteLength),we=0;we<V.lines;we++)for(var Ie=0;Ie<V.channels;Ie++){var Z=N[Ie],Re=Z.nx*Z.size,tt=new Uint8Array(Ge.buffer,Z.end*2,Re*2);ie.set(tt,ae),ae+=Re*2,Z.end+=Re}return new DataView(ie.buffer)}function ot(V){var ee=V.array.slice(V.offset.value,V.offset.value+V.size),xe=wy(ee);const Ge=V.lines*V.channels*V.width,Je=V.type==1?new Uint16Array(Ge):new Uint32Array(Ge);let Ke=0,N=0;const k=new Array(4);for(let $=0;$<V.lines;$++)for(let ue=0;ue<V.channels;ue++){let _e=0;switch(V.type){case 1:k[0]=Ke,k[1]=k[0]+V.width,Ke=k[1]+V.width;for(let De=0;De<V.width;++De){const P=xe[k[0]++]<<8|xe[k[1]++];_e+=P,Je[N]=_e,N++}break;case 2:k[0]=Ke,k[1]=k[0]+V.width,k[2]=k[1]+V.width,Ke=k[2]+V.width;for(let De=0;De<V.width;++De){const P=xe[k[0]++]<<24|xe[k[1]++]<<16|xe[k[2]++]<<8;_e+=P,Je[N]=_e,N++}break}}return new DataView(Je.buffer)}function Qe(V){var ee=V.viewer,xe={value:V.offset.value},Ge=new Uint8Array(V.width*V.lines*(V.channels*V.type*2)),Je={version:Be(ee,xe),unknownUncompressedSize:Be(ee,xe),unknownCompressedSize:Be(ee,xe),acCompressedSize:Be(ee,xe),dcCompressedSize:Be(ee,xe),rleCompressedSize:Be(ee,xe),rleUncompressedSize:Be(ee,xe),rleRawSize:Be(ee,xe),totalAcUncompressedCount:Be(ee,xe),totalDcUncompressedCount:Be(ee,xe),acCompression:Be(ee,xe)};if(Je.version<2)throw"EXRLoader.parse: "+is.compression+" version "+Je.version+" is unsupported";for(var Ke=new Array,N=Oe(ee,xe)-2;N>0;){var k=Ut(ee.buffer,xe),$=he(ee,xe),ue=$>>2&3,_e=($>>4)-1,De=new Int8Array([_e])[0],P=he(ee,xe);Ke.push({name:k,index:De,type:P,compression:ue}),N-=k.length+3}for(var Z=is.channels,se=new Array(V.channels),ae=0;ae<V.channels;++ae){var ie=se[ae]={},we=Z[ae];ie.name=we.name,ie.compression=0,ie.decoded=!1,ie.type=we.pixelType,ie.pLinear=we.pLinear,ie.width=V.width,ie.height=V.lines}for(var Ie={idx:new Array(3)},Re=0;Re<V.channels;++Re)for(var ie=se[Re],ae=0;ae<Ke.length;++ae){var tt=Ke[ae];ie.name==tt.name&&(ie.compression=tt.compression,tt.index>=0&&(Ie.idx[tt.index]=Re),ie.offset=Re)}if(Je.acCompressedSize>0)switch(Je.acCompression){case 0:var nt=new Uint16Array(Je.totalAcUncompressedCount);Pt(V.array,ee,xe,Je.acCompressedSize,nt,Je.totalAcUncompressedCount);break;case 1:var He=V.array.slice(xe.value,xe.value+Je.totalAcUncompressedCount),at=wy(He),nt=new Uint16Array(at.buffer);xe.value+=Je.totalAcUncompressedCount;break}if(Je.dcCompressedSize>0){var Et={array:V.array,offset:xe,size:Je.dcCompressedSize},Wt=new Uint16Array(be(Et).buffer);xe.value+=Je.dcCompressedSize}if(Je.rleRawSize>0){var He=V.array.slice(xe.value,xe.value+Je.rleCompressedSize),at=wy(He),ln=st(at.buffer);xe.value+=Je.rleCompressedSize}for(var Yt=0,mt=new Array(se.length),ae=0;ae<mt.length;++ae)mt[ae]=new Array;for(var ht=0;ht<V.lines;++ht)for(var zt=0;zt<se.length;++zt)mt[zt].push(Yt),Yt+=se[zt].width*V.type*2;et(Ie,mt,se,nt,Wt,Ge);for(var ae=0;ae<se.length;++ae){var ie=se[ae];if(!ie.decoded)switch(ie.compression){case 2:for(var St=0,Qt=0,ht=0;ht<V.lines;++ht){for(var vn=mt[ae][St],fn=0;fn<ie.width;++fn){for(var oi=0;oi<2*ie.type;++oi)Ge[vn++]=ln[Qt+oi*ie.width*ie.height];Qt++}St++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Ge.buffer)}function Ut(V,ee){for(var xe=new Uint8Array(V),Ge=0;xe[ee.value+Ge]!=0;)Ge+=1;var Je=new TextDecoder().decode(xe.slice(ee.value,ee.value+Ge));return ee.value=ee.value+Ge+1,Je}function Rt(V,ee,xe){var Ge=new TextDecoder().decode(new Uint8Array(V).slice(ee.value,ee.value+xe));return ee.value=ee.value+xe,Ge}function Vt(V,ee){var xe=vt(V,ee),Ge=ct(V,ee);return[xe,Ge]}function $t(V,ee){var xe=ct(V,ee),Ge=ct(V,ee);return[xe,Ge]}function vt(V,ee){var xe=V.getInt32(ee.value,!0);return ee.value=ee.value+4,xe}function ct(V,ee){var xe=V.getUint32(ee.value,!0);return ee.value=ee.value+4,xe}function Bt(V,ee){var xe=V[ee.value];return ee.value=ee.value+1,xe}function he(V,ee){var xe=V.getUint8(ee.value);return ee.value=ee.value+1,xe}const Be=function(V,ee){let xe;return"getBigInt64"in DataView.prototype?xe=Number(V.getBigInt64(ee.value,!0)):xe=V.getUint32(ee.value+4,!0)+Number(V.getUint32(ee.value,!0)<<32),ee.value+=8,xe};function ft(V,ee){var xe=V.getFloat32(ee.value,!0);return ee.value+=4,xe}function pe(V,ee){return iu.toHalfFloat(ft(V,ee))}function Fe(V){var ee=(V&31744)>>10,xe=V&1023;return(V>>15?-1:1)*(ee?ee===31?xe?NaN:1/0:Math.pow(2,ee-15)*(1+xe/1024):6103515625e-14*(xe/1024))}function Oe(V,ee){var xe=V.getUint16(ee.value,!0);return ee.value+=2,xe}function It(V,ee){return Fe(Oe(V,ee))}function _t(V,ee,xe,Ge){for(var Je=xe.value,Ke=[];xe.value<Je+Ge-1;){var N=Ut(ee,xe),k=vt(V,xe),$=he(V,xe);xe.value+=3;var ue=vt(V,xe),_e=vt(V,xe);Ke.push({name:N,pixelType:k,pLinear:$,xSampling:ue,ySampling:_e})}return xe.value+=1,Ke}function ut(V,ee){var xe=ft(V,ee),Ge=ft(V,ee),Je=ft(V,ee),Ke=ft(V,ee),N=ft(V,ee),k=ft(V,ee),$=ft(V,ee),ue=ft(V,ee);return{redX:xe,redY:Ge,greenX:Je,greenY:Ke,blueX:N,blueY:k,whiteX:$,whiteY:ue}}function wt(V,ee){var xe=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Ge=he(V,ee);return xe[Ge]}function Zt(V,ee){var xe=ct(V,ee),Ge=ct(V,ee),Je=ct(V,ee),Ke=ct(V,ee);return{xMin:xe,yMin:Ge,xMax:Je,yMax:Ke}}function yn(V,ee){var xe=["INCREASING_Y"],Ge=he(V,ee);return xe[Ge]}function _n(V,ee){var xe=ft(V,ee),Ge=ft(V,ee);return[xe,Ge]}function Si(V,ee){var xe=ft(V,ee),Ge=ft(V,ee),Je=ft(V,ee);return[xe,Ge,Je]}function ji(V,ee,xe,Ge,Je){if(Ge==="string"||Ge==="stringvector"||Ge==="iccProfile")return Rt(ee,xe,Je);if(Ge==="chlist")return _t(V,ee,xe,Je);if(Ge==="chromaticities")return ut(V,xe);if(Ge==="compression")return wt(V,xe);if(Ge==="box2i")return Zt(V,xe);if(Ge==="lineOrder")return yn(V,xe);if(Ge==="float")return ft(V,xe);if(Ge==="v2f")return _n(V,xe);if(Ge==="v3f")return Si(V,xe);if(Ge==="int")return vt(V,xe);if(Ge==="rational")return Vt(V,xe);if(Ge==="timecode")return $t(V,xe);if(Ge==="preview")return xe.value+=Je,"skipped";xe.value+=Je}function ha(V,ee,xe){const Ge={};if(V.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Ge.version=V.getUint8(4);const Je=V.getUint8(5);Ge.spec={singleTile:!!(Je&2),longName:!!(Je&4),deepFormat:!!(Je&8),multiPart:!!(Je&16)},xe.value=8;for(var Ke=!0;Ke;){var N=Ut(ee,xe);if(N==0)Ke=!1;else{var k=Ut(ee,xe),$=ct(V,xe),ue=ji(V,ee,xe,k,$);ue===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${k}'.`):Ge[N]=ue}}if((Je&-5)!=0)throw console.error("EXRHeader:",Ge),"THREE.EXRLoader: provided file is currently unsupported.";return Ge}function pa(V,ee,xe,Ge,Je){const Ke={size:0,viewer:ee,array:xe,offset:Ge,width:V.dataWindow.xMax-V.dataWindow.xMin+1,height:V.dataWindow.yMax-V.dataWindow.yMin+1,channels:V.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:V.channels[0].pixelType,uncompress:null,getter:null,format:null,[Dg?"colorSpace":"encoding"]:null};switch(V.compression){case"NO_COMPRESSION":Ke.lines=1,Ke.uncompress=te;break;case"RLE_COMPRESSION":Ke.lines=1,Ke.uncompress=G;break;case"ZIPS_COMPRESSION":Ke.lines=1,Ke.uncompress=be;break;case"ZIP_COMPRESSION":Ke.lines=16,Ke.uncompress=be;break;case"PIZ_COMPRESSION":Ke.lines=32,Ke.uncompress=Ye;break;case"PXR24_COMPRESSION":Ke.lines=16,Ke.uncompress=ot;break;case"DWAA_COMPRESSION":Ke.lines=32,Ke.uncompress=Qe;break;case"DWAB_COMPRESSION":Ke.lines=256,Ke.uncompress=Qe;break;default:throw"EXRLoader.parse: "+V.compression+" is unsupported"}if(Ke.scanlineBlockSize=Ke.lines,Ke.type==1)switch(Je){case si:Ke.getter=It,Ke.inputSize=2;break;case On:Ke.getter=Oe,Ke.inputSize=2;break}else if(Ke.type==2)switch(Je){case si:Ke.getter=ft,Ke.inputSize=4;break;case On:Ke.getter=pe,Ke.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Ke.type+" for "+V.compression+".";Ke.blockCount=(V.dataWindow.yMax+1)/Ke.scanlineBlockSize;for(var N=0;N<Ke.blockCount;N++)Be(ee,Ge);Ke.outputChannels=Ke.channels==3?4:Ke.channels;const k=Ke.width*Ke.height*Ke.outputChannels;switch(Je){case si:Ke.byteArray=new Float32Array(k),Ke.channels<Ke.outputChannels&&Ke.byteArray.fill(1,0,k);break;case On:Ke.byteArray=new Uint16Array(k),Ke.channels<Ke.outputChannels&&Ke.byteArray.fill(15360,0,k);break;default:console.error("THREE.EXRLoader: unsupported type: ",Je);break}return Ke.bytesPerLine=Ke.width*Ke.inputSize*Ke.channels,Ke.outputChannels==4?Ke.format=Ai:Ke.format=tc,Dg?Ke.colorSpace="srgb-linear":Ke.encoding=3e3,Ke}const Ts=new DataView(e),ma=new Uint8Array(e),Xr={value:0},is=ha(Ts,e,Xr),rn=pa(is,Ts,ma,Xr,this.type),Br={value:0},bi={R:0,G:1,B:2,A:3,Y:0};for(let V=0;V<rn.height/rn.scanlineBlockSize;V++){const ee=ct(Ts,Xr);rn.size=ct(Ts,Xr),rn.lines=ee+rn.scanlineBlockSize>rn.height?rn.height-ee:rn.scanlineBlockSize;const Ge=rn.size<rn.lines*rn.bytesPerLine?rn.uncompress(rn):te(rn);Xr.value+=rn.size;for(let Je=0;Je<rn.scanlineBlockSize;Je++){const Ke=Je+V*rn.scanlineBlockSize;if(Ke>=rn.height)break;for(let N=0;N<rn.channels;N++){const k=bi[is.channels[N].name];for(let $=0;$<rn.width;$++){Br.value=(Je*(rn.channels*rn.width)+N*rn.width+$)*rn.inputSize;const ue=(rn.height-1-Ke)*(rn.width*rn.outputChannels)+$*rn.outputChannels+k;rn.byteArray[ue]=rn.getter(Ge,Br)}}}}return{header:is,width:rn.width,height:rn.height,data:rn.byteArray,format:rn.format,[Dg?"colorSpace":"encoding"]:rn[Dg?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(o,u){Dg?o.colorSpace=u.colorSpace:o.encoding=u.encoding,o.minFilter=on,o.magFilter=on,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,u)}return super.load(e,s,n,r)}};const oE=new WeakMap;class tz extends gr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new ds(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const u={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,u).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const f in t.attributeTypes){const p=t.attributeTypes[f];p.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[f]=p.name)}const n=JSON.stringify(t);if(oE.has(e)){const f=oE.get(e);if(f.key===n)return f.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,u=this._getWorker(s,o).then(f=>(r=f,new Promise((p,g)=>{r._callbacks[s]={resolve:p,reject:g},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(f=>this._createGeometry(f.geometry));return u.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),oE.set(e,{key:n,promise:u}),u}_createGeometry(e){const t=new pn;e.index&&t.setIndex(new jn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,u=r.itemSize;t.setAttribute(s,new jn(o,u))}return t}_loadLibrary(e,t){const n=new ds(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=nz.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function nz(){let i,e;onmessage=function(o){const u=o.data;switch(u.type){case"init":i=u.decoderConfig,e=new Promise(function(g){i.onModuleLoaded=function(v){g({draco:v})},DracoDecoderModule(i)});break;case"decode":const f=u.buffer,p=u.taskConfig;e.then(g=>{const v=g.draco,y=new v.Decoder,A=new v.DecoderBuffer;A.Init(new Int8Array(f),f.byteLength);try{const S=t(v,y,A,p),T=S.attributes.map(M=>M.array.buffer);S.index&&T.push(S.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:S},T)}catch(S){console.error(S),self.postMessage({type:"error",id:u.id,error:S.message})}finally{v.destroy(A),v.destroy(y)}});break}};function t(o,u,f,p){const g=p.attributeIDs,v=p.attributeTypes;let y,A;const S=u.GetEncodedGeometryType(f);if(S===o.TRIANGULAR_MESH)y=new o.Mesh,A=u.DecodeBufferToMesh(f,y);else if(S===o.POINT_CLOUD)y=new o.PointCloud,A=u.DecodeBufferToPointCloud(f,y);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!A.ok()||y.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+A.error_msg());const T={index:null,attributes:[]};for(const M in g){const E=self[v[M]];let R,I;if(p.useUniqueIDs)I=g[M],R=u.GetAttributeByUniqueId(y,I);else{if(I=u.GetAttributeId(y,o[g[M]]),I===-1)continue;R=u.GetAttribute(y,I)}T.attributes.push(r(o,u,y,M,E,R))}return S===o.TRIANGULAR_MESH&&(T.index=n(o,u,y)),o.destroy(y),T}function n(o,u,f){const g=f.num_faces()*3,v=g*4,y=o._malloc(v);u.GetTrianglesUInt32Array(f,v,y);const A=new Uint32Array(o.HEAPF32.buffer,y,g).slice();return o._free(y),{array:A,itemSize:1}}function r(o,u,f,p,g,v){const y=v.num_components(),S=f.num_points()*y,T=S*g.BYTES_PER_ELEMENT,M=s(o,g),E=o._malloc(T);u.GetAttributeDataArrayForAllPoints(f,v,M,T,E);const R=new g(o.HEAPF32.buffer,E,S).slice();return o._free(E),{name:p,array:R,itemSize:y}}function s(o,u){switch(u){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let Ry;const lE=()=>{if(Ry)return Ry;const i="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",e="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",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=i;WebAssembly.validate(t)&&(r=e);let s;const o=WebAssembly.instantiate(u(r),{}).then(v=>{s=v.instance,s.exports.__wasm_call_ctors()});function u(v){const y=new Uint8Array(v.length);for(let S=0;S<v.length;++S){const T=v.charCodeAt(S);y[S]=T>96?T-71:T>64?T-65:T>47?T+4:T>46?63:62}let A=0;for(let S=0;S<v.length;++S)y[A++]=y[S]<60?n[y[S]]:(y[S]-60)*64+y[++S];return y.buffer.slice(0,A)}function f(v,y,A,S,T,M){const E=s.exports.sbrk,R=A+3&-4,I=E(R*S),O=E(T.length),F=new Uint8Array(s.exports.memory.buffer);F.set(T,O);const z=v(I,A,S,O,T.length);if(z===0&&M&&M(I,R,S),y.set(F.subarray(I,I+A*S)),E(I-E(0)),z!==0)throw new Error(`Malformed buffer data: ${z}`)}const p={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},g={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Ry={ready:o,supported:!0,decodeVertexBuffer(v,y,A,S,T){f(s.exports.meshopt_decodeVertexBuffer,v,y,A,S,s.exports[p[T]])},decodeIndexBuffer(v,y,A,S){f(s.exports.meshopt_decodeIndexBuffer,v,y,A,S)},decodeIndexSequence(v,y,A,S){f(s.exports.meshopt_decodeIndexSequence,v,y,A,S)},decodeGltfBuffer(v,y,A,S,T,M){f(s.exports[g[T]],v,y,A,S,s.exports[p[M]])}},Ry},cE=i=>i===Object(i)&&!Array.isArray(i)&&typeof i!="function";function RT(i,e){const t=Nn(s=>s.gl),n=Po(jv,cE(i)?Object.values(i):i);return le.useLayoutEffect(()=>{e==null||e(n)},[e]),le.useEffect(()=>{if("initTexture"in t){let s=[];Array.isArray(n)?s=n:n instanceof Jn?s=[n]:cE(n)&&(s=Object.values(n)),s.forEach(o=>{o instanceof Jn&&t.initTexture(o)})}},[t,n]),le.useMemo(()=>{if(cE(i)){const s={};let o=0;for(const u in i)s[u]=n[o++];return s}else return n},[i,n])}RT.preload=i=>Po.preload(jv,i);RT.clear=i=>Po.clear(jv,i);let Dy=null,_D="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function SD(i=!0,e=!0,t){return n=>{t&&t(n),i&&(Dy||(Dy=new tz),Dy.setDecoderPath(typeof i=="string"?i:_D),n.setDRACOLoader(Dy)),e&&n.setMeshoptDecoder(typeof lE=="function"?lE():lE)}}const K_=(i,e,t,n)=>Po(CT,i,SD(e,t,n));K_.preload=(i,e,t,n)=>Po.preload(CT,i,SD(e,t,n));K_.clear=i=>Po.clear(CT,i);K_.setDecoderPath=i=>{_D=i};function bD(i,e,t){const n=Nn(A=>A.size),r=Nn(A=>A.viewport),s=typeof i=="number"?i:n.width*r.dpr,o=n.height*r.dpr,u=(typeof i=="number"?t:i)||{},{samples:f=0,depth:p,...g}=u,v=p??u.depthBuffer,y=le.useMemo(()=>{const A=new ti(s,o,{minFilter:on,magFilter:on,type:On,...g});return v&&(A.depthTexture=new _d(s,o,si)),A.samples=f,A},[]);return le.useLayoutEffect(()=>{y.setSize(s,o),f&&(y.samples=f)},[f,y,s,o]),le.useEffect(()=>()=>y.dispose(),[]),y}const iz=i=>typeof i=="function",rz=le.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,children:n,makeDefault:r,...s},o)=>{const u=Nn(({set:M})=>M),f=Nn(({camera:M})=>M),p=Nn(({size:M})=>M),g=le.useRef(null);le.useImperativeHandle(o,()=>g.current,[]);const v=le.useRef(null),y=bD(e);le.useLayoutEffect(()=>{s.manual||g.current.updateProjectionMatrix()},[p,s]),le.useLayoutEffect(()=>{g.current.updateProjectionMatrix()}),le.useLayoutEffect(()=>{if(r){const M=f;return u(()=>({camera:g.current})),()=>u(()=>({camera:M}))}},[g,r,u]);let A=0,S=null;const T=iz(n);return da(M=>{T&&(t===1/0||A<t)&&(v.current.visible=!1,M.gl.setRenderTarget(y),S=M.scene.background,i&&(M.scene.background=i),M.gl.render(M.scene,g.current),M.scene.background=S,M.gl.setRenderTarget(null),v.current.visible=!0,A++)}),le.createElement(le.Fragment,null,le.createElement("orthographicCamera",vl({left:p.width/-2,right:p.width/2,top:p.height/2,bottom:p.height/-2,ref:g},s),!T&&n),le.createElement("group",{ref:v},T&&n(y.texture)))}),sz=i=>typeof i=="function",az=le.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:r,...s},o)=>{const u=Nn(({set:M})=>M),f=Nn(({camera:M})=>M),p=Nn(({size:M})=>M),g=le.useRef(null);le.useImperativeHandle(o,()=>g.current,[]);const v=le.useRef(null),y=bD(e);le.useLayoutEffect(()=>{s.manual||(g.current.aspect=p.width/p.height)},[p,s]),le.useLayoutEffect(()=>{g.current.updateProjectionMatrix()});let A=0,S=null;const T=sz(r);return da(M=>{T&&(t===1/0||A<t)&&(v.current.visible=!1,M.gl.setRenderTarget(y),S=M.scene.background,i&&(M.scene.background=i),M.gl.render(M.scene,g.current),M.scene.background=S,M.gl.setRenderTarget(null),v.current.visible=!0,A++)}),le.useLayoutEffect(()=>{if(n){const M=f;return u(()=>({camera:g.current})),()=>u(()=>({camera:M}))}},[g,n,u]),le.createElement(le.Fragment,null,le.createElement("perspectiveCamera",vl({ref:g},s),!T&&r),le.createElement("group",{ref:v},T&&r(y.texture)))}),ED=le.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:u,onEnd:f,...p},g)=>{const v=Nn(z=>z.invalidate),y=Nn(z=>z.camera),A=Nn(z=>z.gl),S=Nn(z=>z.events),T=Nn(z=>z.setEvents),M=Nn(z=>z.set),E=Nn(z=>z.get),R=Nn(z=>z.performance),I=e||y,O=n||S.connected||A.domElement,F=le.useMemo(()=>new m7(I),[I]);return da(()=>{F.enabled&&F.update()},-1),le.useEffect(()=>(s&&F.connect(s===!0?O:s),F.connect(O),()=>void F.dispose()),[s,O,t,F,v]),le.useEffect(()=>{const z=L=>{v(),t&&R.regress(),o&&o(L)},j=L=>{u&&u(L)},W=L=>{f&&f(L)};return F.addEventListener("change",z),F.addEventListener("start",j),F.addEventListener("end",W),()=>{F.removeEventListener("start",j),F.removeEventListener("end",W),F.removeEventListener("change",z)}},[o,u,f,F,v,T]),le.useEffect(()=>{if(i){const z=E().controls;return M({controls:F}),()=>M({controls:z})}},[i,F]),le.createElement("primitive",vl({ref:g,object:F,enableDamping:r},p))}),oz=le.forwardRef(({domElement:i,selector:e,onChange:t,onLock:n,onUnlock:r,enabled:s=!0,makeDefault:o,...u},f)=>{const{camera:p,...g}=u,v=Nn(F=>F.setEvents),y=Nn(F=>F.gl),A=Nn(F=>F.camera),S=Nn(F=>F.invalidate),T=Nn(F=>F.events),M=Nn(F=>F.get),E=Nn(F=>F.set),R=p||A,I=i||T.connected||y.domElement,O=le.useMemo(()=>new d7(R),[R]);return le.useEffect(()=>{if(s){O.connect(I);const F=M().events.compute;return v({compute(z,j){const W=j.size.width/2,L=j.size.height/2;j.pointer.set(W/j.size.width*2-1,-(L/j.size.height)*2+1),j.raycaster.setFromCamera(j.pointer,j.camera)}}),()=>{O.disconnect(),v({compute:F})}}},[s,O]),le.useEffect(()=>{const F=W=>{S(),t&&t(W)};O.addEventListener("change",F),n&&O.addEventListener("lock",n),r&&O.addEventListener("unlock",r);const z=()=>O.lock(),j=e?Array.from(document.querySelectorAll(e)):[document];return j.forEach(W=>W&&W.addEventListener("click",z)),()=>{O.removeEventListener("change",F),n&&O.removeEventListener("lock",n),r&&O.removeEventListener("unlock",r),j.forEach(W=>W?W.removeEventListener("click",z):void 0)}},[t,n,r,e,O,S]),le.useEffect(()=>{if(o){const F=M().controls;return E({controls:O}),()=>E({controls:F})}},[o,O]),le.createElement("primitive",vl({ref:f,object:O},g))});var Jy={exports:{}},lz=Jy.exports,sR;function cz(){return sR||(sR=1,(function(i,e){(function(t,n){i.exports=n()})(lz,function(){var t=function(){function n(A){return o.appendChild(A.dom),A}function r(A){for(var S=0;S<o.children.length;S++)o.children[S].style.display=S===A?"block":"none";s=A}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(A){A.preventDefault(),r(++s%o.children.length)},!1);var u=(performance||Date).now(),f=u,p=0,g=n(new t.Panel("FPS","#0ff","#002")),v=n(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var y=n(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:n,showPanel:r,begin:function(){u=(performance||Date).now()},end:function(){p++;var A=(performance||Date).now();if(v.update(A-u,200),A>f+1e3&&(g.update(1e3*p/(A-f),100),f=A,p=0,y)){var S=performance.memory;y.update(S.usedJSHeapSize/1048576,S.jsHeapSizeLimit/1048576)}return A},update:function(){u=this.end()},domElement:o,setMode:r}};return t.Panel=function(n,r,s){var o=1/0,u=0,f=Math.round,p=f(window.devicePixelRatio||1),g=80*p,v=48*p,y=3*p,A=2*p,S=3*p,T=15*p,M=74*p,E=30*p,R=document.createElement("canvas");R.width=g,R.height=v,R.style.cssText="width:80px;height:48px";var I=R.getContext("2d");return I.font="bold "+9*p+"px Helvetica,Arial,sans-serif",I.textBaseline="top",I.fillStyle=s,I.fillRect(0,0,g,v),I.fillStyle=r,I.fillText(n,y,A),I.fillRect(S,T,M,E),I.fillStyle=s,I.globalAlpha=.9,I.fillRect(S,T,M,E),{dom:R,update:function(O,F){o=Math.min(o,O),u=Math.max(u,O),I.fillStyle=s,I.globalAlpha=1,I.fillRect(0,0,g,T),I.fillStyle=r,I.fillText(f(O)+" "+n+" ("+f(o)+"-"+f(u)+")",y,A),I.drawImage(R,S+p,T,M-p,E,S,T,M-p,E),I.fillRect(S+M-p,T,p,E),I.fillStyle=s,I.globalAlpha=.9,I.fillRect(S+M-p,T,p,f((1-O/F)*E))}}},t})})(Jy)),Jy.exports}var uz=cz();const dz=Tv(uz);function fz(i,e=[],t){const[n,r]=le.useState();return le.useLayoutEffect(()=>{const s=i();return r(s),()=>void 0},e),n}function hz({showPanel:i=0,className:e,parent:t}){const n=fz(()=>new dz,[]);return le.useEffect(()=>{if(n){const r=t&&t.current||document.body;n.showPanel(i),r==null||r.appendChild(n.dom);const s=(e??"").split(" ").filter(f=>f);s.length&&n.dom.classList.add(...s);const o=AF(()=>n.begin()),u=_F(()=>n.end());return()=>{s.length&&n.dom.classList.remove(...s),r==null||r.removeChild(n.dom),o(),u()}}},[t,n,e,i]),null}function pz(){const i=new pn,e=new Float32Array([-1,-1,3,-1,-1,3]);return i.boundingSphere=new Wr,i.boundingSphere.set(new Q,1/0),i.setAttribute("position",new jn(e,2)),i}const mz=le.forwardRef(function({children:e,...t},n){const r=le.useMemo(pz,[]);return le.createElement("mesh",vl({ref:n,geometry:r,frustumCulled:!1},t),e)}),MD=(i,e,t)=>{let n;switch(i){case _i:n=new Uint8ClampedArray(e*t*4);break;case On:n=new Uint16Array(e*t*4);break;case ca:n=new Uint32Array(e*t*4);break;case Iv:n=new Int8Array(e*t*4);break;case Bv:n=new Int16Array(e*t*4);break;case Im:n=new Int32Array(e*t*4);break;case si:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let Iy;const gz=(i,e,t,n)=>{if(Iy!==void 0)return Iy;const r=new ti(1,1,n);e.setRenderTarget(r);const s=new Oi(new lc,new za({color:16777215}));e.render(s,t),e.setRenderTarget(null);const o=MD(i,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,o),r.dispose(),s.geometry.dispose(),s.material.dispose(),Iy=o[0]!==0,Iy};class DT{constructor(e){Sr(this,"_renderer");Sr(this,"_rendererIsDisposable",!1);Sr(this,"_material");Sr(this,"_scene");Sr(this,"_camera");Sr(this,"_quad");Sr(this,"_renderTarget");Sr(this,"_width");Sr(this,"_height");Sr(this,"_type");Sr(this,"_colorSpace");Sr(this,"_supportsReadPixels",!0);Sr(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var n,r,s,o,u,f,p,g,v,y,A,S,T,M,E,R;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:Ai,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)==null?void 0:n.anisotropy)!==void 0?(r=e.renderTargetOptions)==null?void 0:r.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((u=e.renderTargetOptions)==null?void 0:u.magFilter)!==void 0?(f=e.renderTargetOptions)==null?void 0:f.magFilter:on,minFilter:((p=e.renderTargetOptions)==null?void 0:p.minFilter)!==void 0?(g=e.renderTargetOptions)==null?void 0:g.minFilter:on,samples:((v=e.renderTargetOptions)==null?void 0:v.samples)!==void 0?(y=e.renderTargetOptions)==null?void 0:y.samples:void 0,wrapS:((A=e.renderTargetOptions)==null?void 0:A.wrapS)!==void 0?(S=e.renderTargetOptions)==null?void 0:S.wrapS:Ni,wrapT:((T=e.renderTargetOptions)==null?void 0:T.wrapT)!==void 0?(M=e.renderTargetOptions)==null?void 0:M.wrapT:Ni};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=DT.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Ad,this._camera=new Ha,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!gz(this._type,this._renderer,this._camera,t)){let I;switch(this._type){case On:I=this._renderer.extensions.has("EXT_color_buffer_float")?si:void 0;break}I!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${si}`),this._type=I):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Oi(new lc,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ti(this.width,this.height,t),this._renderTarget.texture.mapping=((E=e.renderTargetOptions)==null?void 0:E.mapping)!==void 0?(R=e.renderTargetOptions)==null?void 0:R.mapping:vd}static instantiateRenderer(){const e=new Y_;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=MD(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new oa(this.toArray(),this.width,this.height,Ai,this._type,(e==null?void 0:e.mapping)||vd,(e==null?void 0:e.wrapS)||Ni,(e==null?void 0:e.wrapT)||Ni,(e==null?void 0:e.magFilter)||on,(e==null?void 0:e.minFilter)||on,(e==null?void 0:e.anisotropy)||1,kr);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ai&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Jn&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Jn&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class TD extends Error{}class wD extends Error{}const Ig=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},vz=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),r=e.slice(t,n+10);try{const s=Ig(r,"hdrgm:GainMapMin","0"),o=Ig(r,"hdrgm:GainMapMax"),u=Ig(r,"hdrgm:Gamma","1"),f=Ig(r,"hdrgm:OffsetSDR","0.015625"),p=Ig(r,"hdrgm:OffsetHDR","0.015625"),g=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),v=g?g[1]:"0",y=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!y)throw new Error("Incomplete gainmap metadata");const A=y[1];return{gainMapMin:Array.isArray(s)?s.map(S=>parseFloat(S)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(S=>parseFloat(S)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(u)?u.map(S=>parseFloat(S)):[parseFloat(u),parseFloat(u),parseFloat(u)],offsetSdr:Array.isArray(f)?f.map(S=>parseFloat(S)):[parseFloat(f),parseFloat(f),parseFloat(f)],offsetHdr:Array.isArray(p)?p.map(S=>parseFloat(S)):[parseFloat(p),parseFloat(p),parseFloat(p)],hdrCapacityMin:parseFloat(v),hdrCapacityMax:parseFloat(A)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class xz{constructor(e){Sr(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const o=s.byteLength;let u=2,f=0,p;for(;u<o;){if(++f>250){n(new Error(`Found no marker after ${f} loops `));return}if(s.getUint8(u)!==255){n(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${s.getUint8(u).toString(16)}`));return}if(p=s.getUint8(u+1),r&&console.log(`Marker: ${p.toString(16)}`),p===226){r&&console.log("Found APP2 marker (0xffe2)");const g=u+4;if(s.getUint32(g)===1297106432){const v=g+4;let y;if(s.getUint16(v)===18761)y=!1;else if(s.getUint16(v)===19789)y=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(v+2,!y)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const A=s.getUint32(v+4,!y);if(A<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const S=v+A,T=s.getUint16(S,!y),M=S+2;let E=0;for(let F=M;F<M+12*T;F+=12)s.getUint16(F,!y)===45057&&(E=s.getUint32(F+8,!y));const I=S+2+T*12+4,O=[];for(let F=I;F<I+E*16;F+=16){const z={MPType:s.getUint32(F,!y),size:s.getUint32(F+4,!y),dataOffset:s.getUint32(F+8,!y),dependantImages:s.getUint32(F+12,!y),start:-1,end:-1,isFII:!1};z.dataOffset?(z.start=v+z.dataOffset,z.isFII=!1):(z.start=0,z.isFII=!0),z.end=z.start+z.size,O.push(z)}if(this.options.extractNonFII&&O.length){const F=new Blob([s]),z=[];for(const j of O){if(j.isFII&&!this.options.extractFII)continue;const W=F.slice(j.start,j.end+1,"image/jpeg");z.push(W)}t(z)}}}u+=2+s.getUint16(u+2)}})}}const yz=async i=>{const e=vz(i);if(!e)throw new wD("Gain map XMP metadata not found");const n=await new xz({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new TD("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},aR=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=r=>{t(r)},n.src=URL.createObjectURL(i)});class Az extends gr{constructor(t,n){super(n);Sr(this,"_renderer");Sr(this,"_renderTargetOptions");Sr(this,"_internalLoadingManager");Sr(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new Vv}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Jn,sdr:new Jn});return this._config.createQuadRenderer({width:16,height:16,type:On,colorSpace:kr,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,n,r){const s=n?new Blob([n],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let u,f,p=!1;if(typeof createImageBitmap>"u"){const g=await Promise.all([s?aR(s):Promise.resolve(void 0),aR(o)]);f=g[0],u=g[1],p=r==="flipY"}else{const g=await Promise.all([s?createImageBitmap(s,{imageOrientation:r||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:r||"flipY"})]);f=g[0],u=g[1]}return{sdrImage:u,gainMapImage:f,needsFlip:p}}createTextures(t,n,r){const s=new Jn(n||new ImageData(2,2),vd,Ni,Ni,on,IE,Ai,_i,1,kr);s.flipY=r,s.needsUpdate=!0;const o=new Jn(t,vd,Ni,Ni,on,IE,Ai,_i,1,Hn);return o.flipY=r,o.needsUpdate=!0,{gainMap:s,sdr:o}}updateQuadRenderer(t,n,r,s,o){t.width=n.width,t.height=n.height,t.material.gainMap=r,t.material.sdr=s,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const _z=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Sz=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class bz extends ai{constructor({gamma:t,offsetHdr:n,offsetSdr:r,gainMapMin:s,gainMapMax:o,maxDisplayBoost:u,hdrCapacityMin:f,hdrCapacityMax:p,sdr:g,gainMap:v}){super({name:"GainMapDecoderMaterial",vertexShader:_z,fragmentShader:Sz,uniforms:{sdr:{value:g},gainMap:{value:v},gamma:{value:new Q(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new Q().fromArray(n)},offsetSdr:{value:new Q().fromArray(r)},gainMapMin:{value:new Q().fromArray(s)},gainMapMax:{value:new Q().fromArray(o)},weightFactor:{value:(Math.log2(u)-f)/(p-f)}},blending:Pi,depthTest:!1,depthWrite:!1});Sr(this,"_maxDisplayBoost");Sr(this,"_hdrCapacityMin");Sr(this,"_hdrCapacityMax");this._maxDisplayBoost=u,this._hdrCapacityMin=f,this._hdrCapacityMax=p,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class CD extends Az{constructor(e,t){super({renderer:e,createMaterial:n=>new bz(n),createQuadRenderer:n=>new DT(n)},t)}async render(e,t,n,r){const{sdrImage:s,gainMapImage:o,needsFlip:u}=await this.processImages(n,r,"flipY"),{gainMap:f,sdr:p}=this.createTextures(s,o,u);this.updateQuadRenderer(e,s,f,p,t),e.render()}}class Ez extends CD{load([e,t,n],r,s,o){const u=this.prepareQuadRenderer();let f,p,g;const v=async()=>{if(f&&p&&g){try{await this.render(u,g,f,p)}catch(L){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof o=="function"&&o(L),u.disposeOnDemandRenderer();return}typeof r=="function"&&r(u),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),u.disposeOnDemandRenderer()}};let y=!0,A=0,S=0,T=!0,M=0,E=0,R=!0,I=0,O=0;const F=()=>{if(typeof s=="function"){const L=A+M+I,H=S+E+O,K=y&&T&&R;s(new ProgressEvent("progress",{lengthComputable:K,loaded:H,total:L}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const z=new ds(this._internalLoadingManager);z.setResponseType("arraybuffer"),z.setRequestHeader(this.requestHeader),z.setPath(this.path),z.setWithCredentials(this.withCredentials),z.load(e,async L=>{if(typeof L=="string")throw new Error("Invalid sdr buffer");f=L,await v()},L=>{y=L.lengthComputable,S=L.loaded,A=L.total,F()},L=>{this.manager.itemError(e),typeof o=="function"&&o(L)});const j=new ds(this._internalLoadingManager);j.setResponseType("arraybuffer"),j.setRequestHeader(this.requestHeader),j.setPath(this.path),j.setWithCredentials(this.withCredentials),j.load(t,async L=>{if(typeof L=="string")throw new Error("Invalid gainmap buffer");p=L,await v()},L=>{T=L.lengthComputable,E=L.loaded,M=L.total,F()},L=>{this.manager.itemError(t),typeof o=="function"&&o(L)});const W=new ds(this._internalLoadingManager);return W.setRequestHeader(this.requestHeader),W.setPath(this.path),W.setWithCredentials(this.withCredentials),W.load(n,async L=>{if(typeof L!="string")throw new Error("Invalid metadata string");g=JSON.parse(L),await v()},L=>{R=L.lengthComputable,O=L.loaded,I=L.total,F()},L=>{this.manager.itemError(n),typeof o=="function"&&o(L)}),u}}class Mz extends CD{load(e,t,n,r){const s=this.prepareQuadRenderer(),o=new ds(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const f=new Uint8Array(u);let p,g,v;try{const y=await yz(f);p=y.sdr,g=y.gainMap,v=y.metadata}catch(y){if(y instanceof wD||y instanceof TD)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),v={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},p=f;else throw y}try{await this.render(s,v,p.buffer,g==null?void 0:g.buffer)}catch(y){this.manager.itemError(e),typeof r=="function"&&r(y),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},n,u=>{this.manager.itemError(e),typeof r=="function"&&r(u)}),s}}const Sv={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},RD="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",um=i=>Array.isArray(i),IT=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Z_({files:i=IT,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:r}={}){t&&(BT(t),i=Sv[t],e=RD);const s=um(i),{extension:o,isCubemap:u}=NT(i),f=OT(o);if(!f)throw new Error("useEnvironment: Unrecognized file extension: "+i);const p=Nn(A=>A.gl);le.useLayoutEffect(()=>{if(o!=="webp"&&o!=="jpg"&&o!=="jpeg")return;function A(){Po.clear(f,s?[i]:i)}p.domElement.addEventListener("webglcontextlost",A,{once:!0})},[i,p.domElement]);const g=Po(f,s?[i]:i,A=>{(o==="webp"||o==="jpg"||o==="jpeg")&&A.setRenderer(p),A.setPath==null||A.setPath(e),r&&r(A)});let v=s?g[0]:g;if(o==="jpg"||o==="jpeg"||o==="webp"){var y;v=(y=v.renderTarget)==null?void 0:y.texture}return v.mapping=u?gl:hm,v.colorSpace=n??(u?"srgb":"srgb-linear"),v}const Tz={files:IT,path:"",preset:void 0,extensions:void 0};Z_.preload=i=>{const e={...Tz,...i};let{files:t,path:n=""}=e;const{preset:r,extensions:s}=e;r&&(BT(r),t=Sv[r],n=RD);const{extension:o}=NT(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const u=OT(o);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+t);Po.preload(u,um(t)?[t]:t,f=>{f.setPath==null||f.setPath(n),s&&s(f)})};const wz={files:IT,preset:void 0};Z_.clear=i=>{const e={...wz,...i};let{files:t}=e;const{preset:n}=e;n&&(BT(n),t=Sv[n]);const{extension:r}=NT(t),s=OT(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);Po.clear(s,um(t)?[t]:t)};function BT(i){if(!(i in Sv))throw new Error("Preset must be one of: "+Object.keys(Sv).join(", "))}function NT(i){var e;const t=um(i)&&i.length===6,n=um(i)&&i.length===3&&i.some(o=>o.endsWith("json")),r=um(i)?i[0]:i;return{extension:t?"cube":n?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function OT(i){return i==="cube"?S4:i==="hdr"?$7:i==="exr"?ez:i==="jpg"||i==="jpeg"?Mz:i==="webp"?Ez:null}const Cz=i=>i.current&&i.current.isScene,Rz=i=>Cz(i)?i.current:i;function LT(i,e,t,n,r={}){var s,o,u,f;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const p=Rz(e||t),g=p.background,v=p.environment,y={backgroundBlurriness:p.backgroundBlurriness,backgroundIntensity:p.backgroundIntensity,backgroundRotation:(s=(o=p.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:p.environmentIntensity,environmentRotation:(u=(f=p.environmentRotation)==null||f.clone==null?void 0:f.clone())!==null&&u!==void 0?u:[0,0,0]};return i!=="only"&&(p.environment=n),i&&(p.background=n),ec(p,r),()=>{i!=="only"&&(p.environment=v),i&&(p.background=g),ec(p,y)}}function PT({scene:i,background:e=!1,map:t,...n}){const r=Nn(s=>s.scene);return le.useLayoutEffect(()=>{if(t)return LT(e,i,r,t,n)}),null}function DD({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:u,...f}){const p=Z_(f),g=Nn(v=>v.scene);return le.useLayoutEffect(()=>LT(i,e,g,p,{backgroundBlurriness:t??n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:u})),le.useEffect(()=>()=>{p.dispose()},[p]),null}function Dz({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:r=1,map:s,background:o=!1,blur:u,backgroundBlurriness:f,backgroundIntensity:p,backgroundRotation:g,environmentIntensity:v,environmentRotation:y,scene:A,files:S,path:T,preset:M=void 0,extensions:E}){const R=Nn(W=>W.gl),I=Nn(W=>W.scene),O=le.useRef(null),[F]=le.useState(()=>new Ad),z=le.useMemo(()=>{const W=new S_(n);return W.texture.type=On,W},[n]);le.useEffect(()=>()=>{z.dispose()},[z]),le.useLayoutEffect(()=>{if(r===1){const W=R.autoClear;R.autoClear=!0,O.current.update(R,F),R.autoClear=W}return LT(o,A,I,z.texture,{backgroundBlurriness:u??f,backgroundIntensity:p,backgroundRotation:g,environmentIntensity:v,environmentRotation:y})},[i,F,z.texture,A,I,o,r,R]);let j=1;return da(()=>{if(r===1/0||j<r){const W=R.autoClear;R.autoClear=!0,O.current.update(R,F),R.autoClear=W,j++}}),le.createElement(le.Fragment,null,vF(le.createElement(le.Fragment,null,i,le.createElement("cubeCamera",{ref:O,args:[e,t,z]}),S||M?le.createElement(DD,{background:!0,files:S,preset:M,path:T,extensions:E}):s?le.createElement(PT,{background:!0,map:s,extensions:E}):null),F))}function Iz(i){var e,t,n,r;const s=Z_(i),o=i.map||s;le.useMemo(()=>q_({GroundProjectedEnvImpl:n7}),[]),le.useEffect(()=>()=>{s.dispose()},[s]);const u=le.useMemo(()=>[o],[o]),f=(e=i.ground)==null?void 0:e.height,p=(t=i.ground)==null?void 0:t.radius,g=(n=(r=i.ground)==null?void 0:r.scale)!==null&&n!==void 0?n:1e3;return le.createElement(le.Fragment,null,le.createElement(PT,vl({},i,{map:o})),le.createElement("groundProjectedEnvImpl",{args:u,scale:g,height:f,radius:p}))}function Bz(i){return i.ground?le.createElement(Iz,i):i.map?le.createElement(PT,i):i.children?le.createElement(Dz,i):le.createElement(DD,i)}const Nz=le.forwardRef(({scale:i=10,frames:e=1/0,opacity:t=1,width:n=1,height:r=1,blur:s=1,near:o=0,far:u=10,resolution:f=512,smooth:p=!0,color:g="#000000",depthWrite:v=!1,renderOrder:y,...A},S)=>{const T=le.useRef(null),M=Nn(ne=>ne.scene),E=Nn(ne=>ne.gl),R=le.useRef(null);n=n*(Array.isArray(i)?i[0]:i||1),r=r*(Array.isArray(i)?i[1]:i||1);const[I,O,F,z,j,W,L]=le.useMemo(()=>{const ne=new ti(f,f),fe=new ti(f,f);fe.texture.generateMipmaps=ne.texture.generateMipmaps=!1;const X=new lc(n,r).rotateX(Math.PI/2),re=new Oi(X),ge=new k_;ge.depthTest=ge.depthWrite=!1,ge.onBeforeCompile=Y=>{Y.uniforms={...Y.uniforms,ucolor:{value:new Ft(g)}},Y.fragmentShader=Y.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),Y.fragmentShader=Y.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Te=new ai(K7),Se=new ai(Z7);return Se.depthTest=Te.depthTest=!1,[ne,X,ge,re,Te,Se,fe]},[f,n,r,i,g]),H=ne=>{z.visible=!0,z.material=j,j.uniforms.tDiffuse.value=I.texture,j.uniforms.h.value=ne*1/256,E.setRenderTarget(L),E.render(z,R.current),z.material=W,W.uniforms.tDiffuse.value=L.texture,W.uniforms.v.value=ne*1/256,E.setRenderTarget(I),E.render(z,R.current),z.visible=!1};let K=0,de,ce;return da(()=>{R.current&&(e===1/0||K<e)&&(K++,de=M.background,ce=M.overrideMaterial,T.current.visible=!1,M.background=null,M.overrideMaterial=F,E.setRenderTarget(I),E.render(M,R.current),H(s),p&&H(s*.4),E.setRenderTarget(null),T.current.visible=!0,M.overrideMaterial=ce,M.background=de)}),le.useImperativeHandle(S,()=>T.current,[]),le.createElement("group",vl({"rotation-x":Math.PI/2},A,{ref:T}),le.createElement("mesh",{renderOrder:y,geometry:O,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},le.createElement("meshBasicMaterial",{transparent:!0,map:I.texture,opacity:t,depthWrite:v})),le.createElement("orthographicCamera",{ref:R,args:[-n/2,n/2,r/2,-r/2,o,u]}))});function Oz(i,e,t=new Q){const n=Math.PI*(i-.5),r=2*Math.PI*(e-.5);return t.x=Math.cos(r),t.y=Math.sin(n),t.z=Math.sin(r),t}const Lz=le.forwardRef(({inclination:i=.6,azimuth:e=.1,distance:t=1e3,mieCoefficient:n=.005,mieDirectionalG:r=.8,rayleigh:s=.5,turbidity:o=10,sunPosition:u=Oz(i,e),...f},p)=>{const g=le.useMemo(()=>new Q().setScalar(t),[t]),[v]=le.useState(()=>new e7);return le.createElement("primitive",vl({object:v,ref:p,"material-uniforms-mieCoefficient-value":n,"material-uniforms-mieDirectionalG-value":r,"material-uniforms-rayleigh-value":s,"material-uniforms-sunPosition-value":u,"material-uniforms-turbidity-value":o,scale:g},f))}),Pz={},oR=i=>{let e;const t=new Set,n=(g,v)=>{const y=typeof g=="function"?g(e):g;if(!Object.is(y,e)){const A=e;e=v??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(S=>S(e,A))}},r=()=>e,f={setState:n,getState:r,getInitialState:()=>p,subscribe:g=>(t.add(g),()=>t.delete(g)),destroy:()=>{(Pz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},p=e=i(n,r,f);return f},Uz=i=>i?oR(i):oR,ID={},{useDebugValue:Fz}=Cv,{useSyncExternalStoreWithSelector:zz}=G4;let lR=!1;const Hz=i=>i;function Gz(i,e=Hz,t){(ID?"production":void 0)!=="production"&&t&&!lR&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),lR=!0);const n=zz(i.subscribe,i.getState,i.getServerState||i.getInitialState,e,t);return Fz(n),n}const kz=i=>{(ID?"production":void 0)!=="production"&&typeof i!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof i=="function"?Uz(i):i,t=(n,r)=>Gz(e,n,r);return Object.assign(t,e),t},Vz=i=>kz,jz={};function Wz(i,e){let t;try{t=i()}catch{return}return{getItem:r=>{var s;const o=f=>f===null?null:JSON.parse(f,void 0),u=(s=t.getItem(r))!=null?s:null;return u instanceof Promise?u.then(o):o(u)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const bv=i=>e=>{try{const t=i(e);return t instanceof Promise?t:{then(n){return bv(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return bv(n)(t)}}}},Xz=(i,e)=>(t,n,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:M=>M,version:0,merge:(M,E)=>({...E,...M}),...e},o=!1;const u=new Set,f=new Set;let p;try{p=s.getStorage()}catch{}if(!p)return i((...M)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...M)},n,r);const g=bv(s.serialize),v=()=>{const M=s.partialize({...n()});let E;const R=g({state:M,version:s.version}).then(I=>p.setItem(s.name,I)).catch(I=>{E=I});if(E)throw E;return R},y=r.setState;r.setState=(M,E)=>{y(M,E),v()};const A=i((...M)=>{t(...M),v()},n,r);let S;const T=()=>{var M;if(!p)return;o=!1,u.forEach(R=>R(n()));const E=((M=s.onRehydrateStorage)==null?void 0:M.call(s,n()))||void 0;return bv(p.getItem.bind(p))(s.name).then(R=>{if(R)return s.deserialize(R)}).then(R=>{if(R)if(typeof R.version=="number"&&R.version!==s.version){if(s.migrate)return s.migrate(R.state,R.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return R.state}).then(R=>{var I;return S=s.merge(R,(I=n())!=null?I:A),t(S,!0),v()}).then(()=>{E==null||E(S,void 0),o=!0,f.forEach(R=>R(S))}).catch(R=>{E==null||E(void 0,R)})};return r.persist={setOptions:M=>{s={...s,...M},M.getStorage&&(p=M.getStorage())},clearStorage:()=>{p==null||p.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:M=>(u.add(M),()=>{u.delete(M)}),onFinishHydration:M=>(f.add(M),()=>{f.delete(M)})},T(),S||A},Yz=(i,e)=>(t,n,r)=>{let s={storage:Wz(()=>localStorage),partialize:T=>T,version:0,merge:(T,M)=>({...M,...T}),...e},o=!1;const u=new Set,f=new Set;let p=s.storage;if(!p)return i((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},n,r);const g=()=>{const T=s.partialize({...n()});return p.setItem(s.name,{state:T,version:s.version})},v=r.setState;r.setState=(T,M)=>{v(T,M),g()};const y=i((...T)=>{t(...T),g()},n,r);r.getInitialState=()=>y;let A;const S=()=>{var T,M;if(!p)return;o=!1,u.forEach(R=>{var I;return R((I=n())!=null?I:y)});const E=((M=s.onRehydrateStorage)==null?void 0:M.call(s,(T=n())!=null?T:y))||void 0;return bv(p.getItem.bind(p))(s.name).then(R=>{if(R)if(typeof R.version=="number"&&R.version!==s.version){if(s.migrate)return[!0,s.migrate(R.state,R.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,R.state];return[!1,void 0]}).then(R=>{var I;const[O,F]=R;if(A=s.merge(F,(I=n())!=null?I:y),t(A,!0),O)return g()}).then(()=>{E==null||E(A,void 0),A=n(),o=!0,f.forEach(R=>R(A))}).catch(R=>{E==null||E(void 0,R)})};return r.persist={setOptions:T=>{s={...s,...T},T.storage&&(p=T.storage)},clearStorage:()=>{p==null||p.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:T=>(u.add(T),()=>{u.delete(T)}),onFinishHydration:T=>(f.add(T),()=>{f.delete(T)})},s.skipHydration||S(),A||y},Qz=(i,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((jz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Xz(i,e)):Yz(i,e),qz=Qz,Ue=Vz()(qz(i=>({userLocation:null,setUserLocation:e=>i({userLocation:e}),zones:[],selectedZone:null,setSelectedZone:e=>i({selectedZone:e}),setZones:e=>i({zones:e}),events:[],selectedEvent:null,setSelectedEvent:e=>i({selectedEvent:e}),favoriteEvents:[],toggleFavoriteEvent:e=>i(t=>({favoriteEvents:t.favoriteEvents.includes(e)?t.favoriteEvents.filter(n=>n!==e):[...t.favoriteEvents,e]})),friends:[],selectedFriend:null,setSelectedFriend:e=>i({selectedFriend:e}),currentRoute:null,setRoute:e=>i({currentRoute:e}),isNavigating:!1,setIsNavigating:e=>i({isNavigating:e}),viewMode:"angle",setViewMode:e=>i({viewMode:e}),activePanel:null,setActivePanel:e=>i({activePanel:e}),showMiniMap:!0,toggleMiniMap:()=>i(e=>({showMiniMap:!e.showMiniMap})),arMode:!1,setArMode:e=>i({arMode:e}),cameraTarget:null,setCameraTarget:e=>i({cameraTarget:e}),cameraPosition:null,setCameraPosition:e=>i({cameraPosition:e}),cameraTargetPosition:null,setCameraTargetPosition:e=>i({cameraTargetPosition:e}),editMode:!1,setEditMode:e=>i({editMode:e}),poiEditMode:!1,setPoiEditMode:e=>i({poiEditMode:e}),showAdjustments:!0,setShowAdjustments:e=>i({showAdjustments:e}),notifications:[],addNotification:e=>i(t=>({notifications:[...t.notifications,e]})),removeNotification:e=>i(t=>({notifications:t.notifications.filter(n=>n.id!==e)})),hdriIntensity:1,setHdriIntensity:e=>i({hdriIntensity:e}),hdriMix:0,setHdriMix:e=>i({hdriMix:e}),hdriProcedural:.5,setHdriProcedural:e=>i({hdriProcedural:e}),hdriHue:0,setHdriHue:e=>i({hdriHue:e}),hdriSaturation:1,setHdriSaturation:e=>i({hdriSaturation:e}),hdriBlur:0,setHdriBlur:e=>i({hdriBlur:e}),hdriRotation1:0,setHdriRotation1:e=>i({hdriRotation1:e}),hdriRotation2:0,setHdriRotation2:e=>i({hdriRotation2:e}),showHdriBackground:!0,setShowHdriBackground:e=>i({showHdriBackground:e}),hdriFile:"/textures/env/env_map.hdr",setHdriFile:e=>i({hdriFile:e}),backgroundMode:"sky",setBackgroundMode:e=>i({backgroundMode:e}),timeOfDay:14,setTimeOfDay:e=>i({timeOfDay:e}),sunOrientation:180,setSunOrientation:e=>i({sunOrientation:e}),showLightingPanel:!1,setShowLightingPanel:e=>i({showLightingPanel:e}),graphicsQuality:"high",setGraphicsQuality:e=>i({graphicsQuality:e}),materialColor:"#bcbcbc",setMaterialColor:e=>i({materialColor:e}),materialRoughness:.25,setMaterialRoughness:e=>i({materialRoughness:e}),materialMetalness:.02,setMaterialMetalness:e=>i({materialMetalness:e}),materialOpacity:1,setMaterialOpacity:e=>i({materialOpacity:e}),toneMapping:"ACES",setToneMapping:e=>i({toneMapping:e}),toneMappingExposure:10,setToneMappingExposure:e=>i({toneMappingExposure:e}),bloomIntensity:.5,setBloomIntensity:e=>i({bloomIntensity:e}),bloomThreshold:.9,setBloomThreshold:e=>i({bloomThreshold:e}),vignetteIntensity:.35,setVignetteIntensity:e=>i({vignetteIntensity:e}),ssaoEnabled:!1,setSsaoEnabled:e=>i({ssaoEnabled:e}),ssaoIntensity:1.5,setSsaoIntensity:e=>i({ssaoIntensity:e}),dofEnabled:!1,setDofEnabled:e=>i({dofEnabled:e}),dofFocusDistance:.02,setDofFocusDistance:e=>i({dofFocusDistance:e}),dofFocalLength:.05,setDofFocalLength:e=>i({dofFocalLength:e}),dofBokehScale:3,setDofBokehScale:e=>i({dofBokehScale:e}),chromaticAberration:.002,setChromaticAberration:e=>i({chromaticAberration:e}),colorBrightness:0,setColorBrightness:e=>i({colorBrightness:e}),colorContrast:.05,setColorContrast:e=>i({colorContrast:e}),colorSaturation:.1,setColorSaturation:e=>i({colorSaturation:e}),nightLightsEnabled:!0,setNightLightsEnabled:e=>i({nightLightsEnabled:e}),nightLightsIntensity:1,setNightLightsIntensity:e=>i({nightLightsIntensity:e}),contactShadowsEnabled:!0,setContactShadowsEnabled:e=>i({contactShadowsEnabled:e}),atmosphereEnabled:!0,setAtmosphereEnabled:e=>i({atmosphereEnabled:e}),atmosphereIntensity:.4,setAtmosphereIntensity:e=>i({atmosphereIntensity:e}),atmosphereTurbidity:2,setAtmosphereTurbidity:e=>i({atmosphereTurbidity:e}),atmosphereMieCoeff:.003,setAtmosphereMieCoeff:e=>i({atmosphereMieCoeff:e}),atmosphereRayleighScale:1,setAtmosphereRayleighScale:e=>i({atmosphereRayleighScale:e}),cloudsEnabled:!0,setCloudsEnabled:e=>i({cloudsEnabled:e}),cloudCoverage:.45,setCloudCoverage:e=>i({cloudCoverage:e}),cloudDensity:.7,setCloudDensity:e=>i({cloudDensity:e}),cloudScale:1,setCloudScale:e=>i({cloudScale:e}),cloudSpeed:.02,setCloudSpeed:e=>i({cloudSpeed:e}),cloudAltitude:80,setCloudAltitude:e=>i({cloudAltitude:e}),cloudOpacity:.5,setCloudOpacity:e=>i({cloudOpacity:e}),fogEnabled:!1,setFogEnabled:e=>i({fogEnabled:e}),fogDensity:.3,setFogDensity:e=>i({fogDensity:e}),fogHeight:5,setFogHeight:e=>i({fogHeight:e}),godRaysEnabled:!1,setGodRaysEnabled:e=>i({godRaysEnabled:e}),godRaysIntensity:.5,setGodRaysIntensity:e=>i({godRaysIntensity:e})}),{name:"mff-lighting-settings",version:4,migrate:i=>i,partialize:i=>({timeOfDay:i.timeOfDay,sunOrientation:i.sunOrientation,hdriIntensity:i.hdriIntensity,hdriFile:i.hdriFile,hdriBlur:i.hdriBlur,hdriRotation1:i.hdriRotation1,hdriProcedural:i.hdriProcedural,backgroundMode:i.backgroundMode,showHdriBackground:i.showHdriBackground,graphicsQuality:i.graphicsQuality,toneMapping:i.toneMapping,toneMappingExposure:i.toneMappingExposure,bloomIntensity:i.bloomIntensity,bloomThreshold:i.bloomThreshold,vignetteIntensity:i.vignetteIntensity,ssaoEnabled:i.ssaoEnabled,ssaoIntensity:i.ssaoIntensity,dofEnabled:i.dofEnabled,dofFocusDistance:i.dofFocusDistance,dofFocalLength:i.dofFocalLength,dofBokehScale:i.dofBokehScale,chromaticAberration:i.chromaticAberration,colorBrightness:i.colorBrightness,colorContrast:i.colorContrast,colorSaturation:i.colorSaturation,nightLightsEnabled:i.nightLightsEnabled,nightLightsIntensity:i.nightLightsIntensity,contactShadowsEnabled:i.contactShadowsEnabled,materialColor:i.materialColor,materialRoughness:i.materialRoughness,materialMetalness:i.materialMetalness,atmosphereEnabled:i.atmosphereEnabled,atmosphereIntensity:i.atmosphereIntensity,atmosphereTurbidity:i.atmosphereTurbidity,atmosphereMieCoeff:i.atmosphereMieCoeff,atmosphereRayleighScale:i.atmosphereRayleighScale,cloudsEnabled:i.cloudsEnabled,cloudCoverage:i.cloudCoverage,cloudDensity:i.cloudDensity,cloudScale:i.cloudScale,cloudSpeed:i.cloudSpeed,cloudAltitude:i.cloudAltitude,cloudOpacity:i.cloudOpacity,fogEnabled:i.fogEnabled,fogDensity:i.fogDensity,fogHeight:i.fogHeight,godRaysEnabled:i.godRaysEnabled,godRaysIntensity:i.godRaysIntensity})}));function Jz(){const i=K_("/SM_MFF.glb"),e=Ue(s=>s.materialColor),t=Ue(s=>s.materialRoughness),n=Ue(s=>s.materialMetalness),r=Ue(s=>s.materialOpacity);return le.useEffect(()=>{i!=null&&i.scene&&i.scene.traverse(s=>{s.isMesh&&(s.material=new no({color:e,roughness:t,metalness:n,opacity:r,transparent:r<1,envMapIntensity:1.5,clearcoat:1,clearcoatRoughness:.1,side:Vr}),s.castShadow=!0,s.receiveShadow=!0)})},[i,e,t,n,r]),D.jsx("primitive",{object:i.scene,scale:1,position:[0,0,0],rotation:[0,0,0]})}function Kz(){return D.jsx(Jz,{})}function Zz(){const i=Ue(t=>t.userLocation),e=Ue(t=>t.viewMode);return!i||e==="first-person"?null:D.jsxs("group",{position:i.position,children:[D.jsxs("mesh",{position:[0,.1,0],rotation:[-Math.PI/2,0,0],children:[D.jsx("circleGeometry",{args:[.8,32]}),D.jsx("meshBasicMaterial",{color:"#0066cc",opacity:.6,transparent:!0})]}),D.jsxs("mesh",{position:[0,.2,0],rotation:[-Math.PI/2,0,i.rotation],children:[D.jsx("coneGeometry",{args:[.5,1,3]}),D.jsx("meshBasicMaterial",{color:"#00ccff"})]}),D.jsxs("mesh",{position:[0,3,0],children:[D.jsx("cylinderGeometry",{args:[.1,.1,6]}),D.jsx("meshBasicMaterial",{color:"#0066cc",opacity:.3,transparent:!0})]}),D.jsx(wT,{position:[0,4,0],style:{pointerEvents:"none"},occlude:!1,transform:!0,sprite:!0,children:D.jsx("div",{className:"bg-blue-600 text-white px-2 py-0.5 rounded-full font-bold whitespace-nowrap shadow-lg",style:{fontSize:"10px"},children:" "})})]})}const $z=[{id:"poi-1",name:"VIP_",color:"#ffd700",cameraPosition:[45.6093,37.146,-.9265],targetPosition:[55.9662,.0193,-.7788],description:"POI: VIP_",distance:38.5445,azimuthDeg:.82,elevationDeg:-74.41},{id:"poi-2",name:"",color:"#9933cc",cameraPosition:[-134.7509,22.008,-24.7307],targetPosition:[-127.6949,-.082,-6.942],description:"POI: ",distance:29.2266,azimuthDeg:68.36,elevationDeg:-49.1},{id:"poi-3",name:"_",color:"#96ceb4",cameraPosition:[-8.6085,4.4716,3.3004],targetPosition:[-17.7868,.0393,2.435],description:"POI: _",distance:10.2292,azimuthDeg:185.39,elevationDeg:-25.68},{id:"poi-4",name:"  _1",color:"#e74c3c",cameraPosition:[-64.1141,4.2538,1.7474],targetPosition:[-70.6471,.0297,-4.8607],description:"POI:   _1",distance:10.2074,azimuthDeg:225.33,elevationDeg:-24.45},{id:"poi-5",name:"  _2",color:"#c0392b",cameraPosition:[-69.1699,6.7375,-1.5918],targetPosition:[-71.0304,1.8639,8.8401],description:"POI:   _2",distance:11.6635,azimuthDeg:100.11,elevationDeg:-24.7},{id:"poi-6",name:"__",color:"#ff6b35",cameraPosition:[3.5254,31.3385,1.479],targetPosition:[26.3648,-.2141,2.1837],description:"POI: __",distance:38.9576,azimuthDeg:1.77,elevationDeg:-54.09},{id:"poi-7",name:"-",color:"#00ccff",cameraPosition:[-58.1002,5.2156,2.4404],targetPosition:[-63.0388,.0536,-4.556],description:"POI: -",distance:9.9993,azimuthDeg:234.78,elevationDeg:-31.08},{id:"poi-8",name:"_ 1",color:"#0088ff",cameraPosition:[-44.2211,22.0683,1.5113],targetPosition:[-44.4166,11.5688,7.5921],description:"POI: _ 1",distance:12.1348,azimuthDeg:91.84,elevationDeg:-59.91},{id:"poi-9",name:"_ 2",color:"#4ecdc4",cameraPosition:[-38.4955,22.213,1.2848],targetPosition:[-38.3563,9.421,-6.7289],description:"POI: _ 2",distance:15.0955,azimuthDeg:271,elevationDeg:-57.93},{id:"poi-10",name:"_ 3",color:"#45b7d1",cameraPosition:[-7.2254,22.3843,1.8895],targetPosition:[-7.383,8.3962,10.1424],description:"POI: _ 3",distance:16.242,azimuthDeg:91.09,elevationDeg:-59.45},{id:"poi-11",name:"_ 4",color:"#96ceb4",cameraPosition:[-4.5438,23.7088,2.3991],targetPosition:[-4.6735,15.2893,-2.995],description:"POI: _ 4",distance:10,azimuthDeg:268.62,elevationDeg:-57.35},{id:"poi-12",name:"__1",color:"#45b7d1",cameraPosition:[-16.819,13.809,1.7088],targetPosition:[-22.94,1.1404,-8.4887],description:"POI: __1",distance:17.3766,azimuthDeg:239.03,elevationDeg:-46.81},{id:"poi-13",name:"__2",color:"#4ecdc4",cameraPosition:[-24.6411,11.9931,3.1339],targetPosition:[-26.4808,1.9307,13.3384],description:"POI: __2",distance:14.4488,azimuthDeg:100.22,elevationDeg:-44.14},{id:"poi-14",name:" ",color:"#cc6600",cameraPosition:[-61.1736,13.2597,-2.028],targetPosition:[-63.4424,.7072,13.1006],description:"POI:  ",distance:19.7886,azimuthDeg:98.53,elevationDeg:-39.37},{id:"poi-15",name:"_1",color:"#8e44ad",cameraPosition:[-68.3509,9.3885,-16.0931],targetPosition:[-71.1727,.0193,-14.0301],description:"POI: _1",distance:10,azimuthDeg:143.83,elevationDeg:-69.54},{id:"poi-16",name:"_2",color:"#9b59b6",cameraPosition:[-62.0645,7.2259,-9.1383],targetPosition:[-65.9189,.0193,-14.901],description:"POI: _2",distance:10,azimuthDeg:236.22,elevationDeg:-46.11},{id:"poi-17",name:"_",color:"#cc0066",cameraPosition:[-38.8052,2.9575,1.7756],targetPosition:[-29.0376,.8293,2.0298],description:"POI: _",distance:10,azimuthDeg:1.49,elevationDeg:-12.29},{id:"poi-18",name:"",color:"#33cccc",cameraPosition:[-72.6555,12.8658,1.5419],targetPosition:[-88.4237,.7132,1.4177],description:"POI: ",distance:19.9082,azimuthDeg:180.45,elevationDeg:-37.62},{id:"poi-19",name:"_",color:"#ff69b4",cameraPosition:[-13.7752,11.55,1.1361],targetPosition:[2.7957,.3475,.7583],description:"POI: _",distance:20.0059,azimuthDeg:358.69,elevationDeg:-34.05}],$r=new Map($z.map(i=>[i.name,i])),ZA=[{id:"zone-1",name:"VIP-",color:"#ffd700",position:[52.066,.019,.779],description:" ,    VIP- (, , ).  .",type:"lounge",floor:"1 ,  ",equipment:[" "," ",""],poi:$r.get("VIP_")},{id:"zone-2",name:"",color:"#9933cc",position:[-127.695,-.082,-6.942],description:"  .  , , .",type:"registration",floor:"1 ,  ",equipment:[" "," ",""],poi:$r.get("")},{id:"zone-3",name:"-",color:"#96ceb4",position:[-17.487,.039,2.465],description:"        .",type:"other",floor:"1 ",equipment:["-",""," "],poi:$r.get("_")},{id:"zone-4",name:"- 1",color:"#e74c3c",position:[-71.147,.03,7.861],description:"    . -   ().",type:"other",floor:"1 ,   ",equipment:[" ","  ","  "],poi:$r.get("  _1")},{id:"zone-5",name:"- 2",color:"#c0392b",position:[-70.494,.03,-4.725],description:"    . -   ().",type:"other",floor:"1 ,   ",equipment:[" ","  ","  "],poi:$r.get("  _2")},{id:"zone-6",name:"  ",color:"#ff6b35",position:[30.267,.456,1.719],description:"  .  , /.",type:"conference",capacity:680,floor:"1 , ",equipment:[""," 8x4.5 (2 .)","-"," "],poi:$r.get("__")},{id:"zone-7",name:"-",color:"#00ccff",position:[-63.039,.053,-4.444],description:",     .",type:"other",floor:"1 ",equipment:[" "," "],poi:$r.get("-")},{id:"zone-8",name:"- I",color:"#0088ff",position:[-42.434,.111,15.028],description:"   (, ESG, ).",type:"conference",capacity:110,floor:"2 ",equipment:[" 4.5x2.5","","",""],poi:$r.get("_ 1")},{id:"zone-9",name:"- II",color:"#4ecdc4",position:[-38.756,.111,-11.4],description:"   (, ESG, ).",type:"conference",capacity:110,floor:"2 ",equipment:[" 4.5x2.5","","",""],poi:$r.get("_ 2")},{id:"zone-10",name:"- III",color:"#45b7d1",position:[-6.192,.111,14.388],description:"   (, ESG, ).",type:"conference",capacity:110,floor:"1 ",equipment:[" 5.5x3","","",""],poi:$r.get("_ 3")},{id:"zone-11",name:"- IV",color:"#96ceb4",position:[-6.264,.111,-10.895],description:"   (, ESG, ).",type:"conference",capacity:110,floor:"1 ",equipment:[" 5.5x3","","",""],poi:$r.get("_ 4")},{id:"zone-12",name:"- 1",color:"#45b7d1",position:[-24.793,.068,11.824],description:"   ,  , .",type:"lounge",floor:"2 ",equipment:["","",". "],poi:$r.get("__1")},{id:"zone-13",name:"- 2",color:"#4ecdc4",position:[-22.792,.066,-7.632],description:"   ,  , .",type:"lounge",floor:"2 ",equipment:[""," "," "],poi:$r.get("__2")},{id:"zone-14",name:" ",color:"#cc6600",position:[-62.34,.019,12.455],description:"     .",type:"conference",capacity:100,floor:"1 ,  ",equipment:[" "," "],poi:$r.get(" ")},{id:"zone-15",name:" 1",color:"#8e44ad",position:[-70.673,.019,-14.37],description:"  , ,  .",type:"conference",floor:"1 ,  ",equipment:["","6 ",""],poi:$r.get("_1")},{id:"zone-16",name:" 2",color:"#9b59b6",position:[-64.919,.019,-15.099],description:"  , ,  .",type:"conference",floor:"1 ,  ",equipment:["","4 ",""],poi:$r.get("_2")},{id:"zone-17",name:"",color:"#cc0066",position:[-29.288,.119,2.094],description:" -.  , , B2B-.",type:"exhibition",floor:"1 ,  ",equipment:[" 30-50 .","-",""],poi:$r.get("_")},{id:"zone-18",name:"",color:"#33cccc",position:[-87.889,.019,1.46],description:"    .",type:"lounge",floor:"1 ",poi:$r.get("")},{id:"zone-19",name:"-",color:"#ff69b4",position:[2.896,.348,1.442],description:"     .",type:"other",floor:"1 ",equipment:["-",". "],poi:$r.get("_")}],uE=new Date,Gs=new Date(uE.getFullYear(),uE.getMonth(),uE.getDate()),cR=[{id:"event-1",title:" ",description:"    ",zoneId:"zone-6",startTime:new Date(Gs.getTime()+9*36e5),endTime:new Date(Gs.getTime()+10*36e5),status:"upcoming",tags:["",""],speakers:[" .."," .."],capacity:500},{id:"event-2",title:"  ",description:"   ",zoneId:"zone-9",startTime:new Date(Gs.getTime()+10.5*36e5),endTime:new Date(Gs.getTime()+12*36e5),status:"upcoming",tags:["",""],speakers:[" .."],capacity:150},{id:"event-3",title:"ESG   ",description:"    ",zoneId:"zone-8",startTime:new Date(Gs.getTime()+10.5*36e5),endTime:new Date(Gs.getTime()+12*36e5),status:"upcoming",tags:["ESG",""],speakers:[" .."],capacity:150},{id:"event-4",title:"-",description:"    ",zoneId:"zone-13",startTime:new Date(Gs.getTime()+12*36e5),endTime:new Date(Gs.getTime()+13*36e5),status:"upcoming",tags:["",""]},{id:"event-5",title:"  ",description:"   ",zoneId:"zone-10",startTime:new Date(Gs.getTime()+13*36e5),endTime:new Date(Gs.getTime()+14.5*36e5),status:"upcoming",tags:["",""],speakers:[" .."],capacity:150},{id:"event-6",title:"  ",description:"   ",zoneId:"zone-11",startTime:new Date(Gs.getTime()+13*36e5),endTime:new Date(Gs.getTime()+14.5*36e5),status:"upcoming",tags:["",""],speakers:[" .."],capacity:150},{id:"event-7",title:" :  ",description:"    ",zoneId:"zone-14",startTime:new Date(Gs.getTime()+14.5*36e5),endTime:new Date(Gs.getTime()+15.5*36e5),status:"upcoming",tags:["",""],speakers:[" .."," .."," .."],capacity:200},{id:"event-8",title:" ",description:"   ",zoneId:"zone-6",startTime:new Date(Gs.getTime()+16*36e5),endTime:new Date(Gs.getTime()+17*36e5),status:"upcoming",tags:["",""],capacity:500}],uR=[{id:"friend-1",name:" ",location:{position:[-43.756,0,-14.4],rotation:0,timestamp:new Date},isOnline:!0},{id:"friend-2",name:" ",location:{position:[27.267,0,-1.781],rotation:Math.PI/2,timestamp:new Date},isOnline:!0},{id:"friend-3",name:" ",location:{position:[-22.993,0,7.124],rotation:0,timestamp:new Date},isOnline:!0},{id:"friend-4",name:" ",location:{position:[-63.34,0,-12.545],rotation:Math.PI,timestamp:new Date(Date.now()-3e5)},isOnline:!1}];function eH({position:i,color:e}){const t=le.useRef(null);return da(n=>{if(t.current){const r=1+Math.sin(n.clock.elapsedTime*3)*.1;t.current.scale.set(r,1,r)}}),D.jsxs("mesh",{ref:t,position:[i[0],i[1]+2,i[2]],children:[D.jsx("sphereGeometry",{args:[.5,16,16]}),D.jsx("meshBasicMaterial",{color:e,transparent:!0,opacity:.8})]})}function tH(){const i=Ue(s=>s.zones),e=Ue(s=>s.selectedZone),t=Ue(s=>s.setSelectedZone),n=Ue(s=>s.setCameraTarget);le.useEffect(()=>{i.length===0&&Ue.setState({zones:ZA})},[i.length]);const r=i.length>0?i:ZA;return D.jsx(D.Fragment,{children:r.map(s=>{const o=(e==null?void 0:e.id)===s.id,u=()=>{t(s),n(s.id)};return D.jsxs("group",{position:[s.position[0],s.position[1],s.position[2]],children:[D.jsxs("mesh",{position:[0,2,0],onClick:u,children:[D.jsx("cylinderGeometry",{args:[3,3,4,32]}),D.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),o&&D.jsx(eH,{position:[0,0,0],color:s.color}),D.jsx(wT,{position:[0,8,0],center:!0,distanceFactor:60,occlude:!1,sprite:!0,style:{pointerEvents:"auto"},children:D.jsx("div",{className:`px-3 py-1.5 rounded-xl font-semibold whitespace-nowrap cursor-pointer select-none transition-all ${o?"bg-white/20 text-white scale-110 ring-1 ring-white/30":"bg-black/50 text-white/90 hover:bg-black/60"}`,style:{borderLeft:`3px solid ${s.color}`,fontSize:"13px",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",border:"1px solid rgba(255,255,255,0.08)",borderLeftWidth:"3px",borderLeftColor:s.color,boxShadow:"0 4px 16px rgba(0,0,0,0.3)",letterSpacing:"0.01em"},onClick:f=>{f.stopPropagation(),u()},children:s.name})})]},s.id)})})}function nH(){const i=Ue(t=>t.selectedFriend),e=Ue(t=>t.setSelectedFriend);return le.useEffect(()=>{Ue.setState({friends:uR})},[]),D.jsx(D.Fragment,{children:uR.map(t=>{if(!t.isOnline)return null;const n=(i==null?void 0:i.id)===t.id;return D.jsxs("group",{position:t.location.position,children:[D.jsxs("mesh",{position:[0,.1,0],rotation:[-Math.PI/2,0,0],children:[D.jsx("circleGeometry",{args:[.6,32]}),D.jsx("meshBasicMaterial",{color:"#00cc66",opacity:.7,transparent:!0})]}),D.jsxs("mesh",{position:[0,2,0],children:[D.jsx("sphereGeometry",{args:[.8,32,32]}),D.jsx("meshStandardMaterial",{color:n?"#00ff88":"#00cc66",emissive:"#00cc66",emissiveIntensity:n?.5:.2})]}),D.jsx(wT,{position:[0,3.5,0],style:{pointerEvents:"none"},occlude:!1,transform:!0,sprite:!0,children:D.jsxs("div",{className:`px-2 py-0.5 rounded-full font-bold whitespace-nowrap shadow-lg cursor-pointer transition-all pointer-events-auto ${n?"bg-green-500 text-white":"bg-gray-800 bg-opacity-80 text-green-300 hover:bg-opacity-100"}`,style:{fontSize:"10px"},onClick:r=>{r.stopPropagation(),e(n?null:t)},children:[" ",t.name]})})]},t.id)})})}function iH(i){const e=new iT;if(i.length<2)return e;if(i.length===2)return e.add(new VA(i[0].clone(),i[1].clone())),e;const t=1.5;for(let n=0;n<i.length-1;n++){const r=i[n],s=i[n+1],o=new Q().subVectors(s,r),u=o.length();if(u<.01)continue;let f=0,p=0;n<i.length-2&&(p=Math.min(t,u*.3)),n>0&&(f=Math.min(t,u*.3));const g=o.clone().normalize(),v=r.clone().add(g.clone().multiplyScalar(f)),y=r.clone().add(g.clone().multiplyScalar(u-p));if(v.distanceTo(y)>.01&&e.add(new VA(v,y)),n<i.length-2){const A=i[n+2],S=new Q().subVectors(A,s).normalize(),T=new Q().subVectors(A,s).length(),M=Math.min(t,T*.3),E=y,R=s.clone().add(S.clone().multiplyScalar(M));e.add(new N_(E,s.clone(),R))}}return e}function rH({path:i,pathLength:e}){const t=le.useRef(null),n=le.useMemo(()=>{const s=Math.max(3,Math.floor(e/3.5)),o=[];for(let u=0;u<s;u++)o.push({id:u,offset:u/s});return o},[e]);return da((r,s)=>{t.current&&t.current.children.forEach((o,u)=>{const f=n[u];if(f){f.offset=(f.offset+s*.1)%1;try{const p=Math.max(.001,Math.min(.999,f.offset)),g=i.getPointAt(p),v=i.getTangentAt(p);o.position.set(g.x,g.y+.2,g.z),o.quaternion.setFromUnitVectors(new Q(0,1,0),v.normalize());const y=Math.min(p*5,(1-p)*5,1),A=.5+y*.4,S=.7+y*.3;o.scale.setScalar(S),o.material&&(o.material.opacity=A)}catch{}}})}),D.jsx("group",{ref:t,children:n.map(r=>D.jsxs("mesh",{children:[D.jsx("coneGeometry",{args:[.25,.6,3]}),D.jsx("meshBasicMaterial",{color:"#ff8c00",transparent:!0,opacity:.8,depthWrite:!1})]},r.id))})}function sH({position:i}){const e=le.useRef(null),t=le.useRef(null);return da(n=>{const r=n.clock.elapsedTime;if(e.current){const s=1+Math.sin(r*2)*.15;e.current.scale.set(s,s,1),e.current.material.opacity=.3+Math.sin(r*2)*.1}t.current&&(t.current.position.y=1.5+Math.sin(r*1.5)*.3)}),D.jsxs("group",{position:i,children:[D.jsxs("mesh",{ref:e,position:[0,.1,0],rotation:[-Math.PI/2,0,0],children:[D.jsx("ringGeometry",{args:[1.2,1.8,32]}),D.jsx("meshBasicMaterial",{color:"#ff8c00",transparent:!0,opacity:.3,side:Vr,depthWrite:!1})]}),D.jsxs("mesh",{position:[0,.08,0],rotation:[-Math.PI/2,0,0],children:[D.jsx("circleGeometry",{args:[1.2,32]}),D.jsx("meshBasicMaterial",{color:"#ff8c00",transparent:!0,opacity:.08,side:Vr,depthWrite:!1})]}),D.jsxs("mesh",{ref:t,position:[0,1.5,0],rotation:[Math.PI,0,0],children:[D.jsx("coneGeometry",{args:[.4,1.2,16]}),D.jsx("meshBasicMaterial",{color:"#ff6600",transparent:!0,opacity:.9})]}),D.jsxs("mesh",{position:[0,2.5,0],children:[D.jsx("sphereGeometry",{args:[.25,16,16]}),D.jsx("meshBasicMaterial",{color:"#ffaa44",transparent:!0,opacity:.9})]})]})}function aH(){const i=Ue(s=>s.currentRoute),e=Ue(s=>s.userLocation),{path:t,pathLength:n,lineGeometry:r}=le.useMemo(()=>{if(!i||!e)return{path:null,pathLength:0,lineGeometry:null};const s=[new Q(...e.position),...i.waypoints.map(y=>new Q(...y)),new Q(...i.to)],o=[s[0]];for(let y=1;y<s.length;y++)s[y].distanceTo(o[o.length-1])>1&&o.push(s[y]);o.length<2&&o.push(s[s.length-1]);const u=iH(o),f=u.getLength(),p=Math.max(20,Math.floor(f*2)),g=[];for(let y=0;y<=p;y++)try{g.push(u.getPointAt(y/p))}catch{}const v=new pn().setFromPoints(g);return{path:u,pathLength:f,lineGeometry:v}},[i,e]);return!t||!r?null:D.jsxs("group",{children:[D.jsx("primitive",{object:new sc(r,new Ms({color:"#ff8c00",transparent:!0,opacity:.25,depthWrite:!1}))}),D.jsx(rH,{path:t,pathLength:n}),i&&D.jsx(sH,{position:i.to})]})}function oH(){const{camera:i}=Nn(),e=le.useRef(!1),t=le.useRef(!1),n=le.useRef(!1),r=le.useRef(!1),s=le.useRef(new Q),o=le.useRef(new Q),u=le.useRef(20),f=Ue(S=>S.currentRoute),p=Ue(S=>S.setRoute),g=Ue(S=>S.userLocation),v=Ue(S=>S.setUserLocation),y=Ue(S=>S.setCameraPosition),A=2;return le.useEffect(()=>{g&&(i.position.set(g.position[0],A,g.position[2]),i.updateMatrixWorld());const S=E=>{u.current=Math.max(5,Math.min(100,u.current-E.deltaY*.05))},T=E=>{switch(E.code){case"ArrowUp":case"KeyW":e.current=!0;break;case"ArrowLeft":case"KeyA":n.current=!0;break;case"ArrowDown":case"KeyS":t.current=!0;break;case"ArrowRight":case"KeyD":r.current=!0;break}},M=E=>{switch(E.code){case"ArrowUp":case"KeyW":e.current=!1;break;case"ArrowLeft":case"KeyA":n.current=!1;break;case"ArrowDown":case"KeyS":t.current=!1;break;case"ArrowRight":case"KeyD":r.current=!1;break}};return document.addEventListener("keydown",T),document.addEventListener("keyup",M),document.addEventListener("wheel",S),()=>{document.removeEventListener("keydown",T),document.removeEventListener("keyup",M),document.removeEventListener("wheel",S)}},[i,v,g]),da((S,T)=>{s.current.x-=s.current.x*10*T,s.current.z-=s.current.z*10*T,o.current.z=Number(t.current)-Number(e.current),o.current.x=Number(r.current)-Number(n.current),o.current.normalize(),(e.current||t.current)&&(s.current.z-=o.current.z*u.current*T),(n.current||r.current)&&(s.current.x-=o.current.x*u.current*T);const E=2;S.camera.translateX(-s.current.x*T),S.camera.translateZ(-s.current.z*T),S.camera.position.y=E;const R=[S.camera.position.x,0,S.camera.position.z];if(y([S.camera.position.x,S.camera.position.y,S.camera.position.z]),v({position:R,rotation:S.camera.rotation.y,timestamp:new Date}),f){const I=new Q(f.to[0],0,f.to[2]);new Q(S.camera.position.x,0,S.camera.position.z).distanceTo(I)<2&&p(null)}}),D.jsx(oz,{})}let na=null;function BD(i){na=i}function lH(){const{camera:i}=Nn(),e=Ue(u=>u.cameraTarget),t=Ue(u=>u.setCameraTarget),n=Ue(u=>u.zones),r=le.useRef(null),s=le.useRef(null),o=le.useRef(null);return le.useEffect(()=>{var E;if(console.log("=== CameraController START ==="),console.log("cameraTarget:",e),console.log("zones count:",n.length),!e||typeof e!="string"){console.log("=== CameraController END - invalid target ===");return}const u=n.find(R=>R.id===e);if(console.log("Found zone:",u==null?void 0:u.name,u==null?void 0:u.id),console.log("Zone position:",u==null?void 0:u.position),console.log("Zone POI:",u==null?void 0:u.poi),!u){console.error("Zone not found:",e),t(null),console.log("=== CameraController END - zone not found ===");return}const f=u==null?void 0:u.poi;if(!f||!f.cameraPosition||!f.targetPosition){console.error("POI data missing or invalid:",f),t(null),console.log("=== CameraController END - POI missing ===");return}console.log("POI cameraPosition:",f.cameraPosition),console.log("POI targetPosition:",f.targetPosition),r.current&&cancelAnimationFrame(r.current);const p=new Q(...f.cameraPosition),g=new Q(...f.targetPosition);console.log("Current camera position:",i.position),console.log("Target camera position:",p),console.log("OrbitControls target before:",na==null?void 0:na.target),console.log("New OrbitControls target:",g),console.log("OrbitControls ref exists:",!!na),s.current=i.position.clone(),o.current=((E=na==null?void 0:na.target)==null?void 0:E.clone())||new Q(i.position.x,i.position.y,i.position.z);const v=Date.now(),y=2e3,A=Ue.getState().viewMode==="top";let S,T;if(A){T=new Q(...f.targetPosition);const R=(na==null?void 0:na.target)||new Q(0,0,0),I=new Q().subVectors(T,R);S=i.position.clone().add(I),console.log("Top-Down navigation: Panning to",T)}else S=new Q(...f.cameraPosition),T=new Q(...f.targetPosition);const M=()=>{const R=Date.now()-v,I=Math.min(R/y,1),O=I<.5?4*I*I*I:1-Math.pow(-2*I+2,3)/2;s.current&&(i.position.lerpVectors(s.current,S,O),na&&na.target?(na.target.lerpVectors(o.current,T,O),na.update()):i.lookAt(T)),I<1?r.current=requestAnimationFrame(M):(t(null),r.current=null,console.log("=== Animation completed ==="))};return M(),console.log("=== CameraController STARTING ANIMATION ==="),()=>{r.current&&cancelAnimationFrame(r.current)}},[e,i,t,n]),null}/**
 * postprocessing v6.38.2 build Mon Dec 22 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var dE=1/1e3,cH=1e3,uH=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(i){typeof document<"u"&&document.hidden!==void 0&&(i?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=i)}get delta(){return this._delta*dE}get fixedDelta(){return this._fixedDelta*dE}set fixedDelta(i){this._fixedDelta=i*cH}get elapsed(){return this._elapsed*dE}update(i){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(i!==void 0?i:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(i){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},dH=(()=>{const i=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new pn;return t.setAttribute("position",new jn(i,3)),t.setAttribute("uv",new jn(e,2)),t})(),Vs=class eM{static get fullscreenGeometry(){return dH}constructor(e="Pass",t=new Ad,n=new Ha){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Oi(eM.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Ad),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=Uo){}render(e,t,n,r,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof ti||t instanceof mr||t instanceof Jn||t instanceof eM)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},fH=class extends Vs{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(i,e,t,n,r){const s=i.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},hH=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,Um="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",ND=class extends ai{constructor(){super({name:"CopyMaterial",defines:{COLOR_SPACE_CONVERSION:"1",DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new Ne(null),depthBuffer:new Ne(null),channelWeights:new Ne(null),opacity:new Ne(1)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:hH,vertexShader:Um}),this.depthFunc=uv}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(i){const e=i!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=i}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(i){const e=i!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}get colorSpaceConversion(){return this.defines.COLOR_SPACE_CONVERSION!==void 0}set colorSpaceConversion(i){this.colorSpaceConversion!==i&&(i?this.defines.COLOR_SPACE_CONVERSION=!0:delete this.defines.COLOR_SPACE_CONVERSION,this.needsUpdate=!0)}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(i){i!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=i):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(i){this.uniforms.inputBuffer.value=i}getOpacity(i){return this.uniforms.opacity.value}setOpacity(i){this.uniforms.opacity.value=i}},OD=class extends Vs{constructor(i,e=!0){super("CopyPass"),this.fullscreenMaterial=new ND,this.needsSwap=!1,this.renderTarget=i,i===void 0&&(this.renderTarget=new ti(1,1,{minFilter:on,magFilter:on,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(i){this.autoResize=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(i){this.autoResize=i}render(i,e,t,n,r){this.fullscreenMaterial.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){this.autoResize&&this.renderTarget.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==_i?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":i!==null&&i.outputColorSpace===Hn&&(this.renderTarget.texture.colorSpace=Hn))}},dR=new Ft,UT=class extends Vs{constructor(i=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=i,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(i,e,t){this.color=i,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(i){this.overrideClearColor=i}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(i){this.overrideClearAlpha=i}render(i,e,t,n,r){const s=this.overrideClearColor,o=this.overrideClearAlpha,u=i.getClearAlpha(),f=s!==null,p=o>=0;f?(i.getClearColor(dR),i.setClearColor(s,p?o:u)):p&&i.setClearAlpha(o),i.setRenderTarget(this.renderToScreen?null:e),i.clear(this.color,this.depth,this.stencil),f?i.setClearColor(dR,u):p&&i.setClearAlpha(u)}},pH=class extends Vs{constructor(i,e){super("MaskPass",i,e),this.needsSwap=!1,this.clearPass=new UT(!1,!1,!0),this.inverse=!1}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get inverted(){return this.inverse}set inverted(i){this.inverse=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(i){this.inverted=i}render(i,e,t,n,r){const s=i.getContext(),o=i.state.buffers,u=this.scene,f=this.camera,p=this.clearPass,g=this.inverted?0:1,v=1-g;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,g,4294967295),o.stencil.setClear(v),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?p.render(i,null):(p.render(i,e),p.render(i,t))),this.renderToScreen?(i.setRenderTarget(null),i.render(u,f)):(i.setRenderTarget(e),i.render(u,f),i.setRenderTarget(t),i.render(u,f)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},mH=class{constructor(i=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:n=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,r,n),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new OD,this.depthTexture=null,this.passes=[],this.timer=new uH,this.autoRenderToScreen=!0,this.setRenderer(i)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(i){const e=this.inputBuffer,t=this.multisampling;t>0&&i>0?(this.inputBuffer.samples=i,this.outputBuffer.samples=i,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==i&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,i),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(i){if(this.renderer=i,i!==null){const e=i.getSize(new qe),t=i.getContext().getContextAttributes().alpha,n=this.inputBuffer.texture.type;n===_i&&i.outputColorSpace===Hn&&(this.inputBuffer.texture.colorSpace=Hn,this.outputBuffer.texture.colorSpace=Hn,this.inputBuffer.dispose(),this.outputBuffer.dispose()),i.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(i,t,n)}}replaceRenderer(i,e=!0){const t=this.renderer,n=t.domElement.parentNode;return this.setRenderer(i),e&&n!==null&&(n.removeChild(t.domElement),n.appendChild(i.domElement)),t}createDepthTexture(){const i=this.depthTexture=new _d;return this.inputBuffer.depthTexture=i,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(i.format=nu,i.type=Zf):i.type=ca,i}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const i of this.passes)i.setDepthTexture(null)}}createBuffer(i,e,t,n){const r=this.renderer,s=r===null?new qe:r.getDrawingBufferSize(new qe),o={minFilter:on,magFilter:on,stencilBuffer:e,depthBuffer:i,type:t},u=new ti(s.width,s.height,o);return n>0&&(u.samples=n),t===_i&&r!==null&&r.outputColorSpace===Hn&&(u.texture.colorSpace=Hn),u.texture.name="EffectComposer.Buffer",u.texture.generateMipmaps=!1,u}setMainScene(i){for(const e of this.passes)e.mainScene=i}setMainCamera(i){for(const e of this.passes)e.mainCamera=i}addPass(i,e){const t=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new qe),s=n.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(i.setRenderer(n),i.setSize(r.width,r.height),i.initialize(n,s,o),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),i.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,i):t.push(i),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),i.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const u=this.createDepthTexture();for(i of t)i.setDepthTexture(u)}else i.setDepthTexture(this.depthTexture)}removePass(i){const e=this.passes,t=e.indexOf(i);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const s=(u,f)=>u||f.needsDepthTexture;e.reduce(s,!1)||(i.getDepthTexture()===this.depthTexture&&i.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(i.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const i=this.passes;this.deleteDepthTexture(),i.length>0&&(this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!1),this.passes=[])}render(i){const e=this.renderer,t=this.copyPass;let n=this.inputBuffer,r=this.outputBuffer,s=!1,o,u,f;i===void 0&&(this.timer.update(),i=this.timer.getDelta());for(const p of this.passes)p.enabled&&(p.render(e,n,r,i,s),p.needsSwap&&(s&&(t.renderToScreen=p.renderToScreen,o=e.getContext(),u=e.state.buffers.stencil,u.setFunc(o.NOTEQUAL,1,4294967295),t.render(e,n,r,i,s),u.setFunc(o.EQUAL,1,4294967295)),f=n,n=r,r=f),p instanceof pH?s=!0:p instanceof fH&&(s=!1))}setSize(i,e,t){const n=this.renderer,r=n.getSize(new qe);(i===void 0||e===void 0)&&(i=r.width,e=r.height),(r.width!==i||r.height!==e)&&n.setSize(i,e,t);const s=n.getDrawingBufferSize(new qe);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const o of this.passes)o.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const i of this.passes)i.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Vs.fullscreenGeometry.dispose()}},la={NONE:0,DEPTH:1,CONVOLUTION:2},ui={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},gH=class{constructor(){this.shaderParts=new Map([[ui.FRAGMENT_HEAD,null],[ui.FRAGMENT_MAIN_UV,null],[ui.FRAGMENT_MAIN_IMAGE,null],[ui.VERTEX_HEAD,null],[ui.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=la.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=kr}},fE=!1,fR=class{constructor(i=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(i),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case Vr:t=this.materialsFlatShadedDoubleSide;break;case jr:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case Vr:t=this.materialsDoubleSide;break;case jr:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(i){if(!(i instanceof ai))return i.clone();const e=i.uniforms,t=new Map;for(const r in e){const s=e[r].value;s.isRenderTargetTexture&&(e[r].value=null,t.set(r,s))}const n=i.clone();for(const r of t)e[r[0]].value=r[1],n.uniforms[r[0]].value=r[1];return n}setMaterial(i){if(this.disposeMaterials(),this.material=i,i!==null){const e=this.materials=[this.cloneMaterial(i),this.cloneMaterial(i),this.cloneMaterial(i)];for(const t of e)t.uniforms=Object.assign({},i.uniforms),t.side=ml;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=jr,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.side=Vr,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=jr,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},i.uniforms),n.flatShading=!0,n.side=Vr,n})}}render(i,e,t){const n=i.shadowMap.enabled;if(i.shadowMap.enabled=!1,fE){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),i.render(e,t);for(const s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,i.render(e,t),e.overrideMaterial=r}i.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const i=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of i)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return fE}static set workaroundEnabled(i){fE=i}},ld=-1,Er=class extends eo{constructor(i,e=ld,t=ld,n=1){super(),this.resizable=i,this.baseSize=new qe(1,1),this.preferredSize=new qe(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new qe,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const i=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==ld?t.width=e.width:e.height!==ld?t.width=Math.round(e.height*(i.width/Math.max(i.height,1))):t.width=Math.round(i.width*n),e.height!==ld?t.height=e.height:e.width!==ld?t.height=Math.round(e.width/Math.max(i.width/Math.max(i.height,1),1)):t.height=Math.round(i.height*n)}get width(){return this.effectiveSize.width}set width(i){this.preferredWidth=i}get height(){return this.effectiveSize.height}set height(i){this.preferredHeight=i}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(i){this.s!==i&&(this.s=i,this.preferredSize.setScalar(ld),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(i){this.scale=i}get baseWidth(){return this.baseSize.width}set baseWidth(i){this.baseSize.width!==i&&(this.baseSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(i){this.baseWidth=i}get baseHeight(){return this.baseSize.height}set baseHeight(i){this.baseSize.height!==i&&(this.baseSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(i){this.baseHeight=i}setBaseSize(i,e){(this.baseSize.width!==i||this.baseSize.height!==e)&&(this.baseSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(i){this.preferredSize.width!==i&&(this.preferredSize.width=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(i){this.preferredWidth=i}get preferredHeight(){return this.preferredSize.height}set preferredHeight(i){this.preferredSize.height!==i&&(this.preferredSize.height=i,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(i){this.preferredHeight=i}setPreferredSize(i,e){(this.preferredSize.width!==i||this.preferredSize.height!==e)&&(this.preferredSize.set(i,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(i){this.s=i.scale,this.baseSize.set(i.baseWidth,i.baseHeight),this.preferredSize.set(i.preferredWidth,i.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ld}},bn={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},vH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",xH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,src.a*opacity);}",yH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=(dst.rgb+src.rgb)*0.5;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",AH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.xy,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",_H="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/max(b,1e-9))),vec3(1.0),step(1.0,a));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",SH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",bH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",EH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=abs(dst.rgb-src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",MH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb/max(src.rgb,1e-9);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",TH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-2.0*dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",wH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb,1.0);vec3 b=min(src.rgb,1.0);vec3 c=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",CH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=step(1.0,dst.rgb+src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",RH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.x,a.yz));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",DH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",IH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=src.rgb*max(1.0-dst.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",BH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",NH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",OH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb+src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",LH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(2.0*src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",PH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.xy,b.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",UH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",FH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-abs(1.0-dst.rgb-src.rgb),0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",zH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,opacity);}",HH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=2.0*src.rgb*dst.rgb;vec3 b=1.0-2.0*(1.0-src.rgb)*(1.0-dst.rgb);vec3 c=mix(a,b,step(0.5,dst.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",GH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 c=mix(mix(src2,dst.rgb,step(0.5*dst.rgb,src.rgb)),max(src2-1.0,vec3(0.0)),step(dst.rgb,src2-1.0));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",kH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb*dst.rgb/max(1.0-src.rgb,1e-9),1.0);vec3 c=mix(a,src.rgb,step(1.0,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",VH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.x,b.y,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",jH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-min(dst.rgb*src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",WH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 d=dst.rgb+(src2-1.0);vec3 w=step(0.5,src.rgb);vec3 a=dst.rgb-(1.0-src2)*dst.rgb*(1.0-dst.rgb);vec3 b=mix(d*(sqrt(dst.rgb)-dst.rgb),d*dst.rgb*((16.0*dst.rgb-12.0)*dst.rgb+3.0),w*(1.0-step(0.25,dst.rgb)));vec3 c=mix(a,b,w);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",XH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return src;}",YH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",QH="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=mix(max(1.0-min((1.0-dst.rgb)/(2.0*src.rgb),1.0),0.0),min(dst.rgb/(2.0*(1.0-src.rgb)),1.0),step(0.5,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",qH=new Map([[bn.ADD,vH],[bn.ALPHA,xH],[bn.AVERAGE,yH],[bn.COLOR,AH],[bn.COLOR_BURN,_H],[bn.COLOR_DODGE,SH],[bn.DARKEN,bH],[bn.DIFFERENCE,EH],[bn.DIVIDE,MH],[bn.DST,null],[bn.EXCLUSION,TH],[bn.HARD_LIGHT,wH],[bn.HARD_MIX,CH],[bn.HUE,RH],[bn.INVERT,DH],[bn.INVERT_RGB,IH],[bn.LIGHTEN,BH],[bn.LINEAR_BURN,NH],[bn.LINEAR_DODGE,OH],[bn.LINEAR_LIGHT,LH],[bn.LUMINOSITY,PH],[bn.MULTIPLY,UH],[bn.NEGATION,FH],[bn.NORMAL,zH],[bn.OVERLAY,HH],[bn.PIN_LIGHT,GH],[bn.REFLECT,kH],[bn.SATURATION,VH],[bn.SCREEN,jH],[bn.SOFT_LIGHT,WH],[bn.SRC,XH],[bn.SUBTRACT,YH],[bn.VIVID_LIGHT,QH]]),JH=class extends eo{constructor(i,e=1){super(),this._blendFunction=i,this.opacity=new Ne(e)}getOpacity(){return this.opacity.value}setOpacity(i){this.opacity.value=i}get blendFunction(){return this._blendFunction}set blendFunction(i){this._blendFunction=i,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(i){this.blendFunction=i}getShaderCode(){return qH.get(this.blendFunction)}},ua=class extends eo{constructor(i,e,{attributes:t=la.NONE,blendFunction:n=bn.NORMAL,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:u=null}={}){super(),this.name=i,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=u,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new JH(n),this.blendMode.addEventListener("change",f=>this.setChanged()),this._inputColorSpace=kr,this._outputColorSpace=Ja}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(i){this._inputColorSpace=i,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(i){this._outputColorSpace=i,this.setChanged()}set mainScene(i){}set mainCamera(i){}getName(){return this.name}setRenderer(i){this.renderer=i}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(i){this.attributes=i,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(i){this.fragmentShader=i,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(i){this.vertexShader=i,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(i,e=Uo){}update(i,e,t){}setSize(i,e){}initialize(i,e,t){}dispose(){for(const i of Object.keys(this)){const e=this[i];(e instanceof ti||e instanceof mr||e instanceof Jn||e instanceof Vs)&&this[i].dispose()}}},Qv={SMALL:1,MEDIUM:2,LARGE:3},KH=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,ZH="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",$H=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],eG=class extends ai{constructor(i=new Ti){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ne(null),texelSize:new Ne(new Ti),scale:new Ne(1),kernel:new Ne(0)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:KH,vertexShader:ZH}),this.setTexelSize(i.x,i.y),this.kernelSize=Qv.MEDIUM}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.inputBuffer=i}get kernelSequence(){return $H[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(i){this.uniforms.scale.value=i}getScale(){return this.uniforms.scale.value}setScale(i){this.uniforms.scale.value=i}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(i){this.uniforms.kernel.value=i}setKernel(i){this.kernel=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e,i*.5,e*.5)}setSize(i,e){const t=1/i,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},FT=class extends Vs{constructor({kernelSize:i=Qv.MEDIUM,resolutionScale:e=.5,width:t=Er.AUTO_SIZE,height:n=Er.AUTO_SIZE,resolutionX:r=t,resolutionY:s=n}={}){super("KawaseBlurPass"),this.renderTargetA=new ti(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new Er(this,r,s,e);o.addEventListener("change",u=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new eG,this._blurMaterial.kernelSize=i,this.copyMaterial=new ND}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(i){this._blurMaterial=i}get dithering(){return this.copyMaterial.dithering}set dithering(i){this.copyMaterial.dithering=i}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(i){this.blurMaterial.kernelSize=i}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get scale(){return this.blurMaterial.scale}set scale(i){this.blurMaterial.scale=i}getScale(){return this.blurMaterial.scale}setScale(i){this.blurMaterial.scale=i}getKernelSize(){return this.kernelSize}setKernelSize(i){this.kernelSize=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,r){const s=this.scene,o=this.camera,u=this.renderTargetA,f=this.renderTargetB,p=this.blurMaterial,g=p.kernelSequence;let v=e;this.fullscreenMaterial=p;for(let y=0,A=g.length;y<A;++y){const S=(y&1)===0?u:f;p.kernel=g[y],p.inputBuffer=v.texture,i.setRenderTarget(S),i.render(s,o),v=S}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=v.texture,i.setRenderTarget(this.renderToScreen?null:t),i.render(s,o)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e);const n=t.width,r=t.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(i,e)}initialize(i,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==_i?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):i!==null&&i.outputColorSpace===Hn&&(this.renderTargetA.texture.colorSpace=Hn,this.renderTargetB.texture.colorSpace=Hn))}static get AUTO_SIZE(){return Er.AUTO_SIZE}},tG=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,nG=class extends ai{constructor(i=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:lu.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ne(null),threshold:new Ne(0),smoothing:new Ne(1),range:new Ne(null)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:tG,vertexShader:Um}),this.colorOutput=i,this.luminanceRange=e}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get threshold(){return this.uniforms.threshold.value}set threshold(i){this.smoothing>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=i}getThreshold(){return this.threshold}setThreshold(i){this.threshold=i}get smoothing(){return this.uniforms.smoothing.value}set smoothing(i){this.threshold>0||i>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=i}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(i){this.smoothing=i}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(i){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(i){i?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(i){return this.colorOutput}setColorOutputEnabled(i){this.colorOutput=i}get useRange(){return this.luminanceRange!==null}set useRange(i){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(i){i!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=i,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(i){this.luminanceRange=i}},LD=class extends Vs{constructor({renderTarget:i,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:r=Er.AUTO_SIZE,height:s=Er.AUTO_SIZE,resolutionX:o=r,resolutionY:u=s}={}){super("LuminancePass"),this.fullscreenMaterial=new nG(t,e),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new ti(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const f=this.resolution=new Er(this,o,u,n);f.addEventListener("change",p=>this.setSize(f.baseWidth,f.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(i,e,t,n,r){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}initialize(i,e,t){t!==void 0&&t!==_i&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},iG=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,rG="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",sG=class extends ai{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Ne(null),texelSize:new Ne(new qe)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:iG,vertexShader:rG})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},aG=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,oG="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",lG=class extends ai{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Ne(null),supportBuffer:new Ne(null),texelSize:new Ne(new qe),radius:new Ne(.85)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:aG,vertexShader:oG})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}set supportBuffer(i){this.uniforms.supportBuffer.value=i}get radius(){return this.uniforms.radius.value}set radius(i){this.uniforms.radius.value=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},PD=class extends Vs{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new ti(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new sG,this.upsamplingMaterial=new lG,this.resolution=new qe}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(i){if(this.levels!==i){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<i;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=i-1;t<n;++t){const r=e.clone();r.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(r)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(i){this.upsamplingMaterial.radius=i}render(i,e,t,n,r){const{scene:s,camera:o}=this,{downsamplingMaterial:u,upsamplingMaterial:f}=this,{downsamplingMipmaps:p,upsamplingMipmaps:g}=this;let v=e;this.fullscreenMaterial=u;for(let y=0,A=p.length;y<A;++y){const S=p[y];u.setSize(v.width,v.height),u.inputBuffer=v.texture,i.setRenderTarget(S),i.render(s,o),v=S}this.fullscreenMaterial=f;for(let y=g.length-1;y>=0;--y){const A=g[y];f.setSize(v.width,v.height),f.inputBuffer=v.texture,f.supportBuffer=p[y].texture,i.setRenderTarget(A),i.render(s,o),v=A}}setSize(i,e){const t=this.resolution;t.set(i,e);let n=t.width,r=t.height;for(let s=0,o=this.downsamplingMipmaps.length;s<o;++s)n=Math.round(n*.5),r=Math.round(r*.5),this.downsamplingMipmaps[s].setSize(n,r),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(n,r)}initialize(i,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const r of n)r.texture.type=t;if(t!==_i)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(i!==null&&i.outputColorSpace===Hn)for(const r of n)r.texture.colorSpace=Hn}}dispose(){super.dispose();for(const i of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))i.dispose()}},cG=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv)*intensity;}`,uG=class extends ua{constructor({blendFunction:i=bn.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:n=!0,intensity:r=1,radius:s=.85,levels:o=8,kernelSize:u=Qv.LARGE,resolutionScale:f=.5,width:p=Er.AUTO_SIZE,height:g=Er.AUTO_SIZE,resolutionX:v=p,resolutionY:y=g}={}){super("BloomEffect",cG,{blendFunction:i,uniforms:new Map([["map",new Ne(null)],["intensity",new Ne(r)]])}),this.renderTarget=new ti(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new FT({kernelSize:u}),this.luminancePass=new LD({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new PD,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const A=this.resolution=new Er(this,v,y,f);A.addEventListener("change",S=>this.setSize(A.baseWidth,A.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(i){this.resolution.preferredWidth=i}get height(){return this.resolution.height}set height(i){this.resolution.preferredHeight=i}get dithering(){return this.blurPass.dithering}set dithering(i){this.blurPass.dithering=i}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(i){this.blurPass.kernelSize=i}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(i){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(i){this.uniforms.get("intensity").value=i}getIntensity(){return this.intensity}setIntensity(i){this.intensity=i}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}update(i,e,t){const n=this.renderTarget,r=this.luminancePass;r.enabled?(r.render(i,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,r.renderTarget):this.blurPass.render(i,r.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(i,e):this.blurPass.render(i,e,n)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(i,e),this.mipmapBlurPass.setSize(i,e)}initialize(i,e,t){this.blurPass.initialize(i,e,t),this.luminancePass.initialize(i,e,t),this.mipmapBlurPass.initialize(i,e,t),t!==void 0&&(this.renderTarget.texture.type=t,i!==null&&i.outputColorSpace===Hn&&(this.renderTarget.texture.colorSpace=Hn))}},dG="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(color+vec3(0.5),inputColor.a);}",fG=class extends ua{constructor({blendFunction:i=bn.SRC,brightness:e=0,contrast:t=0}={}){super("BrightnessContrastEffect",dG,{blendFunction:i,uniforms:new Map([["brightness",new Ne(e)],["contrast",new Ne(t)]])}),this.inputColorSpace=Hn}get brightness(){return this.uniforms.get("brightness").value}set brightness(i){this.uniforms.get("brightness").value=i}getBrightness(){return this.brightness}setBrightness(i){this.brightness=i}get contrast(){return this.uniforms.get("contrast").value}set contrast(i){this.uniforms.get("contrast").value=i}getContrast(){return this.contrast}setContrast(i){this.contrast=i}},hG=`#ifdef RADIAL_MODULATION
uniform float modulationOffset;
#endif
varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=inputColor.ra;vec2 ba=inputColor.ba;
#ifdef RADIAL_MODULATION
const vec2 center=vec2(0.5);float d=distance(uv,center)*2.0;d=max(d-modulationOffset,0.0);if(vActive>0.0&&d>0.0){ra=texture2D(inputBuffer,mix(uv,vUvR,d)).ra;ba=texture2D(inputBuffer,mix(uv,vUvB,d)).ba;}
#else
if(vActive>0.0){ra=texture2D(inputBuffer,vUvR).ra;ba=texture2D(inputBuffer,vUvB).ba;}
#endif
outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}`,pG="uniform vec2 offset;varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vActive=(shift.x!=0.0||shift.y!=0.0)?1.0:0.0;vUvR=uv+shift;vUvB=uv-shift;}",mG=class extends ua{constructor({offset:i=new qe(.001,5e-4),radialModulation:e=!1,modulationOffset:t=.15}={}){super("ChromaticAberrationEffect",hG,{vertexShader:pG,attributes:la.CONVOLUTION,uniforms:new Map([["offset",new Ne(i)],["modulationOffset",new Ne(t)]])}),this.radialModulation=e}get offset(){return this.uniforms.get("offset").value}set offset(i){this.uniforms.get("offset").value=i}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(i){i?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(i){this.uniforms.get("modulationOffset").value=i}getOffset(){return this.offset}setOffset(i){this.offset=i}},UD={RED:0,GREEN:1},zT={DISCARD:0,MULTIPLY_RGB_SET_ALPHA:2,MULTIPLY_RGB:3},gG=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 cocNearFar=texture2D(cocBuffer,vUv).rg*scale;float coc=cocNearFar.x;
#else
float coc=texture2D(cocBuffer,vUv).g*scale;
#endif
if(coc==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(cocNearFar.x,cocNearFar.y);
#else
vec2 step=texelSize*coc;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,By=class extends ai{constructor(i=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:i?"2":"1"},uniforms:{inputBuffer:new Ne(null),cocBuffer:new Ne(null),texelSize:new Ne(new qe),kernel64:new Ne(null),kernel16:new Ne(null),scale:new Ne(1)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:gG,vertexShader:Um}),e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}set cocBuffer(i){this.uniforms.cocBuffer.value=i}setCoCBuffer(i){this.uniforms.cocBuffer.value=i}get scale(){return this.uniforms.scale.value}set scale(i){this.uniforms.scale.value=i}getScale(i){return this.scale}setScale(i){this.scale=i}generateKernel(){const i=2.39996323,e=new Float64Array(128),t=new Float64Array(32);let n=0,r=0;for(let s=0,o=Math.sqrt(80);s<80;++s){const u=s*i,f=Math.sqrt(s)/o,p=f*Math.cos(u),g=f*Math.sin(u);s%5===0?(t[r++]=p,t[r++]=g):(e[n++]=p,e[n++]=g)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e)}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},vG=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform mat4 projectionMatrix;uniform mat4 projectionMatrixInverse;uniform float cameraNear;uniform float cameraFar;uniform float focusDistance;uniform float focusRange;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}
#ifdef PERSPECTIVE_CAMERA
#define getViewZ(depth) perspectiveDepthToViewZ(depth, cameraNear, cameraFar)
#else
#define getViewZ(depth) orthographicDepthToViewZ(depth, cameraNear, cameraFar)
#endif
vec3 getViewPosition(const in vec2 screenPosition,const in float depth,const in float viewZ){vec4 clipPosition=vec4(vec3(screenPosition,depth)*2.0-1.0,1.0);float clipW=projectionMatrix[2][3]*viewZ+projectionMatrix[3][3];clipPosition*=clipW;return(projectionMatrixInverse*clipPosition).xyz;}vec3 getViewPosition(const in vec2 screenPosition,const in float depth){return getViewPosition(screenPosition,depth,getViewZ(depth));}
#define getDistance(viewPosition) length(viewPosition)
void main(){float depth=readDepth(vUv);vec3 viewPosition=getViewPosition(vUv,depth);float distance=getDistance(viewPosition);float signedDistance=distance-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,xG=class extends ai{constructor(i=null){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ne(null),projectionMatrix:new Ne(null),projectionMatrixInverse:new Ne(null),cameraNear:new Ne(.3),cameraFar:new Ne(1e3),focusDistance:new Ne(0),focusRange:new Ne(0)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:vG,vertexShader:Um}),this.uniforms.focalLength=this.uniforms.focusRange,i!==null&&this.copyCameraSettings(i)}set depthBuffer(i){this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=Uo){this.depthBuffer=i,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(i){this.uniforms.focusDistance.value=i}get worldFocusDistance(){return this.focusDistance}set worldFocusDistance(i){this.focusDistance=i}getFocusDistance(i){this.uniforms.focusDistance.value=i}setFocusDistance(i){this.uniforms.focusDistance.value=i}get focalLength(){return this.focusRange}set focalLength(i){this.focusRange=i}get focusRange(){return this.uniforms.focusRange.value}set focusRange(i){this.uniforms.focusRange.value=i}get worldFocusRange(){return this.focusRange}set worldFocusRange(i){this.focusRange=i}getFocalLength(i){return this.focusRange}setFocalLength(i){this.focusRange=i}adoptCameraSettings(i){this.copyCameraSettings(i)}copyCameraSettings(i){this.uniforms.projectionMatrix.value=i.projectionMatrix,this.uniforms.projectionMatrixInverse.value=i.projectionMatrixInverse,this.uniforms.cameraNear.value=i.near,this.uniforms.cameraFar.value=i.far;const e=this.defines.PERSPECTIVE_CAMERA!==void 0;i instanceof ki?e||(this.defines.PERSPECTIVE_CAMERA=!0,this.needsUpdate=!0):e&&(delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},yG=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=(mask>0.0)?0.0:1.0;
#else
mask=(mask>0.0)?1.0:0.0;
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 3
vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=vec4(mask*texel.rgb,texel.a);
#elif MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,AG=class extends ai{constructor(i=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Ne(i),inputBuffer:new Ne(null),strength:new Ne(1)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:yG,vertexShader:Um}),this.colorChannel=UD.RED,this.maskFunction=zT.DISCARD}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}set maskTexture(i){this.uniforms.maskTexture.value=i,delete this.defines.MASK_PRECISION_HIGH,i.type!==_i&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(i){this.maskTexture=i}set colorChannel(i){this.defines.COLOR_CHANNEL=i.toFixed(0),this.needsUpdate=!0}setColorChannel(i){this.colorChannel=i}set maskFunction(i){this.defines.MASK_FUNCTION=i.toFixed(0),this.needsUpdate=!0}setMaskFunction(i){this.maskFunction=i}get inverted(){return this.defines.INVERTED!==void 0}set inverted(i){this.inverted&&!i?delete this.defines.INVERTED:i&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(i){this.inverted=i}get strength(){return this.uniforms.strength.value}set strength(i){this.uniforms.strength.value=i}getStrength(){return this.strength}setStrength(i){this.strength=i}},Zl=class extends Vs{constructor(i,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=i,this.input=e}setInput(i){this.input=i}render(i,e,t,n,r){const s=this.fullscreenMaterial.uniforms;e!==null&&s!==void 0&&s[this.input]!==void 0&&(s[this.input].value=e.texture),i.setRenderTarget(this.renderToScreen?null:t),i.render(this.scene,this.camera)}initialize(i,e,t){t!==void 0&&t!==_i&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},_G=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
#if MASK_FUNCTION != 1 && MASK_FUNCTION != 2
uniform lowp sampler2D farCoCBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);
#if MASK_FUNCTION == 1 || MASK_FUNCTION == 2
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,colorFar.a);cocNearFar.x=min(cocNearFar.x*scale,1.0);
#else
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,texture2D(farCoCBuffer,uv).g);cocNearFar=min(cocNearFar*scale,1.0);colorFar.a*=cocNearFar.y;
#endif
vec4 result=inputColor*(1.0-cocNearFar.y)+colorFar;result=mix(result,colorNear,cocNearFar.x);outputColor=result;}`,SG=new Q,bG=class extends ua{constructor(i,{blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focalLength:r,focusDistance:s=t||3,focusRange:o=n||r||2,bokehScale:u=1,resolutionScale:f=.5,width:p,height:g,resolutionX:v=p||Er.AUTO_SIZE,resolutionY:y=g||Er.AUTO_SIZE}={}){super("DepthOfFieldEffect",_G,{blendFunction:e,attributes:la.DEPTH,uniforms:new Map([["nearColorBuffer",new Ne(null)],["farColorBuffer",new Ne(null)],["nearCoCBuffer",new Ne(null)],["farCoCBuffer",new Ne(null)],["scale",new Ne(1)]])}),this.camera=i,this.renderTarget=new ti(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.uniforms.get("farCoCBuffer").value=this.renderTargetCoC.texture,this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Zl(new xG(i));const A=this.cocMaterial;A.focusDistance=s,A.focusRange=o,this.blurPass=new FT({resolutionScale:f,resolutionX:v,resolutionY:y,kernelSize:Qv.MEDIUM}),this.maskPass=new Zl(new AG(this.renderTargetCoC.texture));const S=this.maskPass.fullscreenMaterial;S.colorChannel=UD.GREEN,this.maskFunction=zT.MULTIPLY_RGB,this.bokehNearBasePass=new Zl(new By(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Zl(new By(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Zl(new By(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Zl(new By(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const T=this.resolution=new Er(this,v,y,f);T.addEventListener("change",M=>this.setSize(T.baseWidth,T.baseHeight)),this.bokehScale=u}set mainCamera(i){this.camera=i,this.cocMaterial.copyCameraSettings(i)}get cocTexture(){return this.renderTargetCoC.texture}get maskFunction(){return this.maskPass.fullscreenMaterial.maskFunction}set maskFunction(i){this.maskFunction!==i&&(this.defines.set("MASK_FUNCTION",i.toFixed(0)),this.maskPass.fullscreenMaterial.maskFunction=i,this.setChanged())}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.cocMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(i){this.bokehNearBasePass.fullscreenMaterial.scale=i,this.bokehNearFillPass.fullscreenMaterial.scale=i,this.bokehFarBasePass.fullscreenMaterial.scale=i,this.bokehFarFillPass.fullscreenMaterial.scale=i,this.maskPass.fullscreenMaterial.strength=i,this.uniforms.get("scale").value=i}getBokehScale(){return this.bokehScale}setBokehScale(i){this.bokehScale=i}getTarget(){return this.target}setTarget(i){this.target=i}calculateFocusDistance(i){return this.camera.getWorldPosition(SG).distanceTo(i)}setDepthTexture(i,e=Uo){this.cocMaterial.depthBuffer=i,this.cocMaterial.depthPacking=e}update(i,e,t){const n=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){const u=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=u}this.cocPass.render(i,null,r),this.blurPass.render(i,r,s),this.maskPass.render(i,e,o),this.bokehFarBasePass.render(i,o,n),this.bokehFarFillPass.render(i,n,this.renderTargetFar),this.bokehNearBasePass.render(i,e,n),this.bokehNearFillPass.render(i,n,this.renderTargetNear)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e);const n=t.width,r=t.height;this.cocPass.setSize(i,e),this.blurPass.setSize(i,e),this.maskPass.setSize(i,e),this.renderTargetFar.setSize(i,e),this.renderTargetCoC.setSize(i,e),this.renderTargetMasked.setSize(i,e),this.renderTarget.setSize(n,r),this.renderTargetNear.setSize(n,r),this.renderTargetCoCBlurred.setSize(n,r),this.bokehNearBasePass.fullscreenMaterial.setSize(i,e),this.bokehNearFillPass.fullscreenMaterial.setSize(i,e),this.bokehFarBasePass.fullscreenMaterial.setSize(i,e),this.bokehFarFillPass.fullscreenMaterial.setSize(i,e)}initialize(i,e,t){this.cocPass.initialize(i,e,t),this.maskPass.initialize(i,e,t),this.bokehNearBasePass.initialize(i,e,t),this.bokehNearFillPass.initialize(i,e,t),this.bokehFarBasePass.initialize(i,e,t),this.bokehFarFillPass.initialize(i,e,t),this.blurPass.initialize(i,e,_i),i.capabilities.logarithmicDepthBuffer&&(this.cocPass.fullscreenMaterial.defines.LOG_DEPTH="1"),t!==void 0&&(this.renderTarget.texture.type=t,this.renderTargetNear.texture.type=t,this.renderTargetFar.texture.type=t,this.renderTargetMasked.texture.type=t,i!==null&&i.outputColorSpace===Hn&&(this.renderTarget.texture.colorSpace=Hn,this.renderTargetNear.texture.colorSpace=Hn,this.renderTargetFar.texture.colorSpace=Hn,this.renderTargetMasked.texture.colorSpace=Hn))}},HT=class extends Vs{constructor(i,e,t=null){super("RenderPass",i,e),this.needsSwap=!1,this.clearPass=new UT,this.overrideMaterialManager=t===null?null:new fR(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(i){this.scene=i}set mainCamera(i){this.camera=i}get renderToScreen(){return super.renderToScreen}set renderToScreen(i){super.renderToScreen=i,this.clearPass.renderToScreen=i}get overrideMaterial(){const i=this.overrideMaterialManager;return i!==null?i.material:null}set overrideMaterial(i){const e=this.overrideMaterialManager;i!==null?e!==null?e.setMaterial(i):this.overrideMaterialManager=new fR(i):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(i){this.overrideMaterial=i}get clear(){return this.clearPass.enabled}set clear(i){this.clearPass.enabled=i}getSelection(){return this.selection}setSelection(i){this.selection=i}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(i){this.ignoreBackground=i}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(i){this.skipShadowMapUpdate=i}getClearPass(){return this.clearPass}render(i,e,t,n,r){const s=this.scene,o=this.camera,u=this.selection,f=o.layers.mask,p=s.background,g=i.shadowMap.autoUpdate,v=this.renderToScreen?null:e;u!==null&&o.layers.set(u.getLayer()),this.skipShadowMapUpdate&&(i.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(i,e),i.setRenderTarget(v),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(i,s,o):i.render(s,o),o.layers.mask=f,s.background=p,i.shadowMap.autoUpdate=g}},EG="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",MG=class extends ua{constructor({blendFunction:i=bn.SRC,hue:e=0,saturation:t=0}={}){super("HueSaturationEffect",EG,{blendFunction:i,uniforms:new Map([["hue",new Ne(new Q)],["saturation",new Ne(t)]])}),this.hue=e}get saturation(){return this.uniforms.get("saturation").value}set saturation(i){this.uniforms.get("saturation").value=i}getSaturation(){return this.saturation}setSaturation(i){this.saturation=i}get hue(){const i=this.uniforms.get("hue").value;return Math.acos((i.x*3-1)/2)}set hue(i){const e=Math.sin(i),t=Math.cos(i);this.uniforms.get("hue").value.set((2*t+1)/3,(-Math.sqrt(3)*e-t+1)/3,(Math.sqrt(3)*e-t+1)/3)}getHue(){return this.hue}setHue(i){this.hue=i}},FD={COLOR:2},TG={DISABLED:0},Bg={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Ir={LINEAR:0,REINHARD:1,REINHARD2:2,REINHARD2_ADAPTIVE:3,OPTIMIZED_CINEON:5,CINEON:5,ACES_FILMIC:6,AGX:7,NEUTRAL:8},Ng={DEFAULT:0,ESKIL:1},wG=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,CG=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,RG=class extends ai{constructor(i=new qe,e=FD.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:lu.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new Ne(null),depthBuffer:new Ne(null),predicationBuffer:new Ne(null),texelSize:new Ne(i)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:wG,vertexShader:CG}),this.edgeDetectionMode=e}set depthBuffer(i){this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=Uo){this.depthBuffer=i,this.depthPacking=e}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(i){this.defines.EDGE_DETECTION_MODE=i.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(i){this.edgeDetectionMode=i}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(i){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=i.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(i){this.localContrastAdaptationFactor=i}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(i){this.defines.EDGE_THRESHOLD=i.toFixed("6"),this.defines.DEPTH_THRESHOLD=(i*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(i){this.edgeDetectionThreshold=i}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(i){this.defines.PREDICATION_MODE=i.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(i){this.predicationMode=i}set predicationBuffer(i){this.uniforms.predicationBuffer.value=i}setPredicationBuffer(i){this.uniforms.predicationBuffer.value=i}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(i){this.defines.PREDICATION_THRESHOLD=i.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(i){this.predicationThreshold=i}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(i){this.defines.PREDICATION_SCALE=i.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(i){this.predicationScale=i}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(i){this.defines.PREDICATION_STRENGTH=i.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(i){this.predicationStrength=i}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},DG=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,IG="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",BG=class extends ai{constructor(i=new qe,e=new qe){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new Ne(null),searchTexture:new Ne(null),areaTexture:new Ne(null),resolution:new Ne(e),texelSize:new Ne(i)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:DG,vertexShader:IG})}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(i){this.uniforms.searchTexture.value=i}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(i){this.uniforms.areaTexture.value=i}setLookupTextures(i,e){this.searchTexture=i,this.areaTexture=e}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(i){const e=Math.min(Math.max(i,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(i){this.orthogonalSearchSteps=i}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(i){const e=Math.min(Math.max(i,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(i){this.diagonalSearchSteps=i}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(i){i?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(i){this.diagonalDetection=i}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(i){const e=Math.min(Math.max(i,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(i){this.cornerRounding=i}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(i){i?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(i){this.cornerDetection=i}setSize(i,e){const t=this.uniforms;t.texelSize.value.set(1/i,1/e),t.resolution.value.set(i,e)}},hR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",pR="data:image/png;base64,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",NG="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",OG="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",LG=class extends ua{constructor({blendFunction:i=bn.SRC,preset:e=Bg.MEDIUM,edgeDetectionMode:t=FD.COLOR,predicationMode:n=TG.DISABLED}={}){super("SMAAEffect",NG,{vertexShader:OG,blendFunction:i,attributes:la.CONVOLUTION|la.DEPTH,uniforms:new Map([["weightMap",new Ne(null)]])});let r,s;arguments.length>1&&(r=arguments[0],s=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new ti(1,1,{depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new UT(!0,!1,!1),this.clearPass.overrideClearColor=new Ft(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Zl(new RG),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=n,this.weightsPass=new Zl(new BG);const o=new Vv;o.onLoad=()=>{const u=new Jn(r);u.name="SMAA.Search",u.magFilter=di,u.minFilter=di,u.generateMipmaps=!1,u.needsUpdate=!0,u.flipY=!0,this.weightsMaterial.searchTexture=u;const f=new Jn(s);f.name="SMAA.Area",f.magFilter=on,f.minFilter=on,f.generateMipmaps=!1,f.needsUpdate=!0,f.flipY=!1,this.weightsMaterial.areaTexture=f,this.dispatchEvent({type:"load"})},o.itemStart("search"),o.itemStart("area"),r!==void 0&&s!==void 0?(o.itemEnd("search"),o.itemEnd("area")):typeof Image<"u"&&(r=new Image,s=new Image,r.addEventListener("load",()=>o.itemEnd("search")),s.addEventListener("load",()=>o.itemEnd("area")),r.src=hR,s.src=pR),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(i){this.edgeDetectionMaterial.edgeDetectionThreshold=i}setOrthogonalSearchSteps(i){this.weightsMaterial.orthogonalSearchSteps=i}applyPreset(i){const e=this.edgeDetectionMaterial,t=this.weightsMaterial;switch(i){case Bg.LOW:e.edgeDetectionThreshold=.15,t.orthogonalSearchSteps=4,t.diagonalDetection=!1,t.cornerDetection=!1;break;case Bg.MEDIUM:e.edgeDetectionThreshold=.1,t.orthogonalSearchSteps=8,t.diagonalDetection=!1,t.cornerDetection=!1;break;case Bg.HIGH:e.edgeDetectionThreshold=.1,t.orthogonalSearchSteps=16,t.diagonalSearchSteps=8,t.cornerRounding=25,t.diagonalDetection=!0,t.cornerDetection=!0;break;case Bg.ULTRA:e.edgeDetectionThreshold=.05,t.orthogonalSearchSteps=32,t.diagonalSearchSteps=16,t.cornerRounding=25,t.diagonalDetection=!0,t.cornerDetection=!0;break}}setDepthTexture(i,e=Uo){this.edgeDetectionMaterial.depthBuffer=i,this.edgeDetectionMaterial.depthPacking=e}update(i,e,t){this.clearPass.render(i,this.renderTargetEdges),this.edgeDetectionPass.render(i,e,this.renderTargetEdges),this.weightsPass.render(i,this.renderTargetEdges,this.renderTargetWeights)}setSize(i,e){this.edgeDetectionMaterial.setSize(i,e),this.weightsMaterial.setSize(i,e),this.renderTargetEdges.setSize(i,e),this.renderTargetWeights.setSize(i,e)}dispose(){const{searchTexture:i,areaTexture:e}=this.weightsMaterial;i!==null&&e!==null&&(i.dispose(),e.dispose()),super.dispose()}static get searchImageDataURL(){return hR}static get areaImageDataURL(){return pR}},PG=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,UG="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",FG=class extends ai{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ne(null),normalBuffer:new Ne(null),texelSize:new Ne(new qe)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:PG,vertexShader:UG})}set depthBuffer(i){this.uniforms.depthBuffer.value=i}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=Uo){this.depthBuffer=i,this.depthPacking=e}set normalBuffer(i){this.uniforms.normalBuffer.value=i,i!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(i){this.normalBuffer=i}setTexelSize(i,e){this.uniforms.texelSize.value.set(i,e)}setSize(i,e){this.uniforms.texelSize.value.set(1/i,1/e)}},zG=class extends Vs{constructor({normalBuffer:i=null,resolutionScale:e=.5,width:t=Er.AUTO_SIZE,height:n=Er.AUTO_SIZE,resolutionX:r=t,resolutionY:s=n}={}){super("DepthDownsamplingPass");const o=new FG;o.normalBuffer=i,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new ti(1,1,{minFilter:di,magFilter:di,depthBuffer:!1,type:si}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const u=this.resolution=new Er(this,r,s,e);u.addEventListener("change",f=>this.setSize(u.baseWidth,u.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(i,e=Uo){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e}render(i,e,t,n,r){i.setRenderTarget(this.renderToScreen?null:this.renderTarget),i.render(this.scene,this.camera)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height),this.fullscreenMaterial.setSize(i,e)}initialize(i,e,t){const n=i.getContext();if(!(n.getExtension("EXT_color_buffer_float")||n.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},HG=`#include <packing>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
uniform lowp sampler2D luminanceBuffer0;uniform lowp sampler2D luminanceBuffer1;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float l0=unpackRGBAToFloat(texture2D(luminanceBuffer0,vUv));
#if __VERSION__ < 300
float l1=texture2DLodEXT(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#else
float l1=textureLod(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#endif
l0=max(minLuminance,l0);l1=max(minLuminance,l1);float adaptedLum=l0+(l1-l0)*(1.0-exp(-deltaTime*tau));gl_FragColor=(adaptedLum==1.0)?vec4(1.0):packFloatToRGBA(adaptedLum);}`,GG=class extends ai{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new Ne(null),luminanceBuffer1:new Ne(null),minLuminance:new Ne(.01),deltaTime:new Ne(0),tau:new Ne(1)},extensions:{shaderTextureLOD:!0},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:HG,vertexShader:Um})}set luminanceBuffer0(i){this.uniforms.luminanceBuffer0.value=i}setLuminanceBuffer0(i){this.uniforms.luminanceBuffer0.value=i}set luminanceBuffer1(i){this.uniforms.luminanceBuffer1.value=i}setLuminanceBuffer1(i){this.uniforms.luminanceBuffer1.value=i}set mipLevel1x1(i){this.defines.MIP_LEVEL_1X1=i.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(i){this.mipLevel1x1=i}set deltaTime(i){this.uniforms.deltaTime.value=i}setDeltaTime(i){this.uniforms.deltaTime.value=i}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(i){this.uniforms.minLuminance.value=i}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(i){this.uniforms.minLuminance.value=i}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(i){this.uniforms.tau.value=i}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(i){this.uniforms.tau.value=i}},kG=class extends Vs{constructor(i,{minLuminance:e=.01,adaptationRate:t=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new GG,this.needsSwap=!1,this.renderTargetPrevious=new ti(1,1,{minFilter:di,magFilter:di,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const n=this.fullscreenMaterial;n.luminanceBuffer0=this.renderTargetPrevious.texture,n.luminanceBuffer1=i,n.minLuminance=e,n.adaptationRate=t,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new OD(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(i){this.fullscreenMaterial.mipLevel1x1=i}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(i){this.fullscreenMaterial.adaptationRate=i}render(i,e,t,n,r){this.fullscreenMaterial.deltaTime=n,i.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),i.render(this.scene,this.camera),this.copyPass.render(i,this.renderTargetAdapted)}},VG=`#include <tonemapping_pars_fragment>
uniform float whitePoint;
#if TONE_MAPPING_MODE == 2 || TONE_MAPPING_MODE == 3
uniform float middleGrey;
#if TONE_MAPPING_MODE == 3
uniform lowp sampler2D luminanceBuffer;
#else
uniform float averageLuminance;
#endif
vec3 Reinhard2ToneMapping(vec3 color){color*=toneMappingExposure;float l=luminance(color);
#if TONE_MAPPING_MODE == 3
float lumAvg=unpackRGBAToFloat(texture2D(luminanceBuffer,vec2(0.5)));
#else
float lumAvg=averageLuminance;
#endif
float lumScaled=(l*middleGrey)/max(lumAvg,1e-6);float lumCompressed=lumScaled*(1.0+lumScaled/(whitePoint*whitePoint));lumCompressed/=(1.0+lumScaled);return clamp(lumCompressed*color,0.0,1.0);}
#elif TONE_MAPPING_MODE == 4
#define A 0.15
#define B 0.50
#define C 0.10
#define D 0.20
#define E 0.02
#define F 0.30
vec3 Uncharted2Helper(const in vec3 x){return((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}vec3 Uncharted2ToneMapping(vec3 color){color*=toneMappingExposure;return clamp(Uncharted2Helper(color)/Uncharted2Helper(vec3(whitePoint)),0.0,1.0);}
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){
#if TONE_MAPPING_MODE == 2 || TONE_MAPPING_MODE == 3
outputColor=vec4(Reinhard2ToneMapping(inputColor.rgb),inputColor.a);
#elif TONE_MAPPING_MODE == 4
outputColor=vec4(Uncharted2ToneMapping(inputColor.rgb),inputColor.a);
#else
outputColor=vec4(toneMapping(inputColor.rgb),inputColor.a);
#endif
}`,jG=class extends ua{constructor({blendFunction:i=bn.SRC,adaptive:e=!1,mode:t=e?Ir.REINHARD2_ADAPTIVE:Ir.AGX,resolution:n=256,maxLuminance:r=4,whitePoint:s=r,middleGrey:o=.6,minLuminance:u=.01,averageLuminance:f=1,adaptationRate:p=1}={}){super("ToneMappingEffect",VG,{blendFunction:i,uniforms:new Map([["luminanceBuffer",new Ne(null)],["maxLuminance",new Ne(r)],["whitePoint",new Ne(s)],["middleGrey",new Ne(o)],["averageLuminance",new Ne(f)]])}),this.renderTargetLuminance=new ti(1,1,{minFilter:Ka,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new LD({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new kG(this.luminancePass.texture,{minLuminance:u,adaptationRate:p}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=n,this.mode=t}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(i){if(this.mode===i)return;const t=lu.replace(/\D+/g,"")>=168?"CineonToneMapping(texel)":"OptimizedCineonToneMapping(texel)";switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",i.toFixed(0)),i){case Ir.LINEAR:this.defines.set("toneMapping(texel)","LinearToneMapping(texel)");break;case Ir.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case Ir.CINEON:case Ir.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)",t);break;case Ir.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;case Ir.AGX:this.defines.set("toneMapping(texel)","AgXToneMapping(texel)");break;case Ir.NEUTRAL:this.defines.set("toneMapping(texel)","NeutralToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel");break}this.adaptiveLuminancePass.enabled=i===Ir.REINHARD2_ADAPTIVE,this.setChanged()}getMode(){return this.mode}setMode(i){this.mode=i}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(i){this.uniforms.get("whitePoint").value=i}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(i){this.uniforms.get("middleGrey").value=i}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(i){this.uniforms.get("averageLuminance").value=i}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(i){const e=Math.max(0,Math.ceil(Math.log2(i))),t=Math.pow(2,e);this.luminancePass.resolution.setPreferredSize(t,t),this.adaptiveLuminanceMaterial.mipLevel1x1=e}getResolution(){return this.resolution}setResolution(i){this.resolution=i}get adaptive(){return this.mode===Ir.REINHARD2_ADAPTIVE}set adaptive(i){this.mode=i?Ir.REINHARD2_ADAPTIVE:Ir.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(i){this.adaptiveLuminanceMaterial.adaptationRate=i}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(i){console.warn(this.name,"distinction was removed.")}update(i,e,t){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(i,e),this.adaptiveLuminancePass.render(i,null,null,t))}initialize(i,e,t){this.adaptiveLuminancePass.initialize(i,e,t)}},WG=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,XG=class extends ua{constructor({blendFunction:i,eskil:e=!1,technique:t=e?Ng.ESKIL:Ng.DEFAULT,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",WG,{blendFunction:i,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ne(n)],["darkness",new Ne(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(i){this.technique!==i&&(this.defines.set("VIGNETTE_TECHNIQUE",i.toFixed(0)),this.setChanged())}get eskil(){return this.technique===Ng.ESKIL}set eskil(i){this.technique=i?Ng.ESKIL:Ng.DEFAULT}getTechnique(){return this.technique}setTechnique(i){this.technique=i}get offset(){return this.uniforms.get("offset").value}set offset(i){this.uniforms.get("offset").value=i}getOffset(){return this.offset}setOffset(i){this.offset=i}get darkness(){return this.uniforms.get("darkness").value}set darkness(i){this.uniforms.get("darkness").value=i}getDarkness(){return this.darkness}setDarkness(i){this.darkness=i}},YG=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,QG="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",qG=class extends ai{constructor(i,e,t,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:lu.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ne(null),depthBuffer:new Ne(null),resolution:new Ne(new qe),texelSize:new Ne(new qe),cameraNear:new Ne(.3),cameraFar:new Ne(1e3),aspect:new Ne(1),time:new Ne(0)},blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),i&&this.setShaderParts(i),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(i){this.uniforms.inputBuffer.value=i}setInputBuffer(i){this.uniforms.inputBuffer.value=i}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(i){this.uniforms.depthBuffer.value=i}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(i){this.defines.DEPTH_PACKING=i.toFixed(0),this.needsUpdate=!0}setDepthBuffer(i,e=Uo){this.depthBuffer=i,this.depthPacking=e}setShaderData(i){this.setShaderParts(i.shaderParts),this.setDefines(i.defines),this.setUniforms(i.uniforms),this.setExtensions(i.extensions)}setShaderParts(i){return this.fragmentShader=YG.replace(ui.FRAGMENT_HEAD,i.get(ui.FRAGMENT_HEAD)||"").replace(ui.FRAGMENT_MAIN_UV,i.get(ui.FRAGMENT_MAIN_UV)||"").replace(ui.FRAGMENT_MAIN_IMAGE,i.get(ui.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=QG.replace(ui.VERTEX_HEAD,i.get(ui.VERTEX_HEAD)||"").replace(ui.VERTEX_MAIN_SUPPORT,i.get(ui.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(i){for(const e of i.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(i){for(const e of i.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(i){this.extensions={};for(const e of i)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(i){this.encodeOutput!==i&&(i?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(i){return this.encodeOutput}setOutputEncodingEnabled(i){this.encodeOutput=i}get time(){return this.uniforms.time.value}set time(i){this.uniforms.time.value=i}setDeltaTime(i){this.uniforms.time.value+=i}adoptCameraSettings(i){this.copyCameraSettings(i)}copyCameraSettings(i){i&&(this.uniforms.cameraNear.value=i.near,this.uniforms.cameraFar.value=i.far,i instanceof ki?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(i,e){const t=this.uniforms;t.resolution.value.set(i,e),t.texelSize.value.set(1/i,1/e),t.aspect.value=i/e}static get Section(){return ui}};function mR(i,e,t){for(const n of e){const r="$1"+i+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(s,r))}}function JG(i,e,t){let n=e.getFragmentShader(),r=e.getVertexShader();const s=n!==void 0&&/mainImage/.test(n),o=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&(t.attributes&la.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const u=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,f=t.shaderParts;let p=f.get(ui.FRAGMENT_HEAD)||"",g=f.get(ui.FRAGMENT_MAIN_UV)||"",v=f.get(ui.FRAGMENT_MAIN_IMAGE)||"",y=f.get(ui.VERTEX_HEAD)||"",A=f.get(ui.VERTEX_MAIN_SUPPORT)||"";const S=new Set,T=new Set;if(o&&(g+=`	${i}MainUv(UV);
`,t.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const R=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);A+=`	${i}MainSupport(`,A+=R?`vUv);
`:`);
`;for(const I of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const O of I[1].split(/\s*,\s*/))t.varyings.add(O),S.add(O),T.add(O);for(const I of r.matchAll(u))T.add(I[1])}for(const R of n.matchAll(u))T.add(R[1]);for(const R of e.defines.keys())T.add(R.replace(/\([\w\s,]*\)/g,""));for(const R of e.uniforms.keys())T.add(R);T.delete("while"),T.delete("for"),T.delete("if"),e.uniforms.forEach((R,I)=>t.uniforms.set(i+I.charAt(0).toUpperCase()+I.slice(1),R)),e.defines.forEach((R,I)=>t.defines.set(i+I.charAt(0).toUpperCase()+I.slice(1),R));const M=new Map([["fragment",n],["vertex",r]]);mR(i,T,t.defines),mR(i,T,M),n=M.get("fragment"),r=M.get("vertex");const E=e.blendMode;if(t.blendModes.set(E.blendFunction,E),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(v+=e.inputColorSpace===Hn?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Ja?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const R=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;v+=`${i}MainImage(color0, UV, `,(t.attributes&la.DEPTH)!==0&&R.test(n)&&(v+="depth, ",t.readDepth=!0),v+=`color1);
	`;const I=i+"BlendOpacity";t.uniforms.set(I,E.opacity),v+=`color0 = blend${E.blendFunction}(color0, color1, ${I});

	`,p+=`uniform float ${I};

`}if(p+=n+`
`,r!==null&&(y+=r+`
`),f.set(ui.FRAGMENT_HEAD,p),f.set(ui.FRAGMENT_MAIN_UV,g),f.set(ui.FRAGMENT_MAIN_IMAGE,v),f.set(ui.VERTEX_HEAD,y),f.set(ui.VERTEX_MAIN_SUPPORT,A),e.extensions!==null)for(const R of e.extensions)t.extensions.add(R)}}var KG=class extends Vs{constructor(i,...e){super("EffectPass"),this.fullscreenMaterial=new qG(null,null,null,i),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(i){for(const e of this.effects)e.mainScene=i}set mainCamera(i){this.fullscreenMaterial.copyCameraSettings(i);for(const e of this.effects)e.mainCamera=i}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(i){this.fullscreenMaterial.encodeOutput=i}get dithering(){return this.fullscreenMaterial.dithering}set dithering(i){const e=this.fullscreenMaterial;e.dithering=i,e.needsUpdate=!0}setEffects(i){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=i.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const i=new gH;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===bn.DST)i.attributes|=o.getAttributes()&la.DEPTH;else{if((i.attributes&o.getAttributes()&la.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${o.name})`);JG("e"+e++,o,i)}let t=i.shaderParts.get(ui.FRAGMENT_HEAD),n=i.shaderParts.get(ui.FRAGMENT_MAIN_IMAGE),r=i.shaderParts.get(ui.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const o of i.blendModes.values())t+=o.getShaderCode().replace(s,`blend${o.blendFunction}`)+`
`;(i.attributes&la.DEPTH)!==0?(i.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,i.colorSpace===Hn&&(n+=`color0 = sRGBToLinear(color0);
	`),i.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,i.defines.set("UV","transformedUv")):i.defines.set("UV","vUv"),i.shaderParts.set(ui.FRAGMENT_HEAD,t),i.shaderParts.set(ui.FRAGMENT_MAIN_IMAGE,n),i.shaderParts.set(ui.FRAGMENT_MAIN_UV,r);for(const[o,u]of i.shaderParts)u!==null&&i.shaderParts.set(o,u.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(i)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(i,e=Uo){this.fullscreenMaterial.depthBuffer=i,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(i,e)}render(i,e,t,n,r){for(const s of this.effects)s.update(i,e,n);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=n*this.timeScale,i.setRenderTarget(this.renderToScreen?null:t),i.render(this.scene,this.camera)}}setSize(i,e){this.fullscreenMaterial.setSize(i,e);for(const t of this.effects)t.setSize(i,e)}initialize(i,e,t){this.renderer=i;for(const n of this.effects)n.initialize(i,e,t);this.updateMaterial(),t!==void 0&&t!==_i&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const i of this.effects)i.removeEventListener("change",this.listener),i.dispose()}handleEvent(i){switch(i.type){case"change":this.recompile();break}}},zD=class extends Vs{constructor(i,e,{renderTarget:t,resolutionScale:n=1,width:r=Er.AUTO_SIZE,height:s=Er.AUTO_SIZE,resolutionX:o=r,resolutionY:u=s}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new HT(i,e,new rT);const f=this.renderPass;f.ignoreBackground=!0,f.skipShadowMapUpdate=!0;const p=f.getClearPass();p.overrideClearColor=new Ft(7829503),p.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new ti(1,1,{minFilter:di,magFilter:di}),this.renderTarget.texture.name="NormalPass.Target");const g=this.resolution=new Er(this,o,u,n);g.addEventListener("change",v=>this.setSize(g.baseWidth,g.baseHeight))}set mainScene(i){this.renderPass.mainScene=i}set mainCamera(i){this.renderPass.mainCamera=i}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(i){this.resolution.scale=i}render(i,e,t,n,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(i,s,s)}setSize(i,e){const t=this.resolution;t.setBaseSize(i,e),this.renderTarget.setSize(t.width,t.height)}};function rv(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}new qe;new qe;function HD(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var Ro=function i(e,t,n){var r=this;HD(this,i),rv(this,"dot2",function(s,o){return r.x*s+r.y*o}),rv(this,"dot3",function(s,o,u){return r.x*s+r.y*o+r.z*u}),this.x=e,this.y=t,this.z=n},ZG=[new Ro(1,1,0),new Ro(-1,1,0),new Ro(1,-1,0),new Ro(-1,-1,0),new Ro(1,0,1),new Ro(-1,0,1),new Ro(1,0,-1),new Ro(-1,0,-1),new Ro(0,1,1),new Ro(0,-1,1),new Ro(0,1,-1),new Ro(0,-1,-1)],gR=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],vR=new Array(512),xR=new Array(512),$G=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var t=0;t<256;t++){var n;t&1?n=gR[t]^e&255:n=gR[t]^e>>8&255,vR[t]=vR[t+256]=n,xR[t]=xR[t+256]=ZG[n%12]}};$G(0);function ek(i){if(typeof i=="number")i=Math.abs(i);else if(typeof i=="string"){var e=i;i=0;for(var t=0;t<e.length;t++)i=(i+(t+1)*(e.charCodeAt(t)%96))%2147483647}return i===0&&(i=311),i}function yR(i){var e=ek(i);return function(){var t=e*48271%2147483647;return e=t,t/2147483647}}var tk=function i(e){var t=this;HD(this,i),rv(this,"seed",0),rv(this,"init",function(n){t.seed=n,t.value=yR(n)}),rv(this,"value",yR(this.seed)),this.init(e)};new tk(Math.random());const GT=le.createContext(null),AR=i=>(i.getAttributes()&2)===2,GD=le.memo(le.forwardRef(({children:i,camera:e,scene:t,resolutionScale:n,enabled:r=!0,renderPriority:s=1,autoClear:o=!0,depthBuffer:u,enableNormalPass:f,stencilBuffer:p,multisampling:g=8,frameBufferType:v=On},y)=>{const{gl:A,scene:S,camera:T,size:M}=Nn(),E=t||S,R=e||T,[I,O,F]=le.useMemo(()=>{const W=new mH(A,{depthBuffer:u,stencilBuffer:p,multisampling:g,frameBufferType:v});W.addPass(new HT(E,R));let L=null,H=null;return f&&(H=new zD(E,R),H.enabled=!1,W.addPass(H),n!==void 0&&(L=new zG({normalBuffer:H.texture,resolutionScale:n}),L.enabled=!1,W.addPass(L))),[W,H,L]},[R,A,u,p,g,v,E,f,n]);le.useEffect(()=>I==null?void 0:I.setSize(M.width,M.height),[I,M]),da((W,L)=>{if(r){const H=A.autoClear;A.autoClear=o,p&&!o&&A.clearStencil(),I.render(L),A.autoClear=H}},r?s:0);const z=le.useRef(null);le.useLayoutEffect(()=>{var H;const W=[],L=z.current.__r3f;if(L&&I){const K=L.children;for(let de=0;de<K.length;de++){const ce=K[de].object;if(ce instanceof ua){const ne=[ce];if(!AR(ce)){let X=null;for(;(X=(H=K[de+1])==null?void 0:H.object)instanceof ua&&!AR(X);)ne.push(X),de++}const fe=new KG(R,...ne);W.push(fe)}else ce instanceof Vs&&W.push(ce)}for(const de of W)I==null||I.addPass(de);O&&(O.enabled=!0),F&&(F.enabled=!0)}return()=>{for(const K of W)I==null||I.removePass(K);O&&(O.enabled=!1),F&&(F.enabled=!1)}},[I,i,R,O,F]),le.useEffect(()=>{const W=A.toneMapping;return A.toneMapping=aa,()=>{A.toneMapping=W}},[A]);const j=le.useMemo(()=>({composer:I,normalPass:O,downSamplingPass:F,resolutionScale:n,camera:R,scene:E}),[I,O,F,n,R,E]);return le.useImperativeHandle(y,()=>I,[I]),D.jsx(GT.Provider,{value:j,children:D.jsx("group",{ref:z,children:i})})}));let nk=0;const _R=new WeakMap,wd=(i,e)=>function({blendFunction:t=e==null?void 0:e.blendFunction,opacity:n=e==null?void 0:e.opacity,...r}){let s=_R.get(i);if(!s){const f=`@react-three/postprocessing/${i.name}-${nk++}`;q_({[f]:i}),_R.set(i,s=f)}const o=Nn(f=>f.camera),u=Cv.useMemo(()=>[...(e==null?void 0:e.args)??[],...r.args??[{...e,...r}]],[JSON.stringify(r)]);return D.jsx(s,{camera:o,"blendMode-blendFunction":t,"blendMode-opacity-value":n,...r,args:u})},ik=le.forwardRef(function({blendFunction:i,worldFocusDistance:e,worldFocusRange:t,focusDistance:n,focusRange:r,focalLength:s,bokehScale:o,resolutionScale:u,resolutionX:f,resolutionY:p,width:g,height:v,target:y,depthTexture:A,...S},T){const{camera:M}=le.useContext(GT),E=y!=null,R=le.useMemo(()=>{const I=new bG(M,{blendFunction:i,worldFocusDistance:e,worldFocusRange:t,focusDistance:n,focusRange:r,focalLength:s,bokehScale:o,resolutionScale:u,resolutionX:f,resolutionY:p,width:g,height:v});E&&(I.target=new Q),A&&I.setDepthTexture(A.texture,A.packing);const O=I.maskPass;return O.maskFunction=zT.MULTIPLY_RGB_SET_ALPHA,I},[M,i,e,t,n,r,s,o,u,f,p,g,v,E,A]);return le.useEffect(()=>()=>{R.dispose()},[R]),D.jsx("primitive",{...S,ref:T,object:R,target:y})}),rk=wd(uG,{blendFunction:0}),sk=wd(fG),ak=wd(mG),ok=wd(MG),kD=wd(LG),VD=wd(jG),lk=wd(XG);var ck="Invariant failed";function $A(i,e){if(!i)throw new Error(ck)}const uk=new Q;function jD(i,e,t=new Q,n){const{x:r,y:s,z:o}=i,u=e.x,f=e.y,p=e.z,g=r*r*u,v=s*s*f,y=o*o*p,A=g+v+y,S=Math.sqrt(1/A);if(!Number.isFinite(S))return;const T=uk.copy(i).multiplyScalar(S);if(A<((n==null?void 0:n.centerTolerance)??.1))return t.copy(T);const M=T.multiply(e).multiplyScalar(2);let E=(1-S)*i.length()/(M.length()/2),R=0,I,O,F,z;do{E-=R,I=1/(1+E*u),O=1/(1+E*f),F=1/(1+E*p);const j=I*I,W=O*O,L=F*F,H=j*I,K=W*O,de=L*F;z=g*j+v*W+y*L-1,R=z/((g*H*u+v*K*f+y*de*p)*-2)}while(Math.abs(z)>1e-12);return t.set(r*I,s*O,o*F)}const Wp=new Q,hE=new Q,pE=new Q,tM=class{constructor(e,t,n){this.radii=new Q(e,t,n)}get minimumRadius(){return Math.min(this.radii.x,this.radii.y,this.radii.z)}get maximumRadius(){return Math.max(this.radii.x,this.radii.y,this.radii.z)}get flattening(){return 1-this.minimumRadius/this.maximumRadius}get eccentricity(){return Math.sqrt(this.eccentricitySquared)}get eccentricitySquared(){const e=this.maximumRadius**2,t=this.minimumRadius**2;return(e-t)/e}reciprocalRadii(e=new Q){const{x:t,y:n,z:r}=this.radii;return e.set(1/t,1/n,1/r)}reciprocalRadiiSquared(e=new Q){const{x:t,y:n,z:r}=this.radii;return e.set(1/t**2,1/n**2,1/r**2)}projectOnSurface(e,t=new Q,n){return jD(e,this.reciprocalRadiiSquared(),t,n)}getSurfaceNormal(e,t=new Q){return t.multiplyVectors(this.reciprocalRadiiSquared(Wp),e).normalize()}getEastNorthUpVectors(e,t=new Q,n=new Q,r=new Q){this.getSurfaceNormal(e,r),t.set(-e.y,e.x,0).normalize(),n.crossVectors(r,t).normalize()}getEastNorthUpFrame(e,t=new jt){const n=Wp,r=hE,s=pE;return this.getEastNorthUpVectors(e,n,r,s),t.makeBasis(n,r,s).setPosition(e)}getNorthUpEastFrame(e,t=new jt){const n=Wp,r=hE,s=pE;return this.getEastNorthUpVectors(e,n,r,s),t.makeBasis(r,s,n).setPosition(e)}getIntersection(e,t=new Q){const n=this.reciprocalRadii(Wp),r=hE.copy(n).multiply(e.origin),s=pE.copy(n).multiply(e.direction),o=r.lengthSq(),u=s.lengthSq(),f=r.dot(s),p=f**2-u*(o-1);if(o===1)return t.copy(e.origin);if(o>1){if(f>=0||p<0)return;const g=Math.sqrt(p),v=(-f-g)/u,y=(-f+g)/u;return e.at(Math.min(v,y),t)}if(o<1){const g=f**2-u*(o-1),v=Math.sqrt(g),y=(-f+v)/u;return e.at(y,t)}if(f<0)return e.at(-f/u,t)}getOsculatingSphereCenter(e,t,n=new Q){$A(this.radii.x===this.radii.y);const r=this.radii.x**2,s=this.radii.z**2,o=Wp.set(e.x/r,e.y/r,e.z/s).normalize();return n.copy(o.multiplyScalar(-t).add(e))}getNormalAtHorizon(e,t,n=new Q){$A(this.radii.x===this.radii.y);const r=this.radii.x**2,s=this.radii.z**2,o=e,u=t;let f=(o.x*u.x+o.y*u.y)/r+o.z*u.z/s;f/=(o.x**2+o.y**2)/r+o.z**2/s;const p=Wp.copy(u).multiplyScalar(-f).add(e);return n.set(p.x/r,p.y/r,p.z/s).normalize()}};tM.WGS84=new tM(6378137,6378137,6356752314245179e-9);let ac=tM,dk=class extends pn{constructor(e=new Q(1,1,1),t=32,n=16){super(),this.type="EllipsoidGeometry",this.parameters={radii:e,longitudeSegments:t,latitudeSegments:n},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const r=(t+1)*(n+1),s=new Q,o=new Q,u=new Float32Array(r*3),f=new Float32Array(r*3),p=new Float32Array(r*2),g=[],v=[];for(let y=0,A=0,S=0,T=0;y<=n;++y){const M=[],E=y/n,R=E*Math.PI;let I=0;y===0?I=.5/t:y===n&&(I=-.5/t);for(let O=0;O<=t;++O,A+=3,S+=2,++T){const F=O/t,z=F*Math.PI*2;s.x=e.x*Math.cos(z)*Math.sin(R),s.y=e.y*Math.sin(z)*Math.sin(R),s.z=e.z*Math.cos(R),u[A]=s.x,u[A+1]=s.y,u[A+2]=s.z,o.copy(s).normalize(),f[A]=o.x,f[A+1]=o.y,f[A+2]=o.z,p[S]=F+I,p[S+1]=1-E,M.push(T)}g.push(M)}for(let y=0;y<n;++y)for(let A=0;A<t;++A){const S=g[y][A+1],T=g[y][A],M=g[y+1][A],E=g[y+1][A+1];y!==0&&v.push(S,T,E),y!==n-1&&v.push(T,M,E)}this.setIndex(v),this.setAttribute("position",new jn(u,3)),this.setAttribute("normal",new jn(f,3)),this.setAttribute("uv",new jn(p,2))}copy(e){return super.copy(e),this.parameters={...e.parameters},this}};const Ny=new Q,SR=new Q,jg=class nM{constructor(e=0,t=0,n=0){this.longitude=e,this.latitude=t,this.height=n}set(e,t,n){return this.longitude=e,this.latitude=t,n!=null&&(this.height=n),this}clone(){return new nM(this.longitude,this.latitude,this.height)}copy(e){return this.longitude=e.longitude,this.latitude=e.latitude,this.height=e.height,this}equals(e){return e.longitude===this.longitude&&e.latitude===this.latitude&&e.height===this.height}setLongitude(e){return this.longitude=e,this}setLatitude(e){return this.latitude=e,this}setHeight(e){return this.height=e,this}normalize(){return this.longitude<nM.MIN_LONGITUDE&&(this.longitude+=Math.PI*2),this}setFromECEF(e,t){const n=((t==null?void 0:t.ellipsoid)??ac.WGS84).reciprocalRadiiSquared(Ny),r=jD(e,n,SR,t);if(r==null)throw new Error(`Could not project position to ellipsoid surface: ${e.toArray()}`);const s=Ny.multiplyVectors(r,n).normalize();this.longitude=Math.atan2(s.y,s.x),this.latitude=Math.asin(s.z);const o=Ny.subVectors(e,r);return this.height=Math.sign(o.dot(e))*o.length(),this}toECEF(e=new Q,t){const n=(t==null?void 0:t.ellipsoid)??ac.WGS84,r=Ny.multiplyVectors(n.radii,n.radii),s=Math.cos(this.latitude),o=SR.set(s*Math.cos(this.longitude),s*Math.sin(this.longitude),Math.sin(this.latitude)).normalize();return e.multiplyVectors(r,o),e.divideScalar(Math.sqrt(o.dot(e))).add(o.multiplyScalar(this.height))}fromArray(e,t=0){return this.longitude=e[t],this.latitude=e[t+1],this.height=e[t+2],this}toArray(e=[],t=0){return e[t]=this.longitude,e[t+1]=this.latitude,e[t+2]=this.height,e}*[Symbol.iterator](){yield this.longitude,yield this.latitude,yield this.height}};jg.MIN_LONGITUDE=-Math.PI,jg.MAX_LONGITUDE=Math.PI,jg.MIN_LATITUDE=-Math.PI/2,jg.MAX_LATITUDE=Math.PI/2;let kT=jg;/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var Oo=Uint8Array,tm=Uint16Array,fk=Int32Array,WD=new Oo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),XD=new Oo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hk=new Oo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),YD=function(i,e){for(var t=new tm(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new fk(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return{b:t,r}},QD=YD(WD,2),qD=QD.b,pk=QD.r;qD[28]=258,pk[258]=28;var mk=YD(XD,0),gk=mk.b,iM=new tm(32768);for(var er=0;er<32768;++er){var cd=(er&43690)>>1|(er&21845)<<1;cd=(cd&52428)>>2|(cd&13107)<<2,cd=(cd&61680)>>4|(cd&3855)<<4,iM[er]=((cd&65280)>>8|(cd&255)<<8)>>1}var sv=(function(i,e,t){for(var n=i.length,r=0,s=new tm(e);r<n;++r)i[r]&&++s[i[r]-1];var o=new tm(e);for(r=1;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var u;if(t){u=new tm(1<<e);var f=15-e;for(r=0;r<n;++r)if(i[r])for(var p=r<<4|i[r],g=e-i[r],v=o[i[r]-1]++<<g,y=v|(1<<g)-1;v<=y;++v)u[iM[v]>>f]=p}else for(u=new tm(n),r=0;r<n;++r)i[r]&&(u[r]=iM[o[i[r]-1]++]>>15-i[r]);return u}),qv=new Oo(288);for(var er=0;er<144;++er)qv[er]=8;for(var er=144;er<256;++er)qv[er]=9;for(var er=256;er<280;++er)qv[er]=7;for(var er=280;er<288;++er)qv[er]=8;var JD=new Oo(32);for(var er=0;er<32;++er)JD[er]=5;var vk=sv(qv,9,1),xk=sv(JD,5,1),mE=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},ol=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},gE=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},yk=function(i){return(i+7)/8|0},Ak=function(i,e,t){return(t==null||t>i.length)&&(t=i.length),new Oo(i.subarray(e,t))},_k=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ul=function(i,e,t){var n=new Error(e||_k[i]);if(n.code=i,Error.captureStackTrace&&Error.captureStackTrace(n,ul),!t)throw n;return n},Sk=function(i,e,t,n){var r=i.length,s=0;if(!r||e.f&&!e.l)return t||new Oo(0);var o=!t,u=o||e.i!=2,f=e.i;o&&(t=new Oo(r*3));var p=function(Pt){var Ot=t.length;if(Pt>Ot){var Mt=new Oo(Math.max(Ot*2,Pt));Mt.set(t),t=Mt}},g=e.f||0,v=e.p||0,y=e.b||0,A=e.l,S=e.d,T=e.m,M=e.n,E=r*8;do{if(!A){g=ol(i,v,1);var R=ol(i,v+1,3);if(v+=3,R)if(R==1)A=vk,S=xk,T=9,M=5;else if(R==2){var z=ol(i,v,31)+257,j=ol(i,v+10,15)+4,W=z+ol(i,v+5,31)+1;v+=14;for(var L=new Oo(W),H=new Oo(19),K=0;K<j;++K)H[hk[K]]=ol(i,v+K*3,7);v+=j*3;for(var de=mE(H),ce=(1<<de)-1,ne=sv(H,de,1),K=0;K<W;){var fe=ne[ol(i,v,ce)];v+=fe&15;var I=fe>>4;if(I<16)L[K++]=I;else{var X=0,re=0;for(I==16?(re=3+ol(i,v,3),v+=2,X=L[K-1]):I==17?(re=3+ol(i,v,7),v+=3):I==18&&(re=11+ol(i,v,127),v+=7);re--;)L[K++]=X}}var ge=L.subarray(0,z),Te=L.subarray(z);T=mE(ge),M=mE(Te),A=sv(ge,T,1),S=sv(Te,M,1)}else ul(1);else{var I=yk(v)+4,O=i[I-4]|i[I-3]<<8,F=I+O;if(F>r){f&&ul(0);break}u&&p(y+O),t.set(i.subarray(I,F),y),e.b=y+=O,e.p=v=F*8,e.f=g;continue}if(v>E){f&&ul(0);break}}u&&p(y+131072);for(var Se=(1<<T)-1,Y=(1<<M)-1,me=v;;me=v){var X=A[gE(i,v)&Se],Ce=X>>4;if(v+=X&15,v>E){f&&ul(0);break}if(X||ul(2),Ce<256)t[y++]=Ce;else if(Ce==256){me=v,A=null;break}else{var Ze=Ce-254;if(Ce>264){var K=Ce-257,xt=WD[K];Ze=ol(i,v,(1<<xt)-1)+qD[K],v+=xt}var ve=S[gE(i,v)&Y],ze=ve>>4;ve||ul(3),v+=ve&15;var Te=gk[ze];if(ze>3){var xt=XD[ze];Te+=gE(i,v)&(1<<xt)-1,v+=xt}if(v>E){f&&ul(0);break}u&&p(y+131072);var dt=y+Ze;if(y<Te){var Ee=s-Te,yt=Math.min(Te,dt);for(Ee+y<0&&ul(3);y<yt;++y)t[y]=n[Ee+y]}for(;y<dt;++y)t[y]=t[y-Te]}}e.l=A,e.p=me,e.b=y,e.f=g,A&&(g=1,e.m=T,e.d=S,e.n=M)}while(!g);return y!=t.length&&o?Ak(t,0,y):t.subarray(0,y)},bk=new Oo(0),Ek=function(i,e){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&ul(6,"invalid zlib data"),(i[1]>>5&1)==1&&ul(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function Oy(i,e){return Sk(i.subarray(Ek(i),-4),{i:2},e,e)}var Mk=typeof TextDecoder<"u"&&new TextDecoder,Tk=0;try{Mk.decode(bk,{stream:!0}),Tk=1}catch{}class KD extends V_{constructor(e){super(e),this.type=On,this.outputFormat=Ai}parse(e){const L=Math.pow(2.7182818,2.2);function H(N,k){let $=0;for(let _e=0;_e<65536;++_e)(_e==0||N[_e>>3]&1<<(_e&7))&&(k[$++]=_e);const ue=$-1;for(;$<65536;)k[$++]=0;return ue}function K(N){for(let k=0;k<16384;k++)N[k]={},N[k].len=0,N[k].lit=0,N[k].p=null}const de={l:0,c:0,lc:0};function ce(N,k,$,ue,_e){for(;$<N;)k=k<<8|he(ue,_e),$+=8;$-=N,de.l=k>>$&(1<<N)-1,de.c=k,de.lc=$}const ne=new Array(59);function fe(N){for(let $=0;$<=58;++$)ne[$]=0;for(let $=0;$<65537;++$)ne[N[$]]+=1;let k=0;for(let $=58;$>0;--$){const ue=k+ne[$]>>1;ne[$]=k,k=ue}for(let $=0;$<65537;++$){const ue=N[$];ue>0&&(N[$]=ue|ne[ue]++<<6)}}function X(N,k,$,ue,_e,De){const P=k;let Z=0,se=0;for(;ue<=_e;ue++){if(P.value-k.value>$)return!1;ce(6,Z,se,N,P);const ae=de.l;if(Z=de.c,se=de.lc,De[ue]=ae,ae==63){if(P.value-k.value>$)throw new Error("Something wrong with hufUnpackEncTable");ce(8,Z,se,N,P);let ie=de.l+6;if(Z=de.c,se=de.lc,ue+ie>_e+1)throw new Error("Something wrong with hufUnpackEncTable");for(;ie--;)De[ue++]=0;ue--}else if(ae>=59){let ie=ae-59+2;if(ue+ie>_e+1)throw new Error("Something wrong with hufUnpackEncTable");for(;ie--;)De[ue++]=0;ue--}}fe(De)}function re(N){return N&63}function ge(N){return N>>6}function Te(N,k,$,ue){for(;k<=$;k++){const _e=ge(N[k]),De=re(N[k]);if(_e>>De)throw new Error("Invalid table entry");if(De>14){const P=ue[_e>>De-14];if(P.len)throw new Error("Invalid table entry");if(P.lit++,P.p){const Z=P.p;P.p=new Array(P.lit);for(let se=0;se<P.lit-1;++se)P.p[se]=Z[se]}else P.p=new Array(1);P.p[P.lit-1]=k}else if(De){let P=0;for(let Z=1<<14-De;Z>0;Z--){const se=ue[(_e<<14-De)+P];if(se.len||se.p)throw new Error("Invalid table entry");se.len=De,se.lit=k,P++}}}return!0}const Se={c:0,lc:0};function Y(N,k,$,ue){N=N<<8|he($,ue),k+=8,Se.c=N,Se.lc=k}const me={c:0,lc:0};function Ce(N,k,$,ue,_e,De,P,Z,se){if(N==k){ue<8&&(Y($,ue,_e,De),$=Se.c,ue=Se.lc),ue-=8;let ae=$>>ue;if(ae=new Uint8Array([ae])[0],Z.value+ae>se)return!1;const ie=P[Z.value-1];for(;ae-- >0;)P[Z.value++]=ie}else if(Z.value<se)P[Z.value++]=N;else return!1;me.c=$,me.lc=ue}function Ze(N){return N&65535}function xt(N){const k=Ze(N);return k>32767?k-65536:k}const ve={a:0,b:0};function ze(N,k){const $=xt(N),_e=xt(k),De=$+(_e&1)+(_e>>1),P=De,Z=De-_e;ve.a=P,ve.b=Z}function dt(N,k){const $=Ze(N),ue=Ze(k),_e=$-(ue>>1)&65535,De=ue+_e-32768&65535;ve.a=De,ve.b=_e}function Ee(N,k,$,ue,_e,De,P){const Z=P<16384,se=$>_e?_e:$;let ae=1,ie,we;for(;ae<=se;)ae<<=1;for(ae>>=1,ie=ae,ae>>=1;ae>=1;){we=0;const Ie=we+De*(_e-ie),Re=De*ae,tt=De*ie,He=ue*ae,at=ue*ie;let nt,Et,Wt,ln;for(;we<=Ie;we+=tt){let Yt=we;const mt=we+ue*($-ie);for(;Yt<=mt;Yt+=at){const ht=Yt+He,zt=Yt+Re,St=zt+He;Z?(ze(N[Yt+k],N[zt+k]),nt=ve.a,Wt=ve.b,ze(N[ht+k],N[St+k]),Et=ve.a,ln=ve.b,ze(nt,Et),N[Yt+k]=ve.a,N[ht+k]=ve.b,ze(Wt,ln),N[zt+k]=ve.a,N[St+k]=ve.b):(dt(N[Yt+k],N[zt+k]),nt=ve.a,Wt=ve.b,dt(N[ht+k],N[St+k]),Et=ve.a,ln=ve.b,dt(nt,Et),N[Yt+k]=ve.a,N[ht+k]=ve.b,dt(Wt,ln),N[zt+k]=ve.a,N[St+k]=ve.b)}if($&ae){const ht=Yt+Re;Z?ze(N[Yt+k],N[ht+k]):dt(N[Yt+k],N[ht+k]),nt=ve.a,N[ht+k]=ve.b,N[Yt+k]=nt}}if(_e&ae){let Yt=we;const mt=we+ue*($-ie);for(;Yt<=mt;Yt+=at){const ht=Yt+He;Z?ze(N[Yt+k],N[ht+k]):dt(N[Yt+k],N[ht+k]),nt=ve.a,N[ht+k]=ve.b,N[Yt+k]=nt}}ie=ae,ae>>=1}return we}function yt(N,k,$,ue,_e,De,P,Z,se){let ae=0,ie=0;const we=P,Ie=Math.trunc(ue.value+(_e+7)/8);for(;ue.value<Ie;)for(Y(ae,ie,$,ue),ae=Se.c,ie=Se.lc;ie>=14;){const tt=ae>>ie-14&16383,He=k[tt];if(He.len)ie-=He.len,Ce(He.lit,De,ae,ie,$,ue,Z,se,we),ae=me.c,ie=me.lc;else{if(!He.p)throw new Error("hufDecode issues");let at;for(at=0;at<He.lit;at++){const nt=re(N[He.p[at]]);for(;ie<nt&&ue.value<Ie;)Y(ae,ie,$,ue),ae=Se.c,ie=Se.lc;if(ie>=nt&&ge(N[He.p[at]])==(ae>>ie-nt&(1<<nt)-1)){ie-=nt,Ce(He.p[at],De,ae,ie,$,ue,Z,se,we),ae=me.c,ie=me.lc;break}}if(at==He.lit)throw new Error("hufDecode issues")}}const Re=8-_e&7;for(ae>>=Re,ie-=Re;ie>0;){const tt=k[ae<<14-ie&16383];if(tt.len)ie-=tt.len,Ce(tt.lit,De,ae,ie,$,ue,Z,se,we),ae=me.c,ie=me.lc;else throw new Error("hufDecode issues")}return!0}function Pt(N,k,$,ue,_e,De){const P={value:0},Z=$.value,se=Bt(k,$),ae=Bt(k,$);$.value+=4;const ie=Bt(k,$);if($.value+=4,se<0||se>=65537||ae<0||ae>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const we=new Array(65537),Ie=new Array(16384);K(Ie);const Re=ue-($.value-Z);if(X(N,$,Re,se,ae,we),ie>8*(ue-($.value-Z)))throw new Error("Something wrong with hufUncompress");Te(we,se,ae,Ie),yt(we,Ie,N,$,ie,ae,De,_e,P)}function Ot(N,k,$){for(let ue=0;ue<$;++ue)k[ue]=N[k[ue]]}function Mt(N){for(let k=1;k<N.length;k++){const $=N[k-1]+N[k]-128;N[k]=$}}function je(N,k){let $=0,ue=Math.floor((N.length+1)/2),_e=0;const De=N.length-1;for(;!(_e>De||(k[_e++]=N[$++],_e>De));)k[_e++]=N[ue++]}function st(N){let k=N.byteLength;const $=new Array;let ue=0;const _e=new DataView(N);for(;k>0;){const De=_e.getInt8(ue++);if(De<0){const P=-De;k-=P+1;for(let Z=0;Z<P;Z++)$.push(_e.getUint8(ue++))}else{const P=De;k-=2;const Z=_e.getUint8(ue++);for(let se=0;se<P+1;se++)$.push(Z)}}return $}function et(N,k,$,ue,_e,De){let P=new DataView(De.buffer);const Z=$[N.idx[0]].width,se=$[N.idx[0]].height,ae=3,ie=Math.floor(Z/8),we=Math.ceil(Z/8),Ie=Math.ceil(se/8),Re=Z-(we-1)*8,tt=se-(Ie-1)*8,He={value:0},at=new Array(ae),nt=new Array(ae),Et=new Array(ae),Wt=new Array(ae),ln=new Array(ae);for(let mt=0;mt<ae;++mt)ln[mt]=k[N.idx[mt]],at[mt]=mt<1?0:at[mt-1]+we*Ie,nt[mt]=new Float32Array(64),Et[mt]=new Uint16Array(64),Wt[mt]=new Uint16Array(we*64);for(let mt=0;mt<Ie;++mt){let ht=8;mt==Ie-1&&(ht=tt);let zt=8;for(let Qt=0;Qt<we;++Qt){Qt==we-1&&(zt=Re);for(let vn=0;vn<ae;++vn)Et[vn].fill(0),Et[vn][0]=_e[at[vn]++],oe(He,ue,Et[vn]),Gt(Et[vn],nt[vn]),Dt(nt[vn]);qt(nt);for(let vn=0;vn<ae;++vn)Tt(nt[vn],Wt[vn],Qt*64)}let St=0;for(let Qt=0;Qt<ae;++Qt){const vn=$[N.idx[Qt]].type;for(let fn=8*mt;fn<8*mt+ht;++fn){St=ln[Qt][fn];for(let oi=0;oi<ie;++oi){const En=oi*64+(fn&7)*8;P.setUint16(St+0*vn,Wt[Qt][En+0],!0),P.setUint16(St+2*vn,Wt[Qt][En+1],!0),P.setUint16(St+4*vn,Wt[Qt][En+2],!0),P.setUint16(St+6*vn,Wt[Qt][En+3],!0),P.setUint16(St+8*vn,Wt[Qt][En+4],!0),P.setUint16(St+10*vn,Wt[Qt][En+5],!0),P.setUint16(St+12*vn,Wt[Qt][En+6],!0),P.setUint16(St+14*vn,Wt[Qt][En+7],!0),St+=16*vn}}if(ie!=we)for(let fn=8*mt;fn<8*mt+ht;++fn){const oi=ln[Qt][fn]+8*ie*2*vn,En=ie*64+(fn&7)*8;for(let Ui=0;Ui<zt;++Ui)P.setUint16(oi+Ui*2*vn,Wt[Qt][En+Ui],!0)}}}const Yt=new Uint16Array(Z);P=new DataView(De.buffer);for(let mt=0;mt<ae;++mt){$[N.idx[mt]].decoded=!0;const ht=$[N.idx[mt]].type;if($[mt].type==2)for(let zt=0;zt<se;++zt){const St=ln[mt][zt];for(let Qt=0;Qt<Z;++Qt)Yt[Qt]=P.getUint16(St+Qt*2*ht,!0);for(let Qt=0;Qt<Z;++Qt)P.setFloat32(St+Qt*2*ht,Oe(Yt[Qt]),!0)}}}function At(N,k,$,ue,_e,De){const P=new DataView(De.buffer),Z=$[N],se=Z.width,ae=Z.height,ie=Math.ceil(se/8),we=Math.ceil(ae/8),Ie=Math.floor(se/8),Re=se-(ie-1)*8,tt=ae-(we-1)*8,He={value:0};let at=0;const nt=new Float32Array(64),Et=new Uint16Array(64),Wt=new Uint16Array(ie*64);for(let ln=0;ln<we;++ln){let Yt=8;ln==we-1&&(Yt=tt);for(let mt=0;mt<ie;++mt)Et.fill(0),Et[0]=_e[at++],oe(He,ue,Et),Gt(Et,nt),Dt(nt),Tt(nt,Wt,mt*64);for(let mt=8*ln;mt<8*ln+Yt;++mt){let ht=k[N][mt];for(let zt=0;zt<Ie;++zt){const St=zt*64+(mt&7)*8;for(let Qt=0;Qt<8;++Qt)P.setUint16(ht+Qt*2*Z.type,Wt[St+Qt],!0);ht+=16*Z.type}if(ie!=Ie){const zt=Ie*64+(mt&7)*8;for(let St=0;St<Re;++St)P.setUint16(ht+St*2*Z.type,Wt[zt+St],!0)}}}Z.decoded=!0}function oe(N,k,$){let ue,_e=1;for(;_e<64;)ue=k[N.value],ue==65280?_e=64:ue>>8==255?_e+=ue&255:($[_e]=ue,_e++),N.value++}function Gt(N,k){k[0]=Oe(N[0]),k[1]=Oe(N[1]),k[2]=Oe(N[5]),k[3]=Oe(N[6]),k[4]=Oe(N[14]),k[5]=Oe(N[15]),k[6]=Oe(N[27]),k[7]=Oe(N[28]),k[8]=Oe(N[2]),k[9]=Oe(N[4]),k[10]=Oe(N[7]),k[11]=Oe(N[13]),k[12]=Oe(N[16]),k[13]=Oe(N[26]),k[14]=Oe(N[29]),k[15]=Oe(N[42]),k[16]=Oe(N[3]),k[17]=Oe(N[8]),k[18]=Oe(N[12]),k[19]=Oe(N[17]),k[20]=Oe(N[25]),k[21]=Oe(N[30]),k[22]=Oe(N[41]),k[23]=Oe(N[43]),k[24]=Oe(N[9]),k[25]=Oe(N[11]),k[26]=Oe(N[18]),k[27]=Oe(N[24]),k[28]=Oe(N[31]),k[29]=Oe(N[40]),k[30]=Oe(N[44]),k[31]=Oe(N[53]),k[32]=Oe(N[10]),k[33]=Oe(N[19]),k[34]=Oe(N[23]),k[35]=Oe(N[32]),k[36]=Oe(N[39]),k[37]=Oe(N[45]),k[38]=Oe(N[52]),k[39]=Oe(N[54]),k[40]=Oe(N[20]),k[41]=Oe(N[22]),k[42]=Oe(N[33]),k[43]=Oe(N[38]),k[44]=Oe(N[46]),k[45]=Oe(N[51]),k[46]=Oe(N[55]),k[47]=Oe(N[60]),k[48]=Oe(N[21]),k[49]=Oe(N[34]),k[50]=Oe(N[37]),k[51]=Oe(N[47]),k[52]=Oe(N[50]),k[53]=Oe(N[56]),k[54]=Oe(N[59]),k[55]=Oe(N[61]),k[56]=Oe(N[35]),k[57]=Oe(N[36]),k[58]=Oe(N[48]),k[59]=Oe(N[49]),k[60]=Oe(N[57]),k[61]=Oe(N[58]),k[62]=Oe(N[62]),k[63]=Oe(N[63])}function Dt(N){const k=.5*Math.cos(.7853975),$=.5*Math.cos(3.14159/16),ue=.5*Math.cos(3.14159/8),_e=.5*Math.cos(3*3.14159/16),De=.5*Math.cos(5*3.14159/16),P=.5*Math.cos(3*3.14159/8),Z=.5*Math.cos(7*3.14159/16),se=new Array(4),ae=new Array(4),ie=new Array(4),we=new Array(4);for(let Ie=0;Ie<8;++Ie){const Re=Ie*8;se[0]=ue*N[Re+2],se[1]=P*N[Re+2],se[2]=ue*N[Re+6],se[3]=P*N[Re+6],ae[0]=$*N[Re+1]+_e*N[Re+3]+De*N[Re+5]+Z*N[Re+7],ae[1]=_e*N[Re+1]-Z*N[Re+3]-$*N[Re+5]-De*N[Re+7],ae[2]=De*N[Re+1]-$*N[Re+3]+Z*N[Re+5]+_e*N[Re+7],ae[3]=Z*N[Re+1]-De*N[Re+3]+_e*N[Re+5]-$*N[Re+7],ie[0]=k*(N[Re+0]+N[Re+4]),ie[3]=k*(N[Re+0]-N[Re+4]),ie[1]=se[0]+se[3],ie[2]=se[1]-se[2],we[0]=ie[0]+ie[1],we[1]=ie[3]+ie[2],we[2]=ie[3]-ie[2],we[3]=ie[0]-ie[1],N[Re+0]=we[0]+ae[0],N[Re+1]=we[1]+ae[1],N[Re+2]=we[2]+ae[2],N[Re+3]=we[3]+ae[3],N[Re+4]=we[3]-ae[3],N[Re+5]=we[2]-ae[2],N[Re+6]=we[1]-ae[1],N[Re+7]=we[0]-ae[0]}for(let Ie=0;Ie<8;++Ie)se[0]=ue*N[16+Ie],se[1]=P*N[16+Ie],se[2]=ue*N[48+Ie],se[3]=P*N[48+Ie],ae[0]=$*N[8+Ie]+_e*N[24+Ie]+De*N[40+Ie]+Z*N[56+Ie],ae[1]=_e*N[8+Ie]-Z*N[24+Ie]-$*N[40+Ie]-De*N[56+Ie],ae[2]=De*N[8+Ie]-$*N[24+Ie]+Z*N[40+Ie]+_e*N[56+Ie],ae[3]=Z*N[8+Ie]-De*N[24+Ie]+_e*N[40+Ie]-$*N[56+Ie],ie[0]=k*(N[Ie]+N[32+Ie]),ie[3]=k*(N[Ie]-N[32+Ie]),ie[1]=se[0]+se[3],ie[2]=se[1]-se[2],we[0]=ie[0]+ie[1],we[1]=ie[3]+ie[2],we[2]=ie[3]-ie[2],we[3]=ie[0]-ie[1],N[0+Ie]=we[0]+ae[0],N[8+Ie]=we[1]+ae[1],N[16+Ie]=we[2]+ae[2],N[24+Ie]=we[3]+ae[3],N[32+Ie]=we[3]-ae[3],N[40+Ie]=we[2]-ae[2],N[48+Ie]=we[1]-ae[1],N[56+Ie]=we[0]-ae[0]}function qt(N){for(let k=0;k<64;++k){const $=N[0][k],ue=N[1][k],_e=N[2][k];N[0][k]=$+1.5747*_e,N[1][k]=$-.1873*ue-.4682*_e,N[2][k]=$+1.8556*ue}}function Tt(N,k,$){for(let ue=0;ue<64;++ue)k[$+ue]=iu.toHalfFloat(te(N[ue]))}function te(N){return N<=1?Math.sign(N)*Math.pow(Math.abs(N),2.2):Math.sign(N)*Math.pow(L,Math.abs(N)-1)}function G(N){return new DataView(N.array.buffer,N.offset.value,N.size)}function be(N){const k=N.viewer.buffer.slice(N.offset.value,N.offset.value+N.size),$=new Uint8Array(st(k)),ue=new Uint8Array($.length);return Mt($),je($,ue),new DataView(ue.buffer)}function Ye(N){const k=N.array.slice(N.offset.value,N.offset.value+N.size),$=Oy(k),ue=new Uint8Array($.length);return Mt($),je($,ue),new DataView(ue.buffer)}function ot(N){const k=N.viewer,$={value:N.offset.value},ue=new Uint16Array(N.columns*N.lines*(N.inputChannels.length*N.type)),_e=new Uint8Array(8192);let De=0;const P=new Array(N.inputChannels.length);for(let tt=0,He=N.inputChannels.length;tt<He;tt++)P[tt]={},P[tt].start=De,P[tt].end=P[tt].start,P[tt].nx=N.columns,P[tt].ny=N.lines,P[tt].size=N.type,De+=P[tt].nx*P[tt].ny*P[tt].size;const Z=It(k,$),se=It(k,$);if(se>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(Z<=se)for(let tt=0;tt<se-Z+1;tt++)_e[tt+Z]=Be(k,$);const ae=new Uint16Array(65536),ie=H(_e,ae),we=Bt(k,$);Pt(N.array,k,$,we,ue,De);for(let tt=0;tt<N.inputChannels.length;++tt){const He=P[tt];for(let at=0;at<P[tt].size;++at)Ee(ue,He.start+at,He.nx,He.size,He.ny,He.nx*He.size,ie)}Ot(ae,ue,De);let Ie=0;const Re=new Uint8Array(ue.buffer.byteLength);for(let tt=0;tt<N.lines;tt++)for(let He=0;He<N.inputChannels.length;He++){const at=P[He],nt=at.nx*at.size,Et=new Uint8Array(ue.buffer,at.end*2,nt*2);Re.set(Et,Ie),Ie+=nt*2,at.end+=nt}return new DataView(Re.buffer)}function Qe(N){const k=N.array.slice(N.offset.value,N.offset.value+N.size),$=Oy(k),ue=N.inputChannels.length*N.lines*N.columns*N.totalBytes,_e=new ArrayBuffer(ue),De=new DataView(_e);let P=0,Z=0;const se=new Array(4);for(let ae=0;ae<N.lines;ae++)for(let ie=0;ie<N.inputChannels.length;ie++){let we=0;switch(N.inputChannels[ie].pixelType){case 1:se[0]=P,se[1]=se[0]+N.columns,P=se[1]+N.columns;for(let Re=0;Re<N.columns;++Re){const tt=$[se[0]++]<<8|$[se[1]++];we+=tt,De.setUint16(Z,we,!0),Z+=2}break;case 2:se[0]=P,se[1]=se[0]+N.columns,se[2]=se[1]+N.columns,P=se[2]+N.columns;for(let Re=0;Re<N.columns;++Re){const tt=$[se[0]++]<<24|$[se[1]++]<<16|$[se[2]++]<<8;we+=tt,De.setUint32(Z,we,!0),Z+=4}break}}return De}function Ut(N){const k=N.viewer,$={value:N.offset.value},ue=new Uint8Array(N.columns*N.lines*(N.inputChannels.length*N.type*2)),_e={version:ft(k,$),unknownUncompressedSize:ft(k,$),unknownCompressedSize:ft(k,$),acCompressedSize:ft(k,$),dcCompressedSize:ft(k,$),rleCompressedSize:ft(k,$),rleUncompressedSize:ft(k,$),rleRawSize:ft(k,$),totalAcUncompressedCount:ft(k,$),totalDcUncompressedCount:ft(k,$),acCompression:ft(k,$)};if(_e.version<2)throw new Error("EXRLoader.parse: "+Je.compression+" version "+_e.version+" is unsupported");const De=new Array;let P=It(k,$)-2;for(;P>0;){const He=Rt(k.buffer,$),at=Be(k,$),nt=at>>2&3,Et=(at>>4)-1,Wt=new Int8Array([Et])[0],ln=Be(k,$);De.push({name:He,index:Wt,type:ln,compression:nt}),P-=He.length+3}const Z=Je.channels,se=new Array(N.inputChannels.length);for(let He=0;He<N.inputChannels.length;++He){const at=se[He]={},nt=Z[He];at.name=nt.name,at.compression=0,at.decoded=!1,at.type=nt.pixelType,at.pLinear=nt.pLinear,at.width=N.columns,at.height=N.lines}const ae={idx:new Array(3)};for(let He=0;He<N.inputChannels.length;++He){const at=se[He];for(let nt=0;nt<De.length;++nt){const Et=De[nt];at.name==Et.name&&(at.compression=Et.compression,Et.index>=0&&(ae.idx[Et.index]=He),at.offset=He)}}let ie,we,Ie;if(_e.acCompressedSize>0)switch(_e.acCompression){case 0:ie=new Uint16Array(_e.totalAcUncompressedCount),Pt(N.array,k,$,_e.acCompressedSize,ie,_e.totalAcUncompressedCount);break;case 1:const He=N.array.slice($.value,$.value+_e.totalAcUncompressedCount),at=Oy(He);ie=new Uint16Array(at.buffer),$.value+=_e.totalAcUncompressedCount;break}if(_e.dcCompressedSize>0){const He={array:N.array,offset:$,size:_e.dcCompressedSize};we=new Uint16Array(Ye(He).buffer),$.value+=_e.dcCompressedSize}if(_e.rleRawSize>0){const He=N.array.slice($.value,$.value+_e.rleCompressedSize),at=Oy(He);Ie=st(at.buffer),$.value+=_e.rleCompressedSize}let Re=0;const tt=new Array(se.length);for(let He=0;He<tt.length;++He)tt[He]=new Array;for(let He=0;He<N.lines;++He)for(let at=0;at<se.length;++at)tt[at].push(Re),Re+=se[at].width*N.type*2;ae.idx[0]!==void 0&&se[ae.idx[0]]&&et(ae,tt,se,ie,we,ue);for(let He=0;He<se.length;++He){const at=se[He];if(!at.decoded)switch(at.compression){case 2:let nt=0,Et=0;for(let Wt=0;Wt<N.lines;++Wt){let ln=tt[He][nt];for(let Yt=0;Yt<at.width;++Yt){for(let mt=0;mt<2*at.type;++mt)ue[ln++]=Ie[Et+mt*at.width*at.height];Et++}nt++}break;case 1:At(He,tt,se,ie,we,ue);break;default:throw new Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(ue.buffer)}function Rt(N,k){const $=new Uint8Array(N);let ue=0;for(;$[k.value+ue]!=0;)ue+=1;const _e=new TextDecoder().decode($.slice(k.value,k.value+ue));return k.value=k.value+ue+1,_e}function Vt(N,k,$){const ue=new TextDecoder().decode(new Uint8Array(N).slice(k.value,k.value+$));return k.value=k.value+$,ue}function $t(N,k){const $=ct(N,k),ue=Bt(N,k);return[$,ue]}function vt(N,k){const $=Bt(N,k),ue=Bt(N,k);return[$,ue]}function ct(N,k){const $=N.getInt32(k.value,!0);return k.value=k.value+4,$}function Bt(N,k){const $=N.getUint32(k.value,!0);return k.value=k.value+4,$}function he(N,k){const $=N[k.value];return k.value=k.value+1,$}function Be(N,k){const $=N.getUint8(k.value);return k.value=k.value+1,$}const ft=function(N,k){let $;return"getBigInt64"in DataView.prototype?$=Number(N.getBigInt64(k.value,!0)):$=N.getUint32(k.value+4,!0)+Number(N.getUint32(k.value,!0)<<32),k.value+=8,$};function pe(N,k){const $=N.getFloat32(k.value,!0);return k.value+=4,$}function Fe(N,k){return iu.toHalfFloat(pe(N,k))}function Oe(N){const k=(N&31744)>>10,$=N&1023;return(N>>15?-1:1)*(k?k===31?$?NaN:1/0:Math.pow(2,k-15)*(1+$/1024):6103515625e-14*($/1024))}function It(N,k){const $=N.getUint16(k.value,!0);return k.value+=2,$}function _t(N,k){return Oe(It(N,k))}function ut(N,k,$,ue){const _e=$.value,De=[];for(;$.value<_e+ue-1;){const P=Rt(k,$),Z=ct(N,$),se=Be(N,$);$.value+=3;const ae=ct(N,$),ie=ct(N,$);De.push({name:P,pixelType:Z,pLinear:se,xSampling:ae,ySampling:ie})}return $.value+=1,De}function wt(N,k){const $=pe(N,k),ue=pe(N,k),_e=pe(N,k),De=pe(N,k),P=pe(N,k),Z=pe(N,k),se=pe(N,k),ae=pe(N,k);return{redX:$,redY:ue,greenX:_e,greenY:De,blueX:P,blueY:Z,whiteX:se,whiteY:ae}}function Zt(N,k){const $=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],ue=Be(N,k);return $[ue]}function yn(N,k){const $=ct(N,k),ue=ct(N,k),_e=ct(N,k),De=ct(N,k);return{xMin:$,yMin:ue,xMax:_e,yMax:De}}function _n(N,k){const $=["INCREASING_Y","DECREASING_Y","RANDOM_Y"],ue=Be(N,k);return $[ue]}function Si(N,k){const $=["ENVMAP_LATLONG","ENVMAP_CUBE"],ue=Be(N,k);return $[ue]}function ji(N,k){const $=["ONE_LEVEL","MIPMAP_LEVELS","RIPMAP_LEVELS"],ue=["ROUND_DOWN","ROUND_UP"],_e=Bt(N,k),De=Bt(N,k),P=Be(N,k);return{xSize:_e,ySize:De,levelMode:$[P&15],roundingMode:ue[P>>4]}}function ha(N,k){const $=pe(N,k),ue=pe(N,k);return[$,ue]}function pa(N,k){const $=pe(N,k),ue=pe(N,k),_e=pe(N,k);return[$,ue,_e]}function Ts(N,k,$,ue,_e){if(ue==="string"||ue==="stringvector"||ue==="iccProfile")return Vt(k,$,_e);if(ue==="chlist")return ut(N,k,$,_e);if(ue==="chromaticities")return wt(N,$);if(ue==="compression")return Zt(N,$);if(ue==="box2i")return yn(N,$);if(ue==="envmap")return Si(N,$);if(ue==="tiledesc")return ji(N,$);if(ue==="lineOrder")return _n(N,$);if(ue==="float")return pe(N,$);if(ue==="v2f")return ha(N,$);if(ue==="v3f")return pa(N,$);if(ue==="int")return ct(N,$);if(ue==="rational")return $t(N,$);if(ue==="timecode")return vt(N,$);if(ue==="preview")return $.value+=_e,"skipped";$.value+=_e}function ma(N,k){const $=Math.log2(N);return k=="ROUND_DOWN"?Math.floor($):Math.ceil($)}function Xr(N,k,$){let ue=0;switch(N.levelMode){case"ONE_LEVEL":ue=1;break;case"MIPMAP_LEVELS":ue=ma(Math.max(k,$),N.roundingMode)+1;break;case"RIPMAP_LEVELS":throw new Error("THREE.EXRLoader: RIPMAP_LEVELS tiles currently unsupported.")}return ue}function is(N,k,$,ue){const _e=new Array(N);for(let De=0;De<N;De++){const P=1<<De;let Z=k/P|0;ue=="ROUND_UP"&&Z*P<k&&(Z+=1);const se=Math.max(Z,1);_e[De]=(se+$-1)/$|0}return _e}function rn(){const N=this,k=N.offset,$={value:0};for(let ue=0;ue<N.tileCount;ue++){const _e=ct(N.viewer,k),De=ct(N.viewer,k);k.value+=8,N.size=Bt(N.viewer,k);const P=_e*N.blockWidth,Z=De*N.blockHeight;N.columns=P+N.blockWidth>N.width?N.width-P:N.blockWidth,N.lines=Z+N.blockHeight>N.height?N.height-Z:N.blockHeight;const se=N.columns*N.totalBytes,ie=N.size<N.lines*se?N.uncompress(N):G(N);k.value+=N.size;for(let we=0;we<N.lines;we++){const Ie=we*N.columns*N.totalBytes;for(let Re=0;Re<N.inputChannels.length;Re++){const tt=Je.channels[Re].name,He=N.channelByteOffsets[tt]*N.columns,at=N.decodeChannels[tt];if(at===void 0)continue;$.value=Ie+He;const nt=(N.height-(1+Z+we))*N.outLineWidth;for(let Et=0;Et<N.columns;Et++){const Wt=nt+(Et+P)*N.outputChannels+at;N.byteArray[Wt]=N.getter(ie,$)}}}}}function Br(){const N=this,k=N.offset,$={value:0};for(let ue=0;ue<N.height/N.blockHeight;ue++){const _e=ct(N.viewer,k)-Je.dataWindow.yMin;N.size=Bt(N.viewer,k),N.lines=_e+N.blockHeight>N.height?N.height-_e:N.blockHeight;const De=N.columns*N.totalBytes,Z=N.size<N.lines*De?N.uncompress(N):G(N);k.value+=N.size;for(let se=0;se<N.blockHeight;se++){const ae=ue*N.blockHeight,ie=se+N.scanOrder(ae);if(ie>=N.height)continue;const we=se*De,Ie=(N.height-1-ie)*N.outLineWidth;for(let Re=0;Re<N.inputChannels.length;Re++){const tt=Je.channels[Re].name,He=N.channelByteOffsets[tt]*N.columns,at=N.decodeChannels[tt];if(at!==void 0){$.value=we+He;for(let nt=0;nt<N.columns;nt++){const Et=Ie+nt*N.outputChannels+at;N.byteArray[Et]=N.getter(Z,$)}}}}}}function bi(N,k,$){const ue={};if(N.getUint32(0,!0)!=20000630)throw new Error("THREE.EXRLoader: Provided file doesn't appear to be in OpenEXR format.");ue.version=N.getUint8(4);const _e=N.getUint8(5);ue.spec={singleTile:!!(_e&2),longName:!!(_e&4),deepFormat:!!(_e&8),multiPart:!!(_e&16)},$.value=8;let De=!0;for(;De;){const P=Rt(k,$);if(P==="")De=!1;else{const Z=Rt(k,$),se=Bt(N,$),ae=Ts(N,k,$,Z,se);ae===void 0?console.warn(`THREE.EXRLoader: Skipped unknown header attribute type '${Z}'.`):ue[P]=ae}}if((_e&-7)!=0)throw console.error("THREE.EXRHeader:",ue),new Error("THREE.EXRLoader: Provided file is currently unsupported.");return ue}function V(N,k,$,ue,_e,De){const P={size:0,viewer:k,array:$,offset:ue,width:N.dataWindow.xMax-N.dataWindow.xMin+1,height:N.dataWindow.yMax-N.dataWindow.yMin+1,inputChannels:N.channels,channelByteOffsets:{},shouldExpand:!1,scanOrder:null,totalBytes:null,columns:null,lines:null,type:null,uncompress:null,getter:null,format:null,colorSpace:kr};switch(N.compression){case"NO_COMPRESSION":P.blockHeight=1,P.uncompress=G;break;case"RLE_COMPRESSION":P.blockHeight=1,P.uncompress=be;break;case"ZIPS_COMPRESSION":P.blockHeight=1,P.uncompress=Ye;break;case"ZIP_COMPRESSION":P.blockHeight=16,P.uncompress=Ye;break;case"PIZ_COMPRESSION":P.blockHeight=32,P.uncompress=ot;break;case"PXR24_COMPRESSION":P.blockHeight=16,P.uncompress=Qe;break;case"DWAA_COMPRESSION":P.blockHeight=32,P.uncompress=Ut;break;case"DWAB_COMPRESSION":P.blockHeight=256,P.uncompress=Ut;break;default:throw new Error("EXRLoader.parse: "+N.compression+" is unsupported")}const Z={};for(const Ie of N.channels)switch(Ie.name){case"Y":case"R":case"G":case"B":case"A":Z[Ie.name]=!0,P.type=Ie.pixelType}let se=!1,ae=!1;if(Z.R&&Z.G&&Z.B)P.outputChannels=4;else if(Z.Y)P.outputChannels=1;else throw new Error("EXRLoader.parse: file contains unsupported data channels.");switch(P.outputChannels){case 4:De==Ai?(se=!Z.A,P.format=Ai,P.colorSpace=kr,P.outputChannels=4,P.decodeChannels={R:0,G:1,B:2,A:3}):De==Bo?(P.format=Bo,P.colorSpace=kr,P.outputChannels=2,P.decodeChannels={R:0,G:1}):De==tc?(P.format=tc,P.colorSpace=kr,P.outputChannels=1,P.decodeChannels={R:0}):ae=!0;break;case 1:De==Ai?(se=!0,P.format=Ai,P.colorSpace=kr,P.outputChannels=4,P.shouldExpand=!0,P.decodeChannels={Y:0}):De==Bo?(P.format=Bo,P.colorSpace=kr,P.outputChannels=2,P.shouldExpand=!0,P.decodeChannels={Y:0}):De==tc?(P.format=tc,P.colorSpace=kr,P.outputChannels=1,P.decodeChannels={Y:0}):ae=!0;break;default:ae=!0}if(ae)throw new Error("EXRLoader.parse: invalid output format for specified file.");if(P.type==1)switch(_e){case si:P.getter=_t;break;case On:P.getter=It;break}else if(P.type==2)switch(_e){case si:P.getter=pe;break;case On:P.getter=Fe}else throw new Error("EXRLoader.parse: unsupported pixelType "+P.type+" for "+N.compression+".");P.columns=P.width;const ie=P.width*P.height*P.outputChannels;switch(_e){case si:P.byteArray=new Float32Array(ie),se&&P.byteArray.fill(1,0,ie);break;case On:P.byteArray=new Uint16Array(ie),se&&P.byteArray.fill(15360,0,ie);break;default:console.error("THREE.EXRLoader: unsupported type: ",_e);break}let we=0;for(const Ie of N.channels)P.decodeChannels[Ie.name]!==void 0&&(P.channelByteOffsets[Ie.name]=we),we+=Ie.pixelType*2;if(P.totalBytes=we,P.outLineWidth=P.width*P.outputChannels,N.lineOrder==="INCREASING_Y"?P.scanOrder=Ie=>Ie:P.scanOrder=Ie=>P.height-1-Ie,N.spec.singleTile){P.blockHeight=N.tiles.ySize,P.blockWidth=N.tiles.xSize;const Ie=Xr(N.tiles,P.width,P.height),Re=is(Ie,P.width,N.tiles.xSize,N.tiles.roundingMode),tt=is(Ie,P.height,N.tiles.ySize,N.tiles.roundingMode);P.tileCount=Re[0]*tt[0];for(let He=0;He<Ie;He++)for(let at=0;at<tt[He];at++)for(let nt=0;nt<Re[He];nt++)ft(k,ue);P.decode=rn.bind(P)}else{P.blockWidth=P.width;const Ie=Math.ceil(P.height/P.blockHeight);for(let Re=0;Re<Ie;Re++)ft(k,ue);P.decode=Br.bind(P)}return P}const ee={value:0},xe=new DataView(e),Ge=new Uint8Array(e),Je=bi(xe,e,ee),Ke=V(Je,xe,Ge,ee,this.type,this.outputFormat);if(Ke.decode(),Ke.shouldExpand){const N=Ke.byteArray;if(this.outputFormat==Ai)for(let k=0;k<N.length;k+=4)N[k+2]=N[k+1]=N[k];else if(this.outputFormat==Bo)for(let k=0;k<N.length;k+=2)N[k+1]=N[k]}return{header:Je,width:Ke.width,height:Ke.height,data:Ke.byteArray,format:Ke.format,colorSpace:Ke.colorSpace,type:this.type}}setDataType(e){return this.type=e,this}setOutputFormat(e){return this.outputFormat=e,this}load(e,t,n,r){function s(o,u){o.colorSpace=u.colorSpace,o.minFilter=on,o.magFilter=on,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,u)}return super.load(e,s,n,r)}}class ZD extends gr{load(e,t,n,r){const s=new ds(this.manager);s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(this.withCredentials),s.load(e,o=>{$A(o instanceof ArrayBuffer);try{t(o)}catch(u){r!=null?r(u):console.error(u),this.manager.itemError(e)}},n,r)}}function $D(i){var e,t;return i instanceof Y_?i.getContext().getExtension("OES_texture_float_linear")!=null:((t=(e=i.backend).hasFeature)==null?void 0:t.call(e,"float32-filterable"))??!1}const wk=128,Ck=128,Rk=64,Dk="9627216cc50057994c98a2118f3c4a23765d43b9",Ik=`https://media.githubusercontent.com/media/takram-design-engineering/three-geospatial/${Dk}/packages/core/assets/stbn.bin`,Bk="This is not an object",Nk="This is not a Float16Array object",bR="This constructor is not a subclass of Float16Array",eI="The constructor property value is not an object",Ok="Species constructor didn't return TypedArray object",Lk="Derived constructor created TypedArray object which was too small length",av="Attempting to access detached ArrayBuffer",rM="Cannot convert undefined or null to object",sM="Cannot mix BigInt and other types, use explicit conversions",ER="@@iterator property is not callable",MR="Reduce of empty array with no initial value",Pk="The comparison function must be either a function or undefined",vE="Offset is out of bounds";function Vi(i){return(e,...t)=>Ua(i,e,t)}function Fm(i,e){return Vi(Tm(i,e).get)}const{apply:Ua,construct:Wg,defineProperty:Uk,get:xE,getOwnPropertyDescriptor:Tm,getPrototypeOf:Jv,has:aM,ownKeys:tI,set:TR,setPrototypeOf:nI}=Reflect,Fk=Proxy,{EPSILON:zk,MAX_SAFE_INTEGER:wR,isFinite:iI,isNaN:wm}=Number,{iterator:oc,species:Hk,toStringTag:VT,for:Gk}=Symbol,Cm=Object,{create:$_,defineProperty:Kv,freeze:kk,is:CR}=Cm,oM=Cm.prototype,Vk=oM.__lookupGetter__?Vi(oM.__lookupGetter__):(i,e)=>{if(i==null)throw sr(rM);let t=Cm(i);do{const n=Tm(t,e);if(n!==void 0)return tu(n,"get")?n.get:void 0}while((t=Jv(t))!==null)},tu=Cm.hasOwn||Vi(oM.hasOwnProperty),rI=Array,sI=rI.isArray,eS=rI.prototype,jk=Vi(eS.join),Wk=Vi(eS.push),Xk=Vi(eS.toLocaleString),jT=eS[oc],Yk=Vi(jT),{abs:Qk,trunc:aI}=Math,tS=ArrayBuffer,qk=tS.isView,oI=tS.prototype,Jk=Vi(oI.slice),Kk=Fm(oI,"byteLength"),lM=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null,Zk=lM&&Fm(lM.prototype,"byteLength"),WT=Jv(Uint8Array),$k=WT.from,hs=WT.prototype,eV=hs[oc],tV=Vi(hs.keys),nV=Vi(hs.values),iV=Vi(hs.entries),rV=Vi(hs.set),RR=Vi(hs.reverse),sV=Vi(hs.fill),aV=Vi(hs.copyWithin),DR=Vi(hs.sort),Og=Vi(hs.slice),oV=Vi(hs.subarray),cs=Fm(hs,"buffer"),Rf=Fm(hs,"byteOffset"),xi=Fm(hs,"length"),lI=Fm(hs,VT),lV=Uint8Array,qa=Uint16Array,IR=(...i)=>Ua($k,qa,i),XT=Uint32Array,cV=Float32Array,ah=Jv([][oc]()),nS=Vi(ah.next),uV=Vi((function*(){})().next),dV=Jv(ah),fV=DataView.prototype,hV=Vi(fV.getUint16),sr=TypeError,yE=RangeError,cI=WeakSet,uI=cI.prototype,pV=Vi(uI.add),mV=Vi(uI.has),iS=WeakMap,YT=iS.prototype,e_=Vi(YT.get),gV=Vi(YT.has),QT=Vi(YT.set),dI=new iS,vV=$_(null,{next:{value:function(){const i=e_(dI,this);return nS(i)}},[oc]:{value:function(){return this}}});function Xg(i){if(i[oc]===jT&&ah.next===nS)return i;const e=$_(vV);return QT(dI,e,Yk(i)),e}const fI=new iS,hI=$_(dV,{next:{value:function(){const i=e_(fI,this);return uV(i)},writable:!0,configurable:!0}});for(const i of tI(ah))i!=="next"&&Kv(hI,i,Tm(ah,i));function BR(i){const e=$_(hI);return QT(fI,e,i),e}function t_(i){return i!==null&&typeof i=="object"||typeof i=="function"}function NR(i){return i!==null&&typeof i=="object"}function n_(i){return lI(i)!==void 0}function cM(i){const e=lI(i);return e==="BigInt64Array"||e==="BigUint64Array"}function xV(i){try{return sI(i)?!1:(Kk(i),!0)}catch{return!1}}function pI(i){if(lM===null)return!1;try{return Zk(i),!0}catch{return!1}}function yV(i){return xV(i)||pI(i)}function OR(i){return sI(i)?i[oc]===jT&&ah.next===nS:!1}function AV(i){return n_(i)?i[oc]===eV&&ah.next===nS:!1}function Ly(i){if(typeof i!="string")return!1;const e=+i;return i!==e+""||!iI(e)?!1:e===aI(e)}const i_=Gk("__Float16Array__");function _V(i){if(!NR(i))return!1;const e=Jv(i);if(!NR(e))return!1;const t=e.constructor;if(t===void 0)return!1;if(!t_(t))throw sr(eI);return aM(t,i_)}const uM=1/zk;function SV(i){return i+uM-uM}const mI=6103515625e-14,bV=65504,gI=.0009765625,LR=gI*mI,EV=gI*uM;function MV(i){const e=+i;if(!iI(e)||e===0)return e;const t=e>0?1:-1,n=Qk(e);if(n<mI)return t*SV(n/LR)*LR;const r=(1+EV)*n,s=r-(r-n);return s>bV||wm(s)?t*(1/0):t*s}const vI=new tS(4),xI=new cV(vI),yI=new XT(vI),ll=new qa(512),cl=new lV(512);for(let i=0;i<256;++i){const e=i-127;e<-24?(ll[i]=0,ll[i|256]=32768,cl[i]=24,cl[i|256]=24):e<-14?(ll[i]=1024>>-e-14,ll[i|256]=1024>>-e-14|32768,cl[i]=-e-1,cl[i|256]=-e-1):e<=15?(ll[i]=e+15<<10,ll[i|256]=e+15<<10|32768,cl[i]=13,cl[i|256]=13):e<128?(ll[i]=31744,ll[i|256]=64512,cl[i]=24,cl[i|256]=24):(ll[i]=31744,ll[i|256]=64512,cl[i]=13,cl[i|256]=13)}function Kl(i){xI[0]=MV(i);const e=yI[0],t=e>>23&511;return ll[t]+((e&8388607)>>cl[t])}const qT=new XT(2048);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,qT[i]=e|t}for(let i=1024;i<2048;++i)qT[i]=939524096+(i-1024<<13);const zm=new XT(64);for(let i=1;i<31;++i)zm[i]=i<<23;zm[31]=1199570944;zm[32]=2147483648;for(let i=33;i<63;++i)zm[i]=2147483648+(i-32<<23);zm[63]=3347054592;const AI=new qa(64);for(let i=1;i<64;++i)i!==32&&(AI[i]=1024);function Ei(i){const e=i>>10;return yI[0]=qT[AI[e]+(i&1023)]+zm[e],xI[0]}function Xc(i){const e=+i;return wm(e)||e===0?0:aI(e)}function AE(i){const e=Xc(i);return e<0?0:e<wR?e:wR}function Py(i,e){if(!t_(i))throw sr(Bk);const t=i.constructor;if(t===void 0)return e;if(!t_(t))throw sr(eI);return t[Hk]??e}function ov(i){if(pI(i))return!1;try{return Jk(i,0,0),!1}catch{}return!0}function PR(i,e){const t=wm(i),n=wm(e);if(t&&n)return 0;if(t)return 1;if(n||i<e)return-1;if(i>e)return 1;if(i===0&&e===0){const r=CR(i,0),s=CR(e,0);if(!r&&s)return-1;if(r&&!s)return 1}return 0}const JT=2,r_=new iS;function nm(i){return gV(r_,i)||!qk(i)&&_V(i)}function vi(i){if(!nm(i))throw sr(Nk)}function Uy(i,e){const t=nm(i),n=n_(i);if(!t&&!n)throw sr(Ok);if(typeof e=="number"){let r;if(t){const s=zn(i);r=xi(s)}else r=xi(i);if(r<e)throw sr(Lk)}if(cM(i))throw sr(sM)}function zn(i){const e=e_(r_,i);if(e!==void 0){const r=cs(e);if(ov(r))throw sr(av);return e}const t=i.buffer;if(ov(t))throw sr(av);const n=Wg(cu,[t,i.byteOffset,i.length],i.constructor);return e_(r_,n)}function UR(i){const e=xi(i),t=[];for(let n=0;n<e;++n)t[n]=Ei(i[n]);return t}const _I=new cI;for(const i of tI(hs)){if(i===VT)continue;const e=Tm(hs,i);tu(e,"get")&&typeof e.get=="function"&&pV(_I,e.get)}const TV=kk({get(i,e,t){return Ly(e)&&tu(i,e)?Ei(xE(i,e)):mV(_I,Vk(i,e))?xE(i,e):xE(i,e,t)},set(i,e,t,n){return Ly(e)&&tu(i,e)?TR(i,e,Kl(t)):TR(i,e,t,n)},getOwnPropertyDescriptor(i,e){if(Ly(e)&&tu(i,e)){const t=Tm(i,e);return t.value=Ei(t.value),t}return Tm(i,e)},defineProperty(i,e,t){return Ly(e)&&tu(i,e)&&tu(t,"value")&&(t.value=Kl(t.value)),Uk(i,e,t)}});let cu=class us{constructor(e,t,n){let r;if(nm(e))r=Wg(qa,[zn(e)],new.target);else if(t_(e)&&!yV(e)){let o,u;if(n_(e)){o=e,u=xi(e);const f=cs(e);if(ov(f))throw sr(av);if(cM(e))throw sr(sM);const p=new tS(u*JT);r=Wg(qa,[p],new.target)}else{const f=e[oc];if(f!=null&&typeof f!="function")throw sr(ER);f!=null?OR(e)?(o=e,u=e.length):(o=[...e],u=o.length):(o=e,u=AE(o.length)),r=Wg(qa,[u],new.target)}for(let f=0;f<u;++f)r[f]=Kl(o[f])}else r=Wg(qa,arguments,new.target);const s=new Fk(r,TV);return QT(r_,s,r),s}static from(e,...t){const n=this;if(!aM(n,i_))throw sr(bR);if(n===us){if(nm(e)&&t.length===0){const g=zn(e),v=new qa(cs(g),Rf(g),xi(g));return new us(cs(Og(v)))}if(t.length===0)return new us(cs(IR(e,Kl)));const f=t[0],p=t[1];return new us(cs(IR(e,function(g,...v){return Kl(Ua(f,this,[g,...Xg(v)]))},p)))}let r,s;const o=e[oc];if(o!=null&&typeof o!="function")throw sr(ER);if(o!=null)OR(e)?(r=e,s=e.length):AV(e)?(r=e,s=xi(e)):(r=[...e],s=r.length);else{if(e==null)throw sr(rM);r=Cm(e),s=AE(r.length)}const u=new n(s);if(t.length===0)for(let f=0;f<s;++f)u[f]=r[f];else{const f=t[0],p=t[1];for(let g=0;g<s;++g)u[g]=Ua(f,p,[r[g],g])}return u}static of(...e){const t=this;if(!aM(t,i_))throw sr(bR);const n=e.length;if(t===us){const s=new us(n),o=zn(s);for(let u=0;u<n;++u)o[u]=Kl(e[u]);return s}const r=new t(n);for(let s=0;s<n;++s)r[s]=e[s];return r}keys(){vi(this);const e=zn(this);return tV(e)}values(){vi(this);const e=zn(this);return BR((function*(){for(const t of nV(e))yield Ei(t)})())}entries(){vi(this);const e=zn(this);return BR((function*(){for(const[t,n]of iV(e))yield[t,Ei(n)]})())}at(e){vi(this);const t=zn(this),n=xi(t),r=Xc(e),s=r>=0?r:n+r;if(!(s<0||s>=n))return Ei(t[s])}with(e,t){vi(this);const n=zn(this),r=xi(n),s=Xc(e),o=s>=0?s:r+s,u=+t;if(o<0||o>=r)throw yE(vE);const f=new qa(cs(n),Rf(n),xi(n)),p=new us(cs(Og(f))),g=zn(p);return g[o]=Kl(u),p}map(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0],o=Py(n,us);if(o===us){const f=new us(r),p=zn(f);for(let g=0;g<r;++g){const v=Ei(n[g]);p[g]=Kl(Ua(e,s,[v,g,this]))}return f}const u=new o(r);Uy(u,r);for(let f=0;f<r;++f){const p=Ei(n[f]);u[f]=Ua(e,s,[p,f,this])}return u}filter(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0],o=[];for(let p=0;p<r;++p){const g=Ei(n[p]);Ua(e,s,[g,p,this])&&Wk(o,g)}const u=Py(n,us),f=new u(o);return Uy(f),f}reduce(e,...t){vi(this);const n=zn(this),r=xi(n);if(r===0&&t.length===0)throw sr(MR);let s,o;t.length===0?(s=Ei(n[0]),o=1):(s=t[0],o=0);for(let u=o;u<r;++u)s=e(s,Ei(n[u]),u,this);return s}reduceRight(e,...t){vi(this);const n=zn(this),r=xi(n);if(r===0&&t.length===0)throw sr(MR);let s,o;t.length===0?(s=Ei(n[r-1]),o=r-2):(s=t[0],o=r-1);for(let u=o;u>=0;--u)s=e(s,Ei(n[u]),u,this);return s}forEach(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=0;o<r;++o)Ua(e,s,[Ei(n[o]),o,this])}find(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=0;o<r;++o){const u=Ei(n[o]);if(Ua(e,s,[u,o,this]))return u}}findIndex(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=0;o<r;++o){const u=Ei(n[o]);if(Ua(e,s,[u,o,this]))return o}return-1}findLast(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=r-1;o>=0;--o){const u=Ei(n[o]);if(Ua(e,s,[u,o,this]))return u}}findLastIndex(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=r-1;o>=0;--o){const u=Ei(n[o]);if(Ua(e,s,[u,o,this]))return o}return-1}every(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=0;o<r;++o)if(!Ua(e,s,[Ei(n[o]),o,this]))return!1;return!0}some(e,...t){vi(this);const n=zn(this),r=xi(n),s=t[0];for(let o=0;o<r;++o)if(Ua(e,s,[Ei(n[o]),o,this]))return!0;return!1}set(e,...t){vi(this);const n=zn(this),r=Xc(t[0]);if(r<0)throw yE(vE);if(e==null)throw sr(rM);if(cM(e))throw sr(sM);if(nm(e))return rV(zn(this),zn(e),r);if(n_(e)){const f=cs(e);if(ov(f))throw sr(av)}const s=xi(n),o=Cm(e),u=AE(o.length);if(r===1/0||u+r>s)throw yE(vE);for(let f=0;f<u;++f)n[f+r]=Kl(o[f])}reverse(){vi(this);const e=zn(this);return RR(e),this}toReversed(){vi(this);const e=zn(this),t=new qa(cs(e),Rf(e),xi(e)),n=new us(cs(Og(t))),r=zn(n);return RR(r),n}fill(e,...t){vi(this);const n=zn(this);return sV(n,Kl(e),...Xg(t)),this}copyWithin(e,t,...n){vi(this);const r=zn(this);return aV(r,e,t,...Xg(n)),this}sort(e){vi(this);const t=zn(this),n=e!==void 0?e:PR;return DR(t,(r,s)=>n(Ei(r),Ei(s))),this}toSorted(e){vi(this);const t=zn(this);if(e!==void 0&&typeof e!="function")throw new sr(Pk);const n=e!==void 0?e:PR,r=new qa(cs(t),Rf(t),xi(t)),s=new us(cs(Og(r))),o=zn(s);return DR(o,(u,f)=>n(Ei(u),Ei(f))),s}slice(e,t){vi(this);const n=zn(this),r=Py(n,us);if(r===us){const S=new qa(cs(n),Rf(n),xi(n));return new us(cs(Og(S,e,t)))}const s=xi(n),o=Xc(e),u=t===void 0?s:Xc(t);let f;o===-1/0?f=0:o<0?f=s+o>0?s+o:0:f=s<o?s:o;let p;u===-1/0?p=0:u<0?p=s+u>0?s+u:0:p=s<u?s:u;const g=p-f>0?p-f:0,v=new r(g);if(Uy(v,g),g===0)return v;const y=cs(n);if(ov(y))throw sr(av);let A=0;for(;f<p;)v[A]=Ei(n[f]),++f,++A;return v}subarray(e,t){vi(this);const n=zn(this),r=Py(n,us),s=new qa(cs(n),Rf(n),xi(n)),o=oV(s,e,t),u=new r(cs(o),Rf(o),xi(o));return Uy(u),u}indexOf(e,...t){vi(this);const n=zn(this),r=xi(n);let s=Xc(t[0]);if(s===1/0)return-1;s<0&&(s+=r,s<0&&(s=0));for(let o=s;o<r;++o)if(tu(n,o)&&Ei(n[o])===e)return o;return-1}lastIndexOf(e,...t){vi(this);const n=zn(this),r=xi(n);let s=t.length>=1?Xc(t[0]):r-1;if(s===-1/0)return-1;s>=0?s=s<r-1?s:r-1:s+=r;for(let o=s;o>=0;--o)if(tu(n,o)&&Ei(n[o])===e)return o;return-1}includes(e,...t){vi(this);const n=zn(this),r=xi(n);let s=Xc(t[0]);if(s===1/0)return!1;s<0&&(s+=r,s<0&&(s=0));const o=wm(e);for(let u=s;u<r;++u){const f=Ei(n[u]);if(o&&wm(f)||f===e)return!0}return!1}join(e){vi(this);const t=zn(this),n=UR(t);return jk(n,e)}toLocaleString(...e){vi(this);const t=zn(this),n=UR(t);return Xk(n,...Xg(e))}get[VT](){if(nm(this))return"Float16Array"}};Kv(cu,"BYTES_PER_ELEMENT",{value:JT});Kv(cu,i_,{});nI(cu,WT);const s_=cu.prototype;Kv(s_,"BYTES_PER_ELEMENT",{value:JT});Kv(s_,oc,{value:s_.values,writable:!0,configurable:!0});nI(s_,hs);function wV(i,e,...t){return Ei(hV(i,e,...Xg(t)))}let CV=class extends gr{constructor(e,t){super(t),this.parser=e}load(e,t,n,r){const s=new ZD(this.manager);s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(this.withCredentials),s.load(e,o=>{try{t(this.parser(o))}catch(u){r!=null?r(u):console.error(u),this.manager.itemError(e)}},n,r)}};function RV(i){const e=i instanceof Int8Array?Iv:i instanceof Uint8Array||i instanceof Uint8ClampedArray?_i:i instanceof Int16Array?Bv:i instanceof Uint16Array?Kf:i instanceof Int32Array?Im:i instanceof Uint32Array?ca:i instanceof cu?On:i instanceof Float32Array||i instanceof Float64Array?si:null;return $A(e!=null),e}let Zp=class extends gr{constructor(e,t,n={},r){super(r),this.textureClass=e,this.parser=t,this.options={format:Ai,minFilter:on,magFilter:on,...n}}load(e,t,n,r){const s=new this.textureClass,o=new CV(this.parser,this.manager);return o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),o.load(e,u=>{s.image.data=u instanceof cu?new Uint16Array(u.buffer):u;const{width:f,height:p,depth:g,...v}=this.options;f!=null&&(s.image.width=f),p!=null&&(s.image.height=p),"depth"in s.image&&g!=null&&(s.image.depth=g),s.type=RV(u),Object.assign(s,v),s.needsUpdate=!0,t==null||t(s)},n,r),s}};const dM=to.clamp;to.euclideanModulo;to.inverseLerp;to.lerp;const Ev=to.degToRad;to.radToDeg;to.isPowerOfTwo;to.ceilPowerOfTwo;to.floorPowerOfTwo;to.normalize;function DV(i,e,t,n=0,r=1){return to.mapLinear(i,e,t,n,r)}function IV(i){return Math.min(Math.max(i,0),1)}function or(i){return(e,t)=>{e instanceof mr?Object.defineProperty(e,t,{enumerable:!0,get(){var n;return((n=this.defines)==null?void 0:n[i])!=null},set(n){var r;n!==this[t]&&(n?(this.defines??(this.defines={}),this.defines[i]="1"):(r=this.defines)==null||delete r[i],this.needsUpdate=!0)}}):Object.defineProperty(e,t,{enumerable:!0,get(){return this.defines.has(i)},set(n){n!==this[t]&&(n?this.defines.set(i,"1"):this.defines.delete(i),this.setChanged())}})}}function BV(i,{min:e=Number.MIN_SAFE_INTEGER,max:t=Number.MAX_SAFE_INTEGER}={}){return(n,r)=>{n instanceof mr?Object.defineProperty(n,r,{enumerable:!0,get(){var o;const s=(o=this.defines)==null?void 0:o[i];return s!=null?parseInt(s,10):0},set(s){const o=this[r];s!==o&&(this.defines??(this.defines={}),this.defines[i]=dM(s,e,t).toFixed(0),this.needsUpdate=!0)}}):Object.defineProperty(n,r,{enumerable:!0,get(){const s=this.defines.get(i);return s!=null?parseInt(s,10):0},set(s){const o=this[r];s!==o&&(this.defines.set(i,dM(s,e,t).toFixed(0)),this.setChanged())}})}}class _E extends gr{constructor(e={},t){super(t),this.options=e}load(e,t,n,r){const{width:s,height:o,depth:u}=this.options,f=new su(null,s,o,u),p=new KD(this.manager);return p.setRequestHeader(this.requestHeader),p.setPath(this.path),p.setWithCredentials(this.withCredentials),p.load(e,g=>{const{image:v}=g;f.image={data:v.data,width:s??v.width,height:o??v.height,depth:u??Math.sqrt(v.height)},f.type=g.type,f.format=g.format,f.colorSpace=g.colorSpace,f.needsUpdate=!0;try{t==null||t(f)}catch(y){r!=null?r(y):console.error(y),this.manager.itemError(e)}},n,r),f}}class FR extends gr{constructor(e={},t){super(t),this.options=e}load(e,t,n,r){const{width:s,height:o}=this.options,u=new oa(null,s,o),f=new KD(this.manager);return f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(this.withCredentials),f.load(e,p=>{const{image:g}=p;u.image={data:g.data,width:s??g.width,height:o??g.height},u.type=p.type,u.format=p.format,u.colorSpace=p.colorSpace,u.needsUpdate=!0;try{t==null||t(u)}catch(v){r!=null?r(v):console.error(v),this.manager.itemError(e)}},n,r),u}}const SE=1e-6,Fy=new Q,zy=new Q,Wc=new Q,Lg=new Q,bE=new Q,NV=new Q,OV=new jt,LV=new es,PV=new bd;let UV=class SI{constructor(e=0,t=0,n=0,r=0){this.distance=e,this.heading=t,this.pitch=n,this.roll=r}get distance(){return this._distance}set distance(e){this._distance=Math.max(e,SE)}get pitch(){return this._pitch}set pitch(e){this._pitch=dM(e,-Math.PI/2+SE,Math.PI/2-SE)}set(e,t,n,r){return this.distance=e,this.heading=t,this.pitch=n,r!=null&&(this.roll=r),this}clone(){return new SI(this.distance,this.heading,this.pitch,this.roll)}copy(e){return this.distance=e.distance,this.heading=e.heading,this.pitch=e.pitch,this.roll=e.roll,this}equals(e){return e.distance===this.distance&&e.heading===this.heading&&e.pitch===this.pitch&&e.roll===this.roll}decompose(e,t,n,r,s=ac.WGS84){s.getEastNorthUpVectors(e,Fy,zy,Wc),r==null||r.copy(Wc);const o=Lg.copy(Fy).multiplyScalar(Math.cos(this.heading)).add(bE.copy(zy).multiplyScalar(Math.sin(this.heading))).multiplyScalar(Math.cos(this.pitch)).add(bE.copy(Wc).multiplyScalar(Math.sin(this.pitch))).normalize().multiplyScalar(this.distance);if(t.copy(e).sub(o),this.roll!==0){const u=Lg.copy(e).sub(t).normalize();Wc.applyQuaternion(LV.setFromAxisAngle(u,this.roll))}n.setFromRotationMatrix(OV.lookAt(t,e,Wc))}setFromCamera(e,t=ac.WGS84){const n=Lg.setFromMatrixPosition(e.matrixWorld),r=bE.set(0,0,.5).unproject(e).sub(n).normalize(),s=t.getIntersection(PV.set(n,r));if(s==null)return;this.distance=n.distanceTo(s),t.getEastNorthUpVectors(s,Fy,zy,Wc),this.heading=Math.atan2(zy.dot(r),Fy.dot(r)),this.pitch=Math.asin(Wc.dot(r));const o=Lg.copy(e.up).applyQuaternion(e.quaternion),u=NV.copy(r).multiplyScalar(-o.dot(r)).add(o).normalize(),f=Lg.copy(r).multiplyScalar(-Wc.dot(r)).add(Wc).normalize(),p=f.dot(u),g=r.dot(f.cross(u));return this.roll=Math.atan2(g,p),this}};const FV=/^[ \t]*#include +"([\w\d./]+)"/gm;function Io(i,e){return i.replace(FV,(t,n)=>{const r=n.split("/").reduce((s,o)=>typeof s!="string"&&s!=null?s[o]:void 0,e);if(typeof r!="string")throw new Error(`Could not find include for ${n}.`);return Io(r,e)})}let Hy;function zV(){if(Hy!=null)return Hy;const i=new Uint32Array([268435456]);return Hy=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)[0]===0,Hy}function HV(i,e,t,n=!0){if(n===zV())return new e(i);const r=Object.assign(new DataView(i),{getFloat16(o,u){return wV(this,o,u)}}),s=new e(r.byteLength/e.BYTES_PER_ELEMENT);for(let o=0,u=0;o<s.length;++o,u+=e.BYTES_PER_ELEMENT)s[o]=r[t](u,n);return s}const GV=i=>new Uint8Array(i),Pg=(i,e)=>HV(i,cu,"getFloat16",e);class kV extends Zp{constructor(e){super(su,GV,{format:tc,minFilter:di,magFilter:di,wrapS:Lo,wrapT:Lo,wrapR:Lo,width:wk,height:Ck,depth:Rk},e)}}const VV=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*(?:i\s*\+\+|\+\+\s*i)\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jV(i,e,t,n){let r="";for(let s=parseInt(e,10);s<parseInt(t,10);++s)r+=n.replace(/\[\s*i\s*\]/g,"["+s+"]").replace(/UNROLLED_LOOP_INDEX/g,`${s}`);return r}function WV(i){return i.replace(VV,jV)}function XV(i){return e=>{for(const t of i)fM(t,e)}}function YV(i){return e=>{const t=[];for(const n of i){const r=fM(n,e),s=typeof r=="function";t.push(s?r:()=>fM(n,null))}return()=>{for(const n of t)n()}}}function fM(i,e){if(typeof i=="function")return i(e);i&&(i.current=e)}var QV=parseInt(le.version.split(".")[0],10)>=19?YV:XV,qV="Invariant failed";function zR(i,e){if(!i)throw new Error(qV)}const JV=({ref:i,enableNormalPass:e=!0,...t})=>{const n=le.useRef(null);return le.useLayoutEffect(()=>{const r=n.current;zR(r!=null);const s=r.passes.find(o=>o instanceof zD);zR(s!=null),s.renderTarget.texture.type=On},[]),D.jsx(GD,{ref:QV([n,i]),...t,enableNormalPass:e})};function KV(){const i=Ue(A=>A.bloomIntensity),e=Ue(A=>A.bloomThreshold),t=Ue(A=>A.vignetteIntensity),n=Ue(A=>A.dofEnabled),r=Ue(A=>A.dofFocusDistance),s=Ue(A=>A.dofFocalLength),o=Ue(A=>A.dofBokehScale),u=Ue(A=>A.chromaticAberration),f=Ue(A=>A.colorBrightness),p=Ue(A=>A.colorContrast),g=Ue(A=>A.colorSaturation),v=Ue(A=>A.toneMapping),y=(()=>{switch(v){case"ACES":return Ir.ACES_FILMIC;case"AgX":return Ir.AGX;case"Reinhard":return Ir.REINHARD2;case"Cineon":return Ir.OPTIMIZED_CINEON;case"Neutral":return Ir.NEUTRAL;case"Linear":return Ir.LINEAR;default:return Ir.ACES_FILMIC}})();return D.jsxs(GD,{multisampling:4,children:[D.jsx(VD,{mode:y}),D.jsx(rk,{luminanceThreshold:e,mipmapBlur:!0,intensity:i,radius:.7}),n?D.jsx(ik,{focusDistance:r,focalLength:s,bokehScale:o}):D.jsx(D.Fragment,{}),u>1e-4?D.jsx(ak,{offset:new qe(u,u),radialModulation:!0,modulationOffset:.5}):D.jsx(D.Fragment,{}),D.jsx(sk,{brightness:f,contrast:p}),D.jsx(ok,{hue:0,saturation:g}),t>.01?D.jsx(lk,{offset:.3,darkness:t,eskil:!1}):D.jsx(D.Fragment,{}),D.jsx(kD,{})]})}function ZV(){const i=Ue(r=>r.graphicsQuality),e=Ue(r=>r.atmosphereEnabled),t=Ue(r=>r.backgroundMode);return e&&t==="sky"||i==="performance"?null:D.jsx(le.Suspense,{fallback:null,children:D.jsx(KV,{})})}const $V=`// Reference: https://github.com/mrdoob/three.js/blob/r171/examples/jsm/csm/CSMShader.js

#ifndef SHADOW_CASCADE_COUNT
#error "SHADOW_CASCADE_COUNT macro must be defined."
#endif // SHADOW_CASCADE_COUNT

int getCascadeIndex(
  const mat4 viewMatrix,
  const vec3 worldPosition,
  const vec2 intervals[SHADOW_CASCADE_COUNT],
  const float near,
  const float far
) {
  vec4 viewPosition = viewMatrix * vec4(worldPosition, 1.0);
  float depth = viewZToOrthographicDepth(viewPosition.z, near, far);
  vec2 interval;
  #pragma unroll_loop_start
  for (int i = 0; i < 4; ++i) {
    #if UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT
    interval = intervals[i];
    if (depth >= interval.x && depth < interval.y) {
      return UNROLLED_LOOP_INDEX;
    }
    #endif // UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT
  }
  #pragma unroll_loop_end
  return SHADOW_CASCADE_COUNT - 1;
}

int getFadedCascadeIndex(
  const mat4 viewMatrix,
  const vec3 worldPosition,
  const vec2 intervals[SHADOW_CASCADE_COUNT],
  const float near,
  const float far,
  const float jitter
) {
  vec4 viewPosition = viewMatrix * vec4(worldPosition, 1.0);
  float depth = viewZToOrthographicDepth(viewPosition.z, near, far);

  vec2 interval;
  float intervalCenter;
  float closestEdge;
  float margin;
  int nextIndex = -1;
  int prevIndex = -1;
  float alpha;

  #pragma unroll_loop_start
  for (int i = 0; i < 4; ++i) {
    #if UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT
    interval = intervals[i];
    intervalCenter = (interval.x + interval.y) * 0.5;
    closestEdge = depth < intervalCenter ? interval.x : interval.y;
    margin = closestEdge * closestEdge * 0.5;
    interval += margin * vec2(-0.5, 0.5);

    #if UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT - 1
    if (depth >= interval.x && depth < interval.y) {
      prevIndex = nextIndex;
      nextIndex = UNROLLED_LOOP_INDEX;
      alpha = saturate(min(depth - interval.x, interval.y - depth) / margin);
    }
    #else // UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT - 1
    // Don't fade out the last cascade.
    if (depth >= interval.x) {
      prevIndex = nextIndex;
      nextIndex = UNROLLED_LOOP_INDEX;
      alpha = saturate((depth - interval.x) / margin);
    }
    #endif // UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT - 1
    #endif // UNROLLED_LOOP_INDEX < SHADOW_CASCADE_COUNT
  }
  #pragma unroll_loop_end

  return jitter <= alpha
    ? nextIndex
    : prevIndex;
}
`,ej=`// cSpell:words logdepthbuf

float reverseLogDepth(const float depth, const float near, const float far) {
  #if defined(USE_LOGDEPTHBUF) || defined(USE_LOGARITHMIC_DEPTH_BUFFER)
  float d = pow(2.0, depth * log2(far + 1.0)) - 1.0;
  float a = far / (far - near);
  float b = far * near / (near - far);
  return a + b / d;
  #else // defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(USE_LOGARITHMIC_DEPTH_BUFFER)
  return depth;
  #endif // defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(USE_LOGARITHMIC_DEPTH_BUFFER)
}

float linearizeDepth(const float depth, const float near, const float far) {
  float ndc = depth * 2.0 - 1.0;
  return 2.0 * near * far / (far + near - ndc * (far - near));
}
`,tj=`// Reference: https://advances.realtimerendering.com/s2014/index.html#_NEXT_GENERATION_POST

float interleavedGradientNoise(const vec2 coord) {
  const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);
  return fract(magic.z * fract(dot(coord, magic.xy)));
}
`,nj=`#if !defined(saturate)
#define saturate(a) clamp(a, 0.0, 1.0)
#endif // !defined(saturate)

float remap(const float x, const float min1, const float max1, const float min2, const float max2) {
  return min2 + (x - min1) / (max1 - min1) * (max2 - min2);
}

vec2 remap(const vec2 x, const vec2 min1, const vec2 max1, const vec2 min2, const vec2 max2) {
  return min2 + (x - min1) / (max1 - min1) * (max2 - min2);
}

vec3 remap(const vec3 x, const vec3 min1, const vec3 max1, const vec3 min2, const vec3 max2) {
  return min2 + (x - min1) / (max1 - min1) * (max2 - min2);
}

vec4 remap(const vec4 x, const vec4 min1, const vec4 max1, const vec4 min2, const vec4 max2) {
  return min2 + (x - min1) / (max1 - min1) * (max2 - min2);
}

float remapClamped(
  const float x,
  const float min1,
  const float max1,
  const float min2,
  const float max2
) {
  return clamp(min2 + (x - min1) / (max1 - min1) * (max2 - min2), min2, max2);
}

vec2 remapClamped(
  const vec2 x,
  const vec2 min1,
  const vec2 max1,
  const vec2 min2,
  const vec2 max2
) {
  return clamp(min2 + (x - min1) / (max1 - min1) * (max2 - min2), min2, max2);
}

vec3 remapClamped(
  const vec3 x,
  const vec3 min1,
  const vec3 max1,
  const vec3 min2,
  const vec3 max2
) {
  return clamp(min2 + (x - min1) / (max1 - min1) * (max2 - min2), min2, max2);
}

vec4 remapClamped(
  const vec4 x,
  const vec4 min1,
  const vec4 max1,
  const vec4 min2,
  const vec4 max2
) {
  return clamp(min2 + (x - min1) / (max1 - min1) * (max2 - min2), min2, max2);
}

// Implicitly remap to 0 and 1
float remap(const float x, const float min1, const float max1) {
  return (x - min1) / (max1 - min1);
}

vec2 remap(const vec2 x, const vec2 min1, const vec2 max1) {
  return (x - min1) / (max1 - min1);
}

vec3 remap(const vec3 x, const vec3 min1, const vec3 max1) {
  return (x - min1) / (max1 - min1);
}

vec4 remap(const vec4 x, const vec4 min1, const vec4 max1) {
  return (x - min1) / (max1 - min1);
}

float remapClamped(const float x, const float min1, const float max1) {
  return saturate((x - min1) / (max1 - min1));
}

vec2 remapClamped(const vec2 x, const vec2 min1, const vec2 max1) {
  return saturate((x - min1) / (max1 - min1));
}

vec3 remapClamped(const vec3 x, const vec3 min1, const vec3 max1) {
  return saturate((x - min1) / (max1 - min1));
}

vec4 remapClamped(const vec4 x, const vec4 min1, const vec4 max1) {
  return saturate((x - min1) / (max1 - min1));
}
`,ij=`// Reference: https://jcgt.org/published/0003/02/01/paper.pdf

vec2 signNotZero(vec2 v) {
  return vec2(v.x >= 0.0 ? 1.0 : -1.0, v.y >= 0.0 ? 1.0 : -1.0);
}

vec2 packNormalToVec2(vec3 v) {
  vec2 p = v.xy * (1.0 / (abs(v.x) + abs(v.y) + abs(v.z)));
  return v.z <= 0.0
    ? (1.0 - abs(p.yx)) * signNotZero(p)
    : p;
}

vec3 unpackVec2ToNormal(vec2 e) {
  vec3 v = vec3(e.xy, 1.0 - abs(e.x) - abs(e.y));
  if (v.z < 0.0) {
    v.xy = (1.0 - abs(v.yx)) * signNotZero(v.xy);
  }
  return normalize(v);
}
`,rj=`float raySphereFirstIntersection(
  const vec3 origin,
  const vec3 direction,
  const vec3 center,
  const float radius
) {
  vec3 a = origin - center;
  float b = 2.0 * dot(direction, a);
  float c = dot(a, a) - radius * radius;
  float discriminant = b * b - 4.0 * c;
  return discriminant < 0.0
    ? -1.0
    : (-b - sqrt(discriminant)) * 0.5;
}

float raySphereFirstIntersection(const vec3 origin, const vec3 direction, const float radius) {
  return raySphereFirstIntersection(origin, direction, vec3(0.0), radius);
}

vec4 raySphereFirstIntersection(
  const vec3 origin,
  const vec3 direction,
  const vec3 center,
  const vec4 radius
) {
  vec3 a = origin - center;
  float b = 2.0 * dot(direction, a);
  vec4 c = dot(a, a) - radius * radius;
  vec4 discriminant = b * b - 4.0 * c;
  vec4 mask = step(discriminant, vec4(0.0));
  return mix((-b - sqrt(max(vec4(0.0), discriminant))) * 0.5, vec4(-1.0), mask);
}

vec4 raySphereFirstIntersection(const vec3 origin, const vec3 direction, const vec4 radius) {
  return raySphereFirstIntersection(origin, direction, vec3(0.0), radius);
}

float raySphereSecondIntersection(
  const vec3 origin,
  const vec3 direction,
  const vec3 center,
  const float radius
) {
  vec3 a = origin - center;
  float b = 2.0 * dot(direction, a);
  float c = dot(a, a) - radius * radius;
  float discriminant = b * b - 4.0 * c;
  return discriminant < 0.0
    ? -1.0
    : (-b + sqrt(discriminant)) * 0.5;
}

float raySphereSecondIntersection(const vec3 origin, const vec3 direction, const float radius) {
  return raySphereSecondIntersection(origin, direction, vec3(0.0), radius);
}

vec4 raySphereSecondIntersection(
  const vec3 origin,
  const vec3 direction,
  const vec3 center,
  const vec4 radius
) {
  vec3 a = origin - center;
  float b = 2.0 * dot(direction, a);
  vec4 c = dot(a, a) - radius * radius;
  vec4 discriminant = b * b - 4.0 * c;
  vec4 mask = step(discriminant, vec4(0.0));
  return mix((-b + sqrt(max(vec4(0.0), discriminant))) * 0.5, vec4(-1.0), mask);
}

vec4 raySphereSecondIntersection(const vec3 origin, const vec3 direction, const vec4 radius) {
  return raySphereSecondIntersection(origin, direction, vec3(0.0), radius);
}

void raySphereIntersections(
  const vec3 origin,
  const vec3 direction,
  const vec3 center,
  const float radius,
  out float intersection1,
  out float intersection2
) {
  vec3 a = origin - center;
  float b = 2.0 * dot(direction, a);
  float c = dot(a, a) - radius * radius;
  float discriminant = b * b - 4.0 * c;
  if (discriminant < 0.0) {
    intersection1 = -1.0;
    intersection2 = -1.0;
    return;
  } else {
    float Q = sqrt(discriminant);
    intersection1 = (-b - Q) * 0.5;
    intersection2 = (-b + Q) * 0.5;
  }
}

void raySphereIntersections(
  const vec3 origin,
  const vec3 direction,
  const float radius,
  out float intersection1,
  out float intersection2
) {
  raySphereIntersections(origin, direction, vec3(0.0), radius, intersection1, intersection2);
}

void raySphereIntersections(
  const vec3 origin,
  const vec3 direction,
  const vec3 center,
  const vec4 radius,
  out vec4 intersection1,
  out vec4 intersection2
) {
  vec3 a = origin - center;
  float b = 2.0 * dot(direction, a);
  vec4 c = dot(a, a) - radius * radius;
  vec4 discriminant = b * b - 4.0 * c;
  vec4 mask = step(discriminant, vec4(0.0));
  vec4 Q = sqrt(max(vec4(0.0), discriminant));
  intersection1 = mix((-b - Q) * 0.5, vec4(-1.0), mask);
  intersection2 = mix((-b + Q) * 0.5, vec4(-1.0), mask);
}

void raySphereIntersections(
  const vec3 origin,
  const vec3 direction,
  const vec4 radius,
  out vec4 intersection1,
  out vec4 intersection2
) {
  raySphereIntersections(origin, direction, vec3(0.0), radius, intersection1, intersection2);
}
`,sj=`vec3 screenToView(
  const vec2 uv,
  const float depth,
  const float viewZ,
  const mat4 projectionMatrix,
  const mat4 inverseProjectionMatrix
) {
  vec4 clip = vec4(vec3(uv, depth) * 2.0 - 1.0, 1.0);
  float clipW = projectionMatrix[2][3] * viewZ + projectionMatrix[3][3];
  clip *= clipW;
  return (inverseProjectionMatrix * clip).xyz;
}
`,aj=`// A fifth-order polynomial approximation of Turbo color map.
// See: https://observablehq.com/@mbostock/turbo
// prettier-ignore
vec3 turbo(const float x) {
  float r = 0.1357 + x * (4.5974 - x * (42.3277 - x * (130.5887 - x * (150.5666 - x * 58.1375))));
  float g = 0.0914 + x * (2.1856 + x * (4.8052 - x * (14.0195 - x * (4.2109 + x * 2.7747))));
  float b = 0.1067 + x * (12.5925 - x * (60.1097 - x * (109.0745 - x * (88.5066 - x * 26.8183))));
  return vec3(r, g, b);
}
`,oj=`// Reference: https://www.gamedev.net/tutorials/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/

vec2 vogelDisk(const int index, const int sampleCount, const float phi) {
  const float goldenAngle = 2.39996322972865332;
  float r = sqrt(float(index) + 0.5) / sqrt(float(sampleCount));
  float theta = float(index) * goldenAngle + phi;
  return r * vec2(cos(theta), sin(theta));
}
`,lj=$V,KT=ej,cj=tj,uj=nj,bI=ij,EI=rj,MI=sj,dj=aj,fj=oj,hj="9c6dfd0054f077f3ad4695b802e74d4c6a814440",pj=`https://media.githubusercontent.com/media/takram-design-engineering/three-geospatial/${hj}/packages/atmosphere/assets/stars.bin`,Hm=64,Gm=16,rS=32,sS=128,aS=32,oS=8,Yf=oS*aS,Qf=sS,qf=rS,km=256,Vm=64,a_=1/1e3,TI=100,mj=new Q;function wI(i,e,t,n){const r=t.projectOnSurface(i,mj);return r!=null?t.getOsculatingSphereCenter(r,e,n).negate():n.setScalar(0)}var gj="Invariant failed";function vj(i,e){if(!i)throw new Error(gj)}const HR=typeof window<"u"&&window.requestIdleCallback!=null?window.requestIdleCallback:function(i,e={}){const t=e.timeout??1,n=performance.now();return setTimeout(()=>{i({get didTimeout(){return e.timeout!=null?!1:performance.now()-n-1>t},timeRemaining(){return Math.max(0,1+(performance.now()-n))}})},1)},Zc=`// Based on: https://github.com/ebruneton/precomputed_atmospheric_scattering/blob/master/atmosphere/functions.glsl

/**
 * Copyright (c) 2017 Eric Bruneton
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Precomputed Atmospheric Scattering
 * Copyright (c) 2008 INRIA
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 */

Number ClampCosine(const Number mu) {
  return clamp(mu, Number(-1.0), Number(1.0));
}

Length ClampDistance(const Length d) {
  return max(d, 0.0 * m);
}

Length ClampRadius(const AtmosphereParameters atmosphere, const Length r) {
  return clamp(r, atmosphere.bottom_radius, atmosphere.top_radius);
}

Length SafeSqrt(const Area a) {
  return sqrt(max(a, 0.0 * m2));
}

Length DistanceToTopAtmosphereBoundary(const AtmosphereParameters atmosphere,
    const Length r, const Number mu) {
  assert(r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  Area discriminant = r * r * (mu * mu - 1.0) +
      atmosphere.top_radius * atmosphere.top_radius;
  return ClampDistance(-r * mu + SafeSqrt(discriminant));
}

Length DistanceToBottomAtmosphereBoundary(const AtmosphereParameters atmosphere,
    const Length r, const Number mu) {
  assert(r >= atmosphere.bottom_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  Area discriminant = r * r * (mu * mu - 1.0) +
      atmosphere.bottom_radius * atmosphere.bottom_radius;
  return ClampDistance(-r * mu - SafeSqrt(discriminant));
}

bool RayIntersectsGround(const AtmosphereParameters atmosphere,
    const Length r, const Number mu) {
  assert(r >= atmosphere.bottom_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  return mu < 0.0 && r * r * (mu * mu - 1.0) +
      atmosphere.bottom_radius * atmosphere.bottom_radius >= 0.0 * m2;
}

Number GetTextureCoordFromUnitRange(const Number x, const int texture_size) {
  return 0.5 / Number(texture_size) + x * (1.0 - 1.0 / Number(texture_size));
}

vec2 GetTransmittanceTextureUvFromRMu(const AtmosphereParameters atmosphere,
    const Length r, const Number mu) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  // Distance to top atmosphere boundary for a horizontal ray at ground level.
  Length H = sqrt(atmosphere.top_radius * atmosphere.top_radius -
      atmosphere.bottom_radius * atmosphere.bottom_radius);
  // Distance to the horizon.
  Length rho =
      SafeSqrt(r * r - atmosphere.bottom_radius * atmosphere.bottom_radius);
  // Distance to the top atmosphere boundary for the ray (r,mu), and its minimum
  // and maximum values over all mu - obtained for (r,1) and (r,mu_horizon).
  Length d = DistanceToTopAtmosphereBoundary(atmosphere, r, mu);
  Length d_min = atmosphere.top_radius - r;
  Length d_max = rho + H;
  Number x_mu = (d - d_min) / (d_max - d_min);
  Number x_r = rho / H;
  return vec2(GetTextureCoordFromUnitRange(x_mu, TRANSMITTANCE_TEXTURE_WIDTH),
              GetTextureCoordFromUnitRange(x_r, TRANSMITTANCE_TEXTURE_HEIGHT));
}

DimensionlessSpectrum GetTransmittanceToTopAtmosphereBoundary(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const Length r, const Number mu) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  vec2 uv = GetTransmittanceTextureUvFromRMu(atmosphere, r, mu);
  // @shotamatsuda: Added for the precomputation stage in half-float precision.
  #ifdef TRANSMITTANCE_PRECISION_LOG
  // Manually interpolate the transmittance instead of the optical depth.
  const vec2 size = vec2(TRANSMITTANCE_TEXTURE_WIDTH, TRANSMITTANCE_TEXTURE_HEIGHT);
  const vec3 texel_size = vec3(1.0 / size, 0.0);
  vec2 coord = (uv * size) - 0.5;
  vec2 i = (floor(coord) + 0.5) * texel_size.xy;
  vec2 f = fract(coord);
  vec4 t1 = exp(-texture(transmittance_texture, i));
  vec4 t2 = exp(-texture(transmittance_texture, i + texel_size.xz));
  vec4 t3 = exp(-texture(transmittance_texture, i + texel_size.zy));
  vec4 t4 = exp(-texture(transmittance_texture, i + texel_size.xy));
  return DimensionlessSpectrum(mix(mix(t1, t2, f.x), mix(t3, t4, f.x), f.y));
  #else // TRANSMITTANCE_PRECISION_LOG
  return DimensionlessSpectrum(texture(transmittance_texture, uv));
  #endif // TRANSMITTANCE_PRECISION_LOG
}

DimensionlessSpectrum GetTransmittance(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const Length r, const Number mu, const Length d,
    const bool ray_r_mu_intersects_ground) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  assert(d >= 0.0 * m);

  Length r_d = ClampRadius(atmosphere, sqrt(d * d + 2.0 * r * mu * d + r * r));
  Number mu_d = ClampCosine((r * mu + d) / r_d);

  if (ray_r_mu_intersects_ground) {
    return min(
        GetTransmittanceToTopAtmosphereBoundary(
            atmosphere, transmittance_texture, r_d, -mu_d) /
        GetTransmittanceToTopAtmosphereBoundary(
            atmosphere, transmittance_texture, r, -mu),
        DimensionlessSpectrum(1.0));
  } else {
    return min(
        GetTransmittanceToTopAtmosphereBoundary(
            atmosphere, transmittance_texture, r, mu) /
        GetTransmittanceToTopAtmosphereBoundary(
            atmosphere, transmittance_texture, r_d, mu_d),
        DimensionlessSpectrum(1.0));
  }
}

DimensionlessSpectrum GetTransmittanceToSun(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const Length r, const Number mu_s) {
  Number sin_theta_h = atmosphere.bottom_radius / r;
  Number cos_theta_h = -sqrt(max(1.0 - sin_theta_h * sin_theta_h, 0.0));
  return GetTransmittanceToTopAtmosphereBoundary(
          atmosphere, transmittance_texture, r, mu_s) *
      smoothstep(-sin_theta_h * atmosphere.sun_angular_radius / rad,
                 sin_theta_h * atmosphere.sun_angular_radius / rad,
                 mu_s - cos_theta_h);
}

InverseSolidAngle RayleighPhaseFunction(const Number nu) {
  InverseSolidAngle k = 3.0 / (16.0 * PI * sr);
  return k * (1.0 + nu * nu);
}

InverseSolidAngle MiePhaseFunction(const Number g, const Number nu) {
  InverseSolidAngle k = 3.0 / (8.0 * PI * sr) * (1.0 - g * g) / (2.0 + g * g);
  return k * (1.0 + nu * nu) / pow(1.0 + g * g - 2.0 * g * nu, 1.5);
}

vec4 GetScatteringTextureUvwzFromRMuMuSNu(const AtmosphereParameters atmosphere,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  assert(mu_s >= -1.0 && mu_s <= 1.0);
  assert(nu >= -1.0 && nu <= 1.0);

  // Distance to top atmosphere boundary for a horizontal ray at ground level.
  Length H = sqrt(atmosphere.top_radius * atmosphere.top_radius -
      atmosphere.bottom_radius * atmosphere.bottom_radius);
  // Distance to the horizon.
  Length rho =
      SafeSqrt(r * r - atmosphere.bottom_radius * atmosphere.bottom_radius);
  Number u_r = GetTextureCoordFromUnitRange(rho / H, SCATTERING_TEXTURE_R_SIZE);

  // Discriminant of the quadratic equation for the intersections of the ray
  // (r,mu) with the ground (see RayIntersectsGround).
  Length r_mu = r * mu;
  Area discriminant =
      r_mu * r_mu - r * r + atmosphere.bottom_radius * atmosphere.bottom_radius;
  Number u_mu;
  if (ray_r_mu_intersects_ground) {
    // Distance to the ground for the ray (r,mu), and its minimum and maximum
    // values over all mu - obtained for (r,-1) and (r,mu_horizon).
    Length d = -r_mu - SafeSqrt(discriminant);
    Length d_min = r - atmosphere.bottom_radius;
    Length d_max = rho;
    u_mu = 0.5 - 0.5 * GetTextureCoordFromUnitRange(d_max == d_min ? 0.0 :
        (d - d_min) / (d_max - d_min), SCATTERING_TEXTURE_MU_SIZE / 2);
  } else {
    // Distance to the top atmosphere boundary for the ray (r,mu), and its
    // minimum and maximum values over all mu - obtained for (r,1) and
    // (r,mu_horizon).
    Length d = -r_mu + SafeSqrt(discriminant + H * H);
    Length d_min = atmosphere.top_radius - r;
    Length d_max = rho + H;
    u_mu = 0.5 + 0.5 * GetTextureCoordFromUnitRange(
        (d - d_min) / (d_max - d_min), SCATTERING_TEXTURE_MU_SIZE / 2);
  }

  Length d = DistanceToTopAtmosphereBoundary(
      atmosphere, atmosphere.bottom_radius, mu_s);
  Length d_min = atmosphere.top_radius - atmosphere.bottom_radius;
  Length d_max = H;
  Number a = (d - d_min) / (d_max - d_min);
  Length D = DistanceToTopAtmosphereBoundary(
      atmosphere, atmosphere.bottom_radius, atmosphere.mu_s_min);
  Number A = (D - d_min) / (d_max - d_min);
  // An ad-hoc function equal to 0 for mu_s = mu_s_min (because then d = D and
  // thus a = A), equal to 1 for mu_s = 1 (because then d = d_min and thus
  // a = 0), and with a large slope around mu_s = 0, to get more texture
  // samples near the horizon.
  Number u_mu_s = GetTextureCoordFromUnitRange(
      max(1.0 - a / A, 0.0) / (1.0 + a), SCATTERING_TEXTURE_MU_S_SIZE);

  Number u_nu = (nu + 1.0) / 2.0;
  return vec4(u_nu, u_mu_s, u_mu, u_r);
}

vec2 GetIrradianceTextureUvFromRMuS(const AtmosphereParameters atmosphere,
    const Length r, const Number mu_s) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu_s >= -1.0 && mu_s <= 1.0);
  Number x_r = (r - atmosphere.bottom_radius) /
      (atmosphere.top_radius - atmosphere.bottom_radius);
  Number x_mu_s = mu_s * 0.5 + 0.5;
  return vec2(GetTextureCoordFromUnitRange(x_mu_s, IRRADIANCE_TEXTURE_WIDTH),
              GetTextureCoordFromUnitRange(x_r, IRRADIANCE_TEXTURE_HEIGHT));
}

IrradianceSpectrum GetIrradiance(
    const AtmosphereParameters atmosphere,
    const IrradianceTexture irradiance_texture,
    const Length r, const Number mu_s) {
  vec2 uv = GetIrradianceTextureUvFromRMuS(atmosphere, r, mu_s);
  return IrradianceSpectrum(texture(irradiance_texture, uv));
}
`,$c=`// Based on: https://github.com/ebruneton/precomputed_atmospheric_scattering/blob/master/atmosphere/definitions.glsl

/**
 * Copyright (c) 2017 Eric Bruneton
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 */

#define assert(x)

#define Length float
#define Wavelength float
#define Angle float
#define SolidAngle float
#define Power float
#define LuminousPower float

#define Number float
#define InverseLength float
#define Area float
#define Volume float
#define NumberDensity float
#define Irradiance float
#define Radiance float
#define SpectralPower float
#define SpectralIrradiance float
#define SpectralRadiance float
#define SpectralRadianceDensity float
#define ScatteringCoefficient float
#define InverseSolidAngle float
#define LuminousIntensity float
#define Luminance float
#define Illuminance float

// A generic function from Wavelength to some other type.
#define AbstractSpectrum vec3
// A function from Wavelength to Number.
#define DimensionlessSpectrum vec3
// A function from Wavelength to SpectralPower.
#define PowerSpectrum vec3
// A function from Wavelength to SpectralIrradiance.
#define IrradianceSpectrum vec3
// A function from Wavelength to SpectralRadiance.
#define RadianceSpectrum vec3
// A function from Wavelength to SpectralRadianceDensity.
#define RadianceDensitySpectrum vec3
// A function from Wavelength to ScatteringCoefficient.
#define ScatteringSpectrum vec3

// A position in 3D (3 length values).
#define Position vec3
// A unit direction vector in 3D (3 unit-less values).
#define Direction vec3
// A vector of 3 luminance values.
#define Luminance3 vec3
// A vector of 3 illuminance values.
#define Illuminance3 vec3

#define TransmittanceTexture sampler2D
#define AbstractScatteringTexture sampler3D
#define ReducedScatteringTexture sampler3D
#define ScatteringTexture sampler3D
#define ScatteringDensityTexture sampler3D
#define IrradianceTexture sampler2D

const Length m = 1.0;
const Wavelength nm = 1.0;
const Angle rad = 1.0;
const SolidAngle sr = 1.0;
const Power watt = 1.0;
const LuminousPower lm = 1.0;

#if !defined(PI)
const float PI = 3.14159265358979323846;
#endif // !defined(PI)

const Length km = 1000.0 * m;
const Area m2 = m * m;
const Volume m3 = m * m * m;
const Angle pi = PI * rad;
const Angle deg = pi / 180.0;
const Irradiance watt_per_square_meter = watt / m2;
const Radiance watt_per_square_meter_per_sr = watt / (m2 * sr);
const SpectralIrradiance watt_per_square_meter_per_nm = watt / (m2 * nm);
const SpectralRadiance watt_per_square_meter_per_sr_per_nm = watt / (m2 * sr * nm);
const SpectralRadianceDensity watt_per_cubic_meter_per_sr_per_nm = watt / (m3 * sr * nm);
const LuminousIntensity cd = lm / sr;
const LuminousIntensity kcd = 1000.0 * cd;
const Luminance cd_per_square_meter = cd / m2;
const Luminance kcd_per_square_meter = kcd / m2;

struct DensityProfileLayer {
  Length width;
  Number exp_term;
  InverseLength exp_scale;
  InverseLength linear_term;
  Number constant_term;
};

struct DensityProfile {
  DensityProfileLayer layers[2];
};

// See AtmosphereParameter.ts for further details.
struct AtmosphereParameters {
  IrradianceSpectrum solar_irradiance;
  Angle sun_angular_radius;
  Length bottom_radius;
  Length top_radius;
  DensityProfile rayleigh_density;
  ScatteringSpectrum rayleigh_scattering;
  DensityProfile mie_density;
  ScatteringSpectrum mie_scattering;
  ScatteringSpectrum mie_extinction;
  Number mie_phase_function_g;
  DensityProfile absorption_density;
  ScatteringSpectrum absorption_extinction;
  DimensionlessSpectrum ground_albedo;
  Number mu_s_min;
};
`,ZT=`// Based on: https://github.com/ebruneton/precomputed_atmospheric_scattering/blob/master/atmosphere/functions.glsl

/**
 * Copyright (c) 2017 Eric Bruneton
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Precomputed Atmospheric Scattering
 * Copyright (c) 2008 INRIA
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifdef COMBINED_SCATTERING_TEXTURES
vec3 GetExtrapolatedSingleMieScattering(
    const AtmosphereParameters atmosphere, const vec4 scattering) {
  // Algebraically this can never be negative, but rounding errors can produce
  // that effect for sufficiently short view rays.
  // @shotamatsuda: Avoid division by infinitesimal values.
  // See https://github.com/takram-design-engineering/three-geospatial/issues/47
  if (scattering.r < 1e-5) {
    return vec3(0.0);
  }
  return scattering.rgb * scattering.a / scattering.r *
	    (atmosphere.rayleigh_scattering.r / atmosphere.mie_scattering.r) *
	    (atmosphere.mie_scattering / atmosphere.rayleigh_scattering);
}
#endif // COMBINED_SCATTERING_TEXTURES

IrradianceSpectrum GetCombinedScattering(
    const AtmosphereParameters atmosphere,
    const ReducedScatteringTexture scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground,
    out IrradianceSpectrum single_mie_scattering) {
  vec4 uvwz = GetScatteringTextureUvwzFromRMuMuSNu(
      atmosphere, r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  Number tex_coord_x = uvwz.x * Number(SCATTERING_TEXTURE_NU_SIZE - 1);
  Number tex_x = floor(tex_coord_x);
  Number lerp = tex_coord_x - tex_x;
  vec3 uvw0 = vec3((tex_x + uvwz.y) / Number(SCATTERING_TEXTURE_NU_SIZE),
      uvwz.z, uvwz.w);
  vec3 uvw1 = vec3((tex_x + 1.0 + uvwz.y) / Number(SCATTERING_TEXTURE_NU_SIZE),
      uvwz.z, uvwz.w);
#ifdef COMBINED_SCATTERING_TEXTURES
  vec4 combined_scattering =
      texture(scattering_texture, uvw0) * (1.0 - lerp) +
      texture(scattering_texture, uvw1) * lerp;
  IrradianceSpectrum scattering = IrradianceSpectrum(combined_scattering);
  single_mie_scattering =
      GetExtrapolatedSingleMieScattering(atmosphere, combined_scattering);
#else // COMBINED_SCATTERING_TEXTURES
  IrradianceSpectrum scattering = IrradianceSpectrum(
      texture(scattering_texture, uvw0) * (1.0 - lerp) +
      texture(scattering_texture, uvw1) * lerp);
  single_mie_scattering = IrradianceSpectrum(
      texture(single_mie_scattering_texture, uvw0) * (1.0 - lerp) +
      texture(single_mie_scattering_texture, uvw1) * lerp);
#endif // COMBINED_SCATTERING_TEXTURES
  return scattering;
}

// @shotamatsuda: Added for reading higher-order scattering texture.
#ifdef HAS_HIGHER_ORDER_SCATTERING_TEXTURE
IrradianceSpectrum GetScattering(
    const AtmosphereParameters atmosphere,
    const ReducedScatteringTexture scattering_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground) {
  vec4 uvwz = GetScatteringTextureUvwzFromRMuMuSNu(
      atmosphere, r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  Number tex_coord_x = uvwz.x * Number(SCATTERING_TEXTURE_NU_SIZE - 1);
  Number tex_x = floor(tex_coord_x);
  Number lerp = tex_coord_x - tex_x;
  vec3 uvw0 = vec3((tex_x + uvwz.y) / Number(SCATTERING_TEXTURE_NU_SIZE),
      uvwz.z, uvwz.w);
  vec3 uvw1 = vec3((tex_x + 1.0 + uvwz.y) / Number(SCATTERING_TEXTURE_NU_SIZE),
      uvwz.z, uvwz.w);
  IrradianceSpectrum scattering = IrradianceSpectrum(
      texture(scattering_texture, uvw0) * (1.0 - lerp) +
      texture(scattering_texture, uvw1) * lerp);
  return scattering;
}
#endif // HAS_HIGHER_ORDER_SCATTERING_TEXTURE

RadianceSpectrum GetSkyRadiance(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const ReducedScatteringTexture scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    Position camera, const Direction view_ray, const Length shadow_length,
    const Direction sun_direction,
    out DimensionlessSpectrum transmittance) {
  // Compute the distance to the top atmosphere boundary along the view ray,
  // assuming the viewer is in space (or NaN if the view ray does not intersect
  // the atmosphere).
  Length r = length(camera);
  Length rmu = dot(camera, view_ray);
  // @shotamatsuda: Use SafeSqrt instead.
  // See: https://github.com/takram-design-engineering/three-geospatial/pull/26
  Length distance_to_top_atmosphere_boundary = -rmu -
      SafeSqrt(rmu * rmu - r * r +
          atmosphere.top_radius * atmosphere.top_radius);
  // If the viewer is in space and the view ray intersects the atmosphere, move
  // the viewer to the top atmosphere boundary (along the view ray):
  if (distance_to_top_atmosphere_boundary > 0.0 * m) {
    camera = camera + view_ray * distance_to_top_atmosphere_boundary;
    r = atmosphere.top_radius;
    rmu += distance_to_top_atmosphere_boundary;
  } else if (r > atmosphere.top_radius) {
    // If the view ray does not intersect the atmosphere, simply return 0.
    transmittance = DimensionlessSpectrum(1.0);
    return RadianceSpectrum(0.0 * watt_per_square_meter_per_sr_per_nm);
  }
  // Compute the r, mu, mu_s and nu parameters needed for the texture lookups.
  Number mu = rmu / r;
  Number mu_s = dot(camera, sun_direction) / r;
  Number nu = dot(view_ray, sun_direction);

  // @shotamatsuda: For rendering points below the bottom atmosphere.
  #ifdef GROUND
  bool ray_r_mu_intersects_ground = RayIntersectsGround(atmosphere, r, mu);
  #else // GROUND
  bool ray_r_mu_intersects_ground = false;
  #endif // GROUND

  transmittance = ray_r_mu_intersects_ground ? DimensionlessSpectrum(0.0) :
      GetTransmittanceToTopAtmosphereBoundary(
          atmosphere, transmittance_texture, r, mu);
  IrradianceSpectrum single_mie_scattering;
  IrradianceSpectrum scattering;
  if (shadow_length == 0.0 * m) {
    scattering = GetCombinedScattering(
        atmosphere, scattering_texture, single_mie_scattering_texture,
        r, mu, mu_s, nu, ray_r_mu_intersects_ground,
        single_mie_scattering);
  } else {
    // Case of light shafts (shadow_length is the total length noted l in our
    // paper): we omit the scattering between the camera and the point at
    // distance l, by implementing Eq. (18) of the paper (shadow_transmittance
    // is the T(x,x_s) term, scattering is the S|x_s=x+lv term).
    Length d = shadow_length;
    Length r_p =
        ClampRadius(atmosphere, sqrt(d * d + 2.0 * r * mu * d + r * r));
    Number mu_p = (r * mu + d) / r_p;
    Number mu_s_p = (r * mu_s + d * nu) / r_p;

    scattering = GetCombinedScattering(
        atmosphere, scattering_texture, single_mie_scattering_texture,
        r_p, mu_p, mu_s_p, nu, ray_r_mu_intersects_ground,
        single_mie_scattering);
    DimensionlessSpectrum shadow_transmittance =
        GetTransmittance(atmosphere, transmittance_texture,
            r, mu, shadow_length, ray_r_mu_intersects_ground);
    // @shotamatsuda: Occlude only single Rayleigh scattering by the shadow.
#ifdef HAS_HIGHER_ORDER_SCATTERING_TEXTURE
    IrradianceSpectrum higher_order_scattering = GetScattering(
        atmosphere, higher_order_scattering_texture,
        r_p, mu_p, mu_s_p, nu, ray_r_mu_intersects_ground);
    IrradianceSpectrum single_scattering = scattering - higher_order_scattering;
    scattering = single_scattering * shadow_transmittance + higher_order_scattering;
#else // HAS_HIGHER_ORDER_SCATTERING_TEXTURE
    scattering = scattering * shadow_transmittance;
#endif // HAS_HIGHER_ORDER_SCATTERING_TEXTURE
    single_mie_scattering = single_mie_scattering * shadow_transmittance;
  }
  return scattering * RayleighPhaseFunction(nu) + single_mie_scattering *
      MiePhaseFunction(atmosphere.mie_phase_function_g, nu);
}

// @shotamatsuda: Returns the point on the ray closest to the origin.
vec3 ClosestPointOnRay(const Position camera, const Position point) {
  Position ray = point - camera;
  Number t = clamp(-dot(camera, ray) / dot(ray, ray), 0.0, 1.0);
  return camera + t * ray;
}

vec2 RaySphereIntersections(
    const Position camera, const Direction direction, const Length radius) {
  float b = 2.0 * dot(direction, camera);
  float c = dot(camera, camera) - radius * radius;
  float discriminant = b * b - 4.0 * c;
  float Q = sqrt(discriminant);
  return vec2(-b - Q, -b + Q) * 0.5;
}

// @shotamatsuda: Clip the view ray at the bottom atmosphere boundary.
bool ClipAtBottomAtmosphere(
    const AtmosphereParameters atmosphere,
    const Direction view_ray, inout Position camera, inout Position point) {
  const Length eps = 0.0;
  Length bottom_radius = atmosphere.bottom_radius + eps;
  Length r_camera = length(camera);
  Length r_point = length(point);
  bool camera_below = r_camera < bottom_radius;
  bool point_below = r_point < bottom_radius;

  vec2 t = RaySphereIntersections(camera, view_ray, bottom_radius);
  Position intersection = camera + view_ray * (camera_below ? t.y : t.x);
  camera = camera_below ? intersection : camera;
  point = point_below ? intersection : point;

  return camera_below && point_below;
}

RadianceSpectrum GetSkyRadianceToPoint(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const ReducedScatteringTexture scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    Position camera, Position point, const Length shadow_length,
    const Direction sun_direction, out DimensionlessSpectrum transmittance) {
  // @shotamatsuda: Avoid artifacts when the ray does not intersect the top
  // atmosphere boundary.
  if (length(ClosestPointOnRay(camera, point)) > atmosphere.top_radius) {
    transmittance = vec3(1.0);
    return vec3(0.0);
  }

  Direction view_ray = normalize(point - camera);
  if (ClipAtBottomAtmosphere(atmosphere, view_ray, camera, point)) {
    transmittance = vec3(1.0);
    return vec3(0.0);
  }

  // Compute the distance to the top atmosphere boundary along the view ray,
  // assuming the viewer is in space (or NaN if the view ray does not intersect
  // the atmosphere).
  Length r = length(camera);
  Length rmu = dot(camera, view_ray);
  // @shotamatsuda: Use SafeSqrt instead.
  // See: https://github.com/takram-design-engineering/three-geospatial/pull/26
  Length distance_to_top_atmosphere_boundary = -rmu -
      SafeSqrt(rmu * rmu - r * r +
          atmosphere.top_radius * atmosphere.top_radius);
  // If the viewer is in space and the view ray intersects the atmosphere, move
  // the viewer to the top atmosphere boundary (along the view ray):
  if (distance_to_top_atmosphere_boundary > 0.0 * m) {
    camera = camera + view_ray * distance_to_top_atmosphere_boundary;
    r = atmosphere.top_radius;
    rmu += distance_to_top_atmosphere_boundary;
  }

  // Compute the r, mu, mu_s and nu parameters for the first texture lookup.
  Number mu = rmu / r;
  Number mu_s = dot(camera, sun_direction) / r;
  Number nu = dot(view_ray, sun_direction);
  Length d = length(point - camera);
  bool ray_r_mu_intersects_ground = RayIntersectsGround(atmosphere, r, mu);

  // @shotamatsuda: Hack to avoid rendering artifacts near the horizon, due to
  // finite atmosphere texture resolution and finite floating point precision.
  // See: https://github.com/ebruneton/precomputed_atmospheric_scattering/pull/32
  if (!ray_r_mu_intersects_ground) {
    Number mu_horizon = -SafeSqrt(1.0 -
        (atmosphere.bottom_radius * atmosphere.bottom_radius) / (r * r));
    const Number eps = 0.004;
    mu = max(mu, mu_horizon + eps);
  }

  transmittance = GetTransmittance(atmosphere, transmittance_texture,
      r, mu, d, ray_r_mu_intersects_ground);

  IrradianceSpectrum single_mie_scattering;
  IrradianceSpectrum scattering = GetCombinedScattering(
      atmosphere, scattering_texture, single_mie_scattering_texture,
      r, mu, mu_s, nu, ray_r_mu_intersects_ground,
      single_mie_scattering);

  // Compute the r, mu, mu_s and nu parameters for the second texture lookup.
  // If shadow_length is not 0 (case of light shafts), we want to ignore the
  // scattering along the last shadow_length meters of the view ray, which we
  // do by subtracting shadow_length from d (this way scattering_p is equal to
  // the S|x_s=x_0-lv term in Eq. (17) of our paper).
  d = max(d - shadow_length, 0.0 * m);
  Length r_p = ClampRadius(atmosphere, sqrt(d * d + 2.0 * r * mu * d + r * r));
  Number mu_p = (r * mu + d) / r_p;
  Number mu_s_p = (r * mu_s + d * nu) / r_p;

  IrradianceSpectrum single_mie_scattering_p;
  IrradianceSpectrum scattering_p = GetCombinedScattering(
      atmosphere, scattering_texture, single_mie_scattering_texture,
      r_p, mu_p, mu_s_p, nu, ray_r_mu_intersects_ground,
      single_mie_scattering_p);

  // Combine the lookup results to get the scattering between camera and point.
  DimensionlessSpectrum shadow_transmittance = transmittance;
  if (shadow_length > 0.0 * m) {
    // This is the T(x,x_s) term in Eq. (17) of our paper, for light shafts.
    shadow_transmittance = GetTransmittance(atmosphere, transmittance_texture,
        r, mu, d, ray_r_mu_intersects_ground);
  }
  // @shotamatsuda: Occlude only single Rayleigh scattering by the shadow.
#ifdef HAS_HIGHER_ORDER_SCATTERING_TEXTURE
  IrradianceSpectrum higher_order_scattering = GetScattering(
      atmosphere, higher_order_scattering_texture,
      r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  IrradianceSpectrum single_scattering = scattering - higher_order_scattering;
  IrradianceSpectrum higher_order_scattering_p = GetScattering(
      atmosphere, higher_order_scattering_texture,
      r_p, mu_p, mu_s_p, nu, ray_r_mu_intersects_ground);
  IrradianceSpectrum single_scattering_p =
      scattering_p - higher_order_scattering_p;
  scattering =
      single_scattering - shadow_transmittance * single_scattering_p +
      higher_order_scattering - transmittance * higher_order_scattering_p;
#else // HAS_HIGHER_ORDER_SCATTERING_TEXTURE
  scattering = scattering - shadow_transmittance * scattering_p;
#endif // HAS_HIGHER_ORDER_SCATTERING_TEXTURE

  single_mie_scattering =
      single_mie_scattering - shadow_transmittance * single_mie_scattering_p;
#ifdef COMBINED_SCATTERING_TEXTURES
  single_mie_scattering = GetExtrapolatedSingleMieScattering(
      atmosphere, vec4(scattering, single_mie_scattering.r));
#endif // COMBINED_SCATTERING_TEXTURES

  // Hack to avoid rendering artifacts when the sun is below the horizon.
  single_mie_scattering = single_mie_scattering *
      smoothstep(Number(0.0), Number(0.01), mu_s);

  return scattering * RayleighPhaseFunction(nu) + single_mie_scattering *
      MiePhaseFunction(atmosphere.mie_phase_function_g, nu);
}

IrradianceSpectrum GetSunAndSkyIrradiance(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const IrradianceTexture irradiance_texture,
    const Position point, const Direction normal, const Direction sun_direction,
    out IrradianceSpectrum sky_irradiance) {
  Length r = length(point);
  Number mu_s = dot(point, sun_direction) / r;

  // Indirect irradiance (approximated if the surface is not horizontal).
  sky_irradiance = GetIrradiance(atmosphere, irradiance_texture, r, mu_s) *
      (1.0 + dot(normal, point) / r) * 0.5;

  // Direct irradiance.
  return atmosphere.solar_irradiance *
      GetTransmittanceToSun(
          atmosphere, transmittance_texture, r, mu_s) *
      max(dot(normal, sun_direction), 0.0);
}

// @shotamatsuda: Added for the clouds.
IrradianceSpectrum GetSunAndSkyScalarIrradiance(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const IrradianceTexture irradiance_texture,
    const Position point, const Direction sun_direction,
    out IrradianceSpectrum sky_irradiance) {
  Length r = length(point);
  Number mu_s = dot(point, sun_direction) / r;

  // Indirect irradiance. Integral over sphere yields 2.
  sky_irradiance = GetIrradiance(atmosphere, irradiance_texture, r, mu_s) *
      2.0 * PI;

  // Direct irradiance. Omit the cosine term.
  return atmosphere.solar_irradiance *
      GetTransmittanceToSun(atmosphere, transmittance_texture, r, mu_s);
}

Luminance3 GetSolarLuminance() {
  return ATMOSPHERE.solar_irradiance /
      (PI * ATMOSPHERE.sun_angular_radius * ATMOSPHERE.sun_angular_radius) *
      SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
}

Luminance3 GetSkyLuminance(
    const Position camera, Direction view_ray, const Length shadow_length,
    const Direction sun_direction, out DimensionlessSpectrum transmittance) {
  return GetSkyRadiance(ATMOSPHERE, transmittance_texture,
      scattering_texture, single_mie_scattering_texture,
      camera, view_ray, shadow_length, sun_direction,
      transmittance) * SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;
}

Luminance3 GetSkyLuminanceToPoint(
    const Position camera, const Position point, const Length shadow_length,
    const Direction sun_direction, out DimensionlessSpectrum transmittance) {
  return GetSkyRadianceToPoint(ATMOSPHERE, transmittance_texture,
      scattering_texture, single_mie_scattering_texture,
      camera, point, shadow_length, sun_direction, transmittance) *
      SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;
}

Illuminance3 GetSunAndSkyIlluminance(
    const Position p, const Direction normal, const Direction sun_direction,
    out IrradianceSpectrum sky_irradiance) {
  IrradianceSpectrum sun_irradiance = GetSunAndSkyIrradiance(
      ATMOSPHERE, transmittance_texture, irradiance_texture, p, normal,
      sun_direction, sky_irradiance);
  sky_irradiance *= SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;
  return sun_irradiance * SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
}

// @shotamatsuda: Added for the clouds.
Illuminance3 GetSunAndSkyScalarIlluminance(
    const Position p, const Direction sun_direction,
    out IrradianceSpectrum sky_irradiance) {
  IrradianceSpectrum sun_irradiance = GetSunAndSkyScalarIrradiance(
      ATMOSPHERE, transmittance_texture, irradiance_texture, p,
      sun_direction, sky_irradiance);
  sky_irradiance *= SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;
  return sun_irradiance * SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
}

#define GetSolarRadiance GetSolarLuminance
#define GetSkyRadiance GetSkyLuminance
#define GetSkyRadianceToPoint GetSkyLuminanceToPoint
#define GetSunAndSkyIrradiance GetSunAndSkyIlluminance
#define GetSunAndSkyScalarIrradiance GetSunAndSkyScalarIlluminance
`,Xp=`// Based on: https://github.com/ebruneton/precomputed_atmospheric_scattering/blob/master/atmosphere/functions.glsl

/**
 * Copyright (c) 2017 Eric Bruneton
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Precomputed Atmospheric Scattering
 * Copyright (c) 2008 INRIA
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holders nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 */

Number GetLayerDensity(const DensityProfileLayer layer, const Length altitude) {
  Number density = layer.exp_term * exp(layer.exp_scale * altitude) +
      layer.linear_term * altitude + layer.constant_term;
  return clamp(density, Number(0.0), Number(1.0));
}

Number GetProfileDensity(const DensityProfile profile, const Length altitude) {
  DensityProfileLayer layers[2] = profile.layers;
  return altitude < layers[0].width
    ? GetLayerDensity(layers[0], altitude)
    : GetLayerDensity(layers[1], altitude);
}

Length ComputeOpticalLengthToTopAtmosphereBoundary(
    const AtmosphereParameters atmosphere, const DensityProfile profile,
    const Length r, const Number mu) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  // Number of intervals for the numerical integration.
  const int SAMPLE_COUNT = 500;
  // The integration step, i.e. the length of each integration interval.
  Length dx =
      DistanceToTopAtmosphereBoundary(atmosphere, r, mu) / Number(SAMPLE_COUNT);
  // Integration loop.
  Length result = 0.0 * m;
  for (int i = 0; i <= SAMPLE_COUNT; ++i) {
    Length d_i = Number(i) * dx;
    // Distance between the current sample point and the planet center.
    Length r_i = sqrt(d_i * d_i + 2.0 * r * mu * d_i + r * r);
    // Number density at the current sample point (divided by the number density
    // at the bottom of the atmosphere, yielding a dimensionless number).
    Number y_i = GetProfileDensity(profile, r_i - atmosphere.bottom_radius);
    // Sample weight (from the trapezoidal rule).
    Number weight_i = i == 0 || i == SAMPLE_COUNT ? 0.5 : 1.0;
    result += y_i * weight_i * dx;
  }
  return result;
}

DimensionlessSpectrum ComputeTransmittanceToTopAtmosphereBoundary(
    const AtmosphereParameters atmosphere, const Length r, const Number mu) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  vec3 optical_depth = (
      atmosphere.rayleigh_scattering *
          ComputeOpticalLengthToTopAtmosphereBoundary(
              atmosphere, atmosphere.rayleigh_density, r, mu) +
      atmosphere.mie_extinction *
          ComputeOpticalLengthToTopAtmosphereBoundary(
              atmosphere, atmosphere.mie_density, r, mu) +
      atmosphere.absorption_extinction *
          ComputeOpticalLengthToTopAtmosphereBoundary(
              atmosphere, atmosphere.absorption_density, r, mu));
  // @shotamatsuda: Added for the precomputation stage in half-float precision.
  #ifdef TRANSMITTANCE_PRECISION_LOG
  return optical_depth;
  #else // TRANSMITTANCE_PRECISION_LOG
  return exp(-optical_depth);
  #endif // TRANSMITTANCE_PRECISION_LOG
}

Number GetUnitRangeFromTextureCoord(const Number u, const int texture_size) {
  return (u - 0.5 / Number(texture_size)) / (1.0 - 1.0 / Number(texture_size));
}

void GetRMuFromTransmittanceTextureUv(const AtmosphereParameters atmosphere,
    const vec2 uv, out Length r, out Number mu) {
  assert(uv.x >= 0.0 && uv.x <= 1.0);
  assert(uv.y >= 0.0 && uv.y <= 1.0);
  Number x_mu = GetUnitRangeFromTextureCoord(uv.x, TRANSMITTANCE_TEXTURE_WIDTH);
  Number x_r = GetUnitRangeFromTextureCoord(uv.y, TRANSMITTANCE_TEXTURE_HEIGHT);
  // Distance to top atmosphere boundary for a horizontal ray at ground level.
  Length H = sqrt(atmosphere.top_radius * atmosphere.top_radius -
      atmosphere.bottom_radius * atmosphere.bottom_radius);
  // Distance to the horizon, from which we can compute r:
  Length rho = H * x_r;
  r = sqrt(rho * rho + atmosphere.bottom_radius * atmosphere.bottom_radius);
  // Distance to the top atmosphere boundary for the ray (r,mu), and its minimum
  // and maximum values over all mu - obtained for (r,1) and (r,mu_horizon) -
  // from which we can recover mu:
  Length d_min = atmosphere.top_radius - r;
  Length d_max = rho + H;
  Length d = d_min + x_mu * (d_max - d_min);
  mu = d == 0.0 * m ? Number(1.0) : (H * H - rho * rho - d * d) / (2.0 * r * d);
  mu = ClampCosine(mu);
}

DimensionlessSpectrum ComputeTransmittanceToTopAtmosphereBoundaryTexture(
    const AtmosphereParameters atmosphere, const vec2 frag_coord) {
  const vec2 TRANSMITTANCE_TEXTURE_SIZE =
      vec2(TRANSMITTANCE_TEXTURE_WIDTH, TRANSMITTANCE_TEXTURE_HEIGHT);
  Length r;
  Number mu;
  GetRMuFromTransmittanceTextureUv(
      atmosphere, frag_coord / TRANSMITTANCE_TEXTURE_SIZE, r, mu);
  return ComputeTransmittanceToTopAtmosphereBoundary(atmosphere, r, mu);
}

void ComputeSingleScatteringIntegrand(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const Length d, const bool ray_r_mu_intersects_ground,
    out DimensionlessSpectrum rayleigh, out DimensionlessSpectrum mie) {
  Length r_d = ClampRadius(atmosphere, sqrt(d * d + 2.0 * r * mu * d + r * r));
  Number mu_s_d = ClampCosine((r * mu_s + d * nu) / r_d);
  DimensionlessSpectrum transmittance =
      GetTransmittance(
          atmosphere, transmittance_texture, r, mu, d,
          ray_r_mu_intersects_ground) *
      GetTransmittanceToSun(
          atmosphere, transmittance_texture, r_d, mu_s_d);
  rayleigh = transmittance * GetProfileDensity(
      atmosphere.rayleigh_density, r_d - atmosphere.bottom_radius);
  mie = transmittance * GetProfileDensity(
      atmosphere.mie_density, r_d - atmosphere.bottom_radius);
}

Length DistanceToNearestAtmosphereBoundary(const AtmosphereParameters atmosphere,
    Length r, Number mu, bool ray_r_mu_intersects_ground) {
  if (ray_r_mu_intersects_ground) {
    return DistanceToBottomAtmosphereBoundary(atmosphere, r, mu);
  } else {
    return DistanceToTopAtmosphereBoundary(atmosphere, r, mu);
  }
}

void ComputeSingleScattering(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground,
    out IrradianceSpectrum rayleigh, out IrradianceSpectrum mie) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  assert(mu_s >= -1.0 && mu_s <= 1.0);
  assert(nu >= -1.0 && nu <= 1.0);

  // Number of intervals for the numerical integration.
  const int SAMPLE_COUNT = 50;
  // The integration step, i.e. the length of each integration interval.
  Length dx =
      DistanceToNearestAtmosphereBoundary(atmosphere, r, mu,
          ray_r_mu_intersects_ground) / Number(SAMPLE_COUNT);
  // Integration loop.
  DimensionlessSpectrum rayleigh_sum = DimensionlessSpectrum(0.0);
  DimensionlessSpectrum mie_sum = DimensionlessSpectrum(0.0);
  for (int i = 0; i <= SAMPLE_COUNT; ++i) {
    Length d_i = Number(i) * dx;
    // The Rayleigh and Mie single scattering at the current sample point.
    DimensionlessSpectrum rayleigh_i;
    DimensionlessSpectrum mie_i;
    ComputeSingleScatteringIntegrand(atmosphere, transmittance_texture,
        r, mu, mu_s, nu, d_i, ray_r_mu_intersects_ground, rayleigh_i, mie_i);
    // Sample weight (from the trapezoidal rule).
    Number weight_i = (i == 0 || i == SAMPLE_COUNT) ? 0.5 : 1.0;
    rayleigh_sum += rayleigh_i * weight_i;
    mie_sum += mie_i * weight_i;
  }
  rayleigh = rayleigh_sum * dx * atmosphere.solar_irradiance *
      atmosphere.rayleigh_scattering;
  mie = mie_sum * dx * atmosphere.solar_irradiance * atmosphere.mie_scattering;
}

void GetRMuMuSNuFromScatteringTextureUvwz(const AtmosphereParameters atmosphere,
    const vec4 uvwz, out Length r, out Number mu, out Number mu_s,
    out Number nu, out bool ray_r_mu_intersects_ground) {
  assert(uvwz.x >= 0.0 && uvwz.x <= 1.0);
  assert(uvwz.y >= 0.0 && uvwz.y <= 1.0);
  assert(uvwz.z >= 0.0 && uvwz.z <= 1.0);
  assert(uvwz.w >= 0.0 && uvwz.w <= 1.0);

  // Distance to top atmosphere boundary for a horizontal ray at ground level.
  Length H = sqrt(atmosphere.top_radius * atmosphere.top_radius -
      atmosphere.bottom_radius * atmosphere.bottom_radius);
  // Distance to the horizon.
  Length rho =
      H * GetUnitRangeFromTextureCoord(uvwz.w, SCATTERING_TEXTURE_R_SIZE);
  r = sqrt(rho * rho + atmosphere.bottom_radius * atmosphere.bottom_radius);

  if (uvwz.z < 0.5) {
    // Distance to the ground for the ray (r,mu), and its minimum and maximum
    // values over all mu - obtained for (r,-1) and (r,mu_horizon) - from which
    // we can recover mu:
    Length d_min = r - atmosphere.bottom_radius;
    Length d_max = rho;
    Length d = d_min + (d_max - d_min) * GetUnitRangeFromTextureCoord(
        1.0 - 2.0 * uvwz.z, SCATTERING_TEXTURE_MU_SIZE / 2);
    mu = d == 0.0 * m ? Number(-1.0) :
        ClampCosine(-(rho * rho + d * d) / (2.0 * r * d));
    ray_r_mu_intersects_ground = true;
  } else {
    // Distance to the top atmosphere boundary for the ray (r,mu), and its
    // minimum and maximum values over all mu - obtained for (r,1) and
    // (r,mu_horizon) - from which we can recover mu:
    Length d_min = atmosphere.top_radius - r;
    Length d_max = rho + H;
    Length d = d_min + (d_max - d_min) * GetUnitRangeFromTextureCoord(
        2.0 * uvwz.z - 1.0, SCATTERING_TEXTURE_MU_SIZE / 2);
    mu = d == 0.0 * m ? Number(1.0) :
        ClampCosine((H * H - rho * rho - d * d) / (2.0 * r * d));
    ray_r_mu_intersects_ground = false;
  }

  Number x_mu_s =
      GetUnitRangeFromTextureCoord(uvwz.y, SCATTERING_TEXTURE_MU_S_SIZE);
  Length d_min = atmosphere.top_radius - atmosphere.bottom_radius;
  Length d_max = H;
  Length D = DistanceToTopAtmosphereBoundary(
      atmosphere, atmosphere.bottom_radius, atmosphere.mu_s_min);
  Number A = (D - d_min) / (d_max - d_min);
  Number a = (A - x_mu_s * A) / (1.0 + x_mu_s * A);
  Length d = d_min + min(a, A) * (d_max - d_min);
  mu_s = d == 0.0 * m ? Number(1.0) :
     ClampCosine((H * H - d * d) / (2.0 * atmosphere.bottom_radius * d));

  nu = ClampCosine(uvwz.x * 2.0 - 1.0);
}

void GetRMuMuSNuFromScatteringTextureFragCoord(
    const AtmosphereParameters atmosphere, const vec3 frag_coord,
    out Length r, out Number mu, out Number mu_s, out Number nu,
    out bool ray_r_mu_intersects_ground) {
  const vec4 SCATTERING_TEXTURE_SIZE = vec4(
      SCATTERING_TEXTURE_NU_SIZE - 1,
      SCATTERING_TEXTURE_MU_S_SIZE,
      SCATTERING_TEXTURE_MU_SIZE,
      SCATTERING_TEXTURE_R_SIZE);
  Number frag_coord_nu =
      floor(frag_coord.x / Number(SCATTERING_TEXTURE_MU_S_SIZE));
  Number frag_coord_mu_s =
      mod(frag_coord.x, Number(SCATTERING_TEXTURE_MU_S_SIZE));
  vec4 uvwz =
      vec4(frag_coord_nu, frag_coord_mu_s, frag_coord.y, frag_coord.z) /
          SCATTERING_TEXTURE_SIZE;
  GetRMuMuSNuFromScatteringTextureUvwz(
      atmosphere, uvwz, r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  // Clamp nu to its valid range of values, given mu and mu_s.
  nu = clamp(nu, mu * mu_s - sqrt((1.0 - mu * mu) * (1.0 - mu_s * mu_s)),
      mu * mu_s + sqrt((1.0 - mu * mu) * (1.0 - mu_s * mu_s)));
}

void ComputeSingleScatteringTexture(const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture, const vec3 frag_coord,
    out IrradianceSpectrum rayleigh, out IrradianceSpectrum mie) {
  Length r;
  Number mu;
  Number mu_s;
  Number nu;
  bool ray_r_mu_intersects_ground;
  GetRMuMuSNuFromScatteringTextureFragCoord(atmosphere, frag_coord,
      r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  ComputeSingleScattering(atmosphere, transmittance_texture,
      r, mu, mu_s, nu, ray_r_mu_intersects_ground, rayleigh, mie);
}

AbstractSpectrum GetScattering(
    const AtmosphereParameters atmosphere,
    const AbstractScatteringTexture scattering_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground) {
  vec4 uvwz = GetScatteringTextureUvwzFromRMuMuSNu(
      atmosphere, r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  Number tex_coord_x = uvwz.x * Number(SCATTERING_TEXTURE_NU_SIZE - 1);
  Number tex_x = floor(tex_coord_x);
  Number lerp = tex_coord_x - tex_x;
  vec3 uvw0 = vec3((tex_x + uvwz.y) / Number(SCATTERING_TEXTURE_NU_SIZE),
      uvwz.z, uvwz.w);
  vec3 uvw1 = vec3((tex_x + 1.0 + uvwz.y) / Number(SCATTERING_TEXTURE_NU_SIZE),
      uvwz.z, uvwz.w);
  return AbstractSpectrum(texture(scattering_texture, uvw0) * (1.0 - lerp) +
      texture(scattering_texture, uvw1) * lerp);
}

RadianceSpectrum GetScattering(
    const AtmosphereParameters atmosphere,
    const ReducedScatteringTexture single_rayleigh_scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    const ScatteringTexture multiple_scattering_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground,
    const int scattering_order) {
  if (scattering_order == 1) {
    IrradianceSpectrum rayleigh = GetScattering(
        atmosphere, single_rayleigh_scattering_texture, r, mu, mu_s, nu,
        ray_r_mu_intersects_ground);
    IrradianceSpectrum mie = GetScattering(
        atmosphere, single_mie_scattering_texture, r, mu, mu_s, nu,
        ray_r_mu_intersects_ground);
    return rayleigh * RayleighPhaseFunction(nu) +
        mie * MiePhaseFunction(atmosphere.mie_phase_function_g, nu);
  } else {
    return GetScattering(
        atmosphere, multiple_scattering_texture, r, mu, mu_s, nu,
        ray_r_mu_intersects_ground);
  }
}

IrradianceSpectrum GetIrradiance(
    const AtmosphereParameters atmosphere,
    const IrradianceTexture irradiance_texture,
    const Length r, const Number mu_s);

RadianceDensitySpectrum ComputeScatteringDensity(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const ReducedScatteringTexture single_rayleigh_scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    const ScatteringTexture multiple_scattering_texture,
    const IrradianceTexture irradiance_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const int scattering_order) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  assert(mu_s >= -1.0 && mu_s <= 1.0);
  assert(nu >= -1.0 && nu <= 1.0);
  assert(scattering_order >= 2);

  // Compute unit direction vectors for the zenith, the view direction omega and
  // and the sun direction omega_s, such that the cosine of the view-zenith
  // angle is mu, the cosine of the sun-zenith angle is mu_s, and the cosine of
  // the view-sun angle is nu. The goal is to simplify computations below.
  vec3 zenith_direction = vec3(0.0, 0.0, 1.0);
  vec3 omega = vec3(sqrt(1.0 - mu * mu), 0.0, mu);
  Number sun_dir_x = omega.x == 0.0 ? 0.0 : (nu - mu * mu_s) / omega.x;
  Number sun_dir_y = sqrt(max(1.0 - sun_dir_x * sun_dir_x - mu_s * mu_s, 0.0));
  vec3 omega_s = vec3(sun_dir_x, sun_dir_y, mu_s);

  const int SAMPLE_COUNT = 16;
  const Angle dphi = pi / Number(SAMPLE_COUNT);
  const Angle dtheta = pi / Number(SAMPLE_COUNT);
  RadianceDensitySpectrum rayleigh_mie =
      RadianceDensitySpectrum(0.0 * watt_per_cubic_meter_per_sr_per_nm);

  // Nested loops for the integral over all the incident directions omega_i.
  for (int l = 0; l < SAMPLE_COUNT; ++l) {
    Angle theta = (Number(l) + 0.5) * dtheta;
    Number cos_theta = cos(theta);
    Number sin_theta = sin(theta);
    bool ray_r_theta_intersects_ground =
        RayIntersectsGround(atmosphere, r, cos_theta);

    // The distance and transmittance to the ground only depend on theta, so we
    // can compute them in the outer loop for efficiency.
    Length distance_to_ground = 0.0 * m;
    DimensionlessSpectrum transmittance_to_ground = DimensionlessSpectrum(0.0);
    DimensionlessSpectrum ground_albedo = DimensionlessSpectrum(0.0);
    if (ray_r_theta_intersects_ground) {
      distance_to_ground =
          DistanceToBottomAtmosphereBoundary(atmosphere, r, cos_theta);
      transmittance_to_ground =
          GetTransmittance(atmosphere, transmittance_texture, r, cos_theta,
              distance_to_ground, true /* ray_intersects_ground */);
      ground_albedo = atmosphere.ground_albedo;
    }

    for (int m = 0; m < 2 * SAMPLE_COUNT; ++m) {
      Angle phi = (Number(m) + 0.5) * dphi;
      vec3 omega_i =
          vec3(cos(phi) * sin_theta, sin(phi) * sin_theta, cos_theta);
      SolidAngle domega_i = (dtheta / rad) * (dphi / rad) * sin(theta) * sr;

      // The radiance L_i arriving from direction omega_i after n-1 bounces is
      // the sum of a term given by the precomputed scattering texture for the
      // (n-1)-th order:
      Number nu1 = dot(omega_s, omega_i);
      RadianceSpectrum incident_radiance = GetScattering(atmosphere,
          single_rayleigh_scattering_texture, single_mie_scattering_texture,
          multiple_scattering_texture, r, omega_i.z, mu_s, nu1,
          ray_r_theta_intersects_ground, scattering_order - 1);

      // and of the contribution from the light paths with n-1 bounces and whose
      // last bounce is on the ground. This contribution is the product of the
      // transmittance to the ground, the ground albedo, the ground BRDF, and
      // the irradiance received on the ground after n-2 bounces.
      vec3 ground_normal =
          normalize(zenith_direction * r + omega_i * distance_to_ground);
      IrradianceSpectrum ground_irradiance = GetIrradiance(
          atmosphere, irradiance_texture, atmosphere.bottom_radius,
          dot(ground_normal, omega_s));
      incident_radiance += transmittance_to_ground *
          ground_albedo * (1.0 / (PI * sr)) * ground_irradiance;

      // The radiance finally scattered from direction omega_i towards direction
      // -omega is the product of the incident radiance, the scattering
      // coefficient, and the phase function for directions omega and omega_i
      // (all this summed over all particle types, i.e. Rayleigh and Mie).
      Number nu2 = dot(omega, omega_i);
      Number rayleigh_density = GetProfileDensity(
          atmosphere.rayleigh_density, r - atmosphere.bottom_radius);
      Number mie_density = GetProfileDensity(
          atmosphere.mie_density, r - atmosphere.bottom_radius);
      rayleigh_mie += incident_radiance * (
          atmosphere.rayleigh_scattering * rayleigh_density *
              RayleighPhaseFunction(nu2) +
          atmosphere.mie_scattering * mie_density *
              MiePhaseFunction(atmosphere.mie_phase_function_g, nu2)) *
          domega_i;
    }
  }
  return rayleigh_mie;
}

RadianceSpectrum ComputeMultipleScattering(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const ScatteringDensityTexture scattering_density_texture,
    const Length r, const Number mu, const Number mu_s, const Number nu,
    const bool ray_r_mu_intersects_ground) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu >= -1.0 && mu <= 1.0);
  assert(mu_s >= -1.0 && mu_s <= 1.0);
  assert(nu >= -1.0 && nu <= 1.0);

  // Number of intervals for the numerical integration.
  const int SAMPLE_COUNT = 50;
  // The integration step, i.e. the length of each integration interval.
  Length dx =
      DistanceToNearestAtmosphereBoundary(
          atmosphere, r, mu, ray_r_mu_intersects_ground) /
              Number(SAMPLE_COUNT);
  // Integration loop.
  RadianceSpectrum rayleigh_mie_sum =
      RadianceSpectrum(0.0 * watt_per_square_meter_per_sr_per_nm);
  for (int i = 0; i <= SAMPLE_COUNT; ++i) {
    Length d_i = Number(i) * dx;

    // The r, mu and mu_s parameters at the current integration point (see the
    // single scattering section for a detailed explanation).
    Length r_i =
        ClampRadius(atmosphere, sqrt(d_i * d_i + 2.0 * r * mu * d_i + r * r));
    Number mu_i = ClampCosine((r * mu + d_i) / r_i);
    Number mu_s_i = ClampCosine((r * mu_s + d_i * nu) / r_i);

    // The Rayleigh and Mie multiple scattering at the current sample point.
    RadianceSpectrum rayleigh_mie_i =
        GetScattering(
            atmosphere, scattering_density_texture, r_i, mu_i, mu_s_i, nu,
            ray_r_mu_intersects_ground) *
        GetTransmittance(
            atmosphere, transmittance_texture, r, mu, d_i,
            ray_r_mu_intersects_ground) *
        dx;
    // Sample weight (from the trapezoidal rule).
    Number weight_i = (i == 0 || i == SAMPLE_COUNT) ? 0.5 : 1.0;
    rayleigh_mie_sum += rayleigh_mie_i * weight_i;
  }
  return rayleigh_mie_sum;
}

RadianceDensitySpectrum ComputeScatteringDensityTexture(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const ReducedScatteringTexture single_rayleigh_scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    const ScatteringTexture multiple_scattering_texture,
    const IrradianceTexture irradiance_texture,
    const vec3 frag_coord, const int scattering_order) {
  Length r;
  Number mu;
  Number mu_s;
  Number nu;
  bool ray_r_mu_intersects_ground;
  GetRMuMuSNuFromScatteringTextureFragCoord(atmosphere, frag_coord,
      r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  return ComputeScatteringDensity(atmosphere, transmittance_texture,
      single_rayleigh_scattering_texture, single_mie_scattering_texture,
      multiple_scattering_texture, irradiance_texture, r, mu, mu_s, nu,
      scattering_order);
}

RadianceSpectrum ComputeMultipleScatteringTexture(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const ScatteringDensityTexture scattering_density_texture,
    const vec3 frag_coord, out Number nu) {
  Length r;
  Number mu;
  Number mu_s;
  bool ray_r_mu_intersects_ground;
  GetRMuMuSNuFromScatteringTextureFragCoord(atmosphere, frag_coord,
      r, mu, mu_s, nu, ray_r_mu_intersects_ground);
  return ComputeMultipleScattering(atmosphere, transmittance_texture,
      scattering_density_texture, r, mu, mu_s, nu,
      ray_r_mu_intersects_ground);
}

IrradianceSpectrum ComputeDirectIrradiance(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const Length r, const Number mu_s) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu_s >= -1.0 && mu_s <= 1.0);

  Number alpha_s = atmosphere.sun_angular_radius / rad;
  // Approximate average of the cosine factor mu_s over the visible fraction of
  // the Sun disc.
  Number average_cosine_factor =
    mu_s < -alpha_s ? 0.0 : (mu_s > alpha_s ? mu_s :
        (mu_s + alpha_s) * (mu_s + alpha_s) / (4.0 * alpha_s));

  return atmosphere.solar_irradiance *
      GetTransmittanceToTopAtmosphereBoundary(
          atmosphere, transmittance_texture, r, mu_s) * average_cosine_factor;

}

IrradianceSpectrum ComputeIndirectIrradiance(
    const AtmosphereParameters atmosphere,
    const ReducedScatteringTexture single_rayleigh_scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    const ScatteringTexture multiple_scattering_texture,
    const Length r, const Number mu_s, const int scattering_order) {
  assert(r >= atmosphere.bottom_radius && r <= atmosphere.top_radius);
  assert(mu_s >= -1.0 && mu_s <= 1.0);
  assert(scattering_order >= 1);

  const int SAMPLE_COUNT = 32;
  const Angle dphi = pi / Number(SAMPLE_COUNT);
  const Angle dtheta = pi / Number(SAMPLE_COUNT);

  IrradianceSpectrum result =
      IrradianceSpectrum(0.0 * watt_per_square_meter_per_nm);
  vec3 omega_s = vec3(sqrt(1.0 - mu_s * mu_s), 0.0, mu_s);
  for (int j = 0; j < SAMPLE_COUNT / 2; ++j) {
    Angle theta = (Number(j) + 0.5) * dtheta;
    for (int i = 0; i < 2 * SAMPLE_COUNT; ++i) {
      Angle phi = (Number(i) + 0.5) * dphi;
      vec3 omega =
          vec3(cos(phi) * sin(theta), sin(phi) * sin(theta), cos(theta));
      SolidAngle domega = (dtheta / rad) * (dphi / rad) * sin(theta) * sr;

      Number nu = dot(omega, omega_s);
      result += GetScattering(atmosphere, single_rayleigh_scattering_texture,
          single_mie_scattering_texture, multiple_scattering_texture,
          r, omega.z, mu_s, nu, false /* ray_r_theta_intersects_ground */,
          scattering_order) *
              omega.z * domega;
    }
  }
  return result;
}

void GetRMuSFromIrradianceTextureUv(const AtmosphereParameters atmosphere,
    const vec2 uv, out Length r, out Number mu_s) {
  assert(uv.x >= 0.0 && uv.x <= 1.0);
  assert(uv.y >= 0.0 && uv.y <= 1.0);
  Number x_mu_s = GetUnitRangeFromTextureCoord(uv.x, IRRADIANCE_TEXTURE_WIDTH);
  Number x_r = GetUnitRangeFromTextureCoord(uv.y, IRRADIANCE_TEXTURE_HEIGHT);
  r = atmosphere.bottom_radius +
      x_r * (atmosphere.top_radius - atmosphere.bottom_radius);
  mu_s = ClampCosine(2.0 * x_mu_s - 1.0);
}

const vec2 IRRADIANCE_TEXTURE_SIZE =
    vec2(IRRADIANCE_TEXTURE_WIDTH, IRRADIANCE_TEXTURE_HEIGHT);

IrradianceSpectrum ComputeDirectIrradianceTexture(
    const AtmosphereParameters atmosphere,
    const TransmittanceTexture transmittance_texture,
    const vec2 frag_coord) {
  Length r;
  Number mu_s;
  GetRMuSFromIrradianceTextureUv(
      atmosphere, frag_coord / IRRADIANCE_TEXTURE_SIZE, r, mu_s);
  return ComputeDirectIrradiance(atmosphere, transmittance_texture, r, mu_s);
}

IrradianceSpectrum ComputeIndirectIrradianceTexture(
    const AtmosphereParameters atmosphere,
    const ReducedScatteringTexture single_rayleigh_scattering_texture,
    const ReducedScatteringTexture single_mie_scattering_texture,
    const ScatteringTexture multiple_scattering_texture,
    const vec2 frag_coord, const int scattering_order) {
  Length r;
  Number mu_s;
  GetRMuSFromIrradianceTextureUv(
      atmosphere, frag_coord / IRRADIANCE_TEXTURE_SIZE, r, mu_s);
  return ComputeIndirectIrradiance(atmosphere,
      single_rayleigh_scattering_texture, single_mie_scattering_texture,
      multiple_scattering_texture, r, mu_s, scattering_order);
}
`,xj=new Q(.2126,.7152,.0722),yj=["solarIrradiance","sunAngularRadius","bottomRadius","topRadius","rayleighDensity","rayleighScattering","mieDensity","mieScattering","mieExtinction","miePhaseFunctionG","absorptionDensity","absorptionExtinction","groundAlbedo","muSMin","skyRadianceToLuminance","sunRadianceToLuminance"];function Aj(i,e){if(e!=null)for(const t of yj){const n=e[t];n!=null&&(i[t]instanceof Q?i[t].copy(n):i[t]=n)}}class Yp{constructor(e,t,n,r,s){this.width=e,this.expTerm=t,this.expScale=n,this.linearTerm=r,this.constantTerm=s}toUniform(){return new Ne({width:this.width,exp_term:this.expTerm,exp_scale:this.expScale,linear_term:this.linearTerm,constant_term:this.constantTerm})}}const hM=class{constructor(e){this.solarIrradiance=new Q(1.474,1.8504,1.91198),this.sunAngularRadius=.004675,this.bottomRadius=636e4,this.topRadius=642e4,this.rayleighDensity=[new Yp(0,0,0,0,0),new Yp(0,1,-.125,0,0)],this.rayleighScattering=new Q(.005802,.013558,.0331),this.mieDensity=[new Yp(0,0,0,0,0),new Yp(0,1,-.833333,0,0)],this.mieScattering=new Q(.003996,.003996,.003996),this.mieExtinction=new Q(.00444,.00444,.00444),this.miePhaseFunctionG=.8,this.absorptionDensity=[new Yp(25,0,0,1/15,-2/3),new Yp(0,0,0,-1/15,8/3)],this.absorptionExtinction=new Q(65e-5,.001881,85e-6),this.groundAlbedo=new Ft().setScalar(.1),this.muSMin=Math.cos(Ev(120)),this.sunRadianceToLuminance=new Q(98242.786222,69954.398112,66475.012354),this.skyRadianceToLuminance=new Q(114974.916437,71305.954816,65310.548555),this.sunRadianceToRelativeLuminance=new Q,this.skyRadianceToRelativeLuminance=new Q,Aj(this,e);const t=xj.dot(this.sunRadianceToLuminance);this.sunRadianceToRelativeLuminance.copy(this.sunRadianceToLuminance).divideScalar(t),this.skyRadianceToRelativeLuminance.copy(this.skyRadianceToLuminance).divideScalar(t)}toUniform(){return new Ne({solar_irradiance:this.solarIrradiance,sun_angular_radius:this.sunAngularRadius,bottom_radius:this.bottomRadius*a_,top_radius:this.topRadius*a_,rayleigh_density:{layers:this.rayleighDensity.map(e=>e.toUniform().value)},rayleigh_scattering:this.rayleighScattering,mie_density:{layers:this.mieDensity.map(e=>e.toUniform().value)},mie_scattering:this.mieScattering,mie_extinction:this.mieExtinction,mie_phase_function_g:this.miePhaseFunctionG,absorption_density:{layers:this.absorptionDensity.map(e=>e.toUniform().value)},absorption_extinction:this.absorptionExtinction,ground_albedo:this.groundAlbedo,mu_s_min:this.muSMin})}};hM.DEFAULT=new hM;let $T=hM;const _j=`precision highp sampler2DArray;

#include "core/depth"
#include "core/math"
#include "core/packing"
#include "core/transform"
#ifdef HAS_SHADOW
#include "core/raySphereIntersection"
#include "core/cascadedShadowMaps"
#include "core/interleavedGradientNoise"
#include "core/vogelDisk"
#endif // HAS_SHADOW

#include "bruneton/definitions"

uniform AtmosphereParameters ATMOSPHERE;
uniform vec3 SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
uniform vec3 SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;

uniform sampler2D transmittance_texture;
uniform sampler3D scattering_texture;
uniform sampler2D irradiance_texture;
uniform sampler3D single_mie_scattering_texture;
uniform sampler3D higher_order_scattering_texture;

#include "bruneton/common"
#include "bruneton/runtime"

#include "sky"

uniform sampler2D normalBuffer;

uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat4 inverseProjectionMatrix;
uniform mat4 inverseViewMatrix;
uniform float bottomRadius;
uniform mat4 worldToECEFMatrix;
uniform float geometricErrorCorrectionAmount;
uniform vec3 sunDirection;
uniform vec3 moonDirection;
uniform float moonAngularRadius;
uniform float lunarRadianceScale;
uniform float albedoScale;

#ifdef HAS_LIGHTING_MASK
uniform sampler2D lightingMaskBuffer;
#endif // HAS_LIGHTING_MASK

// prettier-ignore
#define LIGHTING_MASK_CHANNEL_ LIGHTING_MASK_CHANNEL

#ifdef HAS_OVERLAY
uniform sampler2D overlayBuffer;
#endif // HAS_OVERLAY

#ifdef HAS_SHADOW
uniform sampler2DArray shadowBuffer;
uniform vec2 shadowIntervals[SHADOW_CASCADE_COUNT];
uniform mat4 shadowMatrices[SHADOW_CASCADE_COUNT];
uniform mat4 inverseShadowMatrices[SHADOW_CASCADE_COUNT];
uniform float shadowFar;
uniform float shadowTopHeight;
uniform float shadowRadius;
uniform sampler3D stbnTexture;
uniform int frame;
#endif // HAS_SHADOW

#ifdef HAS_SHADOW_LENGTH
uniform sampler2D shadowLengthBuffer;
#endif // HAS_SHADOW_LENGTH

varying vec3 vCameraPosition;
varying vec3 vRayDirection;
varying vec3 vGeometryAltitudeCorrection;
varying vec3 vEllipsoidRadiiSquared;

vec3 readNormal(const vec2 uv) {
  #ifdef OCT_ENCODED_NORMAL
  return unpackVec2ToNormal(texture(normalBuffer, uv).xy);
  #else // OCT_ENCODED_NORMAL
  return 2.0 * texture(normalBuffer, uv).xyz - 1.0;
  #endif // OCT_ENCODED_NORMAL
}

void correctGeometricError(inout vec3 positionECEF, inout vec3 normalECEF) {
  // TODO: The error is pronounced at the edge of the ellipsoid due to the
  // large difference between the sphere position and the unprojected position
  // at the current fragment. Calculating the sphere position from the fragment
  // UV may resolve this.

  // Correct way is slerp, but this will be small-angle interpolation anyways.
  vec3 sphereNormal = normalize(positionECEF / vEllipsoidRadiiSquared);
  vec3 spherePosition = ATMOSPHERE.bottom_radius * sphereNormal;
  normalECEF = mix(normalECEF, sphereNormal, geometricErrorCorrectionAmount);
  positionECEF = mix(positionECEF, spherePosition, geometricErrorCorrectionAmount);
}

#if defined(SUN_LIGHT) || defined(SKY_LIGHT)

vec3 getSunSkyIrradiance(
  const vec3 positionECEF,
  const vec3 normal,
  const vec3 inputColor,
  const float sunTransmittance
) {
  // Assume lambertian BRDF. If both SUN_LIGHT and SKY_LIGHT are not defined,
  // regard the inputColor as radiance at the texel.
  vec3 diffuse = inputColor * albedoScale * RECIPROCAL_PI;
  vec3 skyIrradiance;
  vec3 sunIrradiance = GetSunAndSkyIrradiance(positionECEF, normal, sunDirection, skyIrradiance);

  #ifdef HAS_SHADOW
  sunIrradiance *= sunTransmittance;
  #endif // HAS_SHADOW

  #if defined(SUN_LIGHT) && defined(SKY_LIGHT)
  return diffuse * (sunIrradiance + skyIrradiance);
  #elif defined(SUN_LIGHT)
  return diffuse * sunIrradiance;
  #elif defined(SKY_LIGHT)
  return diffuse * skyIrradiance;
  #endif // defined(SUN_LIGHT) && defined(SKY_LIGHT)
}

#endif // defined(SUN_LIGHT) || defined(SKY_LIGHT)

#if defined(TRANSMITTANCE) || defined(INSCATTER)

void applyTransmittanceInscatter(const vec3 positionECEF, float shadowLength, inout vec3 radiance) {
  vec3 transmittance;
  vec3 inscatter = GetSkyRadianceToPoint(
    vCameraPosition,
    positionECEF,
    shadowLength,
    sunDirection,
    transmittance
  );
  #ifdef TRANSMITTANCE
  radiance = radiance * transmittance;
  #endif // TRANSMITTANCE
  #ifdef INSCATTER
  radiance = radiance + inscatter;
  #endif // INSCATTER
}

#endif // defined(TRANSMITTANCE) || defined(INSCATTER)

#ifdef HAS_SHADOW

float getSTBN() {
  ivec3 size = textureSize(stbnTexture, 0);
  vec3 scale = 1.0 / vec3(size);
  return texture(stbnTexture, vec3(gl_FragCoord.xy, float(frame % size.z)) * scale).r;
}

vec2 getShadowUv(const vec3 worldPosition, const int cascadeIndex) {
  vec4 clip = shadowMatrices[cascadeIndex] * vec4(worldPosition, 1.0);
  clip /= clip.w;
  return clip.xy * 0.5 + 0.5;
}

float getDistanceToShadowTop(const vec3 positionECEF) {
  // Distance to the top of the shadows along the sun direction, which matches
  // the ray origin of BSM.
  return raySphereSecondIntersection(
    positionECEF / METER_TO_LENGTH_UNIT, // TODO: Make units consistent
    sunDirection,
    vec3(0.0),
    bottomRadius + shadowTopHeight
  );
}

float readShadowOpticalDepth(const vec2 uv, const float distanceToTop, const int cascadeIndex) {
  // r: frontDepth, g: meanExtinction, b: maxOpticalDepth, a: maxOpticalDepthTail
  vec4 shadow = texture(shadowBuffer, vec3(uv, float(cascadeIndex)));
  // Omit adding maxOpticalDepthTail to avoid pronounced aliasing. Ground
  // shadow will be attenuated by inscatter anyways.
  return min(shadow.b, shadow.g * max(0.0, distanceToTop - shadow.r));
}

float sampleShadowOpticalDepthPCF(
  const vec3 worldPosition,
  const float distanceToTop,
  const float radius,
  const int cascadeIndex
) {
  vec2 uv = getShadowUv(worldPosition, cascadeIndex);
  if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {
    return 0.0;
  }

  vec2 texelSize = vec2(1.0) / vec2(textureSize(shadowBuffer, 0).xy);
  float sum = 0.0;
  vec2 offset;
  #pragma unroll_loop_start
  for (int i = 0; i < 16; ++i) {
    #if UNROLLED_LOOP_INDEX < SHADOW_SAMPLE_COUNT
    offset = vogelDisk(
      UNROLLED_LOOP_INDEX,
      SHADOW_SAMPLE_COUNT,
      interleavedGradientNoise(gl_FragCoord.xy) * PI2
    );
    sum += readShadowOpticalDepth(uv + offset * radius * texelSize, distanceToTop, cascadeIndex);
    #endif // UNROLLED_LOOP_INDEX < SHADOW_SAMPLE_COUNT
  }
  #pragma unroll_loop_end
  return sum / float(SHADOW_SAMPLE_COUNT);
}

float sampleShadowOpticalDepth(
  const vec3 worldPosition,
  const vec3 positionECEF,
  const float radius,
  const float jitter
) {
  float distanceToTop = getDistanceToShadowTop(positionECEF);
  if (distanceToTop <= 0.0) {
    return 0.0;
  }
  int cascadeIndex = getFadedCascadeIndex(
    viewMatrix,
    worldPosition,
    shadowIntervals,
    cameraNear,
    shadowFar,
    jitter
  );
  return cascadeIndex >= 0
    ? sampleShadowOpticalDepthPCF(worldPosition, distanceToTop, radius, cascadeIndex)
    : 0.0;
}

float getShadowRadius(const vec3 worldPosition) {
  vec4 clip = shadowMatrices[0] * vec4(worldPosition, 1.0);
  clip /= clip.w;

  // Offset by 1px in each direction in shadow's clip coordinates.
  vec2 shadowSize = vec2(textureSize(shadowBuffer, 0));
  vec3 offset = vec3(2.0 / shadowSize, 0.0);
  vec4 clipX = clip + offset.xzzz;
  vec4 clipY = clip + offset.zyzz;

  // Convert back to world space.
  vec4 worldX = inverseShadowMatrices[0] * clipX;
  vec4 worldY = inverseShadowMatrices[0] * clipY;

  // Project into the main camera's clip space.
  mat4 viewProjectionMatrix = projectionMatrix * viewMatrix;
  vec4 projected = viewProjectionMatrix * vec4(worldPosition, 1.0);
  vec4 projectedX = viewProjectionMatrix * worldX;
  vec4 projectedY = viewProjectionMatrix * worldY;
  projected /= projected.w;
  projectedX /= projectedX.w;
  projectedY /= projectedY.w;

  // Take the mean of pixel sizes.
  vec2 center = (projected.xy * 0.5 + 0.5) * resolution;
  vec2 offsetX = (projectedX.xy * 0.5 + 0.5) * resolution;
  vec2 offsetY = (projectedY.xy * 0.5 + 0.5) * resolution;
  float size = max(length(offsetX - center), length(offsetY - center));

  return remapClamped(size, 10.0, 50.0, 0.0, shadowRadius);
}

#endif // HAS_SHADOW

void mainImage(const vec4 inputColor, const vec2 uv, out vec4 outputColor) {
  #if defined(HAS_LIGHTING_MASK) && defined(DEBUG_SHOW_LIGHTING_MASK)
  outputColor.rgb = vec3(texture(lightingMaskBuffer, uv).LIGHTING_MASK_CHANNEL_);
  outputColor.a = 1.0;
  return;
  #endif // defined(HAS_LIGHTING_MASK) && defined(DEBUG_SHOW_LIGHTING_MASK)

  float shadowLength = 0.0;
  #ifdef HAS_SHADOW_LENGTH
  shadowLength = texture(shadowLengthBuffer, uv).r;
  #endif // HAS_SHADOW_LENGTH

  #ifdef HAS_OVERLAY
  vec4 overlay = texture(overlayBuffer, uv);
  if (overlay.a == 1.0) {
    outputColor = overlay;
    return;
  }
  #endif // HAS_OVERLAY

  float depth = readDepth(uv);
  if (depth >= 1.0 - 1e-8) {
    #ifdef SKY
    vec3 rayDirection = normalize(vRayDirection);
    outputColor.rgb = getSkyRadiance(
      vCameraPosition,
      rayDirection,
      shadowLength,
      sunDirection,
      moonDirection,
      moonAngularRadius,
      lunarRadianceScale
    );
    outputColor.a = 1.0;
    #else // SKY
    outputColor = inputColor;
    #endif // SKY

    #ifdef HAS_OVERLAY
    outputColor.rgb = outputColor.rgb * (1.0 - overlay.a) + overlay.rgb;
    #endif // HAS_OVERLAY
    return;
  }
  depth = reverseLogDepth(depth, cameraNear, cameraFar);

  // Reconstruct position and normal in world space.
  vec3 viewPosition = screenToView(
    uv,
    depth,
    getViewZ(depth),
    projectionMatrix,
    inverseProjectionMatrix
  );
  vec3 worldPosition = (inverseViewMatrix * vec4(viewPosition, 1.0)).xyz;
  vec3 positionECEF = (worldToECEFMatrix * vec4(worldPosition, 1.0)).xyz;
  positionECEF = positionECEF * METER_TO_LENGTH_UNIT + vGeometryAltitudeCorrection;

  vec3 viewNormal;
  #ifdef RECONSTRUCT_NORMAL
  vec3 dx = dFdx(viewPosition);
  vec3 dy = dFdy(viewPosition);
  viewNormal = normalize(cross(dx, dy));
  #elif defined(HAS_NORMALS)
  viewNormal = readNormal(uv);
  #endif // defined(HAS_NORMALS)

  #if defined(RECONSTRUCT_NORMAL) || defined(HAS_NORMALS)
  vec3 worldNormal = (inverseViewMatrix * vec4(viewNormal, 0.0)).xyz;
  vec3 normalECEF = (worldToECEFMatrix * vec4(worldNormal, 0.0)).xyz;
  #else // defined(RECONSTRUCT_NORMAL) || defined(HAS_NORMALS)
  vec3 normalECEF = normalize(positionECEF);
  #endif // defined(RECONSTRUCT_NORMAL) || defined(HAS_NORMALS)

  #ifdef CORRECT_GEOMETRIC_ERROR
  correctGeometricError(positionECEF, normalECEF);
  #endif // CORRECT_GEOMETRIC_ERROR

  #ifdef HAS_SHADOW
  float stbn = getSTBN();
  float radius = getShadowRadius(worldPosition);
  float opticalDepth = sampleShadowOpticalDepth(worldPosition, positionECEF, radius, stbn);
  float sunTransmittance = exp(-opticalDepth);
  #else // HAS_SHADOW
  float sunTransmittance = 1.0;
  #endif // HAS_SHADOW

  vec3 radiance;
  #if defined(SUN_LIGHT) || defined(SKY_LIGHT)
  radiance = getSunSkyIrradiance(positionECEF, normalECEF, inputColor.rgb, sunTransmittance);
  #ifdef HAS_LIGHTING_MASK
  float lightingMask = texture(lightingMaskBuffer, uv).LIGHTING_MASK_CHANNEL_;
  radiance = mix(inputColor.rgb, radiance, lightingMask);
  #endif // HAS_LIGHTING_MASK
  #else // defined(SUN_LIGHT) || defined(SKY_LIGHT)
  radiance = inputColor.rgb;
  #endif // defined(SUN_LIGHT) || defined(SKY_LIGHT)

  #if defined(TRANSMITTANCE) || defined(INSCATTER)
  applyTransmittanceInscatter(positionECEF, shadowLength, radiance);
  #endif // defined(TRANSMITTANCE) || defined(INSCATTER)

  outputColor = vec4(radiance, inputColor.a);

  #ifdef HAS_OVERLAY
  outputColor.rgb = outputColor.rgb * (1.0 - overlay.a) + overlay.rgb;
  #endif // HAS_OVERLAY
}
`,Sj=`uniform mat4 inverseViewMatrix;
uniform mat4 inverseProjectionMatrix;
uniform vec3 cameraPosition;
uniform mat4 worldToECEFMatrix;
uniform vec3 altitudeCorrection;
uniform float geometricErrorCorrectionAmount;
uniform vec3 ellipsoidRadii;

varying vec3 vCameraPosition;
varying vec3 vRayDirection;
varying vec3 vGeometryAltitudeCorrection;
varying vec3 vEllipsoidRadiiSquared;

void getCameraRay(out vec3 origin, out vec3 direction) {
  bool isPerspective = inverseProjectionMatrix[2][3] != 0.0; // 4th entry in the 3rd column

  if (isPerspective) {
    // Calculate the camera ray for a perspective camera.
    vec4 viewPosition = inverseProjectionMatrix * vec4(position, 1.0);
    vec4 worldDirection = inverseViewMatrix * vec4(viewPosition.xyz, 0.0);
    origin = cameraPosition;
    direction = worldDirection.xyz;
  } else {
    // Unprojected points to calculate direction.
    vec4 nearPoint = inverseProjectionMatrix * vec4(position.xy, -1.0, 1.0);
    vec4 farPoint = inverseProjectionMatrix * vec4(position.xy, -0.9, 1.0);
    nearPoint /= nearPoint.w;
    farPoint /= farPoint.w;

    // Calculate world values.
    vec4 worldDirection = inverseViewMatrix * vec4(farPoint.xyz - nearPoint.xyz, 0.0);
    vec4 worldOrigin = inverseViewMatrix * nearPoint;

    // Outputs
    direction = worldDirection.xyz;
    origin = worldOrigin.xyz;
  }
}

void mainSupport() {
  vec3 direction, origin;
  getCameraRay(origin, direction);

  vec3 cameraPositionECEF = (worldToECEFMatrix * vec4(origin, 1.0)).xyz;
  vCameraPosition = (cameraPositionECEF + altitudeCorrection) * METER_TO_LENGTH_UNIT;
  vRayDirection = (worldToECEFMatrix * vec4(direction, 0.0)).xyz;

  vGeometryAltitudeCorrection = altitudeCorrection * METER_TO_LENGTH_UNIT;
  // Gradually turn off the altitude correction on geometries as the geometric
  // error correction takes effect, because that on the ideal sphere will be
  // over corrected.
  // See: https://github.com/takram-design-engineering/three-geospatial/pull/23#issuecomment-2542914656
  #ifdef CORRECT_GEOMETRIC_ERROR
  vGeometryAltitudeCorrection *= 1.0 - geometricErrorCorrectionAmount;
  #endif // CORRECT_GEOMETRIC_ERROR

  vec3 radii = ellipsoidRadii * METER_TO_LENGTH_UNIT;
  vEllipsoidRadiiSquared = radii * radii;
}
`,CI=`vec3 getLunarRadiance(const float moonAngularRadius) {
  // Not a physical number but the order of 10^-6 relative to the sun may fit.
  vec3 radiance =
    ATMOSPHERE.solar_irradiance *
    0.000002 /
    (PI * moonAngularRadius * moonAngularRadius) *
    SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
  return radiance;
}

float intersectSphere(const vec3 ray, const vec3 point, const float radius) {
  vec3 P = -point;
  float PoR = dot(P, ray);
  float D = dot(P, P) - radius * radius;
  return -PoR - sqrt(PoR * PoR - D);
}

float orenNayarDiffuse(const vec3 L, const vec3 V, const vec3 N) {
  float NoL = dot(N, L);
  float NoV = dot(N, V);
  float s = dot(L, V) - NoL * NoV;
  float t = mix(1.0, max(NoL, NoV), step(0.0, s));
  return max(0.0, NoL) * (0.62406015 + 0.41284404 * s / t);
}

vec3 getSkyRadiance(
  const vec3 cameraPosition,
  const vec3 rayDirection,
  const float shadowLength,
  const vec3 sunDirection,
  const vec3 moonDirection,
  const float moonAngularRadius,
  const float lunarRadianceScale
) {
  vec3 transmittance;
  vec3 radiance = GetSkyRadiance(
    cameraPosition,
    rayDirection,
    shadowLength,
    sunDirection,
    transmittance
  );

  // Rendering celestial objects without perspective doesn't make sense.
  #ifdef PERSPECTIVE_CAMERA

  #if defined(SUN) || defined(MOON)
  vec3 ddx = dFdx(rayDirection);
  vec3 ddy = dFdy(rayDirection);
  float fragmentAngle = length(ddx + ddy) / length(rayDirection);
  #endif // defined(SUN) || defined(MOON)

  #ifdef SUN
  float viewDotSun = dot(rayDirection, sunDirection);
  if (viewDotSun > cos(ATMOSPHERE.sun_angular_radius)) {
    float angle = acos(clamp(viewDotSun, -1.0, 1.0));
    float antialias = smoothstep(
      ATMOSPHERE.sun_angular_radius,
      ATMOSPHERE.sun_angular_radius - fragmentAngle,
      angle
    );
    radiance += transmittance * GetSolarRadiance() * antialias;
  }
  #endif // SUN

  #ifdef MOON
  float intersection = intersectSphere(rayDirection, moonDirection, moonAngularRadius);
  if (intersection > 0.0) {
    vec3 normal = normalize(moonDirection - rayDirection * intersection);
    float diffuse = orenNayarDiffuse(-sunDirection, rayDirection, normal);
    float viewDotMoon = dot(rayDirection, moonDirection);
    float angle = acos(clamp(viewDotMoon, -1.0, 1.0));
    float antialias = smoothstep(moonAngularRadius, moonAngularRadius - fragmentAngle, angle);
    radiance +=
      transmittance *
      getLunarRadiance(moonAngularRadius) *
      lunarRadianceScale *
      diffuse *
      antialias;
  }
  #endif // MOON

  #endif // PERSPECTIVE_CAMERA

  return radiance;
}
`;var bj=Object.defineProperty,fa=(i,e,t,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(e,t,r)||r);return r&&bj(e,t,r),r};const Ej=new Q,Mj=new Q,Tj=new kT,RI={blendFunction:bn.NORMAL,octEncodedNormal:!1,reconstructNormal:!1,ellipsoid:ac.WGS84,correctAltitude:!0,correctGeometricError:!0,sunLight:!1,skyLight:!1,transmittance:!0,inscatter:!0,albedoScale:1,sky:!1,sun:!0,moon:!0,moonAngularRadius:.0045,lunarRadianceScale:1,ground:!0};let js=class extends ua{constructor(e=new Bm,t,n=$T.DEFAULT){const{blendFunction:r,normalBuffer:s=null,octEncodedNormal:o,reconstructNormal:u,irradianceTexture:f=null,scatteringTexture:p=null,transmittanceTexture:g=null,singleMieScatteringTexture:v=null,higherOrderScatteringTexture:y=null,ellipsoid:A,correctAltitude:S,correctGeometricError:T,sunDirection:M,sunIrradiance:E,sunLight:R,skyIrradiance:I,skyLight:O,transmittance:F,inscatter:z,irradianceScale:j,albedoScale:W,sky:L,sun:H,moon:K,moonDirection:de,moonAngularRadius:ce,lunarRadianceScale:ne,ground:fe}={...RI,...t};super("AerialPerspectiveEffect",WV(Io(_j,{core:{depth:KT,packing:bI,math:uj,transform:MI,raySphereIntersection:EI,cascadedShadowMaps:lj,interleavedGradientNoise:cj,vogelDisk:fj},bruneton:{common:Zc,definitions:$c,runtime:ZT},sky:CI})),{blendFunction:r,vertexShader:Sj,attributes:la.DEPTH,uniforms:new Map(Object.entries({normalBuffer:new Ne(s),projectionMatrix:new Ne(new jt),viewMatrix:new Ne(new jt),inverseProjectionMatrix:new Ne(new jt),inverseViewMatrix:new Ne(new jt),cameraPosition:new Ne(new Q),bottomRadius:new Ne(n.bottomRadius),ellipsoidRadii:new Ne(new Q),worldToECEFMatrix:new Ne(new jt),altitudeCorrection:new Ne(new Q),geometricErrorCorrectionAmount:new Ne(0),sunDirection:new Ne((M==null?void 0:M.clone())??new Q),albedoScale:new Ne(j??W),moonDirection:new Ne((de==null?void 0:de.clone())??new Q),moonAngularRadius:new Ne(ce),lunarRadianceScale:new Ne(ne),overlayBuffer:new Ne(null),shadowBuffer:new Ne(null),shadowMapSize:new Ne(new qe),shadowIntervals:new Ne([]),shadowMatrices:new Ne([]),inverseShadowMatrices:new Ne([]),shadowFar:new Ne(0),shadowTopHeight:new Ne(0),shadowRadius:new Ne(3),stbnTexture:new Ne(null),frame:new Ne(0),shadowLengthBuffer:new Ne(null),lightingMaskBuffer:new Ne(null),ATMOSPHERE:n.toUniform(),SUN_SPECTRAL_RADIANCE_TO_LUMINANCE:new Ne(n.sunRadianceToRelativeLuminance),SKY_SPECTRAL_RADIANCE_TO_LUMINANCE:new Ne(n.skyRadianceToRelativeLuminance),irradiance_texture:new Ne(f),scattering_texture:new Ne(p),transmittance_texture:new Ne(g),single_mie_scattering_texture:new Ne(null),higher_order_scattering_texture:new Ne(null)})),defines:new Map([["TRANSMITTANCE_TEXTURE_WIDTH",km.toFixed(0)],["TRANSMITTANCE_TEXTURE_HEIGHT",Vm.toFixed(0)],["SCATTERING_TEXTURE_R_SIZE",rS.toFixed(0)],["SCATTERING_TEXTURE_MU_SIZE",sS.toFixed(0)],["SCATTERING_TEXTURE_MU_S_SIZE",aS.toFixed(0)],["SCATTERING_TEXTURE_NU_SIZE",oS.toFixed(0)],["IRRADIANCE_TEXTURE_WIDTH",Hm.toFixed(0)],["IRRADIANCE_TEXTURE_HEIGHT",Gm.toFixed(0)],["METER_TO_LENGTH_UNIT",a_.toFixed(7)]])}),this.camera=e,this.atmosphere=n,this.overlay=null,this.shadow=null,this.shadowLength=null,this.lightingMask=null,this.hasNormals=!1,this.combinedScatteringTextures=!1,this.hasHigherOrderScatteringTexture=!1,this.shadowSampleCount=8,this.octEncodedNormal=o,this.reconstructNormal=u,this.singleMieScatteringTexture=v,this.higherOrderScatteringTexture=y,this.ellipsoid=A,this.correctAltitude=S,this.correctGeometricError=T,this.sunLight=E??R,this.skyLight=I??O,this.transmittance=F,this.inscatter=z,this.sky=L,this.sun=H,this.moon=K,this.ground=fe}get mainCamera(){return this.camera}set mainCamera(e){this.camera=e}copyCameraSettings(e){const{projectionMatrix:t,matrixWorldInverse:n,projectionMatrixInverse:r,matrixWorld:s}=e,o=this.uniforms;o.get("projectionMatrix").value.copy(t),o.get("viewMatrix").value.copy(n),o.get("inverseProjectionMatrix").value.copy(r),o.get("inverseViewMatrix").value.copy(s);const u=e.getWorldPosition(o.get("cameraPosition").value),f=o.get("worldToECEFMatrix").value,p=Ej.copy(u).applyMatrix4(f);try{const v=Tj.setFromECEF(p).height,y=Mj.set(0,this.ellipsoid.maximumRadius,-Math.max(0,v)).applyMatrix4(t);o.get("geometricErrorCorrectionAmount").value=IV(DV(y.y,41.5,13.8,0,1))}catch{return}const g=o.get("altitudeCorrection");this.correctAltitude?wI(p,this.atmosphere.bottomRadius,this.ellipsoid,g.value):g.value.setScalar(0)}updateOverlay(){let e=!1;const{uniforms:t,defines:n,overlay:r}=this,s=n.has("HAS_OVERLAY"),o=r!=null;return o!==s&&(o?n.set("HAS_OVERLAY","1"):(n.delete("HAS_OVERLAY"),t.get("overlayBuffer").value=null),e=!0),o&&(t.get("overlayBuffer").value=r.map),e}updateShadow(){let e=!1;const{uniforms:t,defines:n,shadow:r}=this,s=n.has("HAS_SHADOW"),o=r!=null;if(o!==s&&(o?n.set("HAS_SHADOW","1"):(n.delete("HAS_SHADOW"),t.get("shadowBuffer").value=null),e=!0),o){const u=n.get("SHADOW_CASCADE_COUNT"),f=`${r.cascadeCount}`;u!==f&&(n.set("SHADOW_CASCADE_COUNT",r.cascadeCount.toFixed(0)),e=!0),t.get("shadowBuffer").value=r.map,t.get("shadowMapSize").value=r.mapSize,t.get("shadowIntervals").value=r.intervals,t.get("shadowMatrices").value=r.matrices,t.get("inverseShadowMatrices").value=r.inverseMatrices,t.get("shadowFar").value=r.far,t.get("shadowTopHeight").value=r.topHeight}return e}updateShadowLength(){let e=!1;const{uniforms:t,defines:n,shadowLength:r}=this,s=n.has("HAS_SHADOW_LENGTH"),o=r!=null;return o!==s&&(o?n.set("HAS_SHADOW_LENGTH","1"):(n.delete("HAS_SHADOW_LENGTH"),t.get("shadowLengthBuffer").value=null),e=!0),o&&(t.get("shadowLengthBuffer").value=r.map),e}updateLightingMask(){let e=!1;const{uniforms:t,defines:n,lightingMask:r}=this,s=n.has("HAS_LIGHTING_MASK"),o=r!=null;if(o!==s&&(o?n.set("HAS_LIGHTING_MASK","1"):(n.delete("HAS_LIGHTING_MASK"),t.get("lightingMaskBuffer").value=null),e=!0),o){t.get("lightingMaskBuffer").value=r.map;const u=n.get("LIGHTING_MASK_CHANNEL"),f=r.channel;f!==u&&(/^[rgba]$/.test(f)?(n.set("LIGHTING_MASK_CHANNEL",f),e=!0):console.error(`Expression validation failed: ${f}`))}return e}update(e,t,n){this.copyCameraSettings(this.camera);let r=!1;r||(r=this.updateOverlay()),r||(r=this.updateShadow()),r||(r=this.updateShadowLength()),r||(r=this.updateLightingMask()),r&&this.setChanged(),++this.uniforms.get("frame").value}get normalBuffer(){return this.uniforms.get("normalBuffer").value}set normalBuffer(e){this.uniforms.get("normalBuffer").value=e,this.hasNormals=e!=null}get irradianceTexture(){return this.uniforms.get("irradiance_texture").value}set irradianceTexture(e){this.uniforms.get("irradiance_texture").value=e}get scatteringTexture(){return this.uniforms.get("scattering_texture").value}set scatteringTexture(e){this.uniforms.get("scattering_texture").value=e}get transmittanceTexture(){return this.uniforms.get("transmittance_texture").value}set transmittanceTexture(e){this.uniforms.get("transmittance_texture").value=e}get singleMieScatteringTexture(){return this.uniforms.get("single_mie_scattering_texture").value}set singleMieScatteringTexture(e){this.uniforms.get("single_mie_scattering_texture").value=e,this.combinedScatteringTextures=e==null}get higherOrderScatteringTexture(){return this.uniforms.get("higher_order_scattering_texture").value}set higherOrderScatteringTexture(e){this.uniforms.get("higher_order_scattering_texture").value=e,this.hasHigherOrderScatteringTexture=e!=null}get ellipsoid(){return this._ellipsoid}set ellipsoid(e){this._ellipsoid=e,this.uniforms.get("ellipsoidRadii").value.copy(e.radii)}get worldToECEFMatrix(){return this.uniforms.get("worldToECEFMatrix").value}get sunDirection(){return this.uniforms.get("sunDirection").value}get sunIrradiance(){return this.sunLight}set sunIrradiance(e){this.sunLight=e}get skyIrradiance(){return this.skyLight}set skyIrradiance(e){this.skyLight=e}get irradianceScale(){return this.albedoScale}set irradianceScale(e){this.albedoScale=e}get albedoScale(){return this.uniforms.get("albedoScale").value}set albedoScale(e){this.uniforms.get("albedoScale").value=e}get moonDirection(){return this.uniforms.get("moonDirection").value}get moonAngularRadius(){return this.uniforms.get("moonAngularRadius").value}set moonAngularRadius(e){this.uniforms.get("moonAngularRadius").value=e}get lunarRadianceScale(){return this.uniforms.get("lunarRadianceScale").value}set lunarRadianceScale(e){this.uniforms.get("lunarRadianceScale").value=e}get stbnTexture(){return this.uniforms.get("stbnTexture").value}set stbnTexture(e){this.uniforms.get("stbnTexture").value=e}get shadowRadius(){return this.uniforms.get("shadowRadius").value}set shadowRadius(e){this.uniforms.get("shadowRadius").value=e}};fa([or("OCT_ENCODED_NORMAL")],js.prototype,"octEncodedNormal");fa([or("RECONSTRUCT_NORMAL")],js.prototype,"reconstructNormal");fa([or("HAS_NORMALS")],js.prototype,"hasNormals");fa([or("COMBINED_SCATTERING_TEXTURES")],js.prototype,"combinedScatteringTextures");fa([or("HAS_HIGHER_ORDER_SCATTERING_TEXTURE")],js.prototype,"hasHigherOrderScatteringTexture");fa([or("CORRECT_GEOMETRIC_ERROR")],js.prototype,"correctGeometricError");fa([or("SUN_LIGHT")],js.prototype,"sunLight");fa([or("SKY_LIGHT")],js.prototype,"skyLight");fa([or("TRANSMITTANCE")],js.prototype,"transmittance");fa([or("INSCATTER")],js.prototype,"inscatter");fa([or("SKY")],js.prototype,"sky");fa([or("SUN")],js.prototype,"sun");fa([or("MOON")],js.prototype,"moon");fa([or("GROUND")],js.prototype,"ground");fa([BV("SHADOW_SAMPLE_COUNT",{min:1,max:16})],js.prototype,"shadowSampleCount");var wj=Object.defineProperty,DI=(i,e,t,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(e,t,r)||r);return r&&wj(e,t,r),r};const Cj=new Q;function Rj(i,e){let t="",n="";for(let r=1;r<e;++r)t+=`layout(location = ${r}) out float renderTarget${r};
`,n+=`renderTarget${r} = 0.0;
`;return i.replace("#include <mrt_layout>",t).replace("#include <mrt_output>",n)}const ew={ellipsoid:ac.WGS84,correctAltitude:!0,renderTargetCount:1};class lS extends Gv{constructor(e,t=$T.DEFAULT){const{irradianceTexture:n=null,scatteringTexture:r=null,transmittanceTexture:s=null,singleMieScatteringTexture:o=null,higherOrderScatteringTexture:u=null,ellipsoid:f,correctAltitude:p,sunDirection:g,sunAngularRadius:v,renderTargetCount:y,...A}={...ew,...e};super({toneMapped:!1,depthWrite:!1,depthTest:!1,...A,uniforms:{cameraPosition:new Ne(new Q),worldToECEFMatrix:new Ne(new jt),altitudeCorrection:new Ne(new Q),sunDirection:new Ne((g==null?void 0:g.clone())??new Q),ATMOSPHERE:t.toUniform(),SUN_SPECTRAL_RADIANCE_TO_LUMINANCE:new Ne(t.sunRadianceToRelativeLuminance),SKY_SPECTRAL_RADIANCE_TO_LUMINANCE:new Ne(t.skyRadianceToRelativeLuminance),irradiance_texture:new Ne(n),scattering_texture:new Ne(r),transmittance_texture:new Ne(s),single_mie_scattering_texture:new Ne(null),higher_order_scattering_texture:new Ne(null),...A.uniforms},defines:{PI:`${Math.PI}`,TRANSMITTANCE_TEXTURE_WIDTH:km.toFixed(0),TRANSMITTANCE_TEXTURE_HEIGHT:Vm.toFixed(0),SCATTERING_TEXTURE_R_SIZE:rS.toFixed(0),SCATTERING_TEXTURE_MU_SIZE:sS.toFixed(0),SCATTERING_TEXTURE_MU_S_SIZE:aS.toFixed(0),SCATTERING_TEXTURE_NU_SIZE:oS.toFixed(0),IRRADIANCE_TEXTURE_WIDTH:Hm.toFixed(0),IRRADIANCE_TEXTURE_HEIGHT:Gm.toFixed(0),METER_TO_LENGTH_UNIT:a_.toFixed(7),...A.defines}}),this.atmosphere=t,this.combinedScatteringTextures=!1,this.hasHigherOrderScatteringTexture=!1,this.singleMieScatteringTexture=o,this.higherOrderScatteringTexture=u,this.ellipsoid=f,this.correctAltitude=p,v!=null&&(this.sunAngularRadius=v),this.renderTargetCount=y}copyCameraSettings(e){const t=this.uniforms,n=e.getWorldPosition(t.cameraPosition.value),r=Cj.copy(n).applyMatrix4(t.worldToECEFMatrix.value),s=t.altitudeCorrection.value;this.correctAltitude?wI(r,this.atmosphere.bottomRadius,this.ellipsoid,s):s.setScalar(0)}onBeforeCompile(e,t){e.fragmentShader=Rj(e.fragmentShader,this.renderTargetCount)}onBeforeRender(e,t,n,r,s,o){this.copyCameraSettings(n)}get irradianceTexture(){return this.uniforms.irradiance_texture.value}set irradianceTexture(e){this.uniforms.irradiance_texture.value=e}get scatteringTexture(){return this.uniforms.scattering_texture.value}set scatteringTexture(e){this.uniforms.scattering_texture.value=e}get transmittanceTexture(){return this.uniforms.transmittance_texture.value}set transmittanceTexture(e){this.uniforms.transmittance_texture.value=e}get singleMieScatteringTexture(){return this.uniforms.single_mie_scattering_texture.value}set singleMieScatteringTexture(e){this.uniforms.single_mie_scattering_texture.value=e,this.combinedScatteringTextures=e==null}get higherOrderScatteringTexture(){return this.uniforms.higher_order_scattering_texture.value}set higherOrderScatteringTexture(e){this.uniforms.higher_order_scattering_texture.value=e,this.hasHigherOrderScatteringTexture=e!=null}get worldToECEFMatrix(){return this.uniforms.worldToECEFMatrix.value}get sunDirection(){return this.uniforms.sunDirection.value}get sunAngularRadius(){return this.uniforms.ATMOSPHERE.value.sun_angular_radius}set sunAngularRadius(e){this.uniforms.ATMOSPHERE.value.sun_angular_radius=e}get renderTargetCount(){return this._renderTargetCount}set renderTargetCount(e){e!==this.renderTargetCount&&(this._renderTargetCount=e,this.needsUpdate=!0)}}DI([or("COMBINED_SCATTERING_TEXTURES")],lS.prototype,"combinedScatteringTextures");DI([or("HAS_HIGHER_ORDER_SCATTERING_TEXTURE")],lS.prototype,"hasHigherOrderScatteringTexture");/**
    @preserve

    Astronomy library for JavaScript (browser and Node.js).
    https://github.com/cosinekitty/astronomy

    MIT License

    Copyright (c) 2019-2023 Don Cross <cosinekitty@gmail.com>

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
*//**
 * @fileoverview Astronomy calculation library for browser scripting and Node.js.
 * @author Don Cross <cosinekitty@gmail.com>
 * @license MIT
 */const Dj=173.1446326846693,Ij=14959787069098932e-8,oh=.017453292519943295,Bj=365.24217,GR=new Date("2000-01-01T12:00:00Z"),Yc=2*Math.PI,ud=3600*(180/Math.PI),im=484813681109536e-20,Nj=10800*60,Oj=2*Nj,Lj=6378.1366,Pj=Lj/Ij,Uj=81.30056,tw=.0002959122082855911,pM=2825345909524226e-22,mM=8459715185680659e-23,gM=1292024916781969e-23,vM=1524358900784276e-23;function Ky(i){if(!Number.isFinite(i))throw console.trace(),`Value is not a finite number: ${i}`;return i}function Qp(i){return i-Math.floor(i)}var Bi;(function(i){i.Sun="Sun",i.Moon="Moon",i.Mercury="Mercury",i.Venus="Venus",i.Earth="Earth",i.Mars="Mars",i.Jupiter="Jupiter",i.Saturn="Saturn",i.Uranus="Uranus",i.Neptune="Neptune",i.Pluto="Pluto",i.SSB="SSB",i.EMB="EMB",i.Star1="Star1",i.Star2="Star2",i.Star3="Star3",i.Star4="Star4",i.Star5="Star5",i.Star6="Star6",i.Star7="Star7",i.Star8="Star8"})(Bi||(Bi={}));const Fj=[Bi.Star1,Bi.Star2,Bi.Star3,Bi.Star4,Bi.Star5,Bi.Star6,Bi.Star7,Bi.Star8],zj=[{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0},{ra:0,dec:0,dist:0}];function Hj(i){const e=Fj.indexOf(i);return e>=0?zj[e]:null}function II(i){const e=Hj(i);return e&&e.dist>0?e:null}var ou;(function(i){i[i.From2000=0]="From2000",i[i.Into2000=1]="Into2000"})(ou||(ou={}));const rm={Mercury:[[[[4.40250710144,0,0],[.40989414977,1.48302034195,26087.9031415742],[.050462942,4.47785489551,52175.8062831484],[.00855346844,1.16520322459,78263.70942472259],[.00165590362,4.11969163423,104351.61256629678],[.00034561897,.77930768443,130439.51570787099],[7583476e-11,3.71348404924,156527.41884944518]],[[26087.90313685529,0,0],[.01131199811,6.21874197797,26087.9031415742],[.00292242298,3.04449355541,52175.8062831484],[.00075775081,6.08568821653,78263.70942472259],[.00019676525,2.80965111777,104351.61256629678]]],[[[.11737528961,1.98357498767,26087.9031415742],[.02388076996,5.03738959686,52175.8062831484],[.01222839532,3.14159265359,0],[.0054325181,1.79644363964,78263.70942472259],[.0012977877,4.83232503958,104351.61256629678],[.00031866927,1.58088495658,130439.51570787099],[7963301e-11,4.60972126127,156527.41884944518]],[[.00274646065,3.95008450011,26087.9031415742],[.00099737713,3.14159265359,0]]],[[[.39528271651,0,0],[.07834131818,6.19233722598,26087.9031415742],[.00795525558,2.95989690104,52175.8062831484],[.00121281764,6.01064153797,78263.70942472259],[.00021921969,2.77820093972,104351.61256629678],[4354065e-11,5.82894543774,130439.51570787099]],[[.0021734774,4.65617158665,26087.9031415742],[.00044141826,1.42385544001,52175.8062831484]]]],Venus:[[[[3.17614666774,0,0],[.01353968419,5.59313319619,10213.285546211],[.00089891645,5.30650047764,20426.571092422],[5477194e-11,4.41630661466,7860.4193924392],[3455741e-11,2.6996444782,11790.6290886588],[2372061e-11,2.99377542079,3930.2096962196],[1317168e-11,5.18668228402,26.2983197998],[1664146e-11,4.25018630147,1577.3435424478],[1438387e-11,4.15745084182,9683.5945811164],[1200521e-11,6.15357116043,30639.856638633]],[[10213.28554621638,0,0],[.00095617813,2.4640651111,10213.285546211],[7787201e-11,.6247848222,20426.571092422]]],[[[.05923638472,.26702775812,10213.285546211],[.00040107978,1.14737178112,20426.571092422],[.00032814918,3.14159265359,0]],[[.00287821243,1.88964962838,10213.285546211]]],[[[.72334820891,0,0],[.00489824182,4.02151831717,10213.285546211],[1658058e-11,4.90206728031,20426.571092422],[1378043e-11,1.12846591367,11790.6290886588],[1632096e-11,2.84548795207,7860.4193924392],[498395e-11,2.58682193892,9683.5945811164],[221985e-11,2.01346696541,19367.1891622328],[237454e-11,2.55136053886,15720.8387848784]],[[.00034551041,.89198706276,10213.285546211]]]],Earth:[[[[1.75347045673,0,0],[.03341656453,4.66925680415,6283.0758499914],[.00034894275,4.62610242189,12566.1516999828],[3417572e-11,2.82886579754,3.523118349],[3497056e-11,2.74411783405,5753.3848848968],[3135899e-11,3.62767041756,77713.7714681205],[2676218e-11,4.41808345438,7860.4193924392],[2342691e-11,6.13516214446,3930.2096962196],[1273165e-11,2.03709657878,529.6909650946],[1324294e-11,.74246341673,11506.7697697936],[901854e-11,2.04505446477,26.2983197998],[1199167e-11,1.10962946234,1577.3435424478],[857223e-11,3.50849152283,398.1490034082],[779786e-11,1.17882681962,5223.6939198022],[99025e-10,5.23268072088,5884.9268465832],[753141e-11,2.53339052847,5507.5532386674],[505267e-11,4.58292599973,18849.2275499742],[492392e-11,4.20505711826,775.522611324],[356672e-11,2.91954114478,.0673103028],[284125e-11,1.89869240932,796.2980068164],[242879e-11,.34481445893,5486.777843175],[317087e-11,5.84901948512,11790.6290886588],[271112e-11,.31486255375,10977.078804699],[206217e-11,4.80646631478,2544.3144198834],[205478e-11,1.86953770281,5573.1428014331],[202318e-11,2.45767790232,6069.7767545534],[126225e-11,1.08295459501,20.7753954924],[155516e-11,.83306084617,213.299095438]],[[6283.0758499914,0,0],[.00206058863,2.67823455808,6283.0758499914],[4303419e-11,2.63512233481,12566.1516999828]],[[8721859e-11,1.07253635559,6283.0758499914]]],[[],[[.00227777722,3.4137662053,6283.0758499914],[3805678e-11,3.37063423795,12566.1516999828]]],[[[1.00013988784,0,0],[.01670699632,3.09846350258,6283.0758499914],[.00013956024,3.05524609456,12566.1516999828],[308372e-10,5.19846674381,77713.7714681205],[1628463e-11,1.17387558054,5753.3848848968],[1575572e-11,2.84685214877,7860.4193924392],[924799e-11,5.45292236722,11506.7697697936],[542439e-11,4.56409151453,3930.2096962196],[47211e-10,3.66100022149,5884.9268465832],[85831e-11,1.27079125277,161000.6857376741],[57056e-11,2.01374292245,83996.84731811189],[55736e-11,5.2415979917,71430.69561812909],[174844e-11,3.01193636733,18849.2275499742],[243181e-11,4.2734953079,11790.6290886588]],[[.00103018607,1.10748968172,6283.0758499914],[1721238e-11,1.06442300386,12566.1516999828]],[[4359385e-11,5.78455133808,6283.0758499914]]]],Mars:[[[[6.20347711581,0,0],[.18656368093,5.0503710027,3340.6124266998],[.01108216816,5.40099836344,6681.2248533996],[.00091798406,5.75478744667,10021.8372800994],[.00027744987,5.97049513147,3.523118349],[.00010610235,2.93958560338,2281.2304965106],[.00012315897,.84956094002,2810.9214616052],[8926784e-11,4.15697846427,.0172536522],[8715691e-11,6.11005153139,13362.4497067992],[6797556e-11,.36462229657,398.1490034082],[7774872e-11,3.33968761376,5621.8429232104],[3575078e-11,1.6618650571,2544.3144198834],[4161108e-11,.22814971327,2942.4634232916],[3075252e-11,.85696614132,191.4482661116],[2628117e-11,.64806124465,3337.0893083508],[2937546e-11,6.07893711402,.0673103028],[2389414e-11,5.03896442664,796.2980068164],[2579844e-11,.02996736156,3344.1355450488],[1528141e-11,1.14979301996,6151.533888305],[1798806e-11,.65634057445,529.6909650946],[1264357e-11,3.62275122593,5092.1519581158],[1286228e-11,3.06796065034,2146.1654164752],[1546404e-11,2.91579701718,1751.539531416],[1024902e-11,3.69334099279,8962.4553499102],[891566e-11,.18293837498,16703.062133499],[858759e-11,2.4009381194,2914.0142358238],[832715e-11,2.46418619474,3340.5951730476],[83272e-10,4.49495782139,3340.629680352],[712902e-11,3.66335473479,1059.3819301892],[748723e-11,3.82248614017,155.4203994342],[723861e-11,.67497311481,3738.761430108],[635548e-11,2.92182225127,8432.7643848156],[655162e-11,.48864064125,3127.3133312618],[550474e-11,3.81001042328,.9803210682],[55275e-10,4.47479317037,1748.016413067],[425966e-11,.55364317304,6283.0758499914],[415131e-11,.49662285038,213.299095438],[472167e-11,3.62547124025,1194.4470102246],[306551e-11,.38052848348,6684.7479717486],[312141e-11,.99853944405,6677.7017350506],[293198e-11,4.22131299634,20.7753954924],[302375e-11,4.48618007156,3532.0606928114],[274027e-11,.54222167059,3340.545116397],[281079e-11,5.88163521788,1349.8674096588],[231183e-11,1.28242156993,3870.3033917944],[283602e-11,5.7688543494,3149.1641605882],[236117e-11,5.75503217933,3333.498879699],[274033e-11,.13372524985,3340.6797370026],[299395e-11,2.78323740866,6254.6266625236]],[[3340.61242700512,0,0],[.01457554523,3.60433733236,3340.6124266998],[.00168414711,3.92318567804,6681.2248533996],[.00020622975,4.26108844583,10021.8372800994],[3452392e-11,4.7321039319,3.523118349],[2586332e-11,4.60670058555,13362.4497067992],[841535e-11,4.45864030426,2281.2304965106]],[[.00058152577,2.04961712429,3340.6124266998],[.00013459579,2.45738706163,6681.2248533996]]],[[[.03197134986,3.76832042431,3340.6124266998],[.00298033234,4.10616996305,6681.2248533996],[.00289104742,0,0],[.00031365539,4.4465105309,10021.8372800994],[34841e-9,4.7881254926,13362.4497067992]],[[.00217310991,6.04472194776,3340.6124266998],[.00020976948,3.14159265359,0],[.00012834709,1.60810667915,6681.2248533996]]],[[[1.53033488271,0,0],[.1418495316,3.47971283528,3340.6124266998],[.00660776362,3.81783443019,6681.2248533996],[.00046179117,4.15595316782,10021.8372800994],[8109733e-11,5.55958416318,2810.9214616052],[7485318e-11,1.77239078402,5621.8429232104],[5523191e-11,1.3643630377,2281.2304965106],[382516e-10,4.49407183687,13362.4497067992],[2306537e-11,.09081579001,2544.3144198834],[1999396e-11,5.36059617709,3337.0893083508],[2484394e-11,4.9254563992,2942.4634232916],[1960195e-11,4.74249437639,3344.1355450488],[1167119e-11,2.11260868341,5092.1519581158],[1102816e-11,5.00908403998,398.1490034082],[899066e-11,4.40791133207,529.6909650946],[992252e-11,5.83861961952,6151.533888305],[807354e-11,2.10217065501,1059.3819301892],[797915e-11,3.44839203899,796.2980068164],[740975e-11,1.49906336885,2146.1654164752]],[[.01107433345,2.03250524857,3340.6124266998],[.00103175887,2.37071847807,6681.2248533996],[128772e-9,0,0],[.0001081588,2.70888095665,10021.8372800994]],[[.00044242249,.47930604954,3340.6124266998],[8138042e-11,.86998389204,6681.2248533996]]]],Jupiter:[[[[.59954691494,0,0],[.09695898719,5.06191793158,529.6909650946],[.00573610142,1.44406205629,7.1135470008],[.00306389205,5.41734730184,1059.3819301892],[.00097178296,4.14264726552,632.7837393132],[.00072903078,3.64042916389,522.5774180938],[.00064263975,3.41145165351,103.0927742186],[.00039806064,2.29376740788,419.4846438752],[.00038857767,1.27231755835,316.3918696566],[.00027964629,1.7845459182,536.8045120954],[.0001358973,5.7748104079,1589.0728952838],[8246349e-11,3.5822792584,206.1855484372],[8768704e-11,3.63000308199,949.1756089698],[7368042e-11,5.0810119427,735.8765135318],[626315e-10,.02497628807,213.299095438],[6114062e-11,4.51319998626,1162.4747044078],[4905396e-11,1.32084470588,110.2063212194],[5305285e-11,1.30671216791,14.2270940016],[5305441e-11,4.18625634012,1052.2683831884],[4647248e-11,4.69958103684,3.9321532631],[3045023e-11,4.31676431084,426.598190876],[2609999e-11,1.56667394063,846.0828347512],[2028191e-11,1.06376530715,3.1813937377],[1764763e-11,2.14148655117,1066.49547719],[1722972e-11,3.88036268267,1265.5674786264],[1920945e-11,.97168196472,639.897286314],[1633223e-11,3.58201833555,515.463871093],[1431999e-11,4.29685556046,625.6701923124],[973272e-11,4.09764549134,95.9792272178]],[[529.69096508814,0,0],[.00489503243,4.2208293947,529.6909650946],[.00228917222,6.02646855621,7.1135470008],[.00030099479,4.54540782858,1059.3819301892],[.0002072092,5.45943156902,522.5774180938],[.00012103653,.16994816098,536.8045120954],[6067987e-11,4.42422292017,103.0927742186],[5433968e-11,3.98480737746,419.4846438752],[4237744e-11,5.89008707199,14.2270940016]],[[.00047233601,4.32148536482,7.1135470008],[.00030649436,2.929777887,529.6909650946],[.00014837605,3.14159265359,0]]],[[[.02268615702,3.55852606721,529.6909650946],[.00109971634,3.90809347197,1059.3819301892],[.00110090358,0,0],[8101428e-11,3.60509572885,522.5774180938],[6043996e-11,4.25883108339,1589.0728952838],[6437782e-11,.30627119215,536.8045120954]],[[.00078203446,1.52377859742,529.6909650946]]],[[[5.20887429326,0,0],[.25209327119,3.49108639871,529.6909650946],[.00610599976,3.84115365948,1059.3819301892],[.00282029458,2.57419881293,632.7837393132],[.00187647346,2.07590383214,522.5774180938],[.00086792905,.71001145545,419.4846438752],[.00072062974,.21465724607,536.8045120954],[.00065517248,5.9799588479,316.3918696566],[.00029134542,1.67759379655,103.0927742186],[.00030135335,2.16132003734,949.1756089698],[.00023453271,3.54023522184,735.8765135318],[.00022283743,4.19362594399,1589.0728952838],[.00023947298,.2745803748,7.1135470008],[.00013032614,2.96042965363,1162.4747044078],[970336e-10,1.90669633585,206.1855484372],[.00012749023,2.71550286592,1052.2683831884],[7057931e-11,2.18184839926,1265.5674786264],[6137703e-11,6.26418240033,846.0828347512],[2616976e-11,2.00994012876,1581.959348283]],[[.0127180152,2.64937512894,529.6909650946],[.00061661816,3.00076460387,1059.3819301892],[.00053443713,3.89717383175,522.5774180938],[.00031185171,4.88276958012,536.8045120954],[.00041390269,0,0]]]],Saturn:[[[[.87401354025,0,0],[.11107659762,3.96205090159,213.299095438],[.01414150957,4.58581516874,7.1135470008],[.00398379389,.52112032699,206.1855484372],[.00350769243,3.30329907896,426.598190876],[.00206816305,.24658372002,103.0927742186],[792713e-9,3.84007056878,220.4126424388],[.00023990355,4.66976924553,110.2063212194],[.00016573588,.43719228296,419.4846438752],[.00014906995,5.76903183869,316.3918696566],[.0001582029,.93809155235,632.7837393132],[.00014609559,1.56518472,3.9321532631],[.00013160301,4.44891291899,14.2270940016],[.00015053543,2.71669915667,639.897286314],[.00013005299,5.98119023644,11.0457002639],[.00010725067,3.12939523827,202.2533951741],[5863206e-11,.23656938524,529.6909650946],[5227757e-11,4.20783365759,3.1813937377],[6126317e-11,1.76328667907,277.0349937414],[5019687e-11,3.17787728405,433.7117378768],[459255e-10,.61977744975,199.0720014364],[4005867e-11,2.24479718502,63.7358983034],[2953796e-11,.98280366998,95.9792272178],[387367e-10,3.22283226966,138.5174968707],[2461186e-11,2.03163875071,735.8765135318],[3269484e-11,.77492638211,949.1756089698],[1758145e-11,3.2658010994,522.5774180938],[1640172e-11,5.5050445305,846.0828347512],[1391327e-11,4.02333150505,323.5054166574],[1580648e-11,4.37265307169,309.2783226558],[1123498e-11,2.83726798446,415.5524906121],[1017275e-11,3.71700135395,227.5261894396],[848642e-11,3.1915017083,209.3669421749]],[[213.2990952169,0,0],[.01297370862,1.82834923978,213.299095438],[.00564345393,2.88499717272,7.1135470008],[.00093734369,1.06311793502,426.598190876],[.00107674962,2.27769131009,206.1855484372],[.00040244455,2.04108104671,220.4126424388],[.00019941774,1.2795439047,103.0927742186],[.00010511678,2.7488034213,14.2270940016],[6416106e-11,.38238295041,639.897286314],[4848994e-11,2.43037610229,419.4846438752],[4056892e-11,2.92133209468,110.2063212194],[3768635e-11,3.6496533078,3.9321532631]],[[.0011644133,1.17988132879,7.1135470008],[.00091841837,.0732519584,213.299095438],[.00036661728,0,0],[.00015274496,4.06493179167,206.1855484372]]],[[[.04330678039,3.60284428399,213.299095438],[.00240348302,2.85238489373,426.598190876],[.00084745939,0,0],[.00030863357,3.48441504555,220.4126424388],[.00034116062,.57297307557,206.1855484372],[.0001473407,2.11846596715,639.897286314],[9916667e-11,5.79003188904,419.4846438752],[6993564e-11,4.7360468972,7.1135470008],[4807588e-11,5.43305312061,316.3918696566]],[[.00198927992,4.93901017903,213.299095438],[.00036947916,3.14159265359,0],[.00017966989,.5197943111,426.598190876]]],[[[9.55758135486,0,0],[.52921382865,2.39226219573,213.299095438],[.01873679867,5.2354960466,206.1855484372],[.01464663929,1.64763042902,426.598190876],[.00821891141,5.93520042303,316.3918696566],[.00547506923,5.0153261898,103.0927742186],[.0037168465,2.27114821115,220.4126424388],[.00361778765,3.13904301847,7.1135470008],[.00140617506,5.70406606781,632.7837393132],[.00108974848,3.29313390175,110.2063212194],[.00069006962,5.94099540992,419.4846438752],[.00061053367,.94037691801,639.897286314],[.00048913294,1.55733638681,202.2533951741],[.00034143772,.19519102597,277.0349937414],[.00032401773,5.47084567016,949.1756089698],[.00020936596,.46349251129,735.8765135318],[9796004e-11,5.20477537945,1265.5674786264],[.00011993338,5.98050967385,846.0828347512],[208393e-9,1.52102476129,433.7117378768],[.00015298404,3.0594381494,529.6909650946],[6465823e-11,.17732249942,1052.2683831884],[.00011380257,1.7310542704,522.5774180938],[3419618e-11,4.94550542171,1581.959348283]],[[.0618298134,.2584351148,213.299095438],[.00506577242,.71114625261,206.1855484372],[.00341394029,5.79635741658,426.598190876],[.00188491195,.47215589652,220.4126424388],[.00186261486,3.14159265359,0],[.00143891146,1.40744822888,7.1135470008]],[[.00436902572,4.78671677509,213.299095438]]]],Uranus:[[[[5.48129294297,0,0],[.09260408234,.89106421507,74.7815985673],[.01504247898,3.6271926092,1.4844727083],[.00365981674,1.89962179044,73.297125859],[.00272328168,3.35823706307,149.5631971346],[.00070328461,5.39254450063,63.7358983034],[.00068892678,6.09292483287,76.2660712756],[.00061998615,2.26952066061,2.9689454166],[.00061950719,2.85098872691,11.0457002639],[.0002646877,3.14152083966,71.8126531507],[.00025710476,6.11379840493,454.9093665273],[.0002107885,4.36059339067,148.0787244263],[.00017818647,1.74436930289,36.6485629295],[.00014613507,4.73732166022,3.9321532631],[.00011162509,5.8268179635,224.3447957019],[.0001099791,.48865004018,138.5174968707],[9527478e-11,2.95516862826,35.1640902212],[7545601e-11,5.236265824,109.9456887885],[4220241e-11,3.23328220918,70.8494453042],[40519e-9,2.277550173,151.0476698429],[3354596e-11,1.0654900738,4.4534181249],[2926718e-11,4.62903718891,9.5612275556],[349034e-10,5.48306144511,146.594251718],[3144069e-11,4.75199570434,77.7505439839],[2922333e-11,5.35235361027,85.8272988312],[2272788e-11,4.36600400036,70.3281804424],[2051219e-11,1.51773566586,.1118745846],[2148602e-11,.60745949945,38.1330356378],[1991643e-11,4.92437588682,277.0349937414],[1376226e-11,2.04283539351,65.2203710117],[1666902e-11,3.62744066769,380.12776796],[1284107e-11,3.11347961505,202.2533951741],[1150429e-11,.93343589092,3.1813937377],[1533221e-11,2.58594681212,52.6901980395],[1281604e-11,.54271272721,222.8603229936],[1372139e-11,4.19641530878,111.4301614968],[1221029e-11,.1990065003,108.4612160802],[946181e-11,1.19253165736,127.4717966068],[1150989e-11,4.17898916639,33.6796175129]],[[74.7815986091,0,0],[.00154332863,5.24158770553,74.7815985673],[.00024456474,1.71260334156,1.4844727083],[9258442e-11,.4282973235,11.0457002639],[8265977e-11,1.50218091379,63.7358983034],[915016e-10,1.41213765216,149.5631971346]]],[[[.01346277648,2.61877810547,74.7815985673],[623414e-9,5.08111189648,149.5631971346],[.00061601196,3.14159265359,0],[9963722e-11,1.61603805646,76.2660712756],[992616e-10,.57630380333,73.297125859]],[[.00034101978,.01321929936,74.7815985673]]],[[[19.21264847206,0,0],[.88784984413,5.60377527014,74.7815985673],[.03440836062,.32836099706,73.297125859],[.0205565386,1.7829515933,149.5631971346],[.0064932241,4.52247285911,76.2660712756],[.00602247865,3.86003823674,63.7358983034],[.00496404167,1.40139935333,454.9093665273],[.00338525369,1.58002770318,138.5174968707],[.00243509114,1.57086606044,71.8126531507],[.00190522303,1.99809394714,1.4844727083],[.00161858838,2.79137786799,148.0787244263],[.00143706183,1.38368544947,11.0457002639],[.00093192405,.17437220467,36.6485629295],[.00071424548,4.24509236074,224.3447957019],[.00089806014,3.66105364565,109.9456887885],[.00039009723,1.66971401684,70.8494453042],[.00046677296,1.39976401694,35.1640902212],[.00039025624,3.36234773834,277.0349937414],[.00036755274,3.88649278513,146.594251718],[.00030348723,.70100838798,151.0476698429],[.00029156413,3.180563367,77.7505439839],[.00022637073,.72518687029,529.6909650946],[.00011959076,1.7504339214,984.6003316219],[.00025620756,5.25656086672,380.12776796]],[[.01479896629,3.67205697578,74.7815985673]]]],Neptune:[[[[5.31188633046,0,0],[.0179847553,2.9010127389,38.1330356378],[.01019727652,.48580922867,1.4844727083],[.00124531845,4.83008090676,36.6485629295],[.00042064466,5.41054993053,2.9689454166],[.00037714584,6.09221808686,35.1640902212],[.00033784738,1.24488874087,76.2660712756],[.00016482741,7727998e-11,491.5579294568],[9198584e-11,4.93747051954,39.6175083461],[899425e-10,.27462171806,175.1660598002]],[[38.13303563957,0,0],[.00016604172,4.86323329249,1.4844727083],[.00015744045,2.27887427527,38.1330356378]]],[[[.03088622933,1.44104372644,38.1330356378],[.00027780087,5.91271884599,76.2660712756],[.00027623609,0,0],[.00015355489,2.52123799551,36.6485629295],[.00015448133,3.50877079215,39.6175083461]]],[[[30.07013205828,0,0],[.27062259632,1.32999459377,38.1330356378],[.01691764014,3.25186135653,36.6485629295],[.00807830553,5.18592878704,1.4844727083],[.0053776051,4.52113935896,35.1640902212],[.00495725141,1.5710564165,491.5579294568],[.00274571975,1.84552258866,175.1660598002],[.0001201232,1.92059384991,1021.2488945514],[.00121801746,5.79754470298,76.2660712756],[.00100896068,.3770272493,73.297125859],[.00135134092,3.37220609835,39.6175083461],[7571796e-11,1.07149207335,388.4651552382]]]]};function Gj(i){var e,t,n,r,s,o,u;const f=2e3+(i-14)/Bj;return f<-500?(e=(f-1820)/100,-20+32*e*e):f<500?(e=f/100,t=e*e,n=e*t,r=t*t,s=t*n,o=n*n,10583.6-1014.41*e+33.78311*t-5.952053*n-.1798452*r+.022174192*s+.0090316521*o):f<1600?(e=(f-1e3)/100,t=e*e,n=e*t,r=t*t,s=t*n,o=n*n,1574.2-556.01*e+71.23472*t+.319781*n-.8503463*r-.005050998*s+.0083572073*o):f<1700?(e=f-1600,t=e*e,n=e*t,120-.9808*e-.01532*t+n/7129):f<1800?(e=f-1700,t=e*e,n=e*t,r=t*t,8.83+.1603*e-.0059285*t+13336e-8*n-r/1174e3):f<1860?(e=f-1800,t=e*e,n=e*t,r=t*t,s=t*n,o=n*n,u=n*r,13.72-.332447*e+.0068612*t+.0041116*n-37436e-8*r+121272e-10*s-1699e-10*o+875e-12*u):f<1900?(e=f-1860,t=e*e,n=e*t,r=t*t,s=t*n,7.62+.5737*e-.251754*t+.01680668*n-.0004473624*r+s/233174):f<1920?(e=f-1900,t=e*e,n=e*t,r=t*t,-2.79+1.494119*e-.0598939*t+.0061966*n-197e-6*r):f<1941?(e=f-1920,t=e*e,n=e*t,21.2+.84493*e-.0761*t+.0020936*n):f<1961?(e=f-1950,t=e*e,n=e*t,29.07+.407*e-t/233+n/2547):f<1986?(e=f-1975,t=e*e,n=e*t,45.45+1.067*e-t/260-n/718):f<2005?(e=f-2e3,t=e*e,n=e*t,r=t*t,s=t*n,63.86+.3345*e-.060374*t+.0017275*n+651814e-9*r+2373599e-11*s):f<2050?(e=f-2e3,62.92+.32217*e+.005589*e*e):f<2150?(e=(f-1820)/100,-20+32*e*e-.5628*(2150-f)):(e=(f-1820)/100,-20+32*e*e)}let kj=Gj;function kR(i){return i+kj(i)/86400}class gd{constructor(e){if(e instanceof gd){this.date=e.date,this.ut=e.ut,this.tt=e.tt;return}const t=1e3*3600*24;if(e instanceof Date&&Number.isFinite(e.getTime())){this.date=e,this.ut=(e.getTime()-GR.getTime())/t,this.tt=kR(this.ut);return}if(Number.isFinite(e)){this.date=new Date(GR.getTime()+e*t),this.ut=e,this.tt=kR(this.ut);return}throw"Argument must be a Date object, an AstroTime object, or a numeric UTC Julian date."}static FromTerrestrialTime(e){let t=new gd(e);for(;;){const n=e-t.tt;if(Math.abs(n)<1e-12)return t;t=t.AddDays(n)}}toString(){return this.date.toISOString()}AddDays(e){return new gd(this.ut+e)}}function fh(i){return i instanceof gd?i:new gd(i)}function Vj(i){function e(y){return y%Oj*im}const t=i.tt/36525,n=e(128710479305e-5+t*1295965810481e-4),r=e(335779.526232+t*17395272628478e-4),s=e(107226070369e-5+t*1602961601209e-3),o=e(450160.398036-t*69628905431e-4);let u=Math.sin(o),f=Math.cos(o),p=(-172064161-174666*t)*u+33386*f,g=(92052331+9086*t)*f+15377*u,v=2*(r-s+o);return u=Math.sin(v),f=Math.cos(v),p+=(-13170906-1675*t)*u-13696*f,g+=(5730336-3015*t)*f-4587*u,v=2*(r+o),u=Math.sin(v),f=Math.cos(v),p+=(-2276413-234*t)*u+2796*f,g+=(978459-485*t)*f+1374*u,v=2*o,u=Math.sin(v),f=Math.cos(v),p+=(2074554+207*t)*u-698*f,g+=(-897492+470*t)*f-291*u,u=Math.sin(n),f=Math.cos(n),p+=(1475877-3633*t)*u+11817*f,g+=(73871-184*t)*f-1924*u,{dpsi:-135e-6+p*1e-7,deps:388e-6+g*1e-7}}function BI(i){var e=i.tt/36525,t=((((-434e-10*e-576e-9)*e+.0020034)*e-1831e-7)*e-46.836769)*e+84381.406;return t/3600}var Gy;function NI(i){if(!Gy||Math.abs(Gy.tt-i.tt)>1e-6){const e=Vj(i),t=BI(i),n=t+e.deps/3600;Gy={tt:i.tt,dpsi:e.dpsi,deps:e.deps,ee:e.dpsi*Math.cos(t*oh)/15,mobl:t,tobl:n}}return Gy}function jj(i,e){const t=i*oh,n=Math.cos(t),r=Math.sin(t);return[e[0],e[1]*n-e[2]*r,e[1]*r+e[2]*n]}function Wj(i,e){return jj(BI(i),e)}function Xj(i){const e=i.tt/36525;function t(Ot,Mt){const je=[];let st;for(st=0;st<=Mt-Ot;++st)je.push(0);return{min:Ot,array:je}}function n(Ot,Mt,je,st){const et=[];for(let At=0;At<=Mt-Ot;++At)et.push(t(je,st));return{min:Ot,array:et}}function r(Ot,Mt,je){const st=Ot.array[Mt-Ot.min];return st.array[je-st.min]}function s(Ot,Mt,je,st){const et=Ot.array[Mt-Ot.min];et.array[je-et.min]=st}let o,u,f,p,g,v,y,A,S,T,M,E,R,I,O,F,z,j,W,L,H,K,de,ce=n(-6,6,1,4),ne=n(-6,6,1,4);function fe(Ot,Mt){return r(ce,Ot,Mt)}function X(Ot,Mt){return r(ne,Ot,Mt)}function re(Ot,Mt,je){return s(ce,Ot,Mt,je)}function ge(Ot,Mt,je){return s(ne,Ot,Mt,je)}function Te(Ot,Mt,je,st,et){et(Ot*je-Mt*st,Mt*je+Ot*st)}function Se(Ot){return Math.sin(Yc*Ot)}y=e*e,S=0,de=0,M=0,E=3422.7;var Y=Se(.19833+.05611*e),me=Se(.27869+.04508*e),Ce=Se(.16827-.36903*e),Ze=Se(.34734-5.37261*e),xt=Se(.10498-5.37899*e),ve=Se(.42681-.41855*e),ze=Se(.14943-5.37511*e);for(j=.84*Y+.31*me+14.27*Ce+7.26*Ze+.28*xt+.24*ve,W=2.94*Y+.31*me+14.27*Ce+9.34*Ze+1.12*xt+.83*ve,L=-6.4*Y-1.89*ve,H=.21*Y+.31*me+14.27*Ce-88.7*Ze-15.3*xt+.24*ve-1.86*ze,K=j-L,A=-3332e-9*Se(.59734-5.37261*e)-539e-9*Se(.35498-5.37899*e)-64e-9*Se(.39943-5.37511*e),R=Yc*Qp(.60643382+1336.85522467*e-313e-8*y)+j/ud,I=Yc*Qp(.37489701+1325.55240982*e+2565e-8*y)+W/ud,O=Yc*Qp(.99312619+99.99735956*e-44e-8*y)+L/ud,F=Yc*Qp(.25909118+1342.2278298*e-892e-8*y)+H/ud,z=Yc*Qp(.82736186+1236.85308708*e-397e-8*y)+K/ud,g=1;g<=4;++g){switch(g){case 1:f=I,u=4,p=1.000002208;break;case 2:f=O,u=3,p=.997504612-.002495388*e;break;case 3:f=F,u=4,p=1.000002708+139.978*A;break;case 4:f=z,u=6,p=1;break;default:throw`Internal error: I = ${g}`}for(re(0,g,1),re(1,g,Math.cos(f)*p),ge(0,g,0),ge(1,g,Math.sin(f)*p),v=2;v<=u;++v)Te(fe(v-1,g),X(v-1,g),fe(1,g),X(1,g),(Ot,Mt)=>(re(v,g,Ot),ge(v,g,Mt)));for(v=1;v<=u;++v)re(-v,g,fe(v,g)),ge(-v,g,-X(v,g))}function dt(Ot,Mt,je,st){for(var et={x:1,y:0},At=[0,Ot,Mt,je,st],oe=1;oe<=4;++oe)At[oe]!==0&&Te(et.x,et.y,fe(At[oe],oe),X(At[oe],oe),(Gt,Dt)=>(et.x=Gt,et.y=Dt));return et}function Ee(Ot,Mt,je,st,et,At,oe,Gt){var Dt=dt(et,At,oe,Gt);S+=Ot*Dt.y,de+=Mt*Dt.y,M+=je*Dt.x,E+=st*Dt.x}Ee(13.902,14.06,-.001,.2607,0,0,0,4),Ee(.403,-4.01,.394,.0023,0,0,0,3),Ee(2369.912,2373.36,.601,28.2333,0,0,0,2),Ee(-125.154,-112.79,-.725,-.9781,0,0,0,1),Ee(1.979,6.98,-.445,.0433,1,0,0,4),Ee(191.953,192.72,.029,3.0861,1,0,0,2),Ee(-8.466,-13.51,.455,-.1093,1,0,0,1),Ee(22639.5,22609.07,.079,186.5398,1,0,0,0),Ee(18.609,3.59,-.094,.0118,1,0,0,-1),Ee(-4586.465,-4578.13,-.077,34.3117,1,0,0,-2),Ee(3.215,5.44,.192,-.0386,1,0,0,-3),Ee(-38.428,-38.64,.001,.6008,1,0,0,-4),Ee(-.393,-1.43,-.092,.0086,1,0,0,-6),Ee(-.289,-1.59,.123,-.0053,0,1,0,4),Ee(-24.42,-25.1,.04,-.3,0,1,0,2),Ee(18.023,17.93,.007,.1494,0,1,0,1),Ee(-668.146,-126.98,-1.302,-.3997,0,1,0,0),Ee(.56,.32,-.001,-.0037,0,1,0,-1),Ee(-165.145,-165.06,.054,1.9178,0,1,0,-2),Ee(-1.877,-6.46,-.416,.0339,0,1,0,-4),Ee(.213,1.02,-.074,.0054,2,0,0,4),Ee(14.387,14.78,-.017,.2833,2,0,0,2),Ee(-.586,-1.2,.054,-.01,2,0,0,1),Ee(769.016,767.96,.107,10.1657,2,0,0,0),Ee(1.75,2.01,-.018,.0155,2,0,0,-1),Ee(-211.656,-152.53,5.679,-.3039,2,0,0,-2),Ee(1.225,.91,-.03,-.0088,2,0,0,-3),Ee(-30.773,-34.07,-.308,.3722,2,0,0,-4),Ee(-.57,-1.4,-.074,.0109,2,0,0,-6),Ee(-2.921,-11.75,.787,-.0484,1,1,0,2),Ee(1.267,1.52,-.022,.0164,1,1,0,1),Ee(-109.673,-115.18,.461,-.949,1,1,0,0),Ee(-205.962,-182.36,2.056,1.4437,1,1,0,-2),Ee(.233,.36,.012,-.0025,1,1,0,-3),Ee(-4.391,-9.66,-.471,.0673,1,1,0,-4),Ee(.283,1.53,-.111,.006,1,-1,0,4),Ee(14.577,31.7,-1.54,.2302,1,-1,0,2),Ee(147.687,138.76,.679,1.1528,1,-1,0,0),Ee(-1.089,.55,.021,0,1,-1,0,-1),Ee(28.475,23.59,-.443,-.2257,1,-1,0,-2),Ee(-.276,-.38,-.006,-.0036,1,-1,0,-3),Ee(.636,2.27,.146,-.0102,1,-1,0,-4),Ee(-.189,-1.68,.131,-.0028,0,2,0,2),Ee(-7.486,-.66,-.037,-.0086,0,2,0,0),Ee(-8.096,-16.35,-.74,.0918,0,2,0,-2),Ee(-5.741,-.04,0,-9e-4,0,0,2,2),Ee(.255,0,0,0,0,0,2,1),Ee(-411.608,-.2,0,-.0124,0,0,2,0),Ee(.584,.84,0,.0071,0,0,2,-1),Ee(-55.173,-52.14,0,-.1052,0,0,2,-2),Ee(.254,.25,0,-.0017,0,0,2,-3),Ee(.025,-1.67,0,.0031,0,0,2,-4),Ee(1.06,2.96,-.166,.0243,3,0,0,2),Ee(36.124,50.64,-1.3,.6215,3,0,0,0),Ee(-13.193,-16.4,.258,-.1187,3,0,0,-2),Ee(-1.187,-.74,.042,.0074,3,0,0,-4),Ee(-.293,-.31,-.002,.0046,3,0,0,-6),Ee(-.29,-1.45,.116,-.0051,2,1,0,2),Ee(-7.649,-10.56,.259,-.1038,2,1,0,0),Ee(-8.627,-7.59,.078,-.0192,2,1,0,-2),Ee(-2.74,-2.54,.022,.0324,2,1,0,-4),Ee(1.181,3.32,-.212,.0213,2,-1,0,2),Ee(9.703,11.67,-.151,.1268,2,-1,0,0),Ee(-.352,-.37,.001,-.0028,2,-1,0,-1),Ee(-2.494,-1.17,-.003,-.0017,2,-1,0,-2),Ee(.36,.2,-.012,-.0043,2,-1,0,-4),Ee(-1.167,-1.25,.008,-.0106,1,2,0,0),Ee(-7.412,-6.12,.117,.0484,1,2,0,-2),Ee(-.311,-.65,-.032,.0044,1,2,0,-4),Ee(.757,1.82,-.105,.0112,1,-2,0,2),Ee(2.58,2.32,.027,.0196,1,-2,0,0),Ee(2.533,2.4,-.014,-.0212,1,-2,0,-2),Ee(-.344,-.57,-.025,.0036,0,3,0,-2),Ee(-.992,-.02,0,0,1,0,2,2),Ee(-45.099,-.02,0,-.001,1,0,2,0),Ee(-.179,-9.52,0,-.0833,1,0,2,-2),Ee(-.301,-.33,0,.0014,1,0,2,-4),Ee(-6.382,-3.37,0,-.0481,1,0,-2,2),Ee(39.528,85.13,0,-.7136,1,0,-2,0),Ee(9.366,.71,0,-.0112,1,0,-2,-2),Ee(.202,.02,0,0,1,0,-2,-4),Ee(.415,.1,0,.0013,0,1,2,0),Ee(-2.152,-2.26,0,-.0066,0,1,2,-2),Ee(-1.44,-1.3,0,.0014,0,1,-2,2),Ee(.384,-.04,0,0,0,1,-2,-2),Ee(1.938,3.6,-.145,.0401,4,0,0,0),Ee(-.952,-1.58,.052,-.013,4,0,0,-2),Ee(-.551,-.94,.032,-.0097,3,1,0,0),Ee(-.482,-.57,.005,-.0045,3,1,0,-2),Ee(.681,.96,-.026,.0115,3,-1,0,0),Ee(-.297,-.27,.002,-9e-4,2,2,0,-2),Ee(.254,.21,-.003,0,2,-2,0,-2),Ee(-.25,-.22,.004,.0014,1,3,0,-2),Ee(-3.996,0,0,4e-4,2,0,2,0),Ee(.557,-.75,0,-.009,2,0,2,-2),Ee(-.459,-.38,0,-.0053,2,0,-2,2),Ee(-1.298,.74,0,4e-4,2,0,-2,0),Ee(.538,1.14,0,-.0141,2,0,-2,-2),Ee(.263,.02,0,0,1,1,2,0),Ee(.426,.07,0,-6e-4,1,1,-2,-2),Ee(-.304,.03,0,3e-4,1,-1,2,0),Ee(-.372,-.19,0,-.0027,1,-1,-2,2),Ee(.418,0,0,0,0,0,4,0),Ee(-.33,-.04,0,0,3,0,2,0);function yt(Ot,Mt,je,st,et){return Ot*dt(Mt,je,st,et).y}T=0,T+=yt(-526.069,0,0,1,-2),T+=yt(-3.352,0,0,1,-4),T+=yt(44.297,1,0,1,-2),T+=yt(-6,1,0,1,-4),T+=yt(20.599,-1,0,1,0),T+=yt(-30.598,-1,0,1,-2),T+=yt(-24.649,-2,0,1,0),T+=yt(-2,-2,0,1,-2),T+=yt(-22.571,0,1,1,-2),T+=yt(10.985,0,-1,1,-2),S+=.82*Se(.7736-62.5512*e)+.31*Se(.0466-125.1025*e)+.35*Se(.5785-25.1042*e)+.66*Se(.4591+1335.8075*e)+.64*Se(.313-91.568*e)+1.14*Se(.148+1331.2898*e)+.21*Se(.5918+1056.5859*e)+.44*Se(.5784+1322.8595*e)+.24*Se(.2275-5.7374*e)+.28*Se(.2965+2.6929*e)+.33*Se(.3132+6.3368*e),o=F+de/ud;let Pt=(1.000002708+139.978*A)*(18518.511+1.189+M)*Math.sin(o)-6.24*Math.sin(3*o)+T;return{geo_eclip_lon:Yc*Qp((R+S/ud)/Yc),geo_eclip_lat:Math.PI/(180*3600)*Pt,distance_au:ud*Pj/(.999953253*E)}}function Yj(i,e){return[i.rot[0][0]*e[0]+i.rot[1][0]*e[1]+i.rot[2][0]*e[2],i.rot[0][1]*e[0]+i.rot[1][1]*e[1]+i.rot[2][1]*e[2],i.rot[0][2]*e[0]+i.rot[1][2]*e[1]+i.rot[2][2]*e[2]]}function Qj(i,e,t){const n=OI(e,t);return Yj(n,i)}function OI(i,e){const t=i.tt/36525;let n=84381.406,r=((((-951e-10*t+132851e-9)*t-.00114045)*t-1.0790069)*t+5038.481507)*t,s=((((3337e-10*t-467e-9)*t-.00772503)*t+.0512623)*t-.025754)*t+n,o=((((-56e-9*t+170663e-9)*t-.00121197)*t-2.3814292)*t+10.556403)*t;n*=im,r*=im,s*=im,o*=im;const u=Math.sin(n),f=Math.cos(n),p=Math.sin(-r),g=Math.cos(-r),v=Math.sin(-s),y=Math.cos(-s),A=Math.sin(o),S=Math.cos(o),T=S*g-p*A*y,M=S*p*f+A*y*g*f-u*A*v,E=S*p*u+A*y*g*u+f*A*v,R=-A*g-p*S*y,I=-A*p*f+S*y*g*f-u*S*v,O=-A*p*u+S*y*g*u+f*S*v,F=p*v,z=-v*g*f-u*y,j=-v*g*u+y*f;if(e===ou.Into2000)return new Rm([[T,M,E],[R,I,O],[F,z,j]]);if(e===ou.From2000)return new Rm([[T,R,F],[M,I,z],[E,O,j]]);throw"Invalid precess direction"}function qj(i){const e=.779057273264+.00273781191135448*i.ut,t=i.ut%1;let n=360*((e+t)%1);return n<0&&(n+=360),n}let ky;function Jj(i){if(!ky||ky.tt!==i.tt){const e=i.tt/36525;let t=15*NI(i).ee;const n=qj(i);let r=((t+.014506+((((-368e-10*e-29956e-9)*e-44e-8)*e+1.3915817)*e+4612.156534)*e)/3600+n)%360/15;r<0&&(r+=24),ky={tt:i.tt,st:r}}return ky.st}function Kj(i){const e=fh(i);return Jj(e)}function Zj(i,e){const t=NI(i),n=t.mobl*oh,r=t.tobl*oh,s=t.dpsi*im,o=Math.cos(n),u=Math.sin(n),f=Math.cos(r),p=Math.sin(r),g=Math.cos(s),v=Math.sin(s),y=g,A=-v*o,S=-v*u,T=v*f,M=g*o*f+u*p,E=g*u*f-o*p,R=v*p,I=g*o*p-u*f,O=g*u*p+o*f;if(e===ou.From2000)return new Rm([[y,T,R],[A,M,I],[S,E,O]]);if(e===ou.Into2000)return new Rm([[y,A,S],[T,M,E],[R,I,O]]);throw"Invalid precess direction"}let hl=class{constructor(e,t,n,r){this.x=e,this.y=t,this.z=n,this.t=r}Length(){return Math.hypot(this.x,this.y,this.z)}};class $j{constructor(e,t,n,r,s,o,u){this.x=e,this.y=t,this.z=n,this.vx=r,this.vy=s,this.vz=o,this.t=u}}class eW{constructor(e,t,n){this.lat=Ky(e),this.lon=Ky(t),this.dist=Ky(n)}}class Rm{constructor(e){this.rot=e}}function xM(i){const e=fh(i),t=Xj(e),n=t.distance_au*Math.cos(t.geo_eclip_lat),r=[n*Math.cos(t.geo_eclip_lon),n*Math.sin(t.geo_eclip_lon),t.distance_au*Math.sin(t.geo_eclip_lat)],s=Wj(e,r),o=Qj(s,e,ou.Into2000);return new hl(o[0],o[1],o[2],e)}function dm(i,e,t){let n=1,r=0;for(let s of i){let o=0;for(let[f,p,g]of s)o+=f*Math.cos(p+e*g);let u=n*o;t&&(u%=Yc),r+=u,n*=e}return r}function EE(i,e){let t=1,n=0,r=0,s=0;for(let o of i){let u=0,f=0;for(let[p,g,v]of o){let y=g+e*v;u+=p*v*Math.sin(y),s>0&&(f+=p*Math.cos(y))}r+=s*n*f-t*u,n=t,t*=e,++s}return r}const Yg=365250,yM=0,AM=1,_M=2;function SM(i){return new ks(i[0]+44036e-11*i[1]-190919e-12*i[2],-479966e-12*i[0]+.917482137087*i[1]-.397776982902*i[2],.397776982902*i[1]+.917482137087*i[2])}function LI(i,e,t){const n=t*Math.cos(e),r=Math.cos(i),s=Math.sin(i);return[n*r,n*s,t*Math.sin(e)]}function Zy(i,e){const t=e.tt/Yg,n=dm(i[yM],t,!0),r=dm(i[AM],t,!1),s=dm(i[_M],t,!1),o=LI(n,r,s);return SM(o).ToAstroVector(e)}function tW(i,e){const t=e/Yg,n=dm(i[yM],t,!0),r=dm(i[AM],t,!1),s=dm(i[_M],t,!1),o=EE(i[yM],t),u=EE(i[AM],t),f=EE(i[_M],t),p=Math.cos(n),g=Math.sin(n),v=Math.cos(r),y=Math.sin(r),A=+(f*v*p)-s*y*p*u-s*v*g*o,S=+(f*v*g)-s*y*g*u+s*v*p*o,T=+(f*y)+s*v*u,M=LI(n,r,s),E=[A/Yg,S/Yg,T/Yg],R=SM(M),I=SM(E);return new lh(e,R,I)}function Vy(i,e,t,n){const r=n/(n+tw),s=Zy(rm[t],e);i.x+=r*s.x,i.y+=r*s.y,i.z+=r*s.z}function nW(i){const e=new hl(0,0,0,i);return Vy(e,i,Bi.Jupiter,pM),Vy(e,i,Bi.Saturn,mM),Vy(e,i,Bi.Uranus,gM),Vy(e,i,Bi.Neptune,vM),e}const bM=51,iW=29200,sm=146,Qc=201,Vf=[[-73e4,[-26.118207232108,-14.376168177825,3.384402515299],[.0016339372163656,-.0027861699588508,-.0013585880229445]],[-700800,[41.974905202127,-.448502952929,-12.770351505989],[.00073458569351457,.0022785014891658,.00048619778602049]],[-671600,[14.706930780744,44.269110540027,9.353698474772],[-.00210001479998,.00022295915939915,.00070143443551414]],[-642400,[-29.441003929957,-6.43016153057,6.858481011305],[.00084495803960544,-.0030783914758711,-.0012106305981192]],[-613200,[39.444396946234,-6.557989760571,-13.913760296463],[.0011480029005873,.0022400006880665,.00035168075922288]],[-584e3,[20.2303809507,43.266966657189,7.382966091923],[-.0019754081700585,.00053457141292226,.00075929169129793]],[-554800,[-30.65832536462,2.093818874552,9.880531138071],[61010603013347e-18,-.0031326500935382,-.00099346125151067]],[-525600,[35.737703251673,-12.587706024764,-14.677847247563],[.0015802939375649,.0021347678412429,.00019074436384343]],[-496400,[25.466295188546,41.367478338417,5.216476873382],[-.0018054401046468,.0008328308359951,.00080260156912107]],[-467200,[-29.847174904071,10.636426313081,12.297904180106],[-.00063257063052907,-.0029969577578221,-.00074476074151596]],[-438e3,[30.774692107687,-18.236637015304,-14.945535879896],[.0020113162005465,.0019353827024189,-20937793168297e-19]],[-408800,[30.243153324028,38.656267888503,2.938501750218],[-.0016052508674468,.0011183495337525,.00083333973416824]],[-379600,[-27.288984772533,18.643162147874,14.023633623329],[-.0011856388898191,-.0027170609282181,-.00049015526126399]],[-350400,[24.519605196774,-23.245756064727,-14.626862367368],[.0024322321483154,.0016062008146048,-.00023369181613312]],[-321200,[34.505274805875,35.125338586954,.557361475637],[-.0013824391637782,.0013833397561817,.00084823598806262]],[-292e3,[-23.275363915119,25.818514298769,15.055381588598],[-.0016062295460975,-.0023395961498533,-.00024377362639479]],[-262800,[17.050384798092,-27.180376290126,-13.608963321694],[.0028175521080578,.0011358749093955,-.00049548725258825]],[-233600,[38.093671910285,30.880588383337,-1.843688067413],[-.0011317697153459,.0016128814698472,.00084177586176055]],[-204400,[-18.197852930878,31.932869934309,15.438294826279],[-.0019117272501813,-.0019146495909842,-19657304369835e-18]],[-175200,[8.528924039997,-29.618422200048,-11.805400994258],[.0031034370787005,.0005139363329243,-.00077293066202546]],[-146e3,[40.94685725864,25.904973592021,-4.256336240499],[-.00083652705194051,.0018129497136404,.0008156422827306]],[-116800,[-12.326958895325,36.881883446292,15.217158258711],[-.0021166103705038,-.001481442003599,.00017401209844705]],[-87600,[-.633258375909,-30.018759794709,-9.17193287495],[.0032016994581737,-.00025279858672148,-.0010411088271861]],[-58400,[42.936048423883,20.344685584452,-6.588027007912],[-.00050525450073192,.0019910074335507,.00077440196540269]],[-29200,[-5.975910552974,40.61180995846,14.470131723673],[-.0022184202156107,-.0010562361130164,.00033652250216211]],[0,[-9.875369580774,-27.978926224737,-5.753711824704],[.0030287533248818,-.0011276087003636,-.0012651326732361]],[29200,[43.958831986165,14.214147973292,-8.808306227163],[-.00014717608981871,.0021404187242141,.00071486567806614]],[58400,[.67813676352,43.094461639362,13.243238780721],[-.0022358226110718,-.00063233636090933,.00047664798895648]],[87600,[-18.282602096834,-23.30503958666,-1.766620508028],[.0025567245263557,-.0019902940754171,-.0013943491701082]],[116800,[43.873338744526,7.700705617215,-10.814273666425],[.00023174803055677,.0022402163127924,.00062988756452032]],[146e3,[7.392949027906,44.382678951534,11.629500214854],[-.002193281545383,-.00021751799585364,.00059556516201114]],[175200,[-24.981690229261,-16.204012851426,2.466457544298],[.001819398914958,-.0026765419531201,-.0013848283502247]],[204400,[42.530187039511,.845935508021,-12.554907527683],[.00065059779150669,.0022725657282262,.00051133743202822]],[233600,[13.999526486822,44.462363044894,9.669418486465],[-.0021079296569252,.00017533423831993,.00069128485798076]],[262800,[-29.184024803031,-7.371243995762,6.493275957928],[.00093581363109681,-.0030610357109184,-.0012364201089345]],[292e3,[39.831980671753,-6.078405766765,-13.909815358656],[.0011117769689167,.0022362097830152,.00036230548231153]],[321200,[20.294955108476,43.417190420251,7.450091985932],[-.0019742157451535,.00053102050468554,.00075938408813008]],[350400,[-30.66999230216,2.318743558955,9.973480913858],[45605107450676e-18,-.0031308219926928,-.00099066533301924]],[379600,[35.626122155983,-12.897647509224,-14.777586508444],[.0016015684949743,.0021171931182284,.00018002516202204]],[408800,[26.133186148561,41.232139187599,5.00640132622],[-.0017857704419579,.00086046232702817,.00080614690298954]],[438e3,[-29.57674022923,11.863535943587,12.631323039872],[-.00072292830060955,-.0029587820140709,-.000708242964503]],[467200,[29.910805787391,-19.159019294,-15.013363865194],[.0020871080437997,.0018848372554514,-38528655083926e-18]],[496400,[31.375957451819,38.050372720763,2.433138343754],[-.0015546055556611,.0011699815465629,.00083565439266001]],[525600,[-26.360071336928,20.662505904952,14.414696258958],[-.0013142373118349,-.0026236647854842,-.00042542017598193]],[554800,[22.599441488648,-24.508879898306,-14.484045731468],[.0025454108304806,.0014917058755191,-.00030243665086079]],[584e3,[35.877864013014,33.894226366071,-.224524636277],[-.0012941245730845,.0014560427668319,.00084762160640137]],[613200,[-21.538149762417,28.204068269761,15.321973799534],[-.001731211740901,-.0021939631314577,-.0001631691327518]],[642400,[13.971521374415,-28.339941764789,-13.083792871886],[.0029334630526035,.00091860931752944,-.00059939422488627]],[671600,[39.526942044143,28.93989736011,-2.872799527539],[-.0010068481658095,.001702113288809,.00083578230511981]],[700800,[-15.576200701394,34.399412961275,15.466033737854],[-.0020098814612884,-.0017191109825989,70414782780416e-18]],[73e4,[4.24325283709,-30.118201690825,-10.707441231349],[.0031725847067411,.0001609846120227,-.00090672150593868]]];class ks{constructor(e,t,n){this.x=e,this.y=t,this.z=n}clone(){return new ks(this.x,this.y,this.z)}ToAstroVector(e){return new hl(this.x,this.y,this.z,e)}static zero(){return new ks(0,0,0)}quadrature(){return this.x*this.x+this.y*this.y+this.z*this.z}add(e){return new ks(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return new ks(this.x-e.x,this.y-e.y,this.z-e.z)}incr(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}decr(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}mul(e){return new ks(e*this.x,e*this.y,e*this.z)}div(e){return new ks(this.x/e,this.y/e,this.z/e)}mean(e){return new ks((this.x+e.x)/2,(this.y+e.y)/2,(this.z+e.z)/2)}neg(){return new ks(-this.x,-this.y,-this.z)}}class lh{constructor(e,t,n){this.tt=e,this.r=t,this.v=n}clone(){return new lh(this.tt,this.r,this.v)}sub(e){return new lh(this.tt,this.r.sub(e.r),this.v.sub(e.v))}}function rW(i){let[e,[t,n,r],[s,o,u]]=i;return new lh(e,new ks(t,n,r),new ks(s,o,u))}function jy(i,e,t,n){const r=n/(n+tw),s=tW(rm[t],e);return i.r.incr(s.r.mul(r)),i.v.incr(s.v.mul(r)),s}function Ug(i,e,t){const n=t.sub(i),r=n.quadrature();return n.mul(e/(r*Math.sqrt(r)))}class nw{constructor(e){let t=new lh(e,new ks(0,0,0),new ks(0,0,0));this.Jupiter=jy(t,e,Bi.Jupiter,pM),this.Saturn=jy(t,e,Bi.Saturn,mM),this.Uranus=jy(t,e,Bi.Uranus,gM),this.Neptune=jy(t,e,Bi.Neptune,vM),this.Jupiter.r.decr(t.r),this.Jupiter.v.decr(t.v),this.Saturn.r.decr(t.r),this.Saturn.v.decr(t.v),this.Uranus.r.decr(t.r),this.Uranus.v.decr(t.v),this.Neptune.r.decr(t.r),this.Neptune.v.decr(t.v),this.Sun=new lh(e,t.r.mul(-1),t.v.mul(-1))}Acceleration(e){let t=Ug(e,tw,this.Sun.r);return t.incr(Ug(e,pM,this.Jupiter.r)),t.incr(Ug(e,mM,this.Saturn.r)),t.incr(Ug(e,gM,this.Uranus.r)),t.incr(Ug(e,vM,this.Neptune.r)),t}}class cS{constructor(e,t,n,r){this.tt=e,this.r=t,this.v=n,this.a=r}clone(){return new cS(this.tt,this.r.clone(),this.v.clone(),this.a.clone())}}class PI{constructor(e,t){this.bary=e,this.grav=t}}function o_(i,e,t,n){return new ks(e.x+i*(t.x+i*n.x/2),e.y+i*(t.y+i*n.y/2),e.z+i*(t.z+i*n.z/2))}function VR(i,e,t){return new ks(e.x+i*t.x,e.y+i*t.y,e.z+i*t.z)}function EM(i,e){const t=i-e.tt,n=new nw(i),r=o_(t,e.r,e.v,e.a),s=n.Acceleration(r).mean(e.a),o=o_(t,e.r,e.v,s),u=e.v.add(s.mul(t)),f=n.Acceleration(o),p=new cS(i,o,u,f);return new PI(n,p)}const sW=[];function UI(i,e){const t=Math.floor(i);return t<0?0:t>=e?e-1:t}function MM(i){const e=rW(i),t=new nw(e.tt),n=e.r.add(t.Sun.r),r=e.v.add(t.Sun.v),s=t.Acceleration(n),o=new cS(e.tt,n,r,s);return new PI(t,o)}function aW(i,e){const t=Vf[0][0];if(e<t||e>Vf[bM-1][0])return null;const n=UI((e-t)/iW,bM-1);if(!i[n]){const s=i[n]=[];s[0]=MM(Vf[n]).grav,s[Qc-1]=MM(Vf[n+1]).grav;let o,u=s[0].tt;for(o=1;o<Qc-1;++o)s[o]=EM(u+=sm,s[o-1]).grav;u=s[Qc-1].tt;var r=[];for(r[Qc-1]=s[Qc-1],o=Qc-2;o>0;--o)r[o]=EM(u-=sm,r[o+1]).grav;for(o=Qc-2;o>0;--o){const f=o/(Qc-1);s[o].r=s[o].r.mul(1-f).add(r[o].r.mul(f)),s[o].v=s[o].v.mul(1-f).add(r[o].v.mul(f)),s[o].a=s[o].a.mul(1-f).add(r[o].a.mul(f))}}return i[n]}function jR(i,e,t){let n=MM(i);const r=Math.ceil((e-n.grav.tt)/t);for(let s=0;s<r;++s)n=EM(s+1===r?e:n.grav.tt+t,n.grav);return n}function oW(i,e){let t,n,r;const s=aW(sW,i.tt);if(s){const o=UI((i.tt-s[0].tt)/sm,Qc-1),u=s[o],f=s[o+1],p=u.a.mean(f.a),g=o_(i.tt-u.tt,u.r,u.v,p),v=VR(i.tt-u.tt,u.v,p),y=o_(i.tt-f.tt,f.r,f.v,p),A=VR(i.tt-f.tt,f.v,p),S=(i.tt-u.tt)/sm;t=g.mul(1-S).add(y.mul(S)),n=v.mul(1-S).add(A.mul(S))}else{let o;i.tt<Vf[0][0]?o=jR(Vf[0],i.tt,-sm):o=jR(Vf[bM-1],i.tt,+sm),t=o.grav.r,n=o.grav.v,r=o.bary}return r||(r=new nw(i.tt)),t=t.sub(r.Sun.r),n=n.sub(r.Sun.v),new $j(t.x,t.y,t.z,n.x,n.y,n.z,i)}function lv(i,e){var t=fh(e);if(i in rm)return Zy(rm[i],t);if(i===Bi.Pluto){const o=oW(t);return new hl(o.x,o.y,o.z,t)}if(i===Bi.Sun)return new hl(0,0,0,t);if(i===Bi.Moon){var n=Zy(rm.Earth,t),r=xM(t);return new hl(n.x+r.x,n.y+r.y,n.z+r.z,t)}if(i===Bi.EMB){const o=Zy(rm.Earth,t),u=xM(t),f=1+Uj;return new hl(o.x+u.x/f,o.y+u.y/f,o.z+u.z/f,t)}if(i===Bi.SSB)return nW(t);const s=II(i);if(s){const o=new eW(s.dec,15*s.ra,s.dist);return pW(o,t)}throw`HelioVector: Unknown body "${i}"`}function lW(i,e){let t=e,n=0;for(let r=0;r<10;++r){const s=i(t),o=s.Length()/Dj;if(o>1)throw"Object is too distant for light-travel solver.";const u=e.AddDays(-o);if(n=Math.abs(u.tt-t.tt),n<1e-9)return s;t=u}throw`Light-travel time solver did not converge: dt = ${n}`}class cW{constructor(e,t,n,r){this.observerBody=e,this.targetBody=t,this.aberration=n,this.observerPos=r}Position(e){this.aberration&&(this.observerPos=lv(this.observerBody,e));const t=lv(this.targetBody,e);return new hl(t.x-this.observerPos.x,t.y-this.observerPos.y,t.z-this.observerPos.z,e)}}function uW(i,e,t,n){const r=fh(i);if(II(t)){const u=lv(t,r),f=lv(e,r);return new hl(u.x-f.x,u.y-f.y,u.z-f.z,r)}let s;s=lv(e,r);const o=new cW(e,t,n,s);return lW(u=>o.Position(u),r)}function dW(i,e,t){const n=fh(e);switch(i){case Bi.Earth:return new hl(0,0,0,n);case Bi.Moon:return xM(n);default:const r=uW(n,Bi.Earth,i,t);return r.t=n,r}}var WR;(function(i){i[i.Pericenter=0]="Pericenter",i[i.Apocenter=1]="Apocenter"})(WR||(WR={}));function fW(i,e){return new Rm([[e.rot[0][0]*i.rot[0][0]+e.rot[1][0]*i.rot[0][1]+e.rot[2][0]*i.rot[0][2],e.rot[0][1]*i.rot[0][0]+e.rot[1][1]*i.rot[0][1]+e.rot[2][1]*i.rot[0][2],e.rot[0][2]*i.rot[0][0]+e.rot[1][2]*i.rot[0][1]+e.rot[2][2]*i.rot[0][2]],[e.rot[0][0]*i.rot[1][0]+e.rot[1][0]*i.rot[1][1]+e.rot[2][0]*i.rot[1][2],e.rot[0][1]*i.rot[1][0]+e.rot[1][1]*i.rot[1][1]+e.rot[2][1]*i.rot[1][2],e.rot[0][2]*i.rot[1][0]+e.rot[1][2]*i.rot[1][1]+e.rot[2][2]*i.rot[1][2]],[e.rot[0][0]*i.rot[2][0]+e.rot[1][0]*i.rot[2][1]+e.rot[2][0]*i.rot[2][2],e.rot[0][1]*i.rot[2][0]+e.rot[1][1]*i.rot[2][1]+e.rot[2][1]*i.rot[2][2],e.rot[0][2]*i.rot[2][0]+e.rot[1][2]*i.rot[2][1]+e.rot[2][2]*i.rot[2][2]]])}function hW(i,e,t){const n=Ky(t)*oh,r=Math.cos(n),s=Math.sin(n),o=(e+1)%3,u=(e+2)%3,f=e;let p=[[0,0,0],[0,0,0],[0,0,0]];return p[o][o]=r*i.rot[o][o]-s*i.rot[o][u],p[o][u]=s*i.rot[o][o]+r*i.rot[o][u],p[o][f]=i.rot[o][f],p[u][o]=r*i.rot[u][o]-s*i.rot[u][u],p[u][u]=s*i.rot[u][o]+r*i.rot[u][u],p[u][f]=i.rot[u][f],p[f][o]=r*i.rot[f][o]-s*i.rot[f][u],p[f][u]=s*i.rot[f][o]+r*i.rot[f][u],p[f][f]=i.rot[f][f],new Rm(p)}function pW(i,e){e=fh(e);const t=i.lat*oh,n=i.lon*oh,r=i.dist*Math.cos(t);return new hl(r*Math.cos(n),r*Math.sin(n),i.dist*Math.sin(t),e)}function mW(i){i=fh(i);const e=OI(i,ou.From2000),t=Zj(i,ou.From2000);return fW(e,t)}var XR;(function(i){i.Penumbral="penumbral",i.Partial="partial",i.Annular="annular",i.Total="total"})(XR||(XR={}));var YR;(function(i){i[i.Invalid=0]="Invalid",i[i.Ascending=1]="Ascending",i[i.Descending=-1]="Descending"})(YR||(YR={}));function iw(i){return i instanceof gd?i:new gd(i instanceof Date?i:new Date(i))}function gW(i,e=new Q){const{x:t,y:n,z:r}=i;return e.set(t,n,r)}function vW(i,e=new jt){const[t,n,r]=i.rot;return e.set(t[0],n[0],r[0],0,t[1],n[1],r[1],0,t[2],n[2],r[2],0,0,0,0,1)}function xW(i,e=new jt){const t=iw(i),n=hW(mW(t),2,-15*Kj(t));return vW(n,e)}function FI(i,e,t,n,r){const s=dW(i,e,!1);return gW(s,t),n!=null,t.normalize()}function yW(i,e=new Q,t){return FI(Bi.Sun,iw(i),e,t)}function AW(i,e=new Q,t){return FI(Bi.Moon,iw(i),e,t)}const _W=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"
#include "bruneton/common"
#include "bruneton/precompute"

uniform AtmosphereParameters ATMOSPHERE;

uniform sampler2D transmittanceTexture;

layout(location = 0) out vec4 outputColor;

void main() {
  vec3 deltaIrradiance;
  vec3 irradiance;
  deltaIrradiance = ComputeDirectIrradianceTexture(
    ATMOSPHERE,
    transmittanceTexture,
    gl_FragCoord.xy
  );
  irradiance = vec3(0.0);
  outputColor = vec4(OUTPUT, 1.0);
}
`,SW=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"
#include "bruneton/common"
#include "bruneton/precompute"

uniform AtmosphereParameters ATMOSPHERE;

uniform mat3 luminanceFromRadiance;
uniform sampler3D singleRayleighScatteringTexture;
uniform sampler3D singleMieScatteringTexture;
uniform sampler3D multipleScatteringTexture;
uniform int scatteringOrder;

layout(location = 0) out vec4 outputColor;

void main() {
  vec3 deltaIrradiance;
  vec3 irradiance;
  deltaIrradiance = ComputeIndirectIrradianceTexture(
    ATMOSPHERE,
    singleRayleighScatteringTexture,
    singleMieScatteringTexture,
    multipleScatteringTexture,
    gl_FragCoord.xy,
    scatteringOrder
  );
  irradiance = luminanceFromRadiance * deltaIrradiance;
  outputColor = vec4(OUTPUT, 1.0);
}
`,bW=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"
#include "bruneton/common"
#include "bruneton/precompute"

uniform AtmosphereParameters ATMOSPHERE;

uniform mat3 luminanceFromRadiance;
uniform sampler2D transmittanceTexture;
uniform sampler3D scatteringDensityTexture;
uniform int layer;

layout(location = 0) out vec4 outputColor;

void main() {
  vec4 deltaMultipleScattering;
  vec4 scattering;
  float nu;
  deltaMultipleScattering.rgb = ComputeMultipleScatteringTexture(
    ATMOSPHERE,
    transmittanceTexture,
    scatteringDensityTexture,
    vec3(gl_FragCoord.xy, float(layer) + 0.5),
    nu
  );
  deltaMultipleScattering.a = 1.0;
  scattering = vec4(
    luminanceFromRadiance * deltaMultipleScattering.rgb / RayleighPhaseFunction(nu),
    0.0
  );
  outputColor = OUTPUT;
}
`,EW=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"
#include "bruneton/common"
#include "bruneton/precompute"

uniform AtmosphereParameters ATMOSPHERE;

uniform sampler2D transmittanceTexture;
uniform sampler3D singleRayleighScatteringTexture;
uniform sampler3D singleMieScatteringTexture;
uniform sampler3D multipleScatteringTexture;
uniform sampler2D irradianceTexture;
uniform int scatteringOrder;
uniform int layer;

layout(location = 0) out vec4 scatteringDensity;

void main() {
  scatteringDensity.rgb = ComputeScatteringDensityTexture(
    ATMOSPHERE,
    transmittanceTexture,
    singleRayleighScatteringTexture,
    singleMieScatteringTexture,
    multipleScatteringTexture,
    irradianceTexture,
    vec3(gl_FragCoord.xy, float(layer) + 0.5),
    scatteringOrder
  );
  scatteringDensity.a = 1.0;
}
`,MW=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"
#include "bruneton/common"
#include "bruneton/precompute"

uniform AtmosphereParameters ATMOSPHERE;

uniform mat3 luminanceFromRadiance;
uniform sampler2D transmittanceTexture;
uniform int layer;

layout(location = 0) out vec4 outputColor;

void main() {
  vec4 deltaRayleigh;
  vec4 deltaMie;
  vec4 scattering;
  vec4 singleMieScattering;
  ComputeSingleScatteringTexture(
    ATMOSPHERE,
    transmittanceTexture,
    vec3(gl_FragCoord.xy, float(layer) + 0.5),
    deltaRayleigh.rgb,
    deltaMie.rgb
  );
  deltaRayleigh.a = 1.0;
  deltaMie.a = 1.0;
  scattering = vec4(
    luminanceFromRadiance * deltaRayleigh.rgb,
    (luminanceFromRadiance * deltaMie.rgb).r
  );
  singleMieScattering.rgb = luminanceFromRadiance * deltaMie.rgb;
  singleMieScattering.a = 1.0;
  outputColor = OUTPUT;
}
`,TW=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"
#include "bruneton/common"
#include "bruneton/precompute"

uniform AtmosphereParameters ATMOSPHERE;

layout(location = 0) out vec4 transmittance;

void main() {
  transmittance.rgb = ComputeTransmittanceToTopAtmosphereBoundaryTexture(
    ATMOSPHERE,
    gl_FragCoord.xy
  );
  transmittance.a = 1.0;
}
`,wW=`
  precision highp float;
  in vec2 position;
  void main() {
    gl_Position = vec4(position, 1.0, 1.0);
  }
`;function l_(i,e,t){const n=new ti(e,t,{depthBuffer:!1,type:i,format:Ai}),r=n.texture;return r.minFilter=on,r.magFilter=on,r.wrapS=Ni,r.wrapT=Ni,r.colorSpace=Ja,n}function fm(i,e,t,n){const r=new X2(e,t,n,{depthBuffer:!1,type:i,format:Ai}),s=r.texture;return s.minFilter=on,s.magFilter=on,s.wrapS=Ni,s.wrapT=Ni,s.wrapR=Ni,s.colorSpace=Ja,r}function CW(i){const e=i[Symbol.iterator]();return new Promise((t,n)=>{const r=()=>{try{const{value:s,done:o}=e.next();o===!0?t(s):HR(r)}catch(s){n(s instanceof Error?s:new Error)}};HR(r)})}async function QR(i,e,t){const{width:n,height:r}=e,s=t.type===On?new Uint16Array(n*r*4):new Float32Array(n*r*4);await i.readRenderTargetPixelsAsync(e,0,0,e.width,e.height,s),t.userData.imageData=s}class RW{constructor(e){this.lambdas=new Q,this.luminanceFromRadiance=new An,e===On&&(this.opticalDepth=l_(e,km,Vm)),this.deltaIrradiance=l_(e,Hm,Gm),this.deltaRayleighScattering=fm(e,Yf,Qf,qf),this.deltaMieScattering=fm(e,Yf,Qf,qf),this.deltaScatteringDensity=fm(e,Yf,Qf,qf),this.deltaMultipleScattering=this.deltaRayleighScattering}dispose(){var e;(e=this.opticalDepth)==null||e.dispose(),this.deltaIrradiance.dispose(),this.deltaRayleighScattering.dispose(),this.deltaMieScattering.dispose(),this.deltaScatteringDensity.dispose()}}class qp extends Gv{constructor(e){super({glslVersion:vm,vertexShader:wW,...e,defines:{TRANSMITTANCE_TEXTURE_WIDTH:km.toFixed(0),TRANSMITTANCE_TEXTURE_HEIGHT:Vm.toFixed(0),SCATTERING_TEXTURE_R_SIZE:rS.toFixed(0),SCATTERING_TEXTURE_MU_SIZE:sS.toFixed(0),SCATTERING_TEXTURE_MU_S_SIZE:aS.toFixed(0),SCATTERING_TEXTURE_NU_SIZE:oS.toFixed(0),IRRADIANCE_TEXTURE_WIDTH:Hm.toFixed(0),IRRADIANCE_TEXTURE_HEIGHT:Gm.toFixed(0),...e.defines}})}set additive(e){this.transparent=e,this.blending=e?CM:Pi,this.blendEquation=$l,this.blendEquationAlpha=$l,this.blendSrc=$p,this.blendDst=$p,this.blendSrcAlpha=$p,this.blendDstAlpha=$p}setUniforms(e){const t=this.uniforms;t.luminanceFromRadiance!=null&&t.luminanceFromRadiance.value.copy(e.luminanceFromRadiance),t.singleRayleighScatteringTexture!=null&&(t.singleRayleighScatteringTexture.value=e.deltaRayleighScattering.texture),t.singleMieScatteringTexture!=null&&(t.singleMieScatteringTexture.value=e.deltaMieScattering.texture),t.multipleScatteringTexture!=null&&(t.multipleScatteringTexture.value=e.deltaMultipleScattering.texture),t.scatteringDensityTexture!=null&&(t.scatteringDensityTexture.value=e.deltaScatteringDensity.texture),t.irradianceTexture!=null&&(t.irradianceTexture.value=e.deltaIrradiance.texture)}}class DW{constructor(e,{type:t=$D(e)?si:On,combinedScattering:n=!0,higherOrderScattering:r=!0}={}){var s,o;this.transmittanceMaterial=new qp({fragmentShader:Io(TW,{bruneton:{common:Zc,definitions:$c,precompute:Xp}})}),this.directIrradianceMaterial=new qp({fragmentShader:Io(_W,{bruneton:{common:Zc,definitions:$c,precompute:Xp}}),uniforms:{transmittanceTexture:new Ne(null)}}),this.singleScatteringMaterial=new qp({fragmentShader:Io(MW,{bruneton:{common:Zc,definitions:$c,precompute:Xp}}),uniforms:{luminanceFromRadiance:new Ne(new An),transmittanceTexture:new Ne(null),layer:new Ne(0)}}),this.scatteringDensityMaterial=new qp({fragmentShader:Io(EW,{bruneton:{common:Zc,definitions:$c,precompute:Xp}}),uniforms:{transmittanceTexture:new Ne(null),singleRayleighScatteringTexture:new Ne(null),singleMieScatteringTexture:new Ne(null),multipleScatteringTexture:new Ne(null),irradianceTexture:new Ne(null),scatteringOrder:new Ne(0),layer:new Ne(0)}}),this.indirectIrradianceMaterial=new qp({fragmentShader:Io(SW,{bruneton:{common:Zc,definitions:$c,precompute:Xp}}),uniforms:{luminanceFromRadiance:new Ne(new An),singleRayleighScatteringTexture:new Ne(null),singleMieScatteringTexture:new Ne(null),multipleScatteringTexture:new Ne(null),scatteringOrder:new Ne(0)}}),this.multipleScatteringMaterial=new qp({fragmentShader:Io(bW,{bruneton:{common:Zc,definitions:$c,precompute:Xp}}),uniforms:{luminanceFromRadiance:new Ne(new An),transmittanceTexture:new Ne(null),scatteringDensityTexture:new Ne(null),layer:new Ne(0)}}),this.mesh=new Oi(new lc(2,2)),this.scene=new Ad().add(this.mesh),this.camera=new Bm,this.updating=!1,this.renderer=e,this.type=t,this.transmittanceRenderTarget=l_(t,km,Vm),this.scatteringRenderTarget=fm(t,Yf,Qf,qf),this.irradianceRenderTarget=l_(t,Hm,Gm),n||(this.singleMieScatteringRenderTarget=fm(t,Yf,Qf,qf)),r&&(this.higherOrderScatteringRenderTarget=fm(t,Yf,Qf,qf)),this.textures={transmittanceTexture:this.transmittanceRenderTarget.texture,scatteringTexture:this.scatteringRenderTarget.texture,irradianceTexture:this.irradianceRenderTarget.texture,singleMieScatteringTexture:(s=this.singleMieScatteringRenderTarget)==null?void 0:s.texture,higherOrderScatteringTexture:(o=this.higherOrderScatteringRenderTarget)==null?void 0:o.texture}}render3DRenderTarget(e,t){for(let n=0;n<e.depth;++n)t.uniforms.layer.value=n,this.renderer.setRenderTarget(e,n),this.renderer.render(this.scene,this.camera)}computeTransmittance(e){const t=this.transmittanceMaterial;delete t.defines.TRANSMITTANCE_PRECISION_LOG,t.needsUpdate=!0,this.mesh.material=t,this.renderer.setRenderTarget(e.renderTarget),this.renderer.render(this.scene,this.camera)}computeOpticalDepth(e){const t=this.transmittanceMaterial;t.defines.TRANSMITTANCE_PRECISION_LOG="1",t.needsUpdate=!0,this.mesh.material=t,this.renderer.setRenderTarget(e.renderTarget),this.renderer.render(this.scene,this.camera)}computeDirectIrradiance(e){var r;const t=this.directIrradianceMaterial;t.defines.OUTPUT=e.output,t.additive=e.additive,this.type===On?t.defines.TRANSMITTANCE_PRECISION_LOG="1":delete t.defines.TRANSMITTANCE_PRECISION_LOG,t.needsUpdate=!0;const n=t.uniforms;n.transmittanceTexture.value=((r=e.context.opticalDepth)==null?void 0:r.texture)??this.transmittanceRenderTarget.texture,this.mesh.material=t,this.renderer.setRenderTarget(e.renderTarget),this.renderer.render(this.scene,this.camera)}computeSingleScattering(e){var r;const t=this.singleScatteringMaterial;t.defines.OUTPUT=e.output,t.additive=e.additive,this.type===On?t.defines.TRANSMITTANCE_PRECISION_LOG="1":delete t.defines.TRANSMITTANCE_PRECISION_LOG,t.needsUpdate=!0;const n=t.uniforms;n.transmittanceTexture.value=((r=e.context.opticalDepth)==null?void 0:r.texture)??this.transmittanceRenderTarget.texture,t.setUniforms(e.context),this.mesh.material=t,this.render3DRenderTarget(e.renderTarget,t)}computeScatteringDensity(e){var r;const t=this.scatteringDensityMaterial;this.type===On?t.defines.TRANSMITTANCE_PRECISION_LOG="1":delete t.defines.TRANSMITTANCE_PRECISION_LOG,t.needsUpdate=!0;const n=t.uniforms;n.transmittanceTexture.value=((r=e.context.opticalDepth)==null?void 0:r.texture)??this.transmittanceRenderTarget.texture,n.scatteringOrder.value=e.scatteringOrder,t.setUniforms(e.context),this.mesh.material=t,this.render3DRenderTarget(e.renderTarget,t)}computeIndirectIrradiance(e){const t=this.indirectIrradianceMaterial;t.defines.OUTPUT=e.output,t.additive=e.additive,t.needsUpdate=!0;const n=t.uniforms;n.scatteringOrder.value=e.scatteringOrder-1,t.setUniforms(e.context),this.mesh.material=t,this.renderer.setRenderTarget(e.renderTarget),this.renderer.render(this.scene,this.camera)}computeMultipleScattering(e){var r;const t=this.multipleScatteringMaterial;t.defines.OUTPUT=e.output,t.additive=e.additive,this.type===On?t.defines.TRANSMITTANCE_PRECISION_LOG="1":delete t.defines.TRANSMITTANCE_PRECISION_LOG,t.needsUpdate=!0;const n=t.uniforms;n.transmittanceTexture.value=((r=e.context.opticalDepth)==null?void 0:r.texture)??this.transmittanceRenderTarget.texture,t.setUniforms(e.context),this.mesh.material=t,this.render3DRenderTarget(e.renderTarget,t)}*precompute(e,t){this.computeTransmittance({renderTarget:this.transmittanceRenderTarget}),this.type===On&&(vj(e.opticalDepth!=null),this.computeOpticalDepth({renderTarget:e.opticalDepth})),this.computeDirectIrradiance({renderTarget:e.deltaIrradiance,context:e,output:"deltaIrradiance",additive:!1}),this.computeDirectIrradiance({renderTarget:this.irradianceRenderTarget,context:e,output:"irradiance",additive:t}),this.renderer.setRenderTarget(null),yield,this.computeSingleScattering({renderTarget:e.deltaRayleighScattering,context:e,output:"deltaRayleigh",additive:!1}),this.computeSingleScattering({renderTarget:e.deltaMieScattering,context:e,output:"deltaMie",additive:!1}),this.computeSingleScattering({renderTarget:this.scatteringRenderTarget,context:e,output:"scattering",additive:t}),this.singleMieScatteringRenderTarget!=null&&this.computeSingleScattering({renderTarget:this.singleMieScatteringRenderTarget,context:e,output:"singleMieScattering",additive:t}),this.renderer.setRenderTarget(null),yield;for(let n=2;n<=4;++n)this.computeScatteringDensity({renderTarget:e.deltaScatteringDensity,context:e,scatteringOrder:n}),this.computeIndirectIrradiance({renderTarget:e.deltaIrradiance,context:e,scatteringOrder:n,output:"deltaIrradiance",additive:!1}),this.computeIndirectIrradiance({renderTarget:this.irradianceRenderTarget,context:e,scatteringOrder:n,output:"irradiance",additive:!0}),this.computeMultipleScattering({renderTarget:e.deltaMultipleScattering,context:e,output:"deltaMultipleScattering",additive:!1}),this.computeMultipleScattering({renderTarget:this.scatteringRenderTarget,context:e,output:"scattering",additive:!0}),this.higherOrderScatteringRenderTarget!=null&&this.computeMultipleScattering({renderTarget:this.higherOrderScatteringRenderTarget,context:e,output:"scattering",additive:!0}),this.renderer.setRenderTarget(null),yield}async update(e=$T.DEFAULT){var o;this.updating=!0;const t=e.toUniform();this.transmittanceMaterial.uniforms.ATMOSPHERE=t,this.directIrradianceMaterial.uniforms.ATMOSPHERE=t,this.singleScatteringMaterial.uniforms.ATMOSPHERE=t,this.scatteringDensityMaterial.uniforms.ATMOSPHERE=t,this.indirectIrradianceMaterial.uniforms.ATMOSPHERE=t,this.multipleScatteringMaterial.uniforms.ATMOSPHERE=t;const n=this.renderer,r=new RW(this.type);r.lambdas.set(680,550,440),r.luminanceFromRadiance.identity();const s=n.autoClear;return n.autoClear=!1,await CW(this.precompute(r,!1)),n.autoClear=s,r.dispose(),await QR(this.renderer,this.transmittanceRenderTarget,this.transmittanceRenderTarget.texture),await QR(this.renderer,this.irradianceRenderTarget,this.irradianceRenderTarget.texture),this.updating=!1,(o=this.disposeQueue)==null||o.call(this),this.textures}dispose(e={}){var n,r,s,o;if(this.updating){this.disposeQueue=()=>{this.dispose(e),this.disposeQueue=void 0};return}const{textures:t=!0}=e;t||(this.transmittanceRenderTarget.textures.splice(0,1),this.scatteringRenderTarget.textures.splice(0,1),this.irradianceRenderTarget.textures.splice(0,1),(n=this.singleMieScatteringRenderTarget)==null||n.textures.splice(0,1),(r=this.higherOrderScatteringRenderTarget)==null||r.textures.splice(0,1)),this.transmittanceRenderTarget.dispose(),this.scatteringRenderTarget.dispose(),this.irradianceRenderTarget.dispose(),(s=this.singleMieScatteringRenderTarget)==null||s.dispose(),(o=this.higherOrderScatteringRenderTarget)==null||o.dispose(),this.transmittanceMaterial.dispose(),this.directIrradianceMaterial.dispose(),this.singleScatteringMaterial.dispose(),this.scatteringDensityMaterial.dispose(),this.indirectIrradianceMaterial.dispose(),this.multipleScatteringMaterial.dispose(),this.mesh.geometry.dispose()}}function IW(i){var e=[];if(i.length===0)return"";if(typeof i[0]!="string")throw new TypeError("Url must be a string. Received "+i[0]);if(i[0].match(/^[^/:]+:\/*$/)&&i.length>1){var t=i.shift();i[0]=t+i[0]}i[0].match(/^file:\/\/\//)?i[0]=i[0].replace(/^([^/:]+):\/*/,"$1:///"):i[0]=i[0].replace(/^([^/:]+):\/*/,"$1://");for(var n=0;n<i.length;n++){var r=i[n];if(typeof r!="string")throw new TypeError("Url must be a string. Received "+r);r!==""&&(n>0&&(r=r.replace(/^[\/]+/,"")),n<i.length-1?r=r.replace(/[\/]+$/,""):r=r.replace(/[\/]+$/,"/"),e.push(r))}var s=e.join("/");s=s.replace(/\/(\?|&|#[^!])/g,"$1");var o=s.split("?");return s=o.shift()+(o.length>0?"?":"")+o.join("&"),s}function BW(){var i;return typeof arguments[0]=="object"?i=arguments[0]:i=[].slice.call(arguments),IW(i)}const qR={width:km,height:Vm},Jp={width:Yf,height:Qf,depth:qf},JR={width:Hm,height:Gm};class zI extends gr{constructor({format:e="exr",type:t=On,combinedScattering:n=!0,higherOrderScattering:r=!0}={},s){super(s),this.format=e,this.type=t,this.combinedScattering=n,this.higherOrderScattering=r}setType(e){return this.type=$D(e)?si:On,this}setTypeFromRenderer(e){return this.setType(e)}load(e,t,n,r){const s={},o=({key:u,loader:f,path:p})=>(f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(this.withCredentials),f.load(BW(e,p),g=>{var v;g.type=this.type,this.type===si&&(g.image,g.image.data!=null&&(g.image.data=new Float32Array(new cu((v=g.image.data)==null?void 0:v.buffer)))),g.minFilter=on,g.magFilter=on,s[`${u}Texture`]=g,s.irradianceTexture!=null&&s.scatteringTexture!=null&&s.transmittanceTexture!=null&&(this.combinedScattering||s.singleMieScatteringTexture!=null)&&(!this.higherOrderScattering||s.higherOrderScatteringTexture!=null)&&(t==null||t(s))},n,r));return this.format==="exr"?{transmittanceTexture:o({key:"transmittance",loader:new FR(qR,this.manager),path:"transmittance.exr"}),scatteringTexture:o({key:"scattering",loader:new _E(Jp,this.manager),path:"scattering.exr"}),irradianceTexture:o({key:"irradiance",loader:new FR(JR,this.manager),path:"irradiance.exr"}),singleMieScatteringTexture:this.combinedScattering?void 0:o({key:"singleMieScattering",loader:new _E(Jp,this.manager),path:"single_mie_scattering.exr"}),higherOrderScatteringTexture:this.higherOrderScattering?o({key:"higherOrderScattering",loader:new _E(Jp,this.manager),path:"higher_order_scattering.exr"}):void 0}:{transmittanceTexture:o({key:"transmittance",loader:new Zp(oa,Pg,qR,this.manager),path:"transmittance.bin"}),scatteringTexture:o({key:"scattering",loader:new Zp(su,Pg,Jp,this.manager),path:"scattering.bin"}),irradianceTexture:o({key:"irradiance",loader:new Zp(oa,Pg,JR,this.manager),path:"irradiance.bin"}),singleMieScatteringTexture:this.combinedScattering?void 0:o({key:"singleMieScattering",loader:new Zp(su,Pg,Jp,this.manager),path:"single_mie_scattering.bin"}),higherOrderScatteringTexture:this.higherOrderScattering?o({key:"higherOrderScattering",loader:new Zp(su,Pg,Jp,this.manager),path:"higher_order_scattering.bin"}):void 0}}}const NW=`precision highp float;
precision highp sampler3D;

#define RECIPROCAL_PI 0.3183098861837907

#include "core/raySphereIntersection"

#include "bruneton/definitions"

uniform AtmosphereParameters ATMOSPHERE;
uniform vec3 SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
uniform vec3 SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;

uniform sampler2D transmittance_texture;
uniform sampler3D scattering_texture;
uniform sampler2D irradiance_texture;
uniform sampler3D single_mie_scattering_texture;
uniform sampler3D higher_order_scattering_texture;

#include "bruneton/common"
#include "bruneton/runtime"

#include "sky"

uniform vec3 sunDirection;
uniform vec3 moonDirection;
uniform float moonAngularRadius;
uniform float lunarRadianceScale;
uniform vec3 groundAlbedo;

#ifdef HAS_SHADOW_LENGTH
uniform sampler2D shadowLengthBuffer;
#endif // HAS_SHADOW_LENGTH

in vec2 vUv;
in vec3 vCameraPosition;
in vec3 vRayDirection;

layout(location = 0) out vec4 outputColor;

#include <mrt_layout>

void main() {
  float shadowLength = 0.0;
  #ifdef HAS_SHADOW_LENGTH
  shadowLength = texture(shadowLengthBuffer, vUv).r;
  #endif // HAS_SHADOW_LENGTH

  vec3 cameraPosition = vCameraPosition;
  vec3 rayDirection = normalize(vRayDirection);

  #ifdef GROUND_ALBEDO

  float r = length(cameraPosition);
  float mu = dot(cameraPosition, rayDirection) / r;
  bool intersectsGround = RayIntersectsGround(ATMOSPHERE, r, mu);
  if (intersectsGround) {
    float distanceToGround = raySphereFirstIntersection(
      cameraPosition,
      rayDirection,
      ATMOSPHERE.bottom_radius
    );
    vec3 groundPosition = rayDirection * distanceToGround + cameraPosition;
    vec3 surfaceNormal = normalize(groundPosition);
    vec3 skyIrradiance;
    vec3 sunIrradiance = GetSunAndSkyIrradiance(
      cameraPosition,
      surfaceNormal,
      sunDirection,
      skyIrradiance
    );
    vec3 transmittance;
    vec3 inscatter = GetSkyRadianceToPoint(
      cameraPosition,
      ATMOSPHERE.bottom_radius * surfaceNormal,
      shadowLength,
      sunDirection,
      transmittance
    );
    vec3 radiance = groundAlbedo * RECIPROCAL_PI * (sunIrradiance + skyIrradiance);
    outputColor.rgb = radiance * transmittance + inscatter;
  } else {
    outputColor.rgb = getSkyRadiance(
      cameraPosition,
      rayDirection,
      shadowLength,
      sunDirection,
      moonDirection,
      moonAngularRadius,
      lunarRadianceScale
    );
  }

  #else // GROUND_ALBEDO

  outputColor.rgb = getSkyRadiance(
    cameraPosition,
    rayDirection,
    shadowLength,
    sunDirection,
    moonDirection,
    moonAngularRadius,
    lunarRadianceScale
  );

  #endif // GROUND_ALBEDO

  outputColor.a = 1.0;

  #include <mrt_output>
}
`,OW=`precision highp float;
precision highp sampler3D;

uniform mat4 inverseProjectionMatrix;
uniform mat4 inverseViewMatrix;
uniform vec3 cameraPosition;
uniform mat4 worldToECEFMatrix;
uniform vec3 altitudeCorrection;

layout(location = 0) in vec3 position;

out vec2 vUv;
out vec3 vCameraPosition;
out vec3 vRayDirection;

void getCameraRay(out vec3 origin, out vec3 direction) {
  bool isPerspective = inverseProjectionMatrix[2][3] != 0.0; // 4th entry in the 3rd column

  if (isPerspective) {
    // Calculate the camera ray for a perspective camera.
    vec4 viewPosition = inverseProjectionMatrix * vec4(position, 1.0);
    vec4 worldDirection = inverseViewMatrix * vec4(viewPosition.xyz, 0.0);
    origin = cameraPosition;
    direction = worldDirection.xyz;
  } else {
    // Unprojected points to calculate direction.
    vec4 nearPoint = inverseProjectionMatrix * vec4(position.xy, -1.0, 1.0);
    vec4 farPoint = inverseProjectionMatrix * vec4(position.xy, -0.9, 1.0);
    nearPoint /= nearPoint.w;
    farPoint /= farPoint.w;

    // Calculate world values
    vec4 worldDirection = inverseViewMatrix * vec4(farPoint.xyz - nearPoint.xyz, 0.0);
    vec4 worldOrigin = inverseViewMatrix * nearPoint;

    // Outputs
    direction = worldDirection.xyz;
    origin = worldOrigin.xyz;
  }
}

void main() {
  vUv = position.xy * 0.5 + 0.5;

  vec3 direction, origin;
  getCameraRay(origin, direction);

  vec3 cameraPositionECEF = (worldToECEFMatrix * vec4(origin, 1.0)).xyz;
  vCameraPosition = (cameraPositionECEF + altitudeCorrection) * METER_TO_LENGTH_UNIT;
  vRayDirection = (worldToECEFMatrix * vec4(direction, 0.0)).xyz;

  gl_Position = vec4(position.xy, 1.0, 1.0);
}
`;var LW=Object.defineProperty,rw=(i,e,t,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(e,t,r)||r);return r&&LW(e,t,r),r};const HI={...ew,sun:!0,moon:!0,moonAngularRadius:.0045,lunarRadianceScale:1,ground:!0,groundAlbedo:new Ft(0)};class uS extends lS{constructor(e){const{sun:t,moon:n,moonDirection:r,moonAngularRadius:s,lunarRadianceScale:o,ground:u,groundAlbedo:f,...p}={...HI,...e};super({name:"SkyMaterial",glslVersion:vm,vertexShader:OW,fragmentShader:Io(NW,{core:{raySphereIntersection:EI},bruneton:{common:Zc,definitions:$c,runtime:ZT},sky:CI}),...p,uniforms:{inverseProjectionMatrix:new Ne(new jt),inverseViewMatrix:new Ne(new jt),moonDirection:new Ne((r==null?void 0:r.clone())??new Q),moonAngularRadius:new Ne(s),lunarRadianceScale:new Ne(o),groundAlbedo:new Ne(f.clone()),shadowLengthBuffer:new Ne(null),...p.uniforms},defines:{PERSPECTIVE_CAMERA:"1"},depthTest:!0}),this.shadowLength=null,this.sun=t,this.moon=n,this.ground=u}onBeforeRender(e,t,n,r,s,o){super.onBeforeRender(e,t,n,r,s,o);const{uniforms:u,defines:f}=this;u.inverseProjectionMatrix.value.copy(n.projectionMatrixInverse),u.inverseViewMatrix.value.copy(n.matrixWorld);const p=f.PERSPECTIVE_CAMERA!=null,g=n.isPerspectiveCamera===!0;g!==p&&(g?f.PERSPECTIVE_CAMERA="1":delete f.PERSPECTIVE_CAMERA,this.needsUpdate=!0);const v=this.groundAlbedo,y=f.GROUND_ALBEDO!=null,A=v.r!==0||v.g!==0||v.b!==0;A!==y&&(A?this.defines.GROUND_ALBEDO="1":delete this.defines.GROUND_ALBEDO,this.needsUpdate=!0);const S=this.shadowLength,T=f.HAS_SHADOW_LENGTH!=null,M=S!=null;M!==T&&(M?f.HAS_SHADOW_LENGTH="1":(delete f.HAS_SHADOW_LENGTH,u.shadowLengthBuffer.value=null),this.needsUpdate=!0),M&&(u.shadowLengthBuffer.value=S.map)}get moonDirection(){return this.uniforms.moonDirection.value}get moonAngularRadius(){return this.uniforms.moonAngularRadius.value}set moonAngularRadius(e){this.uniforms.moonAngularRadius.value=e}get lunarRadianceScale(){return this.uniforms.lunarRadianceScale.value}set lunarRadianceScale(e){this.uniforms.lunarRadianceScale.value=e}get groundAlbedo(){return this.uniforms.groundAlbedo.value}}rw([or("SUN")],uS.prototype,"sun");rw([or("MOON")],uS.prototype,"moon");rw([or("GROUND")],uS.prototype,"ground");class PW extends pn{constructor(e){super();const t=new Int16Array(e),n=new Uint8Array(e),r=new $f(t,5),s=new $f(n,10);this.setAttribute("position",new pl(r,3,0,!0)),this.setAttribute("magnitude",new pl(s,1,6,!0)),this.setAttribute("color",new pl(s,3,7,!0)),this.boundingSphere=new Wr(new Q,1)}}const UW=`precision highp float;
precision highp sampler3D;

#include "bruneton/definitions"

uniform AtmosphereParameters ATMOSPHERE;
uniform vec3 SUN_SPECTRAL_RADIANCE_TO_LUMINANCE;
uniform vec3 SKY_SPECTRAL_RADIANCE_TO_LUMINANCE;

uniform sampler2D transmittance_texture;
uniform sampler3D scattering_texture;
uniform sampler2D irradiance_texture;
uniform sampler3D single_mie_scattering_texture;
uniform sampler3D higher_order_scattering_texture;

#include "bruneton/common"
#include "bruneton/runtime"

uniform vec3 sunDirection;

in vec3 vCameraPosition;
in vec3 vRayDirection;

layout(location = 0) out vec4 outputColor;

#include <mrt_layout>

in vec3 vColor;

void main() {
  #if !defined(PERSPECTIVE_CAMERA)
  outputColor = vec4(0.0);
  discard; // Rendering celestial objects without perspective doesn't make sense.
  #endif // !defined(PERSPECTIVE_CAMERA)

  #ifdef BACKGROUND
  vec3 rayDirection = normalize(vRayDirection);
  float r = length(vCameraPosition);
  float mu = dot(vCameraPosition, rayDirection) / r;

  if (RayIntersectsGround(ATMOSPHERE, r, mu)) {
    discard;
  }

  vec3 transmittance;
  vec3 radiance = GetSkyRadiance(
    vCameraPosition,
    normalize(vRayDirection),
    0.0, // Shadow length
    sunDirection,
    transmittance
  );
  radiance += transmittance * vColor;
  outputColor = vec4(radiance, 1.0);
  #else // BACKGROUND
  outputColor = vec4(vColor, 1.0);
  #endif // BACKGROUND

  #include <mrt_output>
}
`,FW=`precision highp float;
precision highp sampler3D;

#define saturate(x) clamp(x, 0.0, 1.0)

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform mat4 viewMatrix;
uniform mat4 matrixWorld;
uniform vec3 cameraPosition;
uniform float cameraFar;
uniform mat4 worldToECEFMatrix;
uniform vec3 altitudeCorrection;
uniform float pointSize;
uniform vec2 magnitudeRange;
uniform float intensity;

layout(location = 0) in vec3 position;
layout(location = 1) in float magnitude;
layout(location = 2) in vec3 color;

out vec3 vCameraPosition;
out vec3 vRayDirection;
out vec3 vEllipsoidCenter;
out vec3 vColor;

void main() {
  // Magnitude is stored between 0 to 1 within the given range.
  float m = mix(magnitudeRange.x, magnitudeRange.y, magnitude);
  vec3 v = pow(vec3(10.0), -vec3(magnitudeRange, m) / 2.5);
  vColor = vec3(intensity * color);
  vColor *= saturate((v.z - v.y) / (v.x - v.y));

  #ifdef BACKGROUND
  vec3 worldDirection = normalize(matrixWorld * vec4(position, 1.0)).xyz;
  vec3 cameraPositionECEF = (worldToECEFMatrix * vec4(cameraPosition, 1.0)).xyz;
  vCameraPosition = (cameraPositionECEF + altitudeCorrection) * METER_TO_LENGTH_UNIT;
  vRayDirection = (worldToECEFMatrix * vec4(worldDirection, 0.0)).xyz;
  gl_Position =
    projectionMatrix * viewMatrix * vec4(cameraPosition + worldDirection * cameraFar, 1.0);
  #else // BACKGROUND
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #endif // BACKGROUND

  gl_PointSize = pointSize;
}
`;var zW=Object.defineProperty,GI=(i,e,t,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(e,t,r)||r);return r&&zW(e,t,r),r};const kI={...ew,pointSize:1,intensity:1,background:!0,ground:!0};class sw extends lS{constructor(e){const{pointSize:t,radianceScale:n,intensity:r,background:s,ground:o,...u}={...kI,...e};super({name:"StarsMaterial",glslVersion:vm,vertexShader:FW,fragmentShader:Io(UW,{bruneton:{common:Zc,definitions:$c,runtime:ZT}}),...u,uniforms:{projectionMatrix:new Ne(new jt),modelViewMatrix:new Ne(new jt),viewMatrix:new Ne(new jt),matrixWorld:new Ne(new jt),cameraFar:new Ne(0),pointSize:new Ne(0),magnitudeRange:new Ne(new qe(-2,8)),intensity:new Ne(n??r),...u.uniforms},defines:{PERSPECTIVE_CAMERA:"1"}}),this.pointSize=t,this.background=s,this.ground=o}onBeforeRender(e,t,n,r,s,o){super.onBeforeRender(e,t,n,r,s,o);const u=this.uniforms;u.projectionMatrix.value.copy(n.projectionMatrix),u.modelViewMatrix.value.copy(n.modelViewMatrix),u.viewMatrix.value.copy(n.matrixWorldInverse),u.matrixWorld.value.copy(s.matrixWorld),u.cameraFar.value=n.far,u.pointSize.value=this.pointSize*e.getPixelRatio();const f=n.isPerspectiveCamera===!0;this.defines.PERSPECTIVE_CAMERA!=null!==f&&(f?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}get magnitudeRange(){return this.uniforms.magnitudeRange.value}get radianceScale(){return this.intensity}set radianceScale(e){this.intensity=e}get intensity(){return this.uniforms.intensity.value}set intensity(e){this.uniforms.intensity.value=e}}GI([or("BACKGROUND")],sw.prototype,"background");GI([or("GROUND")],sw.prototype,"ground");const dS=le.createContext({}),HW=({ref:i,textures:e,ellipsoid:t=ac.WGS84,correctAltitude:n=!0,ground:r=!0,date:s,children:o})=>{const u=le.useRef({sunDirection:new Q,moonDirection:new Q,worldToECEFMatrix:new jt,inertialToECEFMatrix:new jt,overlay:null,shadow:null,shadowLength:null,lightingMask:null}),f=Nn(({gl:T})=>T),p=le.useMemo(()=>typeof e=="string"?new zI().setType(f).load(e):void 0,[e,f]);le.useEffect(()=>{if(p!=null)return()=>{for(const T of Object.values(p))T==null||T.dispose()}},[p]);const g=le.useMemo(()=>e==null?new DW(f):void 0,[e,f]);le.useEffect(()=>{if(g!=null)return g.update().catch(T=>{console.error(T)}),()=>{g.dispose()}},[g]);const v=(g==null?void 0:g.textures)??(typeof e=="string"?p:e),y=le.useMemo(()=>({textures:v,ellipsoid:t,correctAltitude:n,ground:r,transientStates:u.current}),[v,t,n,r]),A=le.useMemo(()=>{const{sunDirection:T,moonDirection:M,inertialToECEFMatrix:E}=u.current;return R=>{xW(R,E),yW(R,T).applyMatrix4(E),AW(R,M).applyMatrix4(E)}},[]),S=s!=null&&!isNaN(+s)?+s:void 0;return le.useEffect(()=>{S!=null&&A(S)},[S,A]),le.useImperativeHandle(i,()=>({...u.current,textures:v,updateByDate:A}),[v,A]),D.jsx(dS.Provider,{value:y,children:o})};function aw(i){const{irradianceTexture:e,scatteringTexture:t,transmittanceTexture:n,singleMieScatteringTexture:r,higherOrderScatteringTexture:s,ellipsoid:o,correctAltitude:u,sunDirection:f,sunAngularRadius:p,ground:g,renderTargetCount:v,...y}=i;return[{irradianceTexture:e,scatteringTexture:t,transmittanceTexture:n,singleMieScatteringTexture:r,higherOrderScatteringTexture:s,ellipsoid:o,correctAltitude:u,sunDirection:f,sunAngularRadius:p,ground:g,renderTargetCount:v},y]}function GW(i){const e=le.useMemo(()=>typeof i=="string"?new kV().load(i):void 0,[i]);return le.useEffect(()=>{if(e!=null)return()=>{e.dispose()}},[e]),(typeof i=="string"?e:i)??null}const kW=({ref:i,stbnTexture:e=Ik,...t})=>{const{textures:n,transientStates:r,...s}=le.useContext(dS),[o,{blendFunction:u,...f}]=aw({...RI,...s,...n,...t}),p=le.useContext(GT),{normalPass:g,camera:v}=p,y="geometryPass"in p&&p.geometryPass instanceof HT&&"geometryTexture"in p.geometryPass&&p.geometryPass.geometryTexture instanceof Jn?p.geometryPass.geometryTexture:void 0,A=le.useMemo(()=>new js(void 0,{blendFunction:u}),[u]);le.useEffect(()=>()=>{A.dispose()},[A]);const[S,T]=le.useState(!1);da(()=>{r!=null&&(A.sunDirection.copy(r.sunDirection),A.moonDirection.copy(r.moonDirection),A.worldToECEFMatrix.copy(r.worldToECEFMatrix),A.overlay=r.overlay,A.shadow=r.shadow,A.shadowLength=r.shadowLength,A.lightingMask=r.lightingMask,!S&&A.shadow!=null&&T(!0))});const M=GW(S?e:void 0);return D.jsx("primitive",{ref:i,object:A,mainCamera:v,normalBuffer:y??(g==null?void 0:g.texture)??null,...o,...f,stbnTexture:M,octEncodedNormal:y!=null})};function VW(i){return e=>{for(const t of i)TM(t,e)}}function jW(i){return e=>{const t=[];for(const n of i){const r=TM(n,e),s=typeof r=="function";t.push(s?r:()=>TM(n,null))}return()=>{for(const n of t)n()}}}function TM(i,e){if(typeof i=="function")return i(e);i&&(i.current=e)}var WW=parseInt(le.version.split(".")[0],10)>=19?jW:VW;const XW=({ref:i,...e})=>{const{textures:t,transientStates:n,...r}=le.useContext(dS),[s,{sun:o,moon:u,moonDirection:f,moonAngularRadius:p,lunarRadianceScale:g,groundAlbedo:v,...y}]=aw({...HI,...r,...t,...e}),A=le.useMemo(()=>new uS,[]);return le.useEffect(()=>()=>{A.dispose()},[A]),da(()=>{n!=null&&(A.sunDirection.copy(n.sunDirection),A.moonDirection.copy(n.moonDirection),A.worldToECEFMatrix.copy(n.worldToECEFMatrix),A.shadowLength=n.shadowLength)}),D.jsx(mz,{renderOrder:TI,...y,ref:i,children:D.jsx("primitive",{object:A,...s,sun:o,moon:u,moonDirection:f,moonAngularRadius:p,lunarRadianceScale:g,groundAlbedo:v})})},YW=({ref:i,data:e=pj,...t})=>{const{textures:n,transientStates:r,...s}=le.useContext(dS),[o,{pointSize:u,radianceScale:f,intensity:p,background:g,...v}]=aw({...kI,...s,...n,...t}),[y,A]=le.useState(typeof e!="string"?e:void 0);le.useEffect(()=>{if(typeof e=="string"){const R=new ZD;(async()=>{A(await R.loadAsync(e))})().catch(I=>{console.error(I)})}else A(e)},[e]);const S=le.useMemo(()=>y!=null?new PW(y):void 0,[y]);le.useEffect(()=>()=>{S==null||S.dispose()},[S]);const T=le.useMemo(()=>new sw,[]);le.useEffect(()=>()=>{T.dispose()},[T]);const M=le.useRef(null);da(({camera:R})=>{var I;r!=null&&R.isPerspectiveCamera===!0&&(T.sunDirection.copy(r.sunDirection),(I=M.current)==null||I.setRotationFromMatrix(r.inertialToECEFMatrix),T.worldToECEFMatrix.copy(r.worldToECEFMatrix))});const E=Nn(({camera:R})=>R);return S==null||E.isPerspectiveCamera!==!0?null:D.jsxs("points",{ref:WW([M,i]),frustumCulled:!1,renderOrder:TI+1,...v,children:[D.jsx("primitive",{object:S}),D.jsx("primitive",{object:T,...o,pointSize:u,radianceScale:f,intensity:p,background:g,depthTest:!0,depthWrite:!1})]})};new zI;const QW=`#include "core/depth"
#include "core/turbo"

uniform float near;
uniform float far;

void mainImage(const vec4 inputColor, const vec2 uv, out vec4 outputColor) {
  float depth = readDepth(uv);
  depth = reverseLogDepth(depth, cameraNear, cameraFar);
  depth = linearizeDepth(depth, near, far) / far;

  #ifdef USE_TURBO
  vec3 color = turbo(1.0 - depth);
  #else // USE_TURBO
  vec3 color = vec3(depth);
  #endif // USE_TURBO

  outputColor = vec4(color, inputColor.a);
}
`;var qW=Object.defineProperty,JW=(i,e,t,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(e,t,r)||r);return r&&qW(e,t,r),r};const KW={blendFunction:bn.SRC,useTurbo:!1,near:1,far:1e3};class ZW extends ua{constructor(e){const{blendFunction:t,useTurbo:n,near:r,far:s}={...KW,...e};super("DepthEffect",Io(QW,{core:{depth:KT,turbo:dj}}),{blendFunction:t,attributes:la.DEPTH,uniforms:new Map(Object.entries({near:new Ne(r),far:new Ne(s)}))}),this.useTurbo=n}get near(){return this.uniforms.get("near").value}set near(e){this.uniforms.get("near").value=e}get far(){return this.uniforms.get("far").value}set far(e){this.uniforms.get("far").value=e}}JW([or("USE_TURBO")],ZW.prototype,"useTurbo");const $W=`#define DITHERING

#include <dithering_pars_fragment>

void mainImage(const vec4 inputColor, const vec2 uv, out vec4 outputColor) {
  outputColor = vec4(saturate(dithering(inputColor.rgb)), inputColor.a);
}
`,eX={blendFunction:bn.NORMAL};class tX extends ua{constructor(e){const{blendFunction:t}={...eX,...e};super("DitheringEffect",$W,{blendFunction:t})}}const nX=`#include <common>

uniform sampler2D inputBuffer;

uniform float thresholdLevel;
uniform float thresholdRange;

in vec2 vCenterUv1;
in vec2 vCenterUv2;
in vec2 vCenterUv3;
in vec2 vCenterUv4;
in vec2 vRowUv1;
in vec2 vRowUv2;
in vec2 vRowUv3;
in vec2 vRowUv4;
in vec2 vRowUv5;
in vec2 vRowUv6;
in vec2 vRowUv7;
in vec2 vRowUv8;
in vec2 vRowUv9;

float clampToBorder(const vec2 uv) {
  return float(uv.x >= 0.0 && uv.x <= 1.0 && uv.y >= 0.0 && uv.y <= 1.0);
}

// Reference: https://learnopengl.com/Guest-Articles/2022/Phys.-Based-Bloom
void main() {
  vec3 color = 0.125 * texture(inputBuffer, vec2(vRowUv5)).rgb;
  vec4 weight =
    0.03125 *
    vec4(
      clampToBorder(vRowUv1),
      clampToBorder(vRowUv3),
      clampToBorder(vRowUv7),
      clampToBorder(vRowUv9)
    );
  color += weight.x * texture(inputBuffer, vec2(vRowUv1)).rgb;
  color += weight.y * texture(inputBuffer, vec2(vRowUv3)).rgb;
  color += weight.z * texture(inputBuffer, vec2(vRowUv7)).rgb;
  color += weight.w * texture(inputBuffer, vec2(vRowUv9)).rgb;

  weight =
    0.0625 *
    vec4(
      clampToBorder(vRowUv2),
      clampToBorder(vRowUv4),
      clampToBorder(vRowUv6),
      clampToBorder(vRowUv8)
    );
  color += weight.x * texture(inputBuffer, vec2(vRowUv2)).rgb;
  color += weight.y * texture(inputBuffer, vec2(vRowUv4)).rgb;
  color += weight.z * texture(inputBuffer, vec2(vRowUv6)).rgb;
  color += weight.w * texture(inputBuffer, vec2(vRowUv8)).rgb;

  weight =
    0.125 *
    vec4(
      clampToBorder(vRowUv2),
      clampToBorder(vRowUv4),
      clampToBorder(vRowUv6),
      clampToBorder(vRowUv8)
    );
  color += weight.x * texture(inputBuffer, vec2(vCenterUv1)).rgb;
  color += weight.y * texture(inputBuffer, vec2(vCenterUv2)).rgb;
  color += weight.z * texture(inputBuffer, vec2(vCenterUv3)).rgb;
  color += weight.w * texture(inputBuffer, vec2(vCenterUv4)).rgb;

  // WORKAROUND: Avoid screen flashes if the input buffer contains NaN texels.
  // See: https://github.com/takram-design-engineering/three-geospatial/issues/7
  if (any(isnan(color))) {
    gl_FragColor = vec4(vec3(0.0), 1.0);
    return;
  }

  float l = luminance(color);
  float scale = saturate(smoothstep(thresholdLevel, thresholdLevel + thresholdRange, l));
  gl_FragColor = vec4(color * scale, 1.0);
}
`,iX=`uniform vec2 texelSize;

out vec2 vCenterUv1;
out vec2 vCenterUv2;
out vec2 vCenterUv3;
out vec2 vCenterUv4;
out vec2 vRowUv1;
out vec2 vRowUv2;
out vec2 vRowUv3;
out vec2 vRowUv4;
out vec2 vRowUv5;
out vec2 vRowUv6;
out vec2 vRowUv7;
out vec2 vRowUv8;
out vec2 vRowUv9;

void main() {
  vec2 uv = position.xy * 0.5 + 0.5;
  vCenterUv1 = uv + texelSize * vec2(-1.0, 1.0);
  vCenterUv2 = uv + texelSize * vec2(1.0, 1.0);
  vCenterUv3 = uv + texelSize * vec2(-1.0, -1.0);
  vCenterUv4 = uv + texelSize * vec2(1.0, -1.0);
  vRowUv1 = uv + texelSize * vec2(-2.0, 2.0);
  vRowUv2 = uv + texelSize * vec2(0.0, 2.0);
  vRowUv3 = uv + texelSize * vec2(2.0, 2.0);
  vRowUv4 = uv + texelSize * vec2(-2.0, 0.0);
  vRowUv5 = uv + texelSize;
  vRowUv6 = uv + texelSize * vec2(2.0, 0.0);
  vRowUv7 = uv + texelSize * vec2(-2.0, -2.0);
  vRowUv8 = uv + texelSize * vec2(0.0, -2.0);
  vRowUv9 = uv + texelSize * vec2(2.0, -2.0);

  gl_Position = vec4(position.xy, 1.0, 1.0);
}
`,rX={thresholdLevel:10,thresholdRange:1};class sX extends ai{constructor(e){const{inputBuffer:t=null,thresholdLevel:n,thresholdRange:r,...s}={...rX,...e};super({name:"DownsampleThresholdMaterial",fragmentShader:nX,vertexShader:iX,blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,...s,uniforms:{inputBuffer:new Ne(t),texelSize:new Ne(new qe),thresholdLevel:new Ne(n),thresholdRange:new Ne(r),...s.uniforms}})}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(e){this.uniforms.inputBuffer.value=e}get thresholdLevel(){return this.uniforms.thresholdLevel.value}set thresholdLevel(e){this.uniforms.thresholdLevel.value=e}get thresholdRange(){return this.uniforms.thresholdRange.value}set thresholdRange(e){this.uniforms.thresholdRange.value=e}}const aX=`#include <common>

#define SQRT_2 0.7071067811865476

uniform sampler2D inputBuffer;

uniform vec2 texelSize;
uniform float ghostAmount;
uniform float haloAmount;
uniform float chromaticAberration;

in vec2 vUv;
in vec2 vAspectRatio;

vec3 sampleGhost(const vec2 direction, const vec3 color, const float offset) {
  vec2 suv = clamp(1.0 - vUv + direction * offset, 0.0, 1.0);
  vec3 result = texture(inputBuffer, suv).rgb * color;

  // Falloff at the perimeter.
  float d = clamp(length(0.5 - suv) / (0.5 * SQRT_2), 0.0, 1.0);
  result *= pow(1.0 - d, 3.0);
  return result;
}

vec4 sampleGhosts(float amount) {
  vec3 color = vec3(0.0);
  vec2 direction = vUv - 0.5;
  color += sampleGhost(direction, vec3(0.8, 0.8, 1.0), -5.0);
  color += sampleGhost(direction, vec3(1.0, 0.8, 0.4), -1.5);
  color += sampleGhost(direction, vec3(0.9, 1.0, 0.8), -0.4);
  color += sampleGhost(direction, vec3(1.0, 0.8, 0.4), -0.2);
  color += sampleGhost(direction, vec3(0.9, 0.7, 0.7), -0.1);
  color += sampleGhost(direction, vec3(0.5, 1.0, 0.4), 0.7);
  color += sampleGhost(direction, vec3(0.5, 0.5, 0.5), 1.0);
  color += sampleGhost(direction, vec3(1.0, 1.0, 0.6), 2.5);
  color += sampleGhost(direction, vec3(0.5, 0.8, 1.0), 10.0);
  return vec4(color * amount, 1.0);
}

// Reference: https://john-chapman.github.io/2017/11/05/pseudo-lens-flare.html
float cubicRingMask(const float x, const float radius, const float thickness) {
  float v = min(abs(x - radius) / thickness, 1.0);
  return 1.0 - v * v * (3.0 - 2.0 * v);
}

vec3 sampleHalo(const float radius) {
  vec2 direction = normalize((vUv - 0.5) / vAspectRatio) * vAspectRatio;
  vec3 offset = vec3(texelSize.x * chromaticAberration) * vec3(-1.0, 0.0, 1.0);
  vec2 suv = fract(1.0 - vUv + direction * radius);
  vec3 result = vec3(
    texture(inputBuffer, suv + direction * offset.r).r,
    texture(inputBuffer, suv + direction * offset.g).g,
    texture(inputBuffer, suv + direction * offset.b).b
  );

  // Falloff at the center and perimeter.
  vec2 wuv = (vUv - vec2(0.5, 0.0)) / vAspectRatio + vec2(0.5, 0.0);
  float d = saturate(distance(wuv, vec2(0.5)));
  result *= cubicRingMask(d, 0.45, 0.25);
  return result;
}

vec4 sampleHalos(const float amount) {
  vec3 color = vec3(0.0);
  color += sampleHalo(0.3);
  return vec4(color, 1.0) * amount;
}

void main() {
  gl_FragColor += sampleGhosts(ghostAmount);
  gl_FragColor += sampleHalos(haloAmount);
}

`,oX=`uniform vec2 texelSize;

out vec2 vUv;
out vec2 vAspectRatio;

void main() {
  vUv = position.xy * 0.5 + 0.5;
  vAspectRatio = vec2(texelSize.x / texelSize.y, 1.0);
  gl_Position = vec4(position.xy, 1.0, 1.0);
}
`,lX={ghostAmount:.001,haloAmount:.001,chromaticAberration:10};class cX extends ai{constructor(e){const{inputBuffer:t=null,ghostAmount:n,haloAmount:r,chromaticAberration:s,...o}={...lX,...e};super({name:"LensFlareFeaturesMaterial",fragmentShader:aX,vertexShader:oX,blending:Pi,toneMapped:!1,depthWrite:!1,depthTest:!1,uniforms:{inputBuffer:new Ne(t),texelSize:new Ne(new qe),ghostAmount:new Ne(n),haloAmount:new Ne(r),chromaticAberration:new Ne(s),...o.uniforms}})}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(e){this.uniforms.inputBuffer.value=e}get ghostAmount(){return this.uniforms.ghostAmount.value}set ghostAmount(e){this.uniforms.ghostAmount.value=e}get haloAmount(){return this.uniforms.haloAmount.value}set haloAmount(e){this.uniforms.haloAmount.value=e}get chromaticAberration(){return this.uniforms.chromaticAberration.value}set chromaticAberration(e){this.uniforms.chromaticAberration.value=e}}const uX=`uniform sampler2D bloomBuffer;
uniform sampler2D featuresBuffer;
uniform float intensity;

void mainImage(const vec4 inputColor, const vec2 uv, out vec4 outputColor) {
  vec3 bloom = texture(bloomBuffer, uv).rgb;
  vec3 features = texture(featuresBuffer, uv).rgb;
  outputColor = vec4(inputColor.rgb + (bloom + features) * intensity, inputColor.a);
}
`,VI={blendFunction:bn.NORMAL,resolutionScale:.5,width:Er.AUTO_SIZE,height:Er.AUTO_SIZE,intensity:.005};let dX=class extends ua{constructor(e){const{blendFunction:t,resolutionScale:n,width:r,height:s,resolutionX:o=r,resolutionY:u=s,intensity:f}={...VI,...e};super("LensFlareEffect",uX,{blendFunction:t,attributes:la.CONVOLUTION,uniforms:new Map(Object.entries({bloomBuffer:new Ne(null),featuresBuffer:new Ne(null),intensity:new Ne(1)}))}),this.onResolutionChange=()=>{this.setSize(this.resolution.baseWidth,this.resolution.baseHeight)},this.renderTarget1=new ti(1,1,{depthBuffer:!1,type:On}),this.renderTarget1.texture.name="LensFlare.Target1",this.renderTarget2=new ti(1,1,{depthBuffer:!1,type:On}),this.renderTarget2.texture.name="LensFlare.Target2",this.thresholdMaterial=new sX,this.thresholdPass=new Zl(this.thresholdMaterial),this.blurPass=new PD,this.blurPass.levels=8,this.preBlurPass=new FT({kernelSize:Qv.SMALL}),this.featuresMaterial=new cX,this.featuresPass=new Zl(this.featuresMaterial),this.uniforms.get("bloomBuffer").value=this.blurPass.texture,this.uniforms.get("featuresBuffer").value=this.renderTarget1.texture,this.resolution=new Er(this,o,u,n),this.resolution.addEventListener("change",this.onResolutionChange),this.intensity=f}initialize(e,t,n){this.thresholdPass.initialize(e,t,n),this.blurPass.initialize(e,t,n),this.preBlurPass.initialize(e,t,n),this.featuresPass.initialize(e,t,n)}update(e,t,n){this.thresholdPass.render(e,t,this.renderTarget1),this.blurPass.render(e,this.renderTarget1,null),this.preBlurPass.render(e,this.renderTarget1,this.renderTarget2),this.featuresPass.render(e,this.renderTarget2,this.renderTarget1)}setSize(e,t){const n=this.resolution;n.setBaseSize(e,t);const{width:r,height:s}=n;this.renderTarget1.setSize(r,s),this.renderTarget2.setSize(r,s),this.thresholdMaterial.setSize(r,s),this.blurPass.setSize(r,s),this.preBlurPass.setSize(r,s),this.featuresMaterial.setSize(r,s)}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}get thresholdLevel(){return this.thresholdMaterial.thresholdLevel}set thresholdLevel(e){this.thresholdMaterial.thresholdLevel=e}get thresholdRange(){return this.thresholdMaterial.thresholdRange}set thresholdRange(e){this.thresholdMaterial.thresholdRange=e}};const fX=`#include "core/depth"
#include "core/packing"
#include "core/transform"

uniform highp sampler2D normalBuffer;

uniform mat4 projectionMatrix;
uniform mat4 inverseProjectionMatrix;

vec3 reconstructNormal(const vec2 uv) {
  float depth = readDepth(uv);
  depth = reverseLogDepth(depth, cameraNear, cameraFar);
  vec3 position = screenToView(
    uv,
    depth,
    getViewZ(depth),
    projectionMatrix,
    inverseProjectionMatrix
  );
  vec3 dx = dFdx(position);
  vec3 dy = dFdy(position);
  return normalize(cross(dx, dy));
}

vec3 readNormal(const vec2 uv) {
  #ifdef OCT_ENCODED
  return unpackVec2ToNormal(texture(normalBuffer, uv).xy);
  #else // OCT_ENCODED
  return 2.0 * texture(normalBuffer, uv).xyz - 1.0;
  #endif // OCT_ENCODED
}

void mainImage(const vec4 inputColor, const vec2 uv, out vec4 outputColor) {
  #ifdef RECONSTRUCT_FROM_DEPTH
  vec3 normal = reconstructNormal(uv);
  #else // RECONSTRUCT_FROM_DEPTH
  vec3 normal = readNormal(uv);
  #endif // RECONSTRUCT_FROM_DEPTH

  outputColor = vec4(normal * 0.5 + 0.5, inputColor.a);
}
`;var hX=Object.defineProperty,jI=(i,e,t,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(e,t,r)||r);return r&&hX(e,t,r),r};const pX={blendFunction:bn.SRC,octEncoded:!1,reconstructFromDepth:!1};let WI=class extends ua{constructor(e,t){const{blendFunction:n,normalBuffer:r=null,octEncoded:s,reconstructFromDepth:o}={...pX,...t};super("NormalEffect",Io(fX,{core:{depth:KT,packing:bI,transform:MI}}),{blendFunction:n,attributes:la.DEPTH,uniforms:new Map(Object.entries({normalBuffer:new Ne(r),projectionMatrix:new Ne(new jt),inverseProjectionMatrix:new Ne(new jt)}))}),this.camera=e,e!=null&&(this.mainCamera=e),this.octEncoded=s,this.reconstructFromDepth=o}get mainCamera(){return this.camera}set mainCamera(e){this.camera=e}update(e,t,n){const r=this.uniforms,s=r.get("projectionMatrix"),o=r.get("inverseProjectionMatrix"),u=this.camera;u!=null&&(s.value.copy(u.projectionMatrix),o.value.copy(u.projectionMatrixInverse))}get normalBuffer(){return this.uniforms.get("normalBuffer").value}set normalBuffer(e){this.uniforms.get("normalBuffer").value=e}};jI([or("OCT_ENCODED")],WI.prototype,"octEncoded");jI([or("RECONSTRUCT_FROM_DEPTH")],WI.prototype,"reconstructFromDepth");const mX=wd(tX),gX=({ref:i,...e})=>{const{blendFunction:t,...n}={...VI,...e},r=le.useMemo(()=>new dX,[]);return le.useEffect(()=>()=>{r.dispose()},[r]),D.jsx("primitive",{ref:i,object:r,...n})},vX=new jt,xX=new kT,yX=new Q;class AX extends nc{set(e,t,n,r=ac.WGS84){const s=xX.set(e,t,n).toECEF(yX);r.getEastNorthUpFrame(s,vX).decompose(this.position,this.quaternion,this.scale)}}const _X=({ref:i,longitude:e,latitude:t,height:n=0,ellipsoid:r=ac.WGS84,children:s})=>{const o=le.useMemo(()=>new AX,[]);return le.useEffect(()=>{o.set(e,t,n,r)},[e,t,n,r,o]),D.jsx("primitive",{ref:i,object:o,children:s})},SX=({ref:i,args:e,children:t,...n})=>(q_({EllipsoidGeometry:dk}),D.jsxs("mesh",{ref:i,...n,children:[D.jsx("ellipsoidGeometry",{args:e}),t]})),XI=new kT(Ev(37.62),Ev(55.75),200),Fg=XI.toECEF();function bX({children:i}){const e=le.useRef(null),t=Ue(A=>A.timeOfDay),n=Ue(A=>A.sunOrientation),r=Ue(A=>A.atmosphereEnabled),s=Ue(A=>A.backgroundMode),o=Ue(A=>A.setCameraPosition),u=Ue(A=>A.setCameraTargetPosition),f=r&&s==="sky",p=le.useMemo(()=>{const A=new Date().getFullYear(),S=Date.UTC(A,0,1,0,0,0,0),T=Math.floor(n/360*365)+1,M=S+(T*24+t)*36e5;return new Date(M)},[t,n]),g=Nn(({camera:A})=>A),[v,y]=le.useState(null);return le.useEffect(()=>{if(!f)return;if(new UV(800,Ev(-90),Ev(-25)).decompose(Fg,g.position,g.quaternion,g.up),v!=null){v.target.copy(Fg),v.update(),BD(v);const S=g.position;o([S.x,S.y,S.z]),u([Fg.x,Fg.y,Fg.z]);const T=()=>{const M=g.position;o([M.x,M.y,M.z]),v.target&&u([v.target.x,v.target.y,v.target.z])};return v.addEventListener("change",T),()=>{v.removeEventListener("change",T)}}},[g,v,f,o,u]),da(({gl:A})=>{const S=Ue.getState().toneMappingExposure;A.toneMappingExposure=S,e.current&&f&&e.current.updateByDate(p)}),f?D.jsxs(HW,{ref:e,correctAltitude:!0,children:[D.jsx(ED,{ref:y}),D.jsx(XW,{}),D.jsx(YW,{data:"atmosphere/stars.bin"}),D.jsx(SX,{args:[ac.WGS84.radii,360,180],children:D.jsx("meshBasicMaterial",{color:"gray"})}),D.jsx(_X,{...XI,children:i}),D.jsx(JV,{multisampling:0,children:D.jsxs(le.Fragment,{children:[D.jsx(kW,{sunLight:!0,skyLight:!0,transmittance:!0,inscatter:!0}),D.jsx(gX,{}),D.jsx(VD,{mode:Ir.AGX}),D.jsx(kD,{}),D.jsx(mX,{})]},"atmosphere-effects")})]}):D.jsx(D.Fragment,{children:i})}function EX(){const i=Ue(s=>s.hdriIntensity),e=Ue(s=>s.hdriRotation1),t=Ue(s=>s.hdriBlur),n=Ue(s=>s.hdriFile),r=Ue(s=>s.showHdriBackground);return D.jsx(Bz,{files:n,background:r,backgroundBlurriness:t,backgroundIntensity:i,backgroundRotation:[0,e,0],environmentIntensity:i,environmentRotation:[0,e,0]},n)}function MX({viewMode:i}){const e=le.useRef(null),{camera:t}=Nn(),n=Ue(u=>u.setCameraPosition),r=Ue(u=>u.setCameraTargetPosition),s=Ue(u=>u.arMode);le.useEffect(()=>{const u=e.current;if(u){console.log("OrbitControls ref captured"),BD(u);const f=()=>{const p=t.position;n([p.x,p.y,p.z]),u.target&&r([u.target.x,u.target.y,u.target.z])};return u.addEventListener("change",f),()=>{u.removeEventListener("change",f)}}},[t,n,r]);const o=i==="top";return D.jsx(ED,{ref:e,enableDamping:!0,dampingFactor:.05,minDistance:1,maxDistance:300,maxPolarAngle:Math.PI/2,minPolarAngle:0,enableRotate:!o,enablePan:!s,enableZoom:!0,zoomSpeed:1})}function TX(){const{camera:i}=Nn(),e=Ue(n=>n.setCameraPosition),t=Ue(n=>n.setCameraTargetPosition);return le.useEffect(()=>{const n=setInterval(()=>{var r;if(i){const s=i.position,o=(r=i.controls)==null?void 0:r.target;e([s.x,s.y,s.z]),o&&t([o.x,o.y,o.z])}},100);return()=>clearInterval(n)},[i,e,t]),null}function fS(){const i=Ue(S=>S.timeOfDay),e=Ue(S=>S.sunOrientation),n=Math.max(0,Math.min(1,(i-5)/16)),r=Math.sin(n*Math.PI)*80,s=Math.max(r,2)*Math.PI/180,f=(90+n*180+e)*Math.PI/180,p=80,g=p*Math.cos(s)*Math.sin(f),v=p*Math.sin(s),y=p*Math.cos(s)*Math.cos(f),A=Math.max(0,Math.sin(n*Math.PI));return{x:g,y:v,z:y,sunProgress:A,normalizedTime:n,elevation:r}}function wX(){const{x:i,y:e,z:t,sunProgress:n}=fS(),r=2+(1-n)*8,s=.5+n*2,o=.005+(1-n)*.02;return D.jsx(D.Fragment,{children:D.jsx(Lz,{sunPosition:[i,e,t],turbidity:r,rayleigh:s,mieCoefficient:o,mieDirectionalG:.8,inclination:void 0,azimuth:void 0})})}function CX(){const{x:i,y:e,z:t,sunProgress:n}=fS(),r=1-n,s=1,o=.85+n*.15,u=.6+n*.4,f=`rgb(${Math.round(s*255)}, ${Math.round(o*255)}, ${Math.round(u*255)})`,p=n*1.5,g=Math.max(.08,n*.5);return D.jsxs(D.Fragment,{children:[D.jsx("ambientLight",{intensity:g,color:n<.2?"#1a2040":r>.5?"#ffd4a0":"#ffffff"}),D.jsx("directionalLight",{position:[i,e,t],intensity:p,color:f,castShadow:!0,"shadow-mapSize":[2048,2048],"shadow-camera-left":-60,"shadow-camera-right":60,"shadow-camera-top":60,"shadow-camera-bottom":-60,"shadow-camera-near":1,"shadow-camera-far":200,"shadow-bias":-.001,"shadow-normalBias":.05}),D.jsx("directionalLight",{position:[-i*.5,e*.3,-t*.5],intensity:p*.15,color:"#8090c0"}),D.jsx("hemisphereLight",{args:[n>.3?"#b1e1ff":"#1a1a3e","#3a2a1a",n>.3?.3:.15]})]})}function RX(){const{sunProgress:i}=fS(),e=Ue(s=>s.nightLightsEnabled),t=Ue(s=>s.nightLightsIntensity),n=Math.max(0,1-i/.3)*t;if(!e||n<.01)return null;const r=[[0,8,0],[-15,3,10],[15,3,10],[-15,3,-10],[15,3,-10],[0,3,20],[0,3,-20]];return D.jsxs("group",{children:[r.map((s,o)=>D.jsx("pointLight",{position:s,intensity:n*(o===0?2:1.2),color:o===0?"#ffeedd":"#ffcc88",distance:40,decay:2},o)),D.jsx("spotLight",{position:[0,15,25],"target-position":[0,0,15],intensity:n*3,color:"#ffe0b0",angle:.5,penumbra:.8,distance:60,decay:2})]})}function DX(){const i=Ue(t=>t.contactShadowsEnabled),{sunProgress:e}=fS();return i?D.jsx(Nz,{position:[0,-.09,0],opacity:Math.min(.3,e*.4),scale:300,blur:3,far:30,resolution:256,color:"#000020"}):null}function IX(){const i=RT("/textures/grid.png");return i.wrapS=i.wrapT=Lo,i.repeat.set(50,50),D.jsxs(D.Fragment,{children:[D.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.1,0],receiveShadow:!0,children:[D.jsx("planeGeometry",{args:[1e3,1e3]}),D.jsx("meshStandardMaterial",{map:i,color:"#ffffff",roughness:.15,metalness:.8})]}),D.jsx("gridHelper",{args:[1e3,100,"#333338","#222228"],position:[0,-.05,0]})]})}function BX(){const{gl:i}=Nn(),e=Ue(n=>n.toneMappingExposure),t=Ue(n=>n.graphicsQuality);return le.useEffect(()=>{t==="performance"?i.toneMapping=Dv:i.toneMapping=aa,i.toneMappingExposure=e},[i,e,t]),null}function NX(){const i=Ue(r=>r.viewMode),e=Ue(r=>r.backgroundMode),n=Ue(r=>r.atmosphereEnabled)&&e==="sky";return D.jsxs(D.Fragment,{children:[D.jsx(BX,{}),!n&&D.jsxs(D.Fragment,{children:[e==="sky"&&D.jsx(wX,{}),e==="hdri"&&D.jsx(EX,{}),D.jsx(CX,{}),D.jsx(RX,{}),D.jsx(IX,{}),D.jsx(DX,{})]}),D.jsx(hz,{className:"!top-4 !left-auto !right-14 !bottom-auto"}),D.jsx(le.Suspense,{fallback:null,children:D.jsx(Kz,{})}),D.jsx(Zz,{}),D.jsx(tH,{}),D.jsx(nH,{}),D.jsx(aH,{}),!n&&D.jsxs(D.Fragment,{children:[i==="first-person"?D.jsx(oH,{}):D.jsx(MX,{viewMode:i}),D.jsx(TX,{}),D.jsx(lH,{})]}),D.jsx(ZV,{})]})}function OX(){const i=Ue(u=>u.viewMode),e=Ue(u=>u.toneMappingExposure),t=Ue(u=>u.atmosphereEnabled),n=Ue(u=>u.backgroundMode),r=t&&n==="sky",s=()=>{switch(i){case"top":return[-35,200,0];case"angle":return[-40,120,140];default:return[-40,120,140]}},o=i==="top"&&!r;return D.jsx("div",{className:"w-full h-full relative",children:D.jsxs(RF,{shadows:!r,className:"w-full h-full",gl:{depth:r?!1:void 0,logarithmicDepthBuffer:r,toneMapping:aa,toneMappingExposure:e,outputColorSpace:Hn,antialias:!r,powerPreference:"high-performance"},camera:r?{near:100,far:1e6}:void 0,children:[!r&&D.jsx(D.Fragment,{children:o?D.jsx(rz,{makeDefault:!0,position:[-20,150,0],zoom:1.5,near:.1,far:1e3,up:[0,1,0]}):D.jsx(az,{makeDefault:!0,position:i==="first-person"?void 0:s(),fov:i==="first-person"?75:50},i)}),D.jsx(bX,{children:D.jsx(NX,{})})]})})}function LX(){const i=Ue(s=>s.zones),e=Ue(s=>s.userLocation),t=Ue(s=>s.selectedZone),n=Ue(s=>s.currentRoute),r=s=>[100+s[0]*2,100+s[2]*2];return D.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-sm rounded-2xl p-3 shadow-2xl border border-gray-700",children:[D.jsxs("div",{className:"text-white text-xs font-bold mb-2 flex items-center justify-between",children:[D.jsx("span",{children:"-"}),D.jsx("span",{className:"text-gray-400",children:""})]}),D.jsxs("svg",{width:"200",height:"200",className:"bg-gray-800 rounded-lg",viewBox:"0 0 200 200",children:[D.jsx("defs",{children:D.jsx("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:D.jsx("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"rgba(255,255,255,0.05)",strokeWidth:"0.5"})})}),D.jsx("rect",{width:"200",height:"200",fill:"url(#grid)"}),i.map(s=>{const[o,u]=r(s.position),f=(t==null?void 0:t.id)===s.id;return D.jsx("g",{children:D.jsx("circle",{cx:o,cy:u,r:f?8:6,fill:s.color,opacity:f?.8:.5,stroke:f?"white":"none",strokeWidth:f?2:0})},s.id)}),n&&e&&D.jsxs(D.Fragment,{children:[D.jsx("line",{x1:r(e.position)[0],y1:r(e.position)[1],x2:r(n.to)[0],y2:r(n.to)[1],stroke:"#00ccff",strokeWidth:"2",strokeDasharray:"4 2",opacity:"0.6"}),D.jsx("circle",{cx:r(n.to)[0],cy:r(n.to)[1],r:"10",fill:"none",stroke:"#ff6b35",strokeWidth:"2"})]}),e&&D.jsxs("g",{children:[D.jsxs("circle",{cx:r(e.position)[0],cy:r(e.position)[1],r:"12",fill:"#0066cc",opacity:"0.2",children:[D.jsx("animate",{attributeName:"r",from:"8",to:"16",dur:"1.5s",repeatCount:"indefinite"}),D.jsx("animate",{attributeName:"opacity",from:"0.4",to:"0",dur:"1.5s",repeatCount:"indefinite"})]}),D.jsx("circle",{cx:r(e.position)[0],cy:r(e.position)[1],r:"5",fill:"#00ccff",stroke:"white",strokeWidth:"2"})]})]})]})}function PX({id:i,isActive:e}){const t=e?"2":"1.6";switch(i){case"events":return D.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),D.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),D.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),e&&D.jsx("circle",{cx:"12",cy:"16",r:"1.5",fill:"currentColor"})]});case"zones":return D.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),D.jsx("line",{x1:"16",y1:"6",x2:"16",y2:"22"})]});case"angle":return D.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),D.jsx("circle",{cx:"12",cy:"12",r:"3",fill:e?"currentColor":"none"})]});case"first-person":return D.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("circle",{cx:"12",cy:"5",r:"3"}),D.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),D.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),D.jsx("line",{x1:"12",y1:"16",x2:"8",y2:"22"}),D.jsx("line",{x1:"12",y1:"16",x2:"16",y2:"22"})]});case"friends":return D.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),D.jsx("circle",{cx:"9",cy:"7",r:"4"}),D.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),D.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]});case"menu":return D.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:t,strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("circle",{cx:"12",cy:"12",r:"3"}),D.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]});default:return null}}function UX(){const i=Ue(p=>p.activePanel),e=Ue(p=>p.setActivePanel),t=Ue(p=>p.arMode),n=Ue(p=>p.setArMode),r=Ue(p=>p.viewMode),s=Ue(p=>p.setViewMode),o=Ue(p=>p.userLocation),u=[{id:"events",label:""},{id:"zones",label:""},{id:"angle",label:""},{id:"first-person",label:""},{id:"friends",label:""},{id:"menu",label:""}],f=p=>{p==="ar"?n(!t):p==="angle"||p==="first-person"?(s(p),p==="first-person"&&o&&Ue.getState().setCameraTarget(null)):e(i===p?null:p)};return D.jsx("div",{className:"flex justify-center pb-safe px-2 sm:px-0",children:D.jsx("div",{className:"mb-2 sm:mb-3 bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl w-full sm:w-auto sm:min-w-[420px] sm:max-w-[780px] mx-auto",children:D.jsx("div",{className:"flex justify-around sm:justify-center items-center gap-0 px-1 sm:px-2 py-2",children:u.map(p=>{const g=p.id==="ar"?t:p.id==="angle"||p.id==="first-person"?r===p.id:i===p.id;return D.jsxs("button",{onClick:()=>f(p.id),className:`relative flex flex-col items-center gap-0.5 px-2 sm:px-4 py-1.5 rounded-xl transition-all duration-200 ${g?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[g&&D.jsx("div",{className:"absolute inset-0 bg-white/10 rounded-xl border border-white/10"}),D.jsx("div",{className:"relative z-10",children:D.jsx(PX,{id:p.id,isActive:g})}),D.jsx("span",{className:`relative z-10 text-[10px] font-medium tracking-wide ${g?"text-white":""}`,children:p.label}),g&&D.jsx("div",{className:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-blue-400 shadow-[0_0_6px_rgba(96,165,250,0.6)]"})]},p.id)})})})})}function fs(i){const e=Object.prototype.toString.call(i);return i instanceof Date||typeof i=="object"&&e==="[object Date]"?new i.constructor(+i):typeof i=="number"||e==="[object Number]"||typeof i=="string"||e==="[object String]"?new Date(i):new Date(NaN)}function ch(i,e){return i instanceof Date?new i.constructor(e):new Date(e)}const YI=6048e5,FX=864e5,zX=6e4;let HX={};function hS(){return HX}function Mv(i,e){var u,f,p,g;const t=hS(),n=(e==null?void 0:e.weekStartsOn)??((f=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((g=(p=t.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??0,r=fs(i),s=r.getDay(),o=(s<n?7:0)+s-n;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function c_(i){return Mv(i,{weekStartsOn:1})}function QI(i){const e=fs(i),t=e.getFullYear(),n=ch(i,0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);const r=c_(n),s=ch(i,0);s.setFullYear(t,0,4),s.setHours(0,0,0,0);const o=c_(s);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function KR(i){const e=fs(i);return e.setHours(0,0,0,0),e}function ZR(i){const e=fs(i),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+i-+t}function GX(i,e){const t=KR(i),n=KR(e),r=+t-ZR(t),s=+n-ZR(n);return Math.round((r-s)/FX)}function kX(i){const e=QI(i),t=ch(i,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),c_(t)}function VX(i){return i instanceof Date||typeof i=="object"&&Object.prototype.toString.call(i)==="[object Date]"}function jX(i){if(!VX(i)&&typeof i!="number")return!1;const e=fs(i);return!isNaN(Number(e))}function WX(i){return e=>{const n=(i?Math[i]:Math.trunc)(e);return n===0?0:n}}function XX(i,e){return+fs(i)-+fs(e)}function u_(i,e,t){const n=XX(i,e)/zX;return WX(t==null?void 0:t.roundingMethod)(n)}function YX(i){const e=fs(i),t=ch(i,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const QX={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},qX=(i,e,t)=>{let n;const r=QX[i];return typeof r=="string"?n=r:e===1?n=r.one:n=r.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function ME(i){return(e={})=>{const t=e.width?String(e.width):i.defaultWidth;return i.formats[t]||i.formats[i.defaultWidth]}}const JX={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},KX={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ZX={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$X={date:ME({formats:JX,defaultWidth:"full"}),time:ME({formats:KX,defaultWidth:"full"}),dateTime:ME({formats:ZX,defaultWidth:"full"})},eY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},tY=(i,e,t,n)=>eY[i];function zg(i){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let r;if(n==="formatting"&&i.formattingValues){const o=i.defaultFormattingWidth||i.defaultWidth,u=t!=null&&t.width?String(t.width):o;r=i.formattingValues[u]||i.formattingValues[o]}else{const o=i.defaultWidth,u=t!=null&&t.width?String(t.width):i.defaultWidth;r=i.values[u]||i.values[o]}const s=i.argumentCallback?i.argumentCallback(e):e;return r[s]}}const nY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},iY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},rY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},aY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},oY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},lY=(i,e)=>{const t=Number(i),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},cY={ordinalNumber:lY,era:zg({values:nY,defaultWidth:"wide"}),quarter:zg({values:iY,defaultWidth:"wide",argumentCallback:i=>i-1}),month:zg({values:rY,defaultWidth:"wide"}),day:zg({values:sY,defaultWidth:"wide"}),dayPeriod:zg({values:aY,defaultWidth:"wide",formattingValues:oY,defaultFormattingWidth:"wide"})};function Hg(i){return(e,t={})=>{const n=t.width,r=n&&i.matchPatterns[n]||i.matchPatterns[i.defaultMatchWidth],s=e.match(r);if(!s)return null;const o=s[0],u=n&&i.parsePatterns[n]||i.parsePatterns[i.defaultParseWidth],f=Array.isArray(u)?dY(u,v=>v.test(o)):uY(u,v=>v.test(o));let p;p=i.valueCallback?i.valueCallback(f):f,p=t.valueCallback?t.valueCallback(p):p;const g=e.slice(o.length);return{value:p,rest:g}}}function uY(i,e){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&e(i[t]))return t}function dY(i,e){for(let t=0;t<i.length;t++)if(e(i[t]))return t}function fY(i){return(e,t={})=>{const n=e.match(i.matchPattern);if(!n)return null;const r=n[0],s=e.match(i.parsePattern);if(!s)return null;let o=i.valueCallback?i.valueCallback(s[0]):s[0];o=t.valueCallback?t.valueCallback(o):o;const u=e.slice(r.length);return{value:o,rest:u}}}const hY=/^(\d+)(th|st|nd|rd)?/i,pY=/\d+/i,mY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},gY={any:[/^b/i,/^(a|c)/i]},vY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xY={any:[/1/i,/2/i,/3/i,/4/i]},yY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},AY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_Y={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},SY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},bY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},EY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},MY={ordinalNumber:fY({matchPattern:hY,parsePattern:pY,valueCallback:i=>parseInt(i,10)}),era:Hg({matchPatterns:mY,defaultMatchWidth:"wide",parsePatterns:gY,defaultParseWidth:"any"}),quarter:Hg({matchPatterns:vY,defaultMatchWidth:"wide",parsePatterns:xY,defaultParseWidth:"any",valueCallback:i=>i+1}),month:Hg({matchPatterns:yY,defaultMatchWidth:"wide",parsePatterns:AY,defaultParseWidth:"any"}),day:Hg({matchPatterns:_Y,defaultMatchWidth:"wide",parsePatterns:SY,defaultParseWidth:"any"}),dayPeriod:Hg({matchPatterns:bY,defaultMatchWidth:"any",parsePatterns:EY,defaultParseWidth:"any"})},TY={code:"en-US",formatDistance:qX,formatLong:$X,formatRelative:tY,localize:cY,match:MY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wY(i){const e=fs(i);return GX(e,YX(e))+1}function CY(i){const e=fs(i),t=+c_(e)-+kX(e);return Math.round(t/YI)+1}function qI(i,e){var g,v,y,A;const t=fs(i),n=t.getFullYear(),r=hS(),s=(e==null?void 0:e.firstWeekContainsDate)??((v=(g=e==null?void 0:e.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??r.firstWeekContainsDate??((A=(y=r.locale)==null?void 0:y.options)==null?void 0:A.firstWeekContainsDate)??1,o=ch(i,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const u=Mv(o,e),f=ch(i,0);f.setFullYear(n,0,s),f.setHours(0,0,0,0);const p=Mv(f,e);return t.getTime()>=u.getTime()?n+1:t.getTime()>=p.getTime()?n:n-1}function RY(i,e){var u,f,p,g;const t=hS(),n=(e==null?void 0:e.firstWeekContainsDate)??((f=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((g=(p=t.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,r=qI(i,e),s=ch(i,0);return s.setFullYear(r,0,n),s.setHours(0,0,0,0),Mv(s,e)}function DY(i,e){const t=fs(i),n=+Mv(t,e)-+RY(t,e);return Math.round(n/YI)+1}function Mi(i,e){const t=i<0?"-":"",n=Math.abs(i).toString().padStart(e,"0");return t+n}const dd={y(i,e){const t=i.getFullYear(),n=t>0?t:1-t;return Mi(e==="yy"?n%100:n,e.length)},M(i,e){const t=i.getMonth();return e==="M"?String(t+1):Mi(t+1,2)},d(i,e){return Mi(i.getDate(),e.length)},a(i,e){const t=i.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(i,e){return Mi(i.getHours()%12||12,e.length)},H(i,e){return Mi(i.getHours(),e.length)},m(i,e){return Mi(i.getMinutes(),e.length)},s(i,e){return Mi(i.getSeconds(),e.length)},S(i,e){const t=e.length,n=i.getMilliseconds(),r=Math.trunc(n*Math.pow(10,t-3));return Mi(r,e.length)}},Kp={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$R={G:function(i,e,t){const n=i.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(i,e,t){if(e==="yo"){const n=i.getFullYear(),r=n>0?n:1-n;return t.ordinalNumber(r,{unit:"year"})}return dd.y(i,e)},Y:function(i,e,t,n){const r=qI(i,n),s=r>0?r:1-r;if(e==="YY"){const o=s%100;return Mi(o,2)}return e==="Yo"?t.ordinalNumber(s,{unit:"year"}):Mi(s,e.length)},R:function(i,e){const t=QI(i);return Mi(t,e.length)},u:function(i,e){const t=i.getFullYear();return Mi(t,e.length)},Q:function(i,e,t){const n=Math.ceil((i.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Mi(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(i,e,t){const n=Math.ceil((i.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Mi(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(i,e,t){const n=i.getMonth();switch(e){case"M":case"MM":return dd.M(i,e);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(i,e,t){const n=i.getMonth();switch(e){case"L":return String(n+1);case"LL":return Mi(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(i,e,t,n){const r=DY(i,n);return e==="wo"?t.ordinalNumber(r,{unit:"week"}):Mi(r,e.length)},I:function(i,e,t){const n=CY(i);return e==="Io"?t.ordinalNumber(n,{unit:"week"}):Mi(n,e.length)},d:function(i,e,t){return e==="do"?t.ordinalNumber(i.getDate(),{unit:"date"}):dd.d(i,e)},D:function(i,e,t){const n=wY(i);return e==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):Mi(n,e.length)},E:function(i,e,t){const n=i.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(i,e,t,n){const r=i.getDay(),s=(r-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Mi(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(r,{width:"short",context:"formatting"});case"eeee":default:return t.day(r,{width:"wide",context:"formatting"})}},c:function(i,e,t,n){const r=i.getDay(),s=(r-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Mi(s,e.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(r,{width:"narrow",context:"standalone"});case"cccccc":return t.day(r,{width:"short",context:"standalone"});case"cccc":default:return t.day(r,{width:"wide",context:"standalone"})}},i:function(i,e,t){const n=i.getDay(),r=n===0?7:n;switch(e){case"i":return String(r);case"ii":return Mi(r,e.length);case"io":return t.ordinalNumber(r,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(i,e,t){const r=i.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(i,e,t){const n=i.getHours();let r;switch(n===12?r=Kp.noon:n===0?r=Kp.midnight:r=n/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(i,e,t){const n=i.getHours();let r;switch(n>=17?r=Kp.evening:n>=12?r=Kp.afternoon:n>=4?r=Kp.morning:r=Kp.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(i,e,t){if(e==="ho"){let n=i.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return dd.h(i,e)},H:function(i,e,t){return e==="Ho"?t.ordinalNumber(i.getHours(),{unit:"hour"}):dd.H(i,e)},K:function(i,e,t){const n=i.getHours()%12;return e==="Ko"?t.ordinalNumber(n,{unit:"hour"}):Mi(n,e.length)},k:function(i,e,t){let n=i.getHours();return n===0&&(n=24),e==="ko"?t.ordinalNumber(n,{unit:"hour"}):Mi(n,e.length)},m:function(i,e,t){return e==="mo"?t.ordinalNumber(i.getMinutes(),{unit:"minute"}):dd.m(i,e)},s:function(i,e,t){return e==="so"?t.ordinalNumber(i.getSeconds(),{unit:"second"}):dd.s(i,e)},S:function(i,e){return dd.S(i,e)},X:function(i,e,t){const n=i.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return t2(n);case"XXXX":case"XX":return Of(n);case"XXXXX":case"XXX":default:return Of(n,":")}},x:function(i,e,t){const n=i.getTimezoneOffset();switch(e){case"x":return t2(n);case"xxxx":case"xx":return Of(n);case"xxxxx":case"xxx":default:return Of(n,":")}},O:function(i,e,t){const n=i.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+e2(n,":");case"OOOO":default:return"GMT"+Of(n,":")}},z:function(i,e,t){const n=i.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+e2(n,":");case"zzzz":default:return"GMT"+Of(n,":")}},t:function(i,e,t){const n=Math.trunc(i.getTime()/1e3);return Mi(n,e.length)},T:function(i,e,t){const n=i.getTime();return Mi(n,e.length)}};function e2(i,e=""){const t=i>0?"-":"+",n=Math.abs(i),r=Math.trunc(n/60),s=n%60;return s===0?t+String(r):t+String(r)+e+Mi(s,2)}function t2(i,e){return i%60===0?(i>0?"-":"+")+Mi(Math.abs(i)/60,2):Of(i,e)}function Of(i,e=""){const t=i>0?"-":"+",n=Math.abs(i),r=Mi(Math.trunc(n/60),2),s=Mi(n%60,2);return t+r+e+s}const n2=(i,e)=>{switch(i){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},JI=(i,e)=>{switch(i){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},IY=(i,e)=>{const t=i.match(/(P+)(p+)?/)||[],n=t[1],r=t[2];if(!r)return n2(i,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",n2(n,e)).replace("{{time}}",JI(r,e))},BY={p:JI,P:IY},NY=/^D+$/,OY=/^Y+$/,LY=["D","DD","YY","YYYY"];function PY(i){return NY.test(i)}function UY(i){return OY.test(i)}function FY(i,e,t){const n=zY(i,e,t);if(console.warn(n),LY.includes(i))throw new RangeError(n)}function zY(i,e,t){const n=i[0]==="Y"?"years":"days of the month";return`Use \`${i.toLowerCase()}\` instead of \`${i}\` (in \`${e}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const HY=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,GY=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,kY=/^'([^]*?)'?$/,VY=/''/g,jY=/[a-zA-Z]/;function d_(i,e,t){var g,v,y,A;const n=hS(),r=n.locale??TY,s=n.firstWeekContainsDate??((v=(g=n.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??1,o=n.weekStartsOn??((A=(y=n.locale)==null?void 0:y.options)==null?void 0:A.weekStartsOn)??0,u=fs(i);if(!jX(u))throw new RangeError("Invalid time value");let f=e.match(GY).map(S=>{const T=S[0];if(T==="p"||T==="P"){const M=BY[T];return M(S,r.formatLong)}return S}).join("").match(HY).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const T=S[0];if(T==="'")return{isToken:!1,value:WY(S)};if($R[T])return{isToken:!0,value:S};if(T.match(jY))throw new RangeError("Format string contains an unescaped latin alphabet character `"+T+"`");return{isToken:!1,value:S}});r.localize.preprocessor&&(f=r.localize.preprocessor(u,f));const p={firstWeekContainsDate:s,weekStartsOn:o,locale:r};return f.map(S=>{if(!S.isToken)return S.value;const T=S.value;(UY(T)||PY(T))&&FY(T,e,String(i));const M=$R[T[0]];return M(u,T,r.localize,p)}).join("")}function WY(i){const e=i.match(kY);return e?e[1].replace(VY,"'"):i}function XY(i){return+fs(i)>Date.now()}function YY(i){return+fs(i)<Date.now()}function QY(i,e){const t=+fs(i),[n,r]=[+fs(e.start),+fs(e.end)].sort((s,o)=>s-o);return t>=n&&t<=r}const f_=[{id:"spine-1",position:[-127,0,0]},{id:"spine-2",position:[-105,0,0]},{id:"spine-3",position:[-85,0,0]},{id:"spine-4",position:[-63,0,0]},{id:"spine-5",position:[-45,0,0]},{id:"spine-6",position:[-30,0,0]},{id:"spine-7",position:[-15,0,0]},{id:"spine-8",position:[0,0,0]},{id:"spine-9",position:[15,0,0]},{id:"spine-10",position:[30,0,0]},{id:"spine-11",position:[42,0,0]},{id:"spine-12",position:[55,0,0]},{id:"door-reg-1",position:[-127,0,-5]},{id:"door-conf-n1",position:[-105,0,8]},{id:"door-conf-s1",position:[-105,0,-8]},{id:"door-conf-n2",position:[-85,0,8]},{id:"door-conf-s2",position:[-85,0,-8]},{id:"door-conf-n3",position:[-63,0,10]},{id:"door-conf-s3",position:[-63,0,-10]},{id:"door-exh-n1",position:[-45,0,8]},{id:"door-exh-s1",position:[-45,0,-8]},{id:"door-food-n",position:[-30,0,10]},{id:"door-food-s",position:[-30,0,-10]},{id:"door-exh-n2",position:[-15,0,8]},{id:"door-exh-s2",position:[-15,0,-8]},{id:"door-central-n",position:[0,0,10]},{id:"door-central-s",position:[0,0,-10]},{id:"door-press-n",position:[15,0,10]},{id:"door-press-s",position:[15,0,-10]},{id:"door-plenary-n",position:[30,0,10]},{id:"door-plenary-s",position:[30,0,-10]},{id:"door-vip-n",position:[42,0,6]},{id:"door-vip-s",position:[42,0,-6]},{id:"door-vip-end",position:[55,0,5]},{id:"room-reg",position:[-127,0,-7]},{id:"room-conf-n1",position:[-105,0,12]},{id:"room-conf-s1",position:[-105,0,-12]},{id:"room-conf-n2",position:[-85,0,12]},{id:"room-conf-s2",position:[-85,0,-12]},{id:"room-conf-n3",position:[-63,0,14]},{id:"room-conf-s3",position:[-63,0,-14]},{id:"room-exh-n1",position:[-45,0,12]},{id:"room-exh-s1",position:[-45,0,-12]},{id:"room-food-n",position:[-30,0,14]},{id:"room-food-s",position:[-30,0,-14]},{id:"room-exh-n2",position:[-15,0,12]},{id:"room-exh-s2",position:[-15,0,-12]},{id:"room-central-n",position:[0,0,14]},{id:"room-central-s",position:[0,0,-14]},{id:"room-press-n",position:[15,0,14]},{id:"room-press-s",position:[15,0,-14]},{id:"room-plenary-n",position:[30,0,14]},{id:"room-plenary-s",position:[30,0,-14]},{id:"room-vip-n",position:[42,0,10]},{id:"room-vip-s",position:[42,0,-10]},{id:"room-vip-end",position:[55,0,8]}],qc={};function wM(i,e){qc[i]||(qc[i]=[]),qc[e]||(qc[e]=[]),qc[i].includes(e)||qc[i].push(e),qc[e].includes(i)||qc[e].push(i)}for(let i=1;i<=11;i++)wM(`spine-${i}`,`spine-${i+1}`);const qY=[["spine-1","door-reg-1","room-reg"],["spine-2","door-conf-n1","room-conf-n1"],["spine-2","door-conf-s1","room-conf-s1"],["spine-3","door-conf-n2","room-conf-n2"],["spine-3","door-conf-s2","room-conf-s2"],["spine-4","door-conf-n3","room-conf-n3"],["spine-4","door-conf-s3","room-conf-s3"],["spine-5","door-exh-n1","room-exh-n1"],["spine-5","door-exh-s1","room-exh-s1"],["spine-6","door-food-n","room-food-n"],["spine-6","door-food-s","room-food-s"],["spine-7","door-exh-n2","room-exh-n2"],["spine-7","door-exh-s2","room-exh-s2"],["spine-8","door-central-n","room-central-n"],["spine-8","door-central-s","room-central-s"],["spine-9","door-press-n","room-press-n"],["spine-9","door-press-s","room-press-s"],["spine-10","door-plenary-n","room-plenary-n"],["spine-10","door-plenary-s","room-plenary-s"],["spine-11","door-vip-n","room-vip-n"],["spine-11","door-vip-s","room-vip-s"],["spine-12","door-vip-end","room-vip-end"]];for(const[i,e,t]of qY)wM(i,e),wM(e,t);const $y=new Map;for(const i of f_)$y.set(i.id,i);function i2(i){let e=f_[0].id,t=1/0;for(const n of f_){const r=cv(i,n.position);r<t&&(t=r,e=n.id)}return e}function JY(i,e){if(i===e)return[];const t={},n={},r=new Set;for(const u of f_)t[u.id]=u.id===i?0:1/0,n[u.id]=null,r.add(u.id);for(;r.size>0;){let u=null;for(const f of r)(u===null||t[f]<t[u])&&(u=f);if(!u||t[u]===1/0||u===e)break;r.delete(u);for(const f of qc[u]||[]){const p=$y.get(f),g=$y.get(u),v=t[u]+cv(g.position,p.position);v<t[f]&&(t[f]=v,n[f]=u)}}const s=[];let o=e;for(;o;){const u=$y.get(o);s.unshift(u.position),o=n[o]}return s}function KY(i){if(i.length<=2)return i;const e=[i[0]];for(let t=1;t<i.length-1;t++){const n=e[e.length-1],r=i[t],s=i[t+1],o=r[0]-n[0],u=r[2]-n[2],f=s[0]-r[0],p=s[2]-r[2],g=Math.sqrt(o*o+u*u),v=Math.sqrt(f*f+p*p);if(g<.01||v<.01){e.push(r);continue}Math.abs(o/g*(p/v)-u/g*(f/v))>.05&&e.push(r)}return e.push(i[i.length-1]),e}function pS(i,e){const t=i2(i),n=i2(e),s=JY(t,n).filter(g=>cv(i,g)>2&&cv(e,g)>2),o=KY(s),u=[i,...o,e];let f=0;for(let g=0;g<u.length-1;g++)f+=cv(u[g],u[g+1]);const p=Math.ceil(f/84);return{from:i,to:e,waypoints:o,distance:Math.round(f),estimatedTime:p}}function cv(i,e){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2)+Math.pow(e[2]-i[2],2))}function r2(i){const e=u_(i.startTime,new Date);let t="";return e<=5?t=`  ${e} !`:e<=15?t=`  ${e} .   .`:t="   .",{id:`notif-${i.id}-${Date.now()}`,type:"event",title:i.title,message:t,timestamp:new Date,eventId:i.id,zoneId:i.zoneId}}function mS(i,e,t){return{id:`notif-nav-${Date.now()}`,type:"navigation",title:" ",message:` ${i}: ${e} (~${t} )`,timestamp:new Date}}function s2(i,e){const t=u_(i.startTime,new Date);return[15,5,0].some(r=>{const s=`${i.id}-${r}`;return e.has(s)?!1:t<=r&&t>r-1?(e.add(s),!0):!1})}function ZY(){const i=Ue(y=>y.setActivePanel),e=Ue(y=>y.selectedEvent),t=Ue(y=>y.setSelectedEvent),n=Ue(y=>y.favoriteEvents),r=Ue(y=>y.toggleFavoriteEvent),s=Ue(y=>y.zones),o=Ue(y=>y.setRoute),[u,f]=le.useState("all");le.useEffect(()=>{Ue.setState({events:cR})},[]);const p=le.useMemo(()=>{const y=new Date;let A=cR.map(S=>{const T=u_(S.startTime,y),M=u_(S.endTime,y);let E="upcoming";return M<0?E="completed":T<=0&&(E="ongoing"),{...S,status:E,minutesToStart:T}});return u==="favorites"?A=A.filter(S=>n.includes(S.id)):u==="now"&&(A=A.filter(S=>S.status==="ongoing"||S.status==="upcoming"&&S.minutesToStart<=30)),A.sort((S,T)=>S.startTime.getTime()-T.startTime.getTime())},[u,n]),g=y=>{const A=s.find(T=>T.id===y.zoneId),S=Ue.getState().userLocation;if(A&&S){Ue.getState().setViewMode("first-person");const{setCameraTarget:T}=Ue.getState();T(A.id);const M=pS(S.position,A.position);o(M);const{addNotification:E}=Ue.getState();E(mS(A.name,M.distance,M.estimatedTime)),i(null)}},v=[{id:"all",label:""},{id:"favorites",label:""},{id:"now",label:""}];return D.jsxs("div",{className:"max-h-[calc(100vh-60px)] bg-black/40 backdrop-blur-xl text-white overflow-hidden flex flex-col rounded-2xl m-2 border border-white/10 shadow-2xl",children:[D.jsxs("div",{className:"px-4 py-3 flex items-center justify-between shrink-0 border-b border-white/[0.06]",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-blue-400",children:[D.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),D.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),D.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),D.jsx("h2",{className:"text-sm font-semibold text-gray-200",children:""})]}),D.jsx("button",{onClick:()=>i(null),className:"text-gray-500 hover:text-white hover:bg-white/10 rounded-lg p-1 transition-colors",children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),D.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),D.jsx("div",{className:"flex gap-1 px-3 py-2 shrink-0",children:v.map(y=>D.jsx("button",{onClick:()=>f(y.id),className:`flex-1 py-1 text-[11px] font-medium rounded-lg transition-all ${u===y.id?"bg-white/10 text-white border border-white/10":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:y.label},y.id))}),D.jsx("div",{className:"overflow-y-auto px-3 pb-3 space-y-1.5",children:p.length>0?p.map(y=>{const A=n.includes(y.id),S=s.find(M=>M.id===y.zoneId),T=(e==null?void 0:e.id)===y.id;return D.jsxs("div",{className:`bg-white/5 rounded-xl px-3 py-2 cursor-pointer transition-all hover:bg-white/10 ${y.status==="ongoing"?"border-l-[3px] border-green-500/60":y.status==="completed"?"border-l-[3px] border-gray-600/40 opacity-50":"border-l-[3px] border-blue-500/40"} ${T?"ring-1 ring-white/20":""}`,onClick:()=>t(y.id===(e==null?void 0:e.id)?null:y),children:[D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsx("h3",{className:"font-semibold text-xs leading-tight truncate text-gray-100",children:y.title}),D.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-gray-500 mt-0.5",children:[D.jsxs("span",{children:[d_(y.startTime,"HH:mm")," - ",d_(y.endTime,"HH:mm")]}),S&&D.jsxs(D.Fragment,{children:[D.jsx("span",{className:"w-1.5 h-1.5 rounded-full shrink-0",style:{backgroundColor:S.color}}),D.jsx("span",{className:"truncate",children:S.name})]})]})]}),D.jsx("button",{onClick:M=>{M.stopPropagation(),r(y.id)},className:`text-sm p-0.5 shrink-0 transition-transform hover:scale-110 ${A?"text-amber-400":"text-gray-600"}`,children:A?"":""})]}),y.tags&&y.tags.length>0&&D.jsx("div",{className:"flex flex-wrap gap-0.5 mt-1",children:y.tags.map(M=>D.jsx("span",{className:"px-1.5 py-0 bg-white/5 text-gray-500 text-[9px] rounded-md",children:M},M))}),T&&D.jsxs("div",{className:"mt-2 pt-2 border-t border-white/[0.06]",children:[D.jsx("p",{className:"text-[10px] text-gray-400 mb-2 leading-relaxed",children:y.description}),y.speakers&&y.speakers.length>0&&D.jsxs("div",{className:"mb-2 text-[10px]",children:[D.jsx("span",{className:"text-gray-500",children:": "}),D.jsx("span",{className:"text-gray-300",children:y.speakers.join(", ")})]}),D.jsx("button",{onClick:M=>{M.stopPropagation(),g(y)},className:"w-full bg-white/10 hover:bg-white/15 text-white py-1.5 rounded-lg font-medium transition-all text-[10px] border border-white/[0.06]",children:" "})]})]},y.id)}):D.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-600",children:[D.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"mb-2 opacity-30",children:[D.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),D.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),D.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),D.jsx("p",{className:"text-xs",children:u==="favorites"?"   ":u==="now"?"  ":" "})]})})]})}function $Y(){const i=Ue(v=>v.zones),e=Ue(v=>v.setActivePanel),t=Ue(v=>v.events),n=Ue(v=>v.setViewMode),r=Ue(v=>v.setRoute),[s,o]=le.useState(null),u=v=>{n("angle");const{setCameraTarget:y}=Ue.getState();y(v.id)},f=v=>{const y=Ue.getState().userLocation;if(y){const A=pS(y.position,v.position);r(A);const{addNotification:S}=Ue.getState();S(mS(v.name,A.distance,A.estimatedTime)),e(null)}},p=v=>t.filter(y=>y.zoneId===v),g=v=>{switch(v){case"conference":return"";case"exhibition":return"";case"food":return"";case"registration":return"";case"lounge":return"";default:return""}};return D.jsxs("div",{className:"max-h-[calc(100vh-60px)] bg-black/40 backdrop-blur-xl text-white overflow-hidden flex flex-col rounded-2xl m-2 border border-white/10 shadow-2xl",children:[D.jsxs("div",{className:"px-4 py-3 flex items-center justify-between shrink-0 border-b border-white/[0.06]",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-purple-400",children:[D.jsx("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),D.jsx("line",{x1:"16",y1:"6",x2:"16",y2:"22"})]}),D.jsx("h2",{className:"text-sm font-semibold text-gray-200",children:" "})]}),D.jsx("button",{onClick:()=>e(null),className:"text-gray-500 hover:text-white hover:bg-white/10 rounded-lg p-1 transition-colors",children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),D.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),D.jsx("div",{className:"overflow-y-auto px-3 py-2 space-y-1.5",children:i.map(v=>{const y=p(v.id),A=s===v.id;return D.jsxs("div",{className:`bg-white/5 rounded-xl px-3 py-2 cursor-pointer transition-all hover:bg-white/10 ${A?"ring-1 ring-white/20 bg-white/10":""}`,style:{borderLeftColor:v.color,borderLeftWidth:"3px"},onClick:()=>{if(A)o(null);else{o(v.id),n("angle");const{setCameraTarget:S}=Ue.getState();S(v.id)}},children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("span",{className:"text-sm shrink-0",children:g(v.type)}),D.jsxs("div",{className:"min-w-0 flex-1",children:[D.jsx("h3",{className:"font-semibold text-xs leading-tight truncate text-gray-100",children:v.name}),D.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:v.description})]}),y.length>0&&D.jsx("span",{className:"text-[9px] bg-white/10 text-gray-400 px-1.5 py-0.5 rounded-md shrink-0",children:y.length}),D.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:`text-gray-600 transition-transform shrink-0 ${A?"rotate-180":""}`,children:D.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),A&&D.jsxs("div",{className:"mt-2 pt-2 border-t border-white/[0.06] space-y-2",children:[D.jsxs("div",{className:"flex gap-1.5",children:[D.jsxs("button",{onClick:S=>{S.stopPropagation(),f(v)},className:"flex-1 bg-white/10 hover:bg-white/15 text-white py-1.5 rounded-lg font-medium transition-all text-[10px] border border-white/[0.06] flex items-center justify-center gap-1",children:[D.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:D.jsx("polygon",{points:"3 11 22 2 13 21 11 13 3 11"})}),""]}),D.jsxs("button",{onClick:S=>{S.stopPropagation(),u(v)},className:"flex-1 bg-white/10 hover:bg-white/15 text-white py-1.5 rounded-lg font-medium transition-all text-[10px] border border-white/[0.06] flex items-center justify-center gap-1",children:[D.jsxs("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[D.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),D.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),""]})]}),y.length>0&&D.jsxs("div",{className:"space-y-1",children:[D.jsx("div",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wider",children:""}),y.slice(0,3).map(S=>D.jsxs("div",{className:"bg-white/5 rounded-lg px-2 py-1.5 border border-white/[0.04]",children:[D.jsx("div",{className:"font-medium text-[10px] text-gray-200 truncate",children:S.title}),D.jsx("div",{className:"text-[9px] text-gray-500",children:new Date(S.startTime).toLocaleTimeString("ru",{hour:"2-digit",minute:"2-digit"})})]},S.id)),y.length>3&&D.jsxs("div",{className:"text-[9px] text-gray-600 text-center",children:["+  ",y.length-3]})]})]})]},v.id)})})]})}function eQ(){const i=Ue(u=>u.friends),e=Ue(u=>u.selectedFriend),t=Ue(u=>u.setSelectedFriend),n=Ue(u=>u.setActivePanel),r=Ue(u=>u.setRoute),s=u=>{const f=Ue.getState().userLocation;if(f){const p=pS(f.position,u.location.position);r(p);const{addNotification:g}=Ue.getState();g(mS(u.name,p.distance,p.estimatedTime)),n(null)}},o=i.filter(u=>u.isOnline).length;return D.jsxs("div",{className:"max-h-[calc(100vh-60px)] bg-black/40 backdrop-blur-xl text-white overflow-hidden flex flex-col rounded-2xl m-2 border border-white/10 shadow-2xl",children:[D.jsxs("div",{className:"px-4 py-3 flex items-center justify-between shrink-0 border-b border-white/[0.06]",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-emerald-400",children:[D.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),D.jsx("circle",{cx:"9",cy:"7",r:"4"}),D.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),D.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),D.jsx("h2",{className:"text-sm font-semibold text-gray-200",children:""}),D.jsxs("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-400 px-1.5 py-0.5 rounded-md font-medium",children:[o," "]})]}),D.jsx("button",{onClick:()=>n(null),className:"text-gray-500 hover:text-white hover:bg-white/10 rounded-lg p-1 transition-colors",children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),D.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),D.jsxs("div",{className:"flex-1 overflow-y-auto px-3 py-2 space-y-1.5",children:[i.map(u=>{const f=(e==null?void 0:e.id)===u.id;return D.jsxs("div",{className:`bg-white/5 rounded-xl px-3 py-2 cursor-pointer transition-all hover:bg-white/10 ${f?"ring-1 ring-white/20":""} ${u.isOnline?"":"opacity-40"}`,onClick:()=>t(f?null:u),children:[D.jsxs("div",{className:"flex items-center gap-2.5",children:[D.jsxs("div",{className:"relative",children:[D.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-600 to-gray-700 rounded-full flex items-center justify-center",children:D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-400",children:[D.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),D.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),u.isOnline&&D.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-500 border-2 border-black/40 rounded-full"})]}),D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsx("h3",{className:"font-semibold text-xs leading-tight truncate text-gray-100",children:u.name}),D.jsx("p",{className:"text-[10px] text-gray-500",children:u.isOnline?" ":"  "})]})]}),f&&u.isOnline&&D.jsxs("div",{className:"mt-2 pt-2 border-t border-white/[0.06]",children:[D.jsx("div",{className:"text-[10px] text-gray-500 mb-2",children:":  "}),D.jsxs("div",{className:"flex gap-1.5",children:[D.jsx("button",{onClick:p=>{p.stopPropagation(),s(u)},className:"flex-1 bg-white/10 hover:bg-white/15 text-white py-1.5 rounded-lg font-medium transition-all text-[10px] border border-white/[0.06]",children:"  "}),D.jsx("button",{onClick:p=>p.stopPropagation(),className:"px-3 bg-white/10 hover:bg-white/15 text-white py-1.5 rounded-lg font-medium transition-all border border-white/[0.06]",children:D.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:D.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})})]})]})]},u.id)}),i.length===0&&D.jsxs("div",{className:"text-center text-gray-600 py-8",children:[D.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"mx-auto mb-3 opacity-20",children:[D.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),D.jsx("circle",{cx:"9",cy:"7",r:"4"}),D.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),D.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),D.jsx("p",{className:"text-xs mb-3",children:"      "}),D.jsx("button",{className:"px-4 py-1.5 bg-white/10 text-white text-xs rounded-lg hover:bg-white/15 border border-white/[0.06] transition-all",children:" "})]})]})]})}function tQ(){const i=Ue(p=>p.setActivePanel),e=Ue(p=>p.viewMode),t=Ue(p=>p.setViewMode),n=Ue(p=>p.showMiniMap),r=Ue(p=>p.toggleMiniMap),s=p=>Ue.setState({editMode:p}),o=p=>Ue.setState({poiEditMode:p}),u=[{id:"top",label:"",icon:D.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:D.jsx("polyline",{points:"6 9 12 15 18 9"})})},{id:"angle",label:" ",icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),D.jsx("polyline",{points:"2 17 12 22 22 17"}),D.jsx("polyline",{points:"2 12 12 17 22 12"})]})},{id:"first-person",label:"  ",icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),D.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}],f=[{icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),D.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),title:"",description:"  ",action:()=>{t("angle"),i(null)}},{icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),D.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),title:" ",description:"  ",action:()=>{s(!0),i(null)}},{icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),D.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),title:" POI",description:"  ",action:()=>{o(!0),i(null)}},{icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"18"}),D.jsx("line",{x1:"16",y1:"6",x2:"16",y2:"22"})]}),title:n?" -":" -",description:" ",action:()=>r()},{icon:D.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("circle",{cx:"12",cy:"12",r:"10"}),D.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),D.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),title:" ",description:"  ",action:()=>alert("   2026")}];return D.jsxs("div",{className:"max-h-[calc(100vh-60px)] bg-black/40 backdrop-blur-xl text-white overflow-hidden flex flex-col rounded-2xl m-2 border border-white/10 shadow-2xl",children:[D.jsxs("div",{className:"px-4 py-3 flex items-center justify-between shrink-0 border-b border-white/[0.06]",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-400",children:[D.jsx("circle",{cx:"12",cy:"12",r:"3"}),D.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),D.jsx("h2",{className:"text-sm font-semibold text-gray-200",children:""})]}),D.jsx("button",{onClick:()=>i(null),className:"text-gray-500 hover:text-white hover:bg-white/10 rounded-lg p-1 transition-colors",children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),D.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),D.jsxs("div",{className:"px-3 py-2 border-b border-white/[0.06]",children:[D.jsx("div",{className:"text-[10px] text-gray-500 mb-1.5 font-medium uppercase tracking-wider",children:" "}),D.jsx("div",{className:"flex gap-1.5",children:u.map(p=>D.jsxs("button",{onClick:()=>t(p.id),className:`flex-1 flex flex-col items-center gap-1 py-2 rounded-xl font-medium transition-all text-[10px] ${e===p.id?"bg-white/10 text-white border border-white/10":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:[D.jsx("div",{className:e===p.id?"text-blue-400":"",children:p.icon}),D.jsx("span",{children:p.label})]},p.id))})]}),D.jsx("div",{className:"flex-1 overflow-y-auto px-3 py-2 space-y-1",children:f.map((p,g)=>D.jsxs("button",{onClick:p.action,className:"w-full bg-white/5 hover:bg-white/10 rounded-xl px-3 py-2.5 flex items-center gap-3 transition-all text-left group",children:[D.jsx("div",{className:"text-gray-500 group-hover:text-gray-300 transition-colors",children:p.icon}),D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsx("div",{className:"font-semibold text-xs leading-tight text-gray-200",children:p.title}),D.jsx("div",{className:"text-[10px] text-gray-500 truncate",children:p.description})]}),D.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-gray-700 group-hover:text-gray-500 transition-colors shrink-0",children:D.jsx("polyline",{points:"9 18 15 12 9 6"})})]},g))}),D.jsxs("div",{className:"px-4 py-2.5 text-center text-[10px] text-gray-600 border-t border-white/[0.06]",children:[D.jsx("div",{className:"mb-0.5",children:"   2026"}),D.jsx("div",{className:"text-gray-700",children:"v1.0.0"})]})]})}function nQ(){const i=Ue(s=>s.notifications),e=Ue(s=>s.removeNotification);if(le.useEffect(()=>{if(i.length>0){const s=setTimeout(()=>{e(i[0].id)},5e3);return()=>clearTimeout(s)}},[i,e]),i.length===0)return null;const t=i[0],n=()=>{switch(t.type){case"event":return"";case"navigation":return"";case"friend":return"";default:return""}},r=()=>{switch(t.type){case"event":return"from-blue-600 to-purple-600";case"navigation":return"from-green-600 to-teal-600";case"friend":return"from-orange-600 to-red-600";default:return"from-gray-600 to-gray-700"}};return D.jsx("div",{className:"absolute top-4 left-4 right-4 md:left-auto md:right-4 md:w-96 pointer-events-auto z-50",children:D.jsx("div",{className:`bg-gradient-to-r ${r()} text-white rounded-xl p-4 shadow-2xl transform transition-all animate-slide-in`,children:D.jsxs("div",{className:"flex items-start gap-3",children:[D.jsx("div",{className:"text-2xl",children:n()}),D.jsxs("div",{className:"flex-1",children:[D.jsx("h4",{className:"font-bold mb-1",children:t.title}),D.jsx("p",{className:"text-sm opacity-90",children:t.message})]}),D.jsx("button",{onClick:()=>e(t.id),className:"text-white hover:bg-white/20 rounded-full p-1 transition-colors",children:""})]})})})}function iQ(){const i=Ue(r=>r.setArMode),e=Ue(r=>r.currentRoute),t=le.useRef(null),n=le.useRef(null);return le.useEffect(()=>((async()=>{try{const s=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});t.current&&(t.current.srcObject=s)}catch(s){console.error("Camera access error:",s),alert("     . AR  ."),i(!1)}})(),()=>{var s;(s=t.current)!=null&&s.srcObject&&t.current.srcObject.getTracks().forEach(u=>u.stop())}),[i]),le.useEffect(()=>{if(!n.current)return;const r=n.current,s=r.getContext("2d");if(!s)return;let o;const u=()=>{if(s.clearRect(0,0,r.width,r.height),e){const f=r.width/2,p=r.height/2,g=150,v=Date.now()/500,y=(Math.sin(v)+1)*20;s.save(),s.translate(f,p+100),s.shadowColor="rgba(0, 0, 0, 0.5)",s.shadowBlur=10,s.shadowOffsetX=0,s.shadowOffsetY=5,s.beginPath(),s.moveTo(0,y),s.lineTo(0,g+y),s.strokeStyle="#00ccff",s.lineWidth=10,s.lineCap="round",s.stroke(),s.beginPath(),s.moveTo(-30,g-30+y),s.lineTo(0,g+y),s.lineTo(30,g-30+y),s.strokeStyle="#00ccff",s.lineWidth=10,s.lineJoin="round",s.lineCap="round",s.stroke(),s.restore(),s.fillStyle="rgba(0, 0, 0, 0.7)",s.fillRect(f-100,p-150,200,60),s.fillStyle="#ffffff",s.font="bold 20px sans-serif",s.textAlign="center",s.fillText(" ",f,p-125),s.font="16px sans-serif",s.fillText(`${e.distance}`,f,p-105)}else s.fillStyle="rgba(0, 0, 0, 0.7)",s.fillRect(r.width/2-150,50,300,80),s.fillStyle="#ffffff",s.font="16px sans-serif",s.textAlign="center",s.fillText("  ,",r.width/2,80),s.fillText("  AR-",r.width/2,105);o=requestAnimationFrame(u)};return u(),()=>{o&&cancelAnimationFrame(o)}},[e]),D.jsxs("div",{className:"absolute inset-0 bg-black",children:[D.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"}),D.jsx("canvas",{ref:n,width:window.innerWidth,height:window.innerHeight,className:"absolute inset-0 w-full h-full"}),D.jsxs("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-start z-10",children:[D.jsx("button",{onClick:()=>i(!1),className:"bg-gray-900/80 backdrop-blur-sm text-white px-4 py-2 rounded-full font-medium shadow-lg hover:bg-gray-800 transition-colors",children:"   "}),D.jsx("div",{className:"bg-gray-900/80 backdrop-blur-sm text-white px-4 py-2 rounded-full font-medium shadow-lg",children:" AR "})]}),D.jsx("div",{className:"absolute top-20 right-4",children:D.jsx("div",{className:"bg-gray-900/80 backdrop-blur-sm rounded-full p-4 shadow-lg",children:D.jsxs("div",{className:"w-16 h-16 relative",children:[D.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-red-500 text-2xl font-bold",children:"N"}),D.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 64 64",children:[D.jsx("circle",{cx:"32",cy:"32",r:"30",fill:"none",stroke:"rgba(255,255,255,0.3)",strokeWidth:"2"}),D.jsx("line",{x1:"32",y1:"32",x2:"32",y2:"8",stroke:"#ef4444",strokeWidth:"3",strokeLinecap:"round"})]})]})})})]})}function rQ(i,e){const t=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2];return Math.sqrt(t*t+n*n+r*r)}function sQ(i,e){const t=e[0]-i[0],n=e[2]-i[2];let s=Math.atan2(n,t)*180/Math.PI;return s<0&&(s+=360),s}function aQ(i,e){const t=e[0]-i[0],n=e[1]-i[1],r=e[2]-i[2],s=Math.sqrt(t*t+r*r);return Math.atan2(n,s)*180/Math.PI}function oQ(i,e,t,n){const r=t*Math.PI/180,s=n*Math.PI/180,o=e*Math.cos(s),u=o*Math.cos(r),f=e*Math.sin(s),p=o*Math.sin(r);return[i[0]+u,i[1]+f,i[2]+p]}function lQ(){const i=Ue(ne=>ne.zones),e=Ue(ne=>ne.selectedZone),t=Ue(ne=>ne.setSelectedZone),n=Ue(ne=>ne.editMode),r=Ue(ne=>ne.setEditMode),s=Ue(ne=>ne.poiEditMode),o=Ue(ne=>ne.setPoiEditMode),u=Ue(ne=>ne.setViewMode),f=Ue(ne=>ne.setCameraTarget),p=Ue(ne=>ne.cameraPosition),g=Ue(ne=>ne.cameraTargetPosition),[v,y]=le.useState("position"),[A,S]=le.useState(!1),[T,M]=le.useState(!1);le.useEffect(()=>{const ne=s;S(ne),ne?y("poi"):n&&y("position")},[n,s]),le.useEffect(()=>{s?u("angle"):n&&u("top")},[n,s,u]),le.useEffect(()=>{!n&&!s&&t(null)},[n,s,t]);const E=le.useMemo(()=>{if(!e||!p)return null;const ne=e.position,fe=p,X=g||ne,re=rQ(fe,X),ge=sQ(fe,X),Te=aQ(fe,X);return{cameraPosition:[...fe],targetPosition:[...X],distance:re,azimuthDeg:ge,elevationDeg:Te}},[e,p,g]),R=le.useCallback(ne=>{const fe=Ue.getState().zones,X=fe.find(Y=>Y.id===ne);if(!X)return;if(!E){console.log("     ");return}const re={cameraPosition:[...E.cameraPosition],targetPosition:[...E.targetPosition],distance:E.distance,azimuthDeg:E.azimuthDeg,elevationDeg:E.elevationDeg};console.log("Saving POI for zone:",X.name,re),console.log("Current camera position:",p);const ge=fe.map(Y=>Y.id===ne?{...Y,poi:re}:Y);Ue.setState({zones:ge});const Te=Ue.getState().selectedZone;(Te==null?void 0:Te.id)===ne&&t({...Te,poi:re}),M(!1);const Se=`// Zone: ${X.name}
// POI Settings:
poi: {
  cameraPosition: [${re.cameraPosition[0].toFixed(3)}, ${re.cameraPosition[1].toFixed(3)}, ${re.cameraPosition[2].toFixed(3)}],
  targetPosition: [${re.targetPosition[0].toFixed(3)}, ${re.targetPosition[1].toFixed(3)}, ${re.targetPosition[2].toFixed(3)}],
  distance: ${(re.distance??0).toFixed(1)},
  azimuthDeg: ${(re.azimuthDeg??0).toFixed(2)},
  elevationDeg: ${(re.elevationDeg??0).toFixed(2)}
}`;navigator.clipboard.writeText(Se).then(()=>{console.log(`POI  ${X.name} :`,re)})},[E,p,t]),I=le.useCallback(()=>{if(!E||!e)return;const fe=Ue.getState().zones.map(X=>X.id===e.id?{...X,poi:E}:X);Ue.setState({zones:fe}),t({...e,poi:E}),M(!1),console.log("Captured camera POI:",E)},[E,e,t]),O=le.useCallback(ne=>{var ge,Te;const fe=Ue.getState().selectedZone;if((fe==null?void 0:fe.id)===ne.id){t(null),M(!1);return}if(T&&!confirm("    !   ?"))return;const re=Ue.getState().zones.find(Se=>Se.id===ne.id)||ne;t(re),M(!1),(ge=re.poi)!=null&&ge.cameraPosition&&((Te=re.poi)!=null&&Te.targetPosition)?(console.log("Zone has POI, moving camera to it:",re.poi),f(re.id)):(console.log("Zone has no POI, using zone position:",re.position),f(re.id))},[T,t,f]),F=le.useCallback((ne,fe,X)=>{const re=Ue.getState().zones,ge=re.find(Pt=>Pt.id===ne);if(!ge)return;const Te=ge.poi,Se=(Te==null?void 0:Te.targetPosition)||[...ge.position],Y=(Te==null?void 0:Te.distance)??40,me=(Te==null?void 0:Te.azimuthDeg)??0,Ce=(Te==null?void 0:Te.elevationDeg)??45,Ze=fe==="distance"?X:Y,xt=fe==="azimuthDeg"?X:me,ve=fe==="elevationDeg"?X:Ce,dt={cameraPosition:oQ(Se,Ze,xt,ve),targetPosition:Se,distance:Ze,azimuthDeg:xt,elevationDeg:ve},Ee=re.map(Pt=>Pt.id===ne?{...Pt,poi:dt}:Pt);Ue.setState({zones:Ee});const yt=Ue.getState().selectedZone;(yt==null?void 0:yt.id)===ne&&t({...yt,poi:dt}),M(!0)},[t]),z=le.useCallback(()=>{if(T&&!confirm("    ! ?"))return;const ne=Ue.getState().zones,fe=`export const pois: POICamera[] = [
${ne.map((X,re)=>{var Te,Se,Y,me,Ce,Ze,xt,ve,ze;const ge=X.poi;return`  {
    id: 'poi-${X.id.replace("zone-","")}',
    name: '${X.name}',
    color: '${X.color}',
    cameraPosition: [${((Te=ge==null?void 0:ge.cameraPosition)==null?void 0:Te[0].toFixed(4))||0}, ${((Se=ge==null?void 0:ge.cameraPosition)==null?void 0:Se[1].toFixed(4))||0}, ${((Y=ge==null?void 0:ge.cameraPosition)==null?void 0:Y[2].toFixed(4))||0}],
    targetPosition: [${((me=ge==null?void 0:ge.targetPosition)==null?void 0:me[0].toFixed(4))||0}, ${((Ce=ge==null?void 0:ge.targetPosition)==null?void 0:Ce[1].toFixed(4))||0}, ${((Ze=ge==null?void 0:ge.targetPosition)==null?void 0:Ze[2].toFixed(4))||0}],
    description: 'POI: ${X.name}'${ge?`,
    distance: ${(xt=ge.distance)==null?void 0:xt.toFixed(4)},
    azimuthDeg: ${(ve=ge.azimuthDeg)==null?void 0:ve.toFixed(2)},
    elevationDeg: ${(ze=ge.elevationDeg)==null?void 0:ze.toFixed(2)}`:""}
  }${re<ne.length-1?",":""}`}).join(`
`)}
];`;navigator.clipboard.writeText(fe).then(()=>{alert(`   !

  POI    .
  src/data/poiData.ts`)})},[T]),j=le.useCallback((ne,fe,X)=>{const re=Ue.getState().zones,ge=re.find(Ce=>Ce.id===ne);if(!ge)return;const Te=[...ge.position],Se={x:0,y:1,z:2}[fe];Te[Se]=X;const Y=re.map(Ce=>Ce.id===ne?{...Ce,position:Te}:Ce);Ue.setState({zones:Y});const me=Ue.getState().selectedZone;(me==null?void 0:me.id)===ne&&t({...me,position:Te})},[t]),W=le.useCallback((ne,fe,X)=>{const ge=Ue.getState().zones.find(Se=>Se.id===ne);if(!ge)return;const Te={x:0,y:1,z:2}[fe];j(ne,fe,ge.position[Te]+X)},[j]),L=le.useCallback(ne=>{f(ne)},[f]),H=le.useCallback(()=>{y("position"),r(!0),o(!1)},[r,o]),K=le.useCallback(()=>{y("poi"),r(!1),o(!0)},[r,o]),de=le.useCallback(()=>{T&&!confirm("    ! ?")||(r(!1),o(!1),t(null))},[r,o,t,T]);if(!n&&!s)return null;const ce=i.filter(ne=>{var fe,X;return((fe=ne.poi)==null?void 0:fe.cameraPosition)&&((X=ne.poi)==null?void 0:X.targetPosition)}).length;return D.jsx("div",{className:"fixed inset-0 z-50 overflow-hidden pointer-events-none bg-transparent",children:D.jsxs("div",{className:"absolute right-4 top-20 bottom-4 w-96 bg-gray-900/95 backdrop-blur-md rounded-2xl shadow-2xl flex flex-col pointer-events-auto",children:[D.jsxs("div",{className:`bg-gradient-to-r p-3 rounded-t-2xl flex items-center justify-between ${A?"from-orange-600 to-red-600":"from-purple-600 to-pink-600"}`,children:[D.jsxs("div",{children:[D.jsx("h2",{className:"text-lg font-bold text-white",children:A?"  POI":"  "}),D.jsxs("div",{className:"text-xs text-white/70",children:[": ",ce,"/",i.length]})]}),D.jsxs("div",{className:"flex gap-2",children:[D.jsx("button",{onClick:z,className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1",title:" ",children:D.jsx("span",{children:""})}),D.jsx("button",{onClick:de,className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg font-medium transition-colors",children:" "})]})]}),D.jsxs("div",{className:"bg-gray-800 p-2 flex gap-2 border-b border-gray-700",children:[D.jsx("button",{onClick:H,className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${v==="position"?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:" "}),D.jsx("button",{onClick:K,className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${v==="poi"?"bg-orange-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:" POI ()"})]}),D.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[A?D.jsxs("div",{className:"bg-orange-900/30 border-orange-500/50 border rounded-lg p-2 mb-3",children:[D.jsx("h3",{className:"font-bold mb-1 text-sm text-orange-300",children:"   POI:"}),D.jsxs("ol",{className:"text-xs space-y-0.5 text-orange-200 list-decimal list-inside",children:[D.jsx("li",{children:"    "}),D.jsx("li",{children:"   "}),D.jsx("li",{children:"    "}),D.jsx("li",{children:' " "'}),D.jsx("li",{children:"   "})]}),T&&D.jsx("div",{className:"mt-2 text-yellow-300 text-xs font-bold",children:"   !"})]}):D.jsxs("div",{className:"bg-blue-900/30 border-blue-500/50 border rounded-lg p-2 mb-3",children:[D.jsx("h3",{className:"font-bold mb-1 text-sm text-blue-300",children:"   :"}),D.jsxs("ul",{className:"text-xs space-y-0.5 text-blue-200",children:[D.jsx("li",{children:"     "}),D.jsx("li",{children:"    = X (/)"}),D.jsx("li",{children:"    = Z (/)"}),D.jsx("li",{children:"   "})]})]}),D.jsx("div",{className:"space-y-2",children:i.map(ne=>{var ge,Te,Se;const fe=(e==null?void 0:e.id)===ne.id,X=ne.poi,re=!!(X!=null&&X.cameraPosition)&&!!(X!=null&&X.targetPosition);return D.jsxs("div",{className:`bg-gray-800/90 rounded-lg p-2 border-2 transition-all cursor-pointer ${fe?`border-${A?"orange":"purple"}-400 shadow-lg shadow-${A?"orange":"purple"}-500/50`:"border-gray-700 hover:border-gray-600"} ${re?"ring-1 ring-green-500/30":""}`,onClick:()=>O(ne),children:[D.jsx("div",{className:"flex items-center justify-between mb-2",children:D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ne.color}}),D.jsx("span",{className:"font-bold text-white text-sm",children:ne.name}),re&&D.jsx("span",{className:"text-green-400 text-xs",children:""})]})}),fe&&A&&D.jsxs("div",{className:"space-y-2 mt-2 pt-2 border-t border-gray-700",children:[D.jsx("div",{className:"bg-gray-700/50 rounded p-2 mb-2",children:D.jsxs("div",{className:"text-xs text-gray-400",children:[D.jsxs("div",{children:[": ",((ge=X==null?void 0:X.cameraPosition)==null?void 0:ge.map(Y=>Y.toFixed(1)).join(", "))||" "]}),D.jsxs("div",{children:[": ",((Te=X==null?void 0:X.targetPosition)==null?void 0:Te.map(Y=>Y.toFixed(1)).join(", "))||" "]})]})}),D.jsxs("div",{className:"flex gap-2 mb-2",children:[D.jsx("button",{onClick:Y=>{Y.stopPropagation(),I()},className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm font-medium transition-colors",children:"  "}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),R(ne.id)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg text-sm font-medium transition-colors",children:" "})]}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),L(ne.id)},className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-2 rounded-lg text-sm font-medium transition-colors mb-2",children:" "}),D.jsxs("div",{children:[D.jsxs("label",{className:"text-xs text-gray-400 mb-1 block",children:[": ",((Se=X==null?void 0:X.distance)==null?void 0:Se.toFixed(1))||"40"," "]}),D.jsx("input",{type:"range",min:"5",max:"100",step:"1",value:(X==null?void 0:X.distance)||40,onChange:Y=>{Y.stopPropagation(),F(ne.id,"distance",parseFloat(Y.target.value))},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",onClick:Y=>Y.stopPropagation()})]}),D.jsxs("div",{children:[D.jsxs("label",{className:"text-xs text-gray-400 mb-1 block",children:[": ",((X==null?void 0:X.azimuthDeg)||0).toFixed(1),""]}),D.jsx("input",{type:"range",min:"0",max:"360",step:"1",value:(X==null?void 0:X.azimuthDeg)||0,onChange:Y=>{Y.stopPropagation(),F(ne.id,"azimuthDeg",parseFloat(Y.target.value))},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",onClick:Y=>Y.stopPropagation()})]}),D.jsxs("div",{children:[D.jsxs("label",{className:"text-xs text-gray-400 mb-1 block",children:[": ",((X==null?void 0:X.elevationDeg)||45).toFixed(1),""]}),D.jsx("input",{type:"range",min:"0",max:"90",step:"1",value:(X==null?void 0:X.elevationDeg)||45,onChange:Y=>{Y.stopPropagation(),F(ne.id,"elevationDeg",parseFloat(Y.target.value))},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",onClick:Y=>Y.stopPropagation()})]})]}),fe&&!A&&D.jsxs("div",{className:"space-y-2 mt-2 pt-2 border-t border-gray-700",children:[D.jsxs("div",{children:[D.jsxs("label",{className:"text-xs text-gray-400 mb-1 block",children:["X: ",ne.position[0].toFixed(1)]}),D.jsxs("div",{className:"flex gap-1",children:[D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"x",-1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs font-bold",children:" 1"}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"x",-.1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs",children:" .1"}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"x",.1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs",children:".1 "}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"x",1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs font-bold",children:"1 "})]})]}),D.jsxs("div",{children:[D.jsxs("label",{className:"text-xs text-gray-400 mb-1 block",children:["Z: ",ne.position[2].toFixed(1)]}),D.jsxs("div",{className:"flex gap-1",children:[D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"z",-1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs font-bold",children:" 1"}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"z",-.1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs",children:" .1"}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"z",.1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs",children:".1 "}),D.jsx("button",{onClick:Y=>{Y.stopPropagation(),W(ne.id,"z",1)},className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-1 rounded text-xs font-bold",children:"1 "})]})]}),D.jsxs("div",{className:"pt-1 text-xs text-gray-500 font-mono",children:["[",ne.position[0].toFixed(1),", ",ne.position[1].toFixed(1),", ",ne.position[2].toFixed(1),"]"]})]})]},ne.id)})})]})]})})}const cQ=i=>{switch(i){case"conference":return"";case"exhibition":return"";case"food":return"";case"registration":return"";case"lounge":return"";default:return""}};function uQ(){const i=Ue(T=>T.selectedZone),e=Ue(T=>T.setSelectedZone),t=Ue(T=>T.events),n=Ue(T=>T.userLocation),r=Ue(T=>T.setRoute),s=Ue(T=>T.setCameraTarget),o=Ue(T=>T.addNotification),u=Ue(T=>T.setActivePanel),f=Ue(T=>T.setViewMode);if(!i)return null;const p=t.filter(T=>T.zoneId===i.id),g=new Date,v=p.filter(T=>QY(g,{start:T.startTime,end:T.endTime})),y=p.filter(T=>XY(T.startTime)),A=p.filter(T=>YY(T.endTime)),S=()=>{if(n){const T=pS(n.position,i.position);r(T),o(mS(i.name,T.distance,T.estimatedTime)),f("first-person"),s(null),e(null),u(null)}};return D.jsxs("div",{className:"absolute top-2 left-2 right-2 sm:right-auto sm:top-4 sm:left-4 sm:w-[95%] max-w-sm bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl pointer-events-auto overflow-hidden max-h-[85vh] flex flex-col z-50",children:[D.jsxs("div",{className:"px-4 pt-4 pb-3 flex items-start justify-between shrink-0 border-b border-white/[0.06]",children:[D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-lg",style:{backgroundColor:i.color+"20",border:`1px solid ${i.color}40`},children:cQ(i.type)}),D.jsxs("div",{children:[D.jsx("h2",{className:"text-white font-semibold text-base leading-tight",children:i.name}),D.jsx("p",{className:"text-gray-500 text-[11px]",children:i.description})]})]}),D.jsx("button",{onClick:()=>e(null),className:"text-gray-500 hover:text-white hover:bg-white/10 p-1 rounded-lg transition-colors",children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),D.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),D.jsx("div",{className:"px-4 py-3 shrink-0",children:D.jsxs("button",{onClick:S,className:"w-full bg-white/10 hover:bg-white/15 text-white py-2.5 rounded-xl font-semibold transition-all active:scale-[0.98] border border-white/[0.08] flex items-center justify-center gap-2 text-sm",children:[D.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:D.jsx("polygon",{points:"3 11 22 2 13 21 11 13 3 11"})}),D.jsx("span",{children:" "})]})}),D.jsxs("div",{className:"overflow-y-auto flex-1 px-4 pb-4 space-y-3",children:[v.length>0&&D.jsxs("div",{children:[D.jsxs("h3",{className:"text-emerald-400 text-[10px] font-medium uppercase tracking-wider mb-1.5 flex items-center gap-2",children:[D.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"})," "]}),D.jsx("div",{className:"space-y-1.5",children:v.map(T=>D.jsxs("div",{className:"bg-white/5 rounded-xl px-3 py-2 border border-emerald-500/10",children:[D.jsx("div",{className:"font-semibold text-xs text-white",children:T.title}),D.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5",children:[" ",d_(T.endTime,"HH:mm")]})]},T.id))})]}),y.length>0&&D.jsxs("div",{children:[D.jsx("h3",{className:"text-gray-500 text-[10px] font-medium uppercase tracking-wider mb-1.5",children:""}),D.jsx("div",{className:"space-y-1.5",children:y.map(T=>D.jsxs("div",{className:"bg-white/5 rounded-xl px-3 py-2 border border-white/[0.04]",children:[D.jsx("div",{className:"font-semibold text-xs text-gray-200",children:T.title}),D.jsx("div",{className:"text-[10px] text-blue-400/70 mt-0.5 font-medium",children:d_(T.startTime,"HH:mm")})]},T.id))})]}),A.length>0&&D.jsxs("div",{children:[D.jsx("h3",{className:"text-gray-600 text-[10px] font-medium uppercase tracking-wider mb-1.5",children:""}),D.jsx("div",{className:"space-y-1.5 opacity-50",children:A.map(T=>D.jsxs("div",{className:"bg-white/5 rounded-xl px-3 py-2",children:[D.jsx("div",{className:"font-semibold text-xs text-gray-400 line-through",children:T.title}),D.jsx("div",{className:"text-[10px] text-gray-600 mt-0.5",children:""})]},T.id))})]}),p.length===0&&D.jsxs("div",{className:"py-6 text-center",children:[D.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"mx-auto mb-2 text-gray-700",children:[D.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),D.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),D.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),D.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),D.jsx("p",{className:"text-gray-600 text-xs",children:"  "})]})]})]})}const dQ=[{label:"Env Map",value:"/textures/env/env_map.hdr"},{label:"Studio Small 08",value:"/studio_small_08_4k.hdr"},{label:"Shanghai Bund",value:"/shanghai_bund_1k.hdr"},{label:"Industrial Sunset",value:"/industrial_sunset_02_1k.hdr"},{label:"Broadway Hall",value:"/photo_studio_broadway_hall_1k.hdr"},{label:"Monochrome",value:"/monochrome_studio_02_1k.hdr"},{label:"Kominka",value:"/studio_kominka_02_1k.hdr"},{label:"Ferndale 01",value:"/ferndale_studio_01_1k.hdr"},{label:"Ferndale 02",value:"/ferndale_studio_02_1k.hdr"},{label:"Ferndale 04",value:"/ferndale_studio_04_1k.hdr"},{label:"Ferndale 05",value:"/ferndale_studio_05_1k.hdr"},{label:"Ferndale 06",value:"/ferndale_studio_06_1k.hdr"},{label:"Ferndale 07",value:"/ferndale_studio_07_1k.hdr"},{label:"Ferndale 11",value:"/ferndale_studio_11_1k.hdr"},{label:"Ferndale 12",value:"/ferndale_studio_12_1k.hdr"},{label:"Wooden 05",value:"/wooden_studio_05_1k.hdr"},{label:"Wooden 08",value:"/wooden_studio_08_1k.hdr"},{label:"Wooden 15",value:"/wooden_studio_15_1k.hdr"},{label:"Wooden 19",value:"/wooden_studio_19_1k.hdr"},{label:"Studio Small 01",value:"/studio_small_01_1k.hdr"},{label:"Studio Small 02",value:"/studio_small_02_1k.hdr"},{label:"Studio Small 04",value:"/studio_small_04_1k.hdr"}],fQ=[{label:"",time:8,orientation:90,icon:""},{label:"",time:12,orientation:180,icon:""},{label:"",time:14,orientation:200,icon:""},{label:"",time:18,orientation:270,icon:""},{label:"",time:22,orientation:0,icon:""}],hQ=["ACES","AgX","Neutral","Reinhard","Cineon","Linear"];function a2(i){const e=Math.floor(i),t=Math.floor((i-e)*60),n=e<12?"AM":"PM";return`${e===0?12:e>12?e-12:e}:${t.toString().padStart(2,"0")} ${n}`}function Zi({label:i,value:e,min:t,max:n,step:r,onChange:s,displayValue:o}){return D.jsxs("div",{className:"flex-1 min-w-[60px] sm:min-w-0",children:[D.jsxs("div",{className:"flex justify-between items-center mb-1",children:[D.jsx("span",{className:"text-[8px] sm:text-[9px] text-white/50 font-medium tracking-wider uppercase",children:i}),o&&D.jsx("span",{className:"text-[8px] sm:text-[9px] text-white/40 font-mono",children:o})]}),D.jsx("input",{type:"range",min:t,max:n,step:r,value:e,onChange:u=>s(parseFloat(u.target.value)),className:"w-full h-1 bg-white/15 rounded-full appearance-none cursor-pointer accent-white"})]})}function Df({label:i,value:e,onChange:t}){return D.jsx("button",{onClick:()=>t(!e),className:`px-2 py-1 rounded-md text-[10px] font-medium transition-all border whitespace-nowrap ${e?"bg-blue-500/30 border-blue-400/40 text-blue-300":"bg-white/5 border-white/10 text-white/40"}`,children:i})}function Wy({onClick:i,className:e=""}){return D.jsx("button",{onClick:i,className:`shrink-0 p-1 rounded-full hover:bg-white/10 text-white/40 hover:text-white transition-colors ${e}`,children:D.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),D.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})}function pQ(){const[i,e]=le.useState("lighting"),t=Ue(),n=r=>{t.setTimeOfDay(r.time),t.setSunOrientation(r.orientation)};return D.jsxs("div",{className:"fixed bottom-16 sm:bottom-20 left-1/2 -translate-x-1/2 z-50 pointer-events-auto select-none w-[calc(100%-16px)] sm:w-auto",children:[D.jsx("div",{className:"flex justify-center mb-2 gap-1 overflow-x-auto no-scrollbar",children:[{key:"lighting",label:"",action:()=>t.setBackgroundMode("sky")},{key:"atmosphere",label:"",action:()=>t.setBackgroundMode("sky")},{key:"environment",label:"",action:()=>t.setBackgroundMode("hdri")},{key:"effects",label:"",action:()=>{}}].map(r=>D.jsx("button",{onClick:()=>{e(r.key),r.action()},className:`px-2.5 sm:px-3 py-1 rounded-full text-[10px] sm:text-[11px] font-medium transition-all whitespace-nowrap ${i===r.key?"bg-white/20 text-white backdrop-blur-md":"text-white/50 hover:text-white/80"}`,children:r.label},r.key))}),D.jsx("div",{className:"bg-black/40 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl px-3 sm:px-5 py-3 w-full sm:min-w-[520px] sm:max-w-[780px] max-h-[50vh] overflow-y-auto",children:i==="lighting"?D.jsx("div",{className:"space-y-3 sm:space-y-0",children:D.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-3 sm:gap-5",children:[D.jsxs("div",{className:"shrink-0 text-center",children:[D.jsx("div",{className:"text-xl sm:text-2xl font-bold text-white tracking-tight leading-none",children:a2(t.timeOfDay).split(" ")[0]}),D.jsx("div",{className:"text-[10px] text-white/50 font-medium tracking-wider",children:a2(t.timeOfDay).split(" ")[1]})]}),D.jsx("div",{className:"shrink-0 flex gap-1",children:fQ.map(r=>D.jsx("button",{onClick:()=>n(r),title:r.label,className:`w-7 h-7 rounded-lg text-sm flex items-center justify-center transition-all border ${Math.abs(t.timeOfDay-r.time)<1?"bg-white/20 border-white/30":"bg-white/5 border-white/10 hover:bg-white/15"}`,children:r.icon},r.label))}),D.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[D.jsx("div",{className:"text-[9px] text-white/50 font-medium tracking-wider uppercase mb-1.5",children:"TIME OF DAY"}),D.jsx("input",{type:"range",min:5,max:21,step:.1,value:t.timeOfDay,onChange:r=>t.setTimeOfDay(parseFloat(r.target.value)),className:"w-full h-1.5 rounded-full appearance-none cursor-pointer",style:{background:"linear-gradient(to right, #1a1a3e, #4a3a6e, #c98030, #f0c040, #ffe870, #f0c040, #c98030, #4a3a6e, #1a1a3e)"}})]}),D.jsxs("div",{className:"w-full sm:w-[90px] shrink-0",children:[D.jsx("div",{className:"text-[9px] text-white/50 font-medium tracking-wider uppercase mb-1.5",children:"ORIENTATION"}),D.jsx("input",{type:"range",min:0,max:360,step:1,value:t.sunOrientation,onChange:r=>t.setSunOrientation(parseFloat(r.target.value)),className:"w-full h-1.5 bg-white/15 rounded-full appearance-none cursor-pointer accent-white"})]}),D.jsx(Df,{label:"",value:t.nightLightsEnabled,onChange:t.setNightLightsEnabled}),D.jsx(Wy,{onClick:()=>t.setShowAdjustments(!1)})]})}):i==="environment"?D.jsx("div",{className:"space-y-3 sm:space-y-0",children:D.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-3 sm:gap-4",children:[D.jsxs("div",{className:"shrink-0 w-full sm:w-auto sm:min-w-[120px]",children:[D.jsx("div",{className:"text-[9px] text-white/50 font-medium tracking-wider uppercase mb-1.5",children:"HDRI"}),D.jsx("select",{value:t.hdriFile,onChange:r=>t.setHdriFile(r.target.value),className:"w-full bg-white/10 border border-white/10 rounded-lg px-2 py-1 text-white text-[10px] cursor-pointer focus:outline-none hover:bg-white/15 transition-colors",children:dQ.map(r=>D.jsx("option",{value:r.value,className:"bg-gray-900",children:r.label},r.value))})]}),D.jsx(Zi,{label:"BLUR",value:t.hdriBlur,min:0,max:1,step:.01,onChange:t.setHdriBlur}),D.jsx(Zi,{label:"INTENSITY",value:t.hdriIntensity,min:.05,max:5,step:.01,onChange:t.setHdriIntensity,displayValue:t.hdriIntensity.toFixed(1)}),D.jsx(Zi,{label:"ROTATION",value:t.hdriRotation1,min:0,max:6.28,step:.01,onChange:t.setHdriRotation1}),D.jsx(Zi,{label:"EXPOSURE",value:t.toneMappingExposure,min:.2,max:20,step:.1,onChange:t.setToneMappingExposure,displayValue:t.toneMappingExposure.toFixed(1)}),D.jsx(Wy,{onClick:()=>t.setShowAdjustments(!1)})]})}):i==="atmosphere"?D.jsxs("div",{className:"space-y-3",children:[D.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[D.jsx(Df,{label:" ",value:t.cloudsEnabled,onChange:t.setCloudsEnabled}),D.jsx(Df,{label:" ",value:t.atmosphereEnabled,onChange:t.setAtmosphereEnabled}),D.jsx(Df,{label:" ",value:t.fogEnabled,onChange:t.setFogEnabled}),D.jsx(Df,{label:" ",value:t.godRaysEnabled,onChange:t.setGodRaysEnabled}),D.jsx(Wy,{onClick:()=>t.setShowAdjustments(!1),className:"ml-auto"})]}),t.cloudsEnabled&&D.jsxs("div",{className:"flex flex-wrap items-end gap-2 sm:gap-3",children:[D.jsx(Zi,{label:"",value:t.cloudCoverage,min:0,max:1,step:.01,onChange:t.setCloudCoverage,displayValue:`${Math.round(t.cloudCoverage*100)}%`}),D.jsx(Zi,{label:"",value:t.cloudDensity,min:0,max:1,step:.01,onChange:t.setCloudDensity,displayValue:t.cloudDensity.toFixed(2)}),D.jsx(Zi,{label:"",value:t.cloudScale,min:.3,max:3,step:.1,onChange:t.setCloudScale,displayValue:t.cloudScale.toFixed(1)}),D.jsx(Zi,{label:"",value:t.cloudSpeed,min:0,max:.1,step:.001,onChange:t.setCloudSpeed,displayValue:t.cloudSpeed.toFixed(3)}),D.jsx(Zi,{label:"",value:t.cloudAltitude,min:30,max:200,step:5,onChange:t.setCloudAltitude,displayValue:`${t.cloudAltitude}`}),D.jsx(Zi,{label:".",value:t.cloudOpacity,min:0,max:1,step:.01,onChange:t.setCloudOpacity,displayValue:t.cloudOpacity.toFixed(2)})]}),(t.atmosphereEnabled||t.fogEnabled||t.godRaysEnabled)&&D.jsxs("div",{className:"flex flex-wrap items-end gap-2 sm:gap-3",children:[t.atmosphereEnabled&&D.jsxs(D.Fragment,{children:[D.jsx(Zi,{label:".",value:t.atmosphereIntensity,min:0,max:1,step:.01,onChange:t.setAtmosphereIntensity,displayValue:t.atmosphereIntensity.toFixed(2)}),D.jsx(Zi,{label:"",value:t.atmosphereTurbidity,min:.5,max:10,step:.1,onChange:t.setAtmosphereTurbidity,displayValue:t.atmosphereTurbidity.toFixed(1)}),D.jsx(Zi,{label:"",value:t.atmosphereRayleighScale,min:.1,max:3,step:.1,onChange:t.setAtmosphereRayleighScale,displayValue:t.atmosphereRayleighScale.toFixed(1)})]}),t.fogEnabled&&D.jsxs(D.Fragment,{children:[D.jsx(Zi,{label:"",value:t.fogDensity,min:0,max:1,step:.01,onChange:t.setFogDensity,displayValue:t.fogDensity.toFixed(2)}),D.jsx(Zi,{label:" .",value:t.fogHeight,min:0,max:20,step:.5,onChange:t.setFogHeight,displayValue:`${t.fogHeight}`})]}),t.godRaysEnabled&&D.jsx(Zi,{label:"",value:t.godRaysIntensity,min:0,max:1,step:.01,onChange:t.setGodRaysIntensity,displayValue:t.godRaysIntensity.toFixed(2)})]})]}):D.jsxs("div",{className:"space-y-3",children:[D.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-3",children:[D.jsx("div",{className:"shrink-0",children:D.jsx("button",{onClick:()=>t.setGraphicsQuality(t.graphicsQuality==="high"?"performance":"high"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all border ${t.graphicsQuality==="high"?"bg-green-500/20 border-green-400/40 text-green-300":"bg-red-500/10 border-red-400/20 text-red-300"}`,children:t.graphicsQuality==="high"?" HIGH":" PERF"})}),D.jsxs("div",{className:"shrink-0",children:[D.jsx("div",{className:"text-[9px] text-white/50 font-medium tracking-wider uppercase mb-1",children:"TONE MAP"}),D.jsx("div",{className:"flex gap-0.5 flex-wrap",children:hQ.map(r=>D.jsx("button",{onClick:()=>t.setToneMapping(r),className:`px-1.5 py-0.5 rounded text-[9px] transition-all ${t.toneMapping===r?"bg-white/20 text-white":"text-white/30 hover:text-white/60"}`,children:r},r))})]}),D.jsx(Zi,{label:"EXPOSURE",value:t.toneMappingExposure,min:.2,max:20,step:.1,onChange:t.setToneMappingExposure,displayValue:t.toneMappingExposure.toFixed(1)}),D.jsx(Wy,{onClick:()=>t.setShowAdjustments(!1),className:"ml-auto"})]}),t.graphicsQuality==="high"&&D.jsxs("div",{className:"flex flex-wrap items-end gap-2 sm:gap-3",children:[D.jsx(Zi,{label:"BLOOM",value:t.bloomIntensity,min:0,max:2,step:.01,onChange:t.setBloomIntensity,displayValue:t.bloomIntensity.toFixed(2)}),D.jsx(Zi,{label:"VIGNETTE",value:t.vignetteIntensity,min:0,max:1,step:.01,onChange:t.setVignetteIntensity,displayValue:t.vignetteIntensity.toFixed(2)}),D.jsx(Zi,{label:"CHROMA",value:t.chromaticAberration,min:0,max:.01,step:1e-4,onChange:t.setChromaticAberration}),D.jsx(Df,{label:"DOF",value:t.dofEnabled,onChange:t.setDofEnabled}),D.jsx(Df,{label:"SHADOW",value:t.contactShadowsEnabled,onChange:t.setContactShadowsEnabled})]}),t.graphicsQuality==="high"&&D.jsxs("div",{className:"flex flex-wrap items-end gap-2 sm:gap-3",children:[D.jsx(Zi,{label:"BRIGHTNESS",value:t.colorBrightness,min:-.3,max:.3,step:.01,onChange:t.setColorBrightness,displayValue:t.colorBrightness.toFixed(2)}),D.jsx(Zi,{label:"CONTRAST",value:t.colorContrast,min:-.3,max:.5,step:.01,onChange:t.setColorContrast,displayValue:t.colorContrast.toFixed(2)}),D.jsx(Zi,{label:"SATURATION",value:t.colorSaturation,min:-1,max:1,step:.01,onChange:t.setColorSaturation,displayValue:t.colorSaturation.toFixed(2)}),t.dofEnabled&&D.jsxs(D.Fragment,{children:[D.jsx(Zi,{label:"FOCUS",value:t.dofFocusDistance,min:0,max:.1,step:.001,onChange:t.setDofFocusDistance}),D.jsx(Zi,{label:"BOKEH",value:t.dofBokehScale,min:0,max:10,step:.1,onChange:t.setDofBokehScale,displayValue:t.dofBokehScale.toFixed(1)})]})]}),t.graphicsQuality==="performance"&&D.jsx("div",{className:"text-center text-white/30 text-[10px] py-1",children:"  HIGH   "})]})})]})}function mQ(){const i=Ue(s=>s.activePanel),e=Ue(s=>s.arMode),t=Ue(s=>s.showMiniMap),n=Ue(s=>s.showAdjustments),r=Ue(s=>s.setShowAdjustments);return e?D.jsx(iQ,{}):D.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[D.jsx(nQ,{}),D.jsxs("div",{className:"absolute top-3 sm:top-4 left-3 sm:left-4 pointer-events-none drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)]",children:[D.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[D.jsx("span",{className:"text-white font-bold text-xs sm:text-sm tracking-tight opacity-90",children:""}),D.jsx("span",{className:"text-gray-400 text-xs sm:text-sm",children:"|"}),D.jsx("span",{className:"text-gray-300 text-xs sm:text-sm font-medium",children:"3D "})]}),D.jsxs("div",{className:"text-[9px] sm:text-[10px] text-gray-400 leading-tight hidden sm:block",children:["  ",D.jsx("br",{}),"   "]})]}),D.jsx("div",{className:"absolute top-3 sm:top-4 right-3 sm:right-4 flex items-center gap-2 pointer-events-auto",children:D.jsx("button",{onClick:()=>r(!n),className:`p-2 rounded-xl border transition-all backdrop-blur-xl ${n?"bg-white/15 border-white/20 text-white":"bg-black/30 border-white/[0.08] text-gray-400 hover:text-white hover:bg-black/40"}`,title:"Toggle Settings",children:D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),D.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),D.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),D.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),D.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),D.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),D.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),D.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),D.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]})})}),n&&D.jsx(pQ,{}),D.jsx(lQ,{}),D.jsx(uQ,{}),t&&!n&&D.jsx("div",{className:"absolute top-4 right-4 pointer-events-auto mt-16 scale-75 origin-top-right opacity-50 hidden sm:block",children:D.jsx(LX,{})}),D.jsxs("div",{className:`absolute top-0 left-0 max-h-full w-full sm:w-80 transition-transform duration-300 pointer-events-auto z-40 ${i?"translate-x-0":"-translate-x-full"}`,children:[i==="events"&&D.jsx(ZY,{}),i==="zones"&&D.jsx($Y,{}),i==="friends"&&D.jsx(eQ,{}),i==="menu"&&D.jsx(tQ,{})]}),i&&D.jsx("div",{className:"absolute inset-0 bg-black/30 sm:hidden pointer-events-auto z-30",onClick:()=>Ue.getState().setActivePanel(null)}),!n&&D.jsx("div",{className:"absolute bottom-0 left-0 right-0 pointer-events-auto z-20",children:D.jsx(UX,{})})]})}function gQ(){const i=Ue(n=>n.setZones),e=Ue(n=>n.setUserLocation),t=Ue(n=>n.zones);return le.useEffect(()=>{if(t.length===0){i(ZA);const n=ZA.find(r=>r.name.includes(""));n&&e({position:n.position,rotation:0,timestamp:new Date})}},[i,e,t.length]),null}function vQ(){const i=Ue(r=>r.events),e=Ue(r=>r.favoriteEvents),t=Ue(r=>r.addNotification),n=le.useRef(new Set);le.useEffect(()=>{const r=setInterval(()=>{i.forEach(s=>{e.includes(s.id)&&s2(s,n.current)&&t(r2(s))})},6e4);return i.forEach(s=>{e.includes(s.id)&&s2(s,n.current)&&t(r2(s))}),()=>clearInterval(r)},[i,e,t])}function xQ(){vQ();const[i,e]=le.useState(!0),[t,n]=le.useState(!0);le.useEffect(()=>{const s=setTimeout(()=>{e(!1)},1e3);return()=>clearTimeout(s)},[]);const r=()=>{n(!1)};return i?D.jsx("div",{className:"w-full h-full flex items-center justify-center bg-dark",children:D.jsx("div",{className:"text-white text-2xl",children:"..."})}):t?D.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-blue-900 via-blue-800 to-purple-900 p-6",children:[D.jsxs("div",{className:"text-center mb-8",children:[D.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"  "}),D.jsx("p",{className:"text-blue-200 text-lg",children:"3D   "})]}),D.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-2xl mb-8",children:D.jsx("div",{className:"w-64 h-64 bg-gray-200 flex items-center justify-center rounded-xl",children:D.jsxs("div",{className:"text-gray-500 text-center",children:[D.jsx("div",{className:"text-6xl mb-2",children:""}),D.jsxs("div",{className:"text-sm",children:[" QR-",D.jsx("br",{})," "]})]})})}),D.jsx("button",{onClick:r,className:"bg-white text-blue-900 px-8 py-4 rounded-full font-bold text-lg shadow-lg hover:bg-blue-50 transition-all transform hover:scale-105",children:"  "}),D.jsxs("div",{className:"mt-8 text-blue-200 text-sm text-center max-w-md",children:[D.jsx("p",{children:"  QR-    :"}),D.jsxs("ul",{className:"mt-2 space-y-1",children:[D.jsx("li",{children:" 3D  "}),D.jsx("li",{children:"    "}),D.jsx("li",{children:" AR "}),D.jsx("li",{children:"  "})]})]})]}):D.jsxs("div",{className:"w-full h-full relative",children:[D.jsx(gQ,{}),D.jsx(OX,{}),D.jsx(mQ,{})]})}GB.createRoot(document.getElementById("root")).render(D.jsx(Cv.StrictMode,{children:D.jsx(xQ,{})}));
//# sourceMappingURL=index-BbcH8T5R.js.map
